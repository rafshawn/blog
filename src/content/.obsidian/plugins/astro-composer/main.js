/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AstroComposerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian14 = require("obsidian");

// src/types.ts
var KNOWN_ARRAY_KEYS = ["tags", "aliases", "cssclasses"];
var CONSTANTS = {
  DEBOUNCE_MS: 500,
  STAT_MTIME_THRESHOLD: 1e3,
  EDITOR_STABILIZE_DELAY: 100,
  FILE_EXPLORER_REVEAL_DELAY: 200
};

// src/settings.ts
var DEFAULT_SETTINGS = {
  defaultTemplate: '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
  autoInsertProperties: true,
  dateFormat: "YYYY-MM-DD",
  enableCopyHeadingLink: true,
  copyHeadingLinkFormat: "obsidian",
  addTrailingSlashToLinks: false,
  enableOpenTerminalCommand: false,
  terminalProjectRootPath: "",
  terminalApplicationName: "",
  enableTerminalDebugLogging: false,
  enableTerminalRibbonIcon: false,
  enableOpenConfigFileCommand: false,
  configFilePath: "",
  enableConfigRibbonIcon: false,
  contentTypes: [],
  migrationCompleted: false,
  helpButtonReplacement: {
    enabled: false,
    commandId: "edit-astro-config",
    iconId: "wrench"
  },
  showMdxFilesInExplorer: false,
  processBackgroundFileChanges: true
};

// src/commands/index.ts
var import_obsidian5 = require("obsidian");

// src/utils/file-operations.ts
var import_obsidian = require("obsidian");

// src/utils/path-matching.ts
function matchesFolderPattern(filePath, folderPattern) {
  const normalizedFilePath = filePath.toLowerCase();
  const normalizedPattern = folderPattern.toLowerCase().replace(/^\/|\/$/g, "");
  if (!normalizedPattern || normalizedPattern.trim() === "") {
    return !normalizedFilePath.includes("/") || normalizedFilePath.split("/").length === 1;
  }
  if (!normalizedPattern.includes("*")) {
    return normalizedFilePath === normalizedPattern || normalizedFilePath.startsWith(normalizedPattern + "/");
  }
  const escapedPattern = normalizedPattern.replace(/[.+?^${}()|[\]\\]/g, "\\$&").replace(/\*/g, "[^/]+");
  const regexPattern = `^${escapedPattern}(?:/|$)`;
  const regex = new RegExp(regexPattern);
  return regex.test(normalizedFilePath);
}
function getPatternDepth(folderPattern) {
  if (!folderPattern || folderPattern.trim() === "") return 0;
  return folderPattern.split("/").length;
}
function sortByPatternSpecificity(types) {
  return [...types].sort((a, b) => {
    const depthA = getPatternDepth(a.folder);
    const depthB = getPatternDepth(b.folder);
    return depthB - depthA;
  });
}

// src/utils/string-utils.ts
function toKebabCase(str) {
  return str.replace(/([a-z0-9])([A-Z])/g, "$1-$2").replace(/([A-Z])([A-Z][a-z])/g, "$1-$2$3").toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
}

// src/utils/file-operations.ts
var FileOperations = class {
  constructor(app, settings, plugin) {
    this.app = app;
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  generateFilename(title, enableUnderscorePrefix = false) {
    const kebabTitle = toKebabCase(title);
    const safeKebabTitle = kebabTitle || "untitled";
    const prefix = enableUnderscorePrefix ? "_" : "";
    return `${prefix}${safeKebabTitle}`;
  }
  determineType(file) {
    const filePath = file.path;
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return contentType.id;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return contentType.id;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return contentType.id;
            }
          }
        } else {
          return contentType.id;
        }
      }
    }
    return "note";
  }
  getContentType(typeId) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    return contentTypes.find((ct) => ct.id === typeId) || null;
  }
  getTitleKey(type) {
    if (type === "note") return "title";
    const contentType = this.getContentType(type);
    if (!contentType) return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  async createFile(options) {
    var _a;
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to create a ${type}.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = toKebabCase(title);
    const enableUnderscorePrefix = (contentType == null ? void 0 : contentType.enableUnderscorePrefix) || false;
    const prefix = enableUnderscorePrefix ? "_" : "";
    let targetFolder = "";
    if (type === "note") {
      targetFolder = "";
    } else if (contentType) {
      const originalDir = ((_a = file.parent) == null ? void 0 : _a.path) || "";
      if (originalDir === "" || originalDir === "/") {
        targetFolder = contentType.folder || "";
      } else {
        targetFolder = originalDir;
      }
    }
    if (targetFolder) {
      const folder = this.app.vault.getAbstractFileByPath(targetFolder);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(targetFolder);
      }
    }
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType);
    } else {
      return this.createFileStructure(file, kebabTitle, prefix, targetFolder, contentType);
    }
  }
  async createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType) {
    const folderName = `${prefix}${kebabTitle}`;
    let folderPath;
    if (targetFolder) {
      folderPath = `${targetFolder}/${folderName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        folderPath = `${currentDir}/${folderName}`;
      } else {
        folderPath = folderName;
      }
    }
    try {
      const folder = this.app.vault.getAbstractFileByPath(folderPath);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(folderPath);
      }
    } catch (e) {
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const fileName = `${indexFileName}${extension}`;
    const newPath = `${folderPath}/${fileName}`;
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        return null;
      }
      setTimeout(() => {
        const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
        if (fileExplorer && fileExplorer.view) {
          const view = fileExplorer.view;
          if (view && typeof view === "object" && "tree" in view) {
            const fileTree = view.tree;
            if (fileTree && newFile instanceof import_obsidian.TFile && typeof fileTree.revealFile === "function") {
              fileTree.revealFile(newFile);
            }
          }
        }
      }, 200);
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a;
        const view = leaf.view;
        if (view && "editor" in view) {
          const editor = view.editor;
          if (editor) {
            const content = editor.getValue();
            if (content) {
              const lines = content.split("\n");
              const lastLine = lines.length - 1;
              const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
              editor.setCursor({ line: lastLine, ch: lastLineLength });
              editor.focus();
              return true;
            }
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to create folder structure: ${errorMessage}.`);
      return null;
    }
  }
  async createFileStructure(file, kebabTitle, prefix, targetFolder, contentType) {
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const newName = `${prefix}${kebabTitle}${extension}`;
    let newPath;
    if (targetFolder) {
      newPath = `${targetFolder}/${newName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        newPath = `${currentDir}/${newName}`;
      } else {
        newPath = newName;
      }
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File with name "${newName}" already exists.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a;
        const view = leaf.view;
        if (view && "editor" in view) {
          const editor = view.editor;
          if (editor) {
            const content = editor.getValue();
            if (content) {
              const lines = content.split("\n");
              const lastLine = lines.length - 1;
              const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
              editor.setCursor({ line: lastLine, ch: lastLineLength });
              editor.focus();
              return true;
            }
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
  }
  async renameFile(options) {
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to rename the content.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = toKebabCase(title);
    const prefix = "";
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.renameFolderStructure(file, kebabTitle, prefix, type, contentType);
    } else {
      return this.renameFileStructure(file, kebabTitle, prefix, contentType);
    }
  }
  async renameFolderStructure(file, kebabTitle, prefix, type, contentType) {
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const isIndex = file.basename === indexFileName;
    if (isIndex) {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      const newFile = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    } else {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.basename.startsWith("_") ? "_" : "";
      const extension = file.extension;
      const newName = `${prefix}${kebabTitle}.${extension}`;
      const newPath = `${file.parent.path}/${newName}`;
      const existingFile = this.app.vault.getAbstractFileByPath(newPath);
      if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
        new import_obsidian.Notice(`File already exists at ${newPath}.`);
        return null;
      }
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    }
  }
  async renameFileStructure(file, kebabTitle, prefix, contentType) {
    if (!file.parent) {
      new import_obsidian.Notice("Cannot rename: file has no parent folder.");
      return null;
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
    const isIndex = indexFileName && indexFileName.trim() !== "" && file.basename === indexFileName;
    if (isIndex) {
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      if (this.plugin) {
        this.plugin.pluginCreatedFiles.set(newFilePath, Date.now());
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        console.error("FileOperations: Folder rename failed:", error);
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFile2 = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile2 instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile2;
    }
    prefix = file.basename.startsWith("_") ? "_" : "";
    const extension = file.extension;
    const newName = `${prefix}${kebabTitle}.${extension}`;
    let newPath;
    if (file.parent.path === "" || file.parent.path === "/") {
      newPath = newName;
    } else {
      newPath = `${file.parent.path}/${newName}`;
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
    } catch (error) {
      console.error("FileOperations: File rename failed:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
    const newFile = this.app.vault.getAbstractFileByPath(newPath);
    if (!(newFile instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Failed to locate renamed file.");
      return null;
    }
    return newFile;
  }
};

// src/utils/template-parsing.ts
var import_obsidian2 = require("obsidian");
var TemplateParser = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
  }
  /**
   * Convert a string to kebab-case for slug generation
   */
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  parseFrontmatter(content) {
    let propertiesEnd = 0;
    let propertiesText = "";
    const existingProperties = {};
    if (content.startsWith("---")) {
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
      try {
        let currentKey = null;
        const arrayKeys = /* @__PURE__ */ new Set();
        propertiesText.split("\n").forEach((line) => {
          const trimmedLine = line.trim();
          const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
          if (match) {
            const [, key, value] = match;
            currentKey = key;
            const trimmedValue = value ? value.trim() : "";
            const bracketArrayMatch = trimmedValue.match(/^\[(.*)\]$/);
            if (bracketArrayMatch) {
              const arrayContent = bracketArrayMatch[1].trim();
              existingProperties[key] = [];
              arrayKeys.add(key);
              if (arrayContent) {
                const items = [];
                let currentItem = "";
                let inQuotes = false;
                let quoteChar = "";
                for (let i = 0; i < arrayContent.length; i++) {
                  const char = arrayContent[i];
                  if (!inQuotes && (char === '"' || char === "'")) {
                    inQuotes = true;
                    quoteChar = char;
                  } else if (inQuotes && char === quoteChar) {
                    if (i > 0 && arrayContent[i - 1] === "\\") {
                      currentItem += char;
                    } else {
                      inQuotes = false;
                      quoteChar = "";
                    }
                  } else if (!inQuotes && char === ",") {
                    const trimmedItem = currentItem.trim();
                    if (trimmedItem) {
                      const unquoted = trimmedItem.replace(/^["']|["']$/g, "");
                      items.push(unquoted);
                    }
                    currentItem = "";
                  } else {
                    currentItem += char;
                  }
                }
                if (currentItem.trim()) {
                  const trimmedItem = currentItem.trim();
                  const unquoted = trimmedItem.replace(/^["']|["']$/g, "");
                  items.push(unquoted);
                }
                existingProperties[key] = items;
              }
            } else {
              const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
              const isEmptyArray = !trimmedValue || trimmedValue === "";
              const isArrayProperty = isKnownArrayKey || isEmptyArray;
              if (isArrayProperty) {
                existingProperties[key] = [];
                arrayKeys.add(key);
              } else {
                const unquotedValue = trimmedValue.replace(/^["']|["']$/g, "");
                existingProperties[key] = [unquotedValue];
              }
            }
          } else if (currentKey && trimmedLine.startsWith("- ")) {
            const isArrayProperty = arrayKeys.has(currentKey);
            if (isArrayProperty) {
              const item = trimmedLine.replace(/^-\s*/, "");
              if (item) existingProperties[currentKey].push(item);
            }
          } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
            const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
            if (keyMatch) {
              const [, key, value] = keyMatch;
              if (!existingProperties[key]) {
                existingProperties[key] = [value ? value.trim() : ""];
              }
            }
          }
        });
        KNOWN_ARRAY_KEYS.forEach((key) => {
          if (propertiesText.includes(key + ":") && !existingProperties[key]) {
            existingProperties[key] = [];
          }
        });
      } catch (e) {
        new import_obsidian2.Notice("Falling back to template due to parsing error.");
      }
    }
    const bodyContent = content.slice(propertiesEnd);
    return {
      properties: existingProperties,
      propertiesText,
      propertiesEnd,
      bodyContent
    };
  }
  parseTemplate(templateString, title) {
    const templateLines = templateString.split("\n");
    const templateProps = [];
    const templateValues = {};
    let inProperties = false;
    for (let i = 0; i < templateLines.length; i++) {
      const line = templateLines[i].trim();
      if (line === "---") {
        inProperties = !inProperties;
        if (!inProperties) {
          break;
        }
        continue;
      }
      if (inProperties) {
        const match = line.match(/^(\w+):\s*(.*)$/);
        if (match) {
          const [, key, value] = match;
          templateProps.push(key);
          const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
          const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
          const isArrayProperty = isKnownArrayKey || isEmptyArray;
          if (isArrayProperty) {
            if (value && value.startsWith("[")) {
              const items = value.replace(/[[\]]/g, "").split(",").map((t) => t.trim()).filter((t) => t);
              templateValues[key] = items;
            } else {
              templateValues[key] = [];
              for (let j = i + 1; j < templateLines.length; j++) {
                const nextLine = templateLines[j].trim();
                if (nextLine.startsWith("- ")) {
                  const item = nextLine.replace(/^-\s*/, "").trim();
                  if (item) {
                    const arrayValue = templateValues[key];
                    if (Array.isArray(arrayValue)) {
                      arrayValue.push(item);
                    }
                  }
                } else if (nextLine === "---" || nextLine && !nextLine.startsWith("- ") && nextLine.includes(":")) {
                  break;
                }
              }
            }
          } else {
            const slug = this.toKebabCase(title);
            const stringValue = (value || "").replace(/\{\{title\}\}/g, title).replace(/\{\{date\}\}/g, window.moment(/* @__PURE__ */ new Date()).format(this.settings.dateFormat)).replace(/\{\{slug\}\}/g, slug);
            templateValues[key] = stringValue;
          }
        }
      }
    }
    return { templateProps, templateValues };
  }
  buildFrontmatterContent(finalProps, arrayKeys) {
    let newContent = "---\n";
    for (const key in finalProps) {
      const isArrayProperty = KNOWN_ARRAY_KEYS.includes(key) || arrayKeys && arrayKeys.has(key);
      if (isArrayProperty) {
        newContent += `${key}:
`;
        if (finalProps[key].length > 0) {
          finalProps[key].forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${finalProps[key][0] || ""}
`;
      }
    }
    newContent += "---";
    return newContent;
  }
  async updateTitleInFrontmatter(file, newTitle, type) {
    const titleKey = this.getTitleKey(type);
    const hasTitleInTemplate = this.templateHasTitle(type);
    if (!hasTitleInTemplate) {
      return;
    }
    const content = await this.app.vault.read(file);
    let propertiesEnd = 0;
    let propertiesText = "";
    let hasFrontmatter = false;
    if (content.startsWith("---")) {
      hasFrontmatter = true;
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
    }
    const propOrder = [];
    const existing = {};
    let currentKey = null;
    let titleKeyPosition = -1;
    const arrayKeys = /* @__PURE__ */ new Set();
    propertiesText.split("\n").forEach((line, index) => {
      const trimmedLine = line.trim();
      const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
      if (match) {
        const [, key, value] = match;
        propOrder.push(key);
        currentKey = key;
        if (key === titleKey) {
          titleKeyPosition = index;
        }
        const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
        const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
        const isArrayProperty = isKnownArrayKey || isEmptyArray;
        if (isArrayProperty) {
          existing[key] = [];
          arrayKeys.add(key);
        } else {
          existing[key] = value ? value.trim() : "";
        }
      } else if (currentKey && arrayKeys.has(currentKey) && trimmedLine.startsWith("- ")) {
        const item = trimmedLine.replace(/^-\s*/, "");
        if (item) existing[currentKey].push(item);
      } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
        const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
        if (keyMatch) {
          const [, key, value] = keyMatch;
          if (!propOrder.includes(key)) {
            propOrder.push(key);
            existing[key] = value ? value.trim() : "";
          }
        }
      }
    });
    let titleVal;
    if (newTitle.includes('"') || newTitle.includes("'") || newTitle.includes("\n") || newTitle.includes("\\")) {
      titleVal = `'${newTitle.replace(/'/g, "''")}'`;
    } else if (newTitle.includes(" ") || newTitle.includes(":") || newTitle.includes("#") || newTitle.includes("@")) {
      titleVal = `"${newTitle.replace(/"/g, '\\"')}"`;
    } else {
      titleVal = newTitle;
    }
    existing[titleKey] = titleVal;
    if ("slug" in existing) {
      const newSlug = this.toKebabCase(newTitle);
      existing["slug"] = newSlug;
    }
    if (titleKeyPosition === -1) {
      propOrder.push(titleKey);
    }
    if (!hasFrontmatter) {
      return;
    }
    let newContent = "---\n";
    for (const key of propOrder) {
      const val = existing[key];
      if (Array.isArray(val)) {
        newContent += `${key}:
`;
        if (val.length > 0) {
          val.forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${val || ""}
`;
      }
    }
    newContent += "---\n";
    const bodyContent = content.slice(propertiesEnd);
    newContent += bodyContent;
    await this.app.vault.modify(file, newContent);
  }
  getTitleKey(type) {
    if (type === "note") return "title";
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType) return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  // Check if the template for this content type has {{title}}
  templateHasTitle(type) {
    if (type === "note") return true;
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType) return true;
    const template = contentType.template;
    return template.includes("{{title}}");
  }
};

// src/utils/link-conversion.ts
var import_obsidian3 = require("obsidian");
var LinkConverter = class {
  constructor(settings, plugin) {
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  // Local toKebabCase removed, using imported one instead
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.(md|mdx)$/, "");
    const fileExtension = link.endsWith(".mdx") ? ".mdx" : ".md";
    const contentTypeInfo = this.getContentTypeForPath(path + fileExtension);
    let basePath = contentTypeInfo.basePath || "";
    let contentFolder = contentTypeInfo.contentFolder || "";
    let indexFileName = contentTypeInfo.indexFileName || "";
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  getAstroUrlFromInternalLinkWithContext(link, currentFilePath, currentFileContentType) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.(md|mdx)$/, "");
    let basePath = "";
    let contentFolder = "";
    let indexFileName = "";
    const fileExtension = link.endsWith(".mdx") ? ".mdx" : ".md";
    const targetContentType = this.getContentTypeForPath(path + fileExtension);
    if (!targetContentType.basePath && currentFileContentType.basePath) {
      basePath = currentFileContentType.basePath;
      indexFileName = currentFileContentType.indexFileName;
      contentFolder = currentFileContentType.contentFolder;
    } else {
      basePath = targetContentType.basePath;
      indexFileName = targetContentType.indexFileName;
      contentFolder = targetContentType.contentFolder;
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  isInConfiguredContentDirectory(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return true;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return true;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return true;
            }
          }
        } else {
          return true;
        }
      }
    }
    return false;
  }
  getContentTypeForPath(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: ""
          };
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          } else {
            if (pathDepth === expectedDepth) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          }
        } else {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: contentType.folder
          };
        }
      }
    }
    return {
      basePath: "",
      creationMode: "file",
      indexFileName: "",
      contentFolder: ""
    };
  }
  convertWikilinksForAstro(editor, file) {
    var _a, _b;
    if (!(file instanceof import_obsidian3.TFile)) {
      new import_obsidian3.Notice("No active file.");
      return;
    }
    const cursor = editor.getCursor();
    const originalLine = cursor.line;
    const originalCh = cursor.ch;
    const originalContent = editor.getValue();
    const originalLineCount = originalContent.split("\n").length;
    const originalLineLength = ((_a = originalContent.split("\n")[originalLine]) == null ? void 0 : _a.length) || 0;
    const content = editor.getValue();
    let newContent = content;
    let convertedCount = 0;
    let skippedCount = 0;
    const skippedLinks = [];
    const currentFileContentType = this.getContentTypeForPath(file.path);
    const imageExtensions = /\.(png|jpg|jpeg|gif|svg)$/i;
    const canConvertLink = (linkText) => {
      if (imageExtensions.test(linkText)) {
        return false;
      }
      if (linkText.match(/^https?:\/\//)) {
        return false;
      }
      if (!linkText.includes(".md") && !linkText.includes(".mdx") && !linkText.match(/^[a-zA-Z0-9_-]+(\/[a-zA-Z0-9_-]+)*$/)) {
        return false;
      }
      let targetPath;
      if (linkText.endsWith(".md") || linkText.endsWith(".mdx")) {
        targetPath = linkText;
      } else {
        targetPath = linkText + ".md";
      }
      const isInConfiguredDirectory = this.isInConfiguredContentDirectory(targetPath);
      const isSimpleFilename = !targetPath.includes("/");
      const hasCurrentContentType = currentFileContentType.basePath !== "" || currentFileContentType.creationMode !== "file" || currentFileContentType.indexFileName !== "";
      return isInConfiguredDirectory || isSimpleFilename && hasCurrentContentType;
    };
    newContent = newContent.replace(
      /\[\[([^\]|]+)(\|([^\]]+))?\]\]/g,
      (match, linkText, _pipe, displayText) => {
        if (imageExtensions.test(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        if (!canConvertLink(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        const display = displayText || linkText.replace(/\.(md|mdx)$/, "");
        const url = this.getAstroUrlFromInternalLinkWithContext(linkText, file.path, currentFileContentType);
        convertedCount++;
        return `[${display}](${url})`;
      }
    );
    newContent = newContent.replace(
      /\[([^\]]+)\]\(([^)]+\.(md|mdx)[^)]*)\)/g,
      (match, displayText, link) => {
        if (link.match(/^https?:\/\//) || imageExtensions.test(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        if (!canConvertLink(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        const url = this.getAstroUrlFromInternalLinkWithContext(link, file.path, currentFileContentType);
        convertedCount++;
        return `[${displayText}](${url})`;
      }
    );
    newContent = newContent.replace(
      /!\[(.*?)\]\(([^)]+)\)/g,
      (match) => {
        skippedCount++;
        return match;
      }
    );
    newContent = newContent.replace(/\{\{([^}]+)\}\}/g, (match, fileName) => {
      if (imageExtensions.test(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      if (!canConvertLink(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      const url = this.getAstroUrlFromInternalLinkWithContext(fileName, file.path, currentFileContentType);
      convertedCount++;
      return `[Embedded: ${fileName}](${url})`;
    });
    editor.setValue(newContent);
    const newLineCount = newContent.split("\n").length;
    const newLineLength = ((_b = newContent.split("\n")[originalLine]) == null ? void 0 : _b.length) || 0;
    let newLine = originalLine;
    let newCh = originalCh;
    if (newLineCount !== originalLineCount) {
      if (newLine >= newLineCount) {
        newLine = Math.max(0, newLineCount - 1);
      }
    }
    if (newLineLength !== originalLineLength) {
      if (newCh > newLineLength) {
        newCh = Math.max(0, newLineLength);
      }
    }
    editor.setCursor({ line: newLine, ch: newCh });
    if (convertedCount > 0 && skippedCount === 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} internal link${convertedCount > 1 ? "s" : ""} for Astro.`);
    } else if (convertedCount > 0 && skippedCount > 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} link${convertedCount > 1 ? "s" : ""} for Astro. Skipped ${skippedCount} link${skippedCount > 1 ? "s" : ""} outside configured content directories.`);
    } else if (skippedCount > 0) {
      new import_obsidian3.Notice(`No links converted. All ${skippedCount} link${skippedCount > 1 ? "s" : ""} are outside configured content directories or are images/external links.`);
    } else {
      new import_obsidian3.Notice("No internal links found to convert.");
    }
  }
};

// src/ui/title-modal.ts
var import_obsidian4 = require("obsidian");
var TitleModal = class extends import_obsidian4.Modal {
  constructor(app, file, plugin, type, isRename = false, isNewNote = false) {
    super(app);
    this.file = file;
    this.plugin = plugin;
    this.type = type;
    this.isRename = isRename;
    this.isNewNote = isNewNote;
    const settings = plugin.settings;
    this.fileOps = new FileOperations(app, settings, plugin);
    this.templateParser = new TemplateParser(app, settings);
  }
  async getCurrentTitleAsync() {
    if (!this.file) {
      return "";
    }
    try {
      const content = await this.app.vault.read(this.file);
      const titleKey = this.fileOps.getTitleKey(this.type);
      const { properties } = this.templateParser.parseFrontmatter(content);
      if (titleKey in properties) {
        const titleValue = properties[titleKey];
        if (Array.isArray(titleValue) && titleValue.length > 0) {
          return String(titleValue[0]);
        }
        if (titleValue !== null && titleValue !== void 0) {
          return String(titleValue);
        }
      }
    } catch (error) {
      console.error("Error reading file for title:", error);
    }
    return this.getFallbackTitle();
  }
  getCurrentTitle() {
    if (!this.file) {
      return "";
    }
    const titleKey = this.fileOps.getTitleKey(this.type);
    const cache = this.app.metadataCache.getFileCache(this.file);
    if ((cache == null ? void 0 : cache.frontmatter) && titleKey in cache.frontmatter) {
      const titleValue = cache.frontmatter[titleKey];
      if (typeof titleValue === "string") {
        return titleValue;
      }
      if (Array.isArray(titleValue) && titleValue.length > 0) {
        const firstValue = titleValue[0];
        if (typeof firstValue === "string") {
          return firstValue;
        }
        if (firstValue != null) {
          if (typeof firstValue === "number" || typeof firstValue === "boolean") {
            return String(firstValue);
          }
          if (typeof firstValue === "string") {
            return firstValue;
          }
        }
      }
      if (titleValue == null) {
        return "";
      }
      if (typeof titleValue === "number" || typeof titleValue === "boolean") {
        return String(titleValue);
      }
      if (typeof titleValue === "string") {
        return titleValue;
      }
      return "";
    }
    return this.getFallbackTitle();
  }
  getFallbackTitle() {
    if (!this.file) {
      return "";
    }
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    return basename.replace(/-/g, " ").split(" ").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
  /**
   * Extracts a suggested title from the file basename for newly created files.
   * This is used when a file is created from a link (e.g., [[sEfsleif]]).
   * Preserves the original text as much as possible.
   */
  getSuggestedTitleFromBasename() {
    if (!this.file) {
      return "";
    }
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    return basename;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const isMobile = window.innerWidth <= 768 || import_obsidian4.Platform.isMobile;
    if (isMobile) {
      this.modalEl.addClass("astro-composer-mobile-modal");
    }
    if (this.isRename) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "Rename content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Rename ${typeName} content` });
        contentEl.createEl("p", { text: `Enter new title for your ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      void this.getCurrentTitleAsync().then((title) => {
        this.titleInput.value = title;
      });
    } else if (this.isNewNote) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
    } else {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      if (this.file) {
        const suggestedTitle = this.getSuggestedTitleFromBasename();
        if (suggestedTitle) {
          this.titleInput.value = suggestedTitle;
        }
      }
    }
    this.titleInput.focus();
    if (this.isNewNote) {
      setTimeout(() => {
        this.titleInput.setSelectionRange(0, 0);
      }, 0);
    }
    const buttonContainer = contentEl.createDiv({ cls: "astro-composer-button-container" });
    const cancelButton = buttonContainer.createEl("button", { text: "Cancel", cls: "astro-composer-cancel-button" });
    cancelButton.onclick = () => this.close();
    const submitButton = buttonContainer.createEl("button", { text: this.isRename ? "Rename" : "Create", cls: ["astro-composer-create-button", "mod-cta"] });
    submitButton.onclick = () => this.submit();
    this.titleInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") void this.submit();
    });
  }
  async submit() {
    const title = this.titleInput.value.trim();
    if (!title) {
      new import_obsidian4.Notice("Please enter a title.");
      return;
    }
    try {
      let newFile = null;
      if (this.isRename) {
        newFile = await this.fileOps.renameFile({ file: this.file, title, type: this.type });
        if (newFile) {
          await this.templateParser.updateTitleInFrontmatter(newFile, title, this.type);
        } else {
          this.close();
          return;
        }
      } else if (this.isNewNote) {
        if (this.file) {
          newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
          const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
          if (newFile && shouldInsertProperties) {
            await this.addPropertiesToFile(newFile, title, this.type);
            this.positionCursorAtEnd(newFile);
          }
        }
      } else if (this.file) {
        newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
        const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
        if (newFile && shouldInsertProperties) {
          await this.addPropertiesToFile(newFile, title, this.type);
          this.positionCursorAtEnd(newFile);
        }
      } else {
        newFile = await this.createNewFile(title);
      }
      if (!newFile) {
        new import_obsidian4.Notice(`Failed to ${this.isRename ? "rename" : "create"} ${this.type}.`);
        this.close();
        return;
      }
    } catch (error) {
      console.error("TitleModal: Error during process:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian4.Notice(`Error ${this.isRename ? "renaming" : "creating"} ${this.type}: ${errorMessage}.`);
      this.close();
      return;
    }
    this.close();
  }
  getTypeDisplayName() {
    if (this.type === "note") {
      return "Content";
    }
    const contentType = this.fileOps.getContentType(this.type);
    return contentType ? contentType.name : "Content";
  }
  async createNewFile(title) {
    var _a, _b;
    let targetFolder;
    const originalDir = ((_b = (_a = this.file) == null ? void 0 : _a.parent) == null ? void 0 : _b.path) || "";
    if (this.type !== "note") {
      const contentType2 = this.fileOps.getContentType(this.type);
      if (originalDir === "" || originalDir === "/") {
        targetFolder = (contentType2 == null ? void 0 : contentType2.folder) || "";
      } else {
        targetFolder = originalDir;
      }
    } else {
      targetFolder = originalDir;
    }
    const filename = this.fileOps.generateFilename(title);
    const contentType = this.fileOps.getContentType(this.type);
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const filePath = targetFolder ? `${targetFolder}/${filename}${extension}` : `${filename}${extension}`;
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(filePath, Date.now());
    }
    let initialContent = "";
    if (this.plugin.settings.autoInsertProperties) {
      initialContent = this.generateInitialContent(title);
    }
    try {
      const newFile = await this.app.vault.create(filePath, initialContent);
      const leaf = this.app.workspace.getLeaf();
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a2;
        const view = leaf.view;
        if (view instanceof import_obsidian4.MarkdownView && view.editor) {
          const editor = view.editor;
          const content = editor.getValue();
          if (content) {
            const lines = content.split("\n");
            const lastLine = lines.length - 1;
            const lastLineLength = ((_a2 = lines[lastLine]) == null ? void 0 : _a2.length) || 0;
            editor.setCursor({ line: lastLine, ch: lastLineLength });
            editor.focus();
            return true;
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      throw new Error(`Failed to create file: ${errorMessage}`);
    }
  }
  generateInitialContent(title) {
    const now = /* @__PURE__ */ new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    const slug = toKebabCase(title);
    let template;
    if (this.type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(this.type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    template = template.replace(/\{\{slug\}\}/g, slug);
    return template;
  }
  async addPropertiesToFile(file, title, type) {
    const now = /* @__PURE__ */ new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    const slug = toKebabCase(title);
    let template;
    if (type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    template = template.replace(/\{\{slug\}\}/g, slug);
    await this.app.vault.modify(file, template);
  }
  positionCursorAtEnd(file) {
    const positionCursor = () => {
      var _a;
      const view = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
      if (view && view.file === file && view.editor) {
        const editor = view.editor;
        const content = editor.getValue();
        if (content) {
          const lines = content.split("\n");
          const lastLine = lines.length - 1;
          const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
          editor.setCursor({ line: lastLine, ch: lastLineLength });
          editor.focus();
          return true;
        }
      }
      return false;
    };
    setTimeout(() => {
      if (!positionCursor()) {
        setTimeout(() => {
          positionCursor();
        }, 200);
      }
    }, 100);
  }
  escapeYamlString(str) {
    if (str.includes('"') || str.includes("'") || str.includes("\n") || str.includes("\\")) {
      return `'${str.replace(/'/g, "''")}'`;
    } else if (str.includes(" ") || str.includes(":") || str.includes("#") || str.includes("@")) {
      return `"${str.replace(/"/g, '\\"')}"`;
    } else {
      return str;
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/commands/index.ts
function registerCommands(plugin, settings) {
  const isMobile = import_obsidian5.Platform.isMobile;
  if (isMobile) {
    let hasMatchingContentType2 = function(file, settings2) {
      const type = fileOps.determineType(file);
      if (type === "note") {
        return false;
      }
      const contentType = fileOps.getContentType(type);
      return contentType !== null && contentType.enabled;
    };
    var hasMatchingContentType = hasMatchingContentType2;
    const pluginInterface2 = plugin;
    const fileOps = new FileOperations(plugin.app, settings, pluginInterface2);
    const linkConverter = new LinkConverter(settings, pluginInterface2);
    plugin.addCommand({
      id: "standardize-properties",
      name: "Standardize properties",
      icon: "file-check",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          const currentSettings = pluginInterface2.settings || settings;
          void standardizeProperties(plugin.app, currentSettings, file, pluginInterface2, editor);
        }
      }
    });
    plugin.addCommand({
      id: "convert-wikilinks-astro",
      name: "Convert internal links for astro",
      icon: "link-2",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          linkConverter.convertWikilinksForAstro(editor, file);
        }
      }
    });
    plugin.addCommand({
      id: "rename-content",
      name: "Rename current content",
      icon: "pencil",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          if (!hasMatchingContentType2(file, settings)) {
            new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
            return;
          }
          const type = fileOps.determineType(file);
          const cache = plugin.app.metadataCache.getFileCache(file);
          const titleKey = fileOps.getTitleKey(type);
          if (!(cache == null ? void 0 : cache.frontmatter) || !(titleKey in cache.frontmatter)) {
            new import_obsidian5.Notice(`Cannot rename: No ${titleKey} found in properties`);
            return;
          }
          new TitleModal(plugin.app, file, plugin, type, true).open();
        }
      }
    });
    return;
  }
  const pluginInterface = plugin;
  function hasMatchingContentType(file, settings2) {
    const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings2;
    const tempFileOps = new FileOperations(plugin.app, currentSettings, plugin);
    const type = tempFileOps.determineType(file);
    if (type === "note") {
      return false;
    }
    const contentType = tempFileOps.getContentType(type);
    return contentType !== null && contentType.enabled;
  }
  plugin.addCommand({
    id: "standardize-properties",
    name: "Standardize properties",
    icon: "file-check",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        void standardizeProperties(plugin.app, settings, file, plugin, editor);
      }
    }
  });
  plugin.addCommand({
    id: "convert-wikilinks-astro",
    name: "Convert internal links for astro",
    icon: "link-2",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentLinkConverter = new LinkConverter(currentSettings, pluginInterface);
        currentLinkConverter.convertWikilinksForAstro(editor, file);
      }
    }
  });
  plugin.addCommand({
    id: "rename-content",
    name: "Rename current content",
    icon: "pencil",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentFileOps = new FileOperations(plugin.app, currentSettings, pluginInterface);
        if (!hasMatchingContentType(file, currentSettings)) {
          new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
          return;
        }
        const type = currentFileOps.determineType(file);
        new TitleModal(plugin.app, file, pluginInterface, type, true).open();
      }
    }
  });
  if (!isMobile) {
    plugin.addCommand({
      id: "open-project-terminal",
      name: "Open project terminal",
      icon: "terminal-square",
      callback: () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenTerminalCommand) {
          new import_obsidian5.Notice("Open terminal command is disabled. Enable it in settings to use this command.");
          return;
        }
        openTerminalInProjectRoot(plugin.app, currentSettings);
      }
    });
  }
  if (!isMobile) {
    plugin.addCommand({
      id: "edit-astro-config",
      name: "Edit astro config",
      icon: "wrench",
      callback: async () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenConfigFileCommand) {
          new import_obsidian5.Notice("Edit config file command is disabled. Enable it in settings to use this command.");
          return;
        }
        await openConfigFile(plugin.app, currentSettings);
      }
    });
  }
}
async function standardizeProperties(app, settings, file, plugin, editor) {
  var _a;
  const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings;
  const templateParser = new TemplateParser(app, currentSettings);
  const fileOps = new FileOperations(app, currentSettings, plugin);
  let cursorPosition = null;
  let originalContent = "";
  if (editor) {
    const cursor = editor.getCursor();
    cursorPosition = { line: cursor.line, ch: cursor.ch };
    originalContent = editor.getValue();
  }
  const type = fileOps.determineType(file);
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  let templateString;
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  const contentType = fileOps.getContentType(type);
  if (!contentType) {
    new import_obsidian5.Notice("Content type not found.");
    return;
  }
  templateString = contentType.template;
  await new Promise((resolve) => setTimeout(resolve, 100));
  const content = await app.vault.read(file);
  const title = file.basename.replace(/^_/, "");
  const parsed = templateParser.parseFrontmatter(content);
  const { templateProps, templateValues } = templateParser.parseTemplate(templateString, title);
  const finalProps = { ...parsed.properties };
  const arrayKeys = /* @__PURE__ */ new Set();
  const slug = toKebabCase(title);
  for (const key of templateProps) {
    if (!(key in parsed.properties)) {
      const templateValue = templateValues[key];
      if (Array.isArray(templateValue)) {
        finalProps[key] = templateValue;
        arrayKeys.add(key);
      } else {
        finalProps[key] = [templateValue || ""];
      }
    } else {
      const templateValue = templateValues[key];
      const isArrayValue = Array.isArray(templateValue);
      if (isArrayValue) {
        const existingItems = parsed.properties[key] || [];
        const newItems = templateValue.filter((item) => !existingItems.includes(item));
        finalProps[key] = [...existingItems, ...newItems];
        arrayKeys.add(key);
      } else {
        if (key === "slug") {
          const existingSlug = parsed.properties[key][0] || "";
          if (!existingSlug || existingSlug.trim() === "") {
            finalProps[key] = [slug];
          }
        }
      }
    }
  }
  if ("slug" in parsed.properties && templateString.includes("{{slug}}")) {
    const existingSlug = parsed.properties["slug"][0] || "";
    if (!existingSlug || existingSlug.trim() === "") {
      finalProps["slug"] = [slug];
    }
  }
  for (const key in parsed.properties) {
    if (parsed.properties[key].length > 1) {
      arrayKeys.add(key);
    }
  }
  const newContent = templateParser.buildFrontmatterContent(finalProps, arrayKeys) + parsed.bodyContent;
  await app.vault.modify(file, newContent);
  if (editor && cursorPosition) {
    await new Promise((resolve) => setTimeout(resolve, 50));
    const activeView = app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
    if (activeView && activeView.file === file && activeView.editor) {
      const activeEditor = activeView.editor;
      const newLineCount = newContent.split("\n").length;
      const originalLineCount = originalContent.split("\n").length;
      let newLine = cursorPosition.line;
      let newCh = cursorPosition.ch;
      if (newLineCount !== originalLineCount) {
        if (newLine >= newLineCount) {
          newLine = Math.max(0, newLineCount - 1);
        }
      }
      const newLineLength = ((_a = newContent.split("\n")[newLine]) == null ? void 0 : _a.length) || 0;
      if (newCh > newLineLength) {
        newCh = Math.max(0, newLineLength);
      }
      activeEditor.setCursor({ line: newLine, ch: newCh });
    }
  }
  new import_obsidian5.Notice("Properties standardized using template.");
}
function renameContentByPath(app, filePath, settings, plugin) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (!(file instanceof import_obsidian5.TFile)) {
    new import_obsidian5.Notice(`File not found: ${filePath}`);
    return;
  }
  const fileOps = new FileOperations(app, settings, plugin);
  function hasMatchingContentType(file2, settings2) {
    const type2 = fileOps.determineType(file2);
    if (type2 === "note") {
      return false;
    }
    const contentType = fileOps.getContentType(type2);
    return contentType !== null && contentType.enabled;
  }
  if (!hasMatchingContentType(file, settings)) {
    new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
    return;
  }
  const type = fileOps.determineType(file);
  new TitleModal(app, file, plugin, type, true).open();
}
function registerContentTypeCommands(plugin, settings) {
  const pluginInterface = plugin;
  const contentTypes = settings.contentTypes || [];
  for (const contentType of contentTypes) {
    if (!contentType.enabled) {
      continue;
    }
    const commandId = `create-content-type-${contentType.id}`;
    const commandName = `Create new content type: ${contentType.name}`;
    plugin.addCommand({
      id: commandId,
      name: commandName,
      callback: async () => {
        let targetFolder = contentType.folder || "";
        if (targetFolder && targetFolder.trim() !== "") {
          const folder = plugin.app.vault.getAbstractFileByPath(targetFolder);
          if (!(folder instanceof import_obsidian5.TFolder)) {
            try {
              await plugin.app.vault.createFolder(targetFolder);
            } catch (error) {
              const errorMessage = error instanceof Error ? error.message : String(error);
              new import_obsidian5.Notice(`Failed to create folder: ${errorMessage}`);
              return;
            }
          }
        }
        const tempFileName = "Untitled.md";
        const filePath = targetFolder ? `${targetFolder}/${tempFileName}` : tempFileName;
        const existingFile = plugin.app.vault.getAbstractFileByPath(filePath);
        if (existingFile instanceof import_obsidian5.TFile) {
          new TitleModal(plugin.app, existingFile, pluginInterface, contentType.id, false, true).open();
          return;
        }
        if (pluginInterface && "pluginCreatedFiles" in pluginInterface) {
          pluginInterface.pluginCreatedFiles.set(filePath, Date.now());
        }
        try {
          const tempFile = await plugin.app.vault.create(filePath, "");
          new TitleModal(plugin.app, tempFile, pluginInterface, contentType.id, false, true).open();
        } catch (error) {
          const errorMessage = error instanceof Error ? error.message : String(error);
          new import_obsidian5.Notice(`Failed to create file: ${errorMessage}`);
          if (pluginInterface && "pluginCreatedFiles" in pluginInterface) {
            pluginInterface.pluginCreatedFiles.delete(filePath);
          }
        }
      }
    });
  }
}
var terminalLogger = {
  enabled: false,
  setEnabled(value) {
    this.enabled = value;
  },
  log(...args) {
    if (this.enabled) {
      console.debug("[astro-composer:terminal]", ...args);
    }
  }
};
function getDefaultTerminalApp() {
  if (!import_obsidian5.Platform.isDesktopApp) {
    return "";
  }
  if (import_obsidian5.Platform.isMacOS) {
    return "Terminal";
  }
  if (import_obsidian5.Platform.isWin) {
    try {
      const os = require("os");
      const release = os.release();
      const majorVersion = parseInt(release.split(".")[0]);
      const buildNumber = parseInt(release.split(".")[2]);
      if (majorVersion > 10 || majorVersion === 10 && buildNumber >= 22e3) {
        return "wt.exe";
      }
    } catch (e) {
    }
    return "cmd.exe";
  }
  if (import_obsidian5.Platform.isLinux) {
    return "gnome-terminal";
  }
  return "";
}
function sanitizeTerminalApp(value) {
  return value.trim();
}
function escapeDoubleQuotes(value) {
  return value.replace(/"/g, '\\"');
}
function openTerminalInProjectRoot(app, settings) {
  terminalLogger.setEnabled(settings.enableTerminalDebugLogging);
  try {
    const { exec } = require("child_process");
    const path = require("path");
    const fs = require("fs");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    let projectPath;
    if (settings.terminalProjectRootPath && settings.terminalProjectRootPath.trim()) {
      projectPath = path.resolve(vaultPathString, settings.terminalProjectRootPath);
    } else {
      projectPath = vaultPathString;
    }
    if (!fs.existsSync(projectPath)) {
      new import_obsidian5.Notice(`Project root directory not found at: ${projectPath}`);
      return;
    }
    const configuredApp = sanitizeTerminalApp(settings.terminalApplicationName || "");
    const terminalApp = configuredApp || getDefaultTerminalApp();
    if (!configuredApp && !terminalApp) {
      new import_obsidian5.Notice("Terminal application name is empty. Please configure it in settings.");
      return;
    }
    const platform = process.platform;
    terminalLogger.log("Opening terminal", { platform, terminalApp, projectPath });
    if (platform === "win32") {
      const escapedPath = projectPath.replace(/"/g, '"');
      const lowerApp = terminalApp.toLowerCase();
      if (lowerApp === "wt.exe" || lowerApp === "wt" || lowerApp === "windows terminal") {
        exec("where wt", (error) => {
          if (!error) {
            const command = `start "" wt.exe -d "${escapedPath}"`;
            terminalLogger.log("Windows launch (wt)", { command, projectPath });
            exec(command, (execError) => {
              if (execError) {
                terminalLogger.log("Windows Terminal failed, falling back to cmd", { error: execError.message });
                const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
                exec(fallbackCommand, (cmdError) => {
                  if (cmdError) {
                    new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
                  }
                });
              }
            });
          } else {
            terminalLogger.log("Windows Terminal not found, using cmd", {});
            const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
            exec(fallbackCommand, (cmdError) => {
              if (cmdError) {
                new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
              }
            });
          }
        });
      } else if (lowerApp === "powershell" || lowerApp === "powershell.exe") {
        const escapedPathForPS = projectPath.replace(/'/g, "''");
        const command = `start "" powershell -NoExit -Command "Set-Location '${escapedPathForPS}';"`;
        terminalLogger.log("Windows launch (powershell)", { command, projectPath });
        exec(command, (error) => {
          if (error) {
            new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
          }
        });
      } else if (lowerApp === "cmd.exe" || lowerApp === "cmd") {
        const command = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
        terminalLogger.log("Windows launch (cmd)", { command, projectPath });
        exec(command, (error) => {
          if (error) {
            new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
          }
        });
      } else {
        const command = `start "" "${terminalApp}"`;
        terminalLogger.log("Windows launch (generic)", { command, terminalApp, projectPath });
        exec(command, (error) => {
          if (error) {
            terminalLogger.log("Generic terminal failed, falling back to cmd", { error: error.message });
            const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
            exec(fallbackCommand, (cmdError) => {
              if (cmdError) {
                new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
              }
            });
          }
        });
      }
    } else if (platform === "darwin") {
      const escapedApp = escapeDoubleQuotes(terminalApp);
      const escapedPath = escapeDoubleQuotes(projectPath);
      const command = `open -na "${escapedApp}" "${escapedPath}"`;
      terminalLogger.log("macOS launch", { command, terminalApp, projectPath });
      exec(command, (error) => {
        if (error) {
          new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
        }
      });
    } else {
      const terminals = terminalApp ? [terminalApp] : ["gnome-terminal", "konsole", "xterm"];
      const projectPathEscaped = projectPath.replace(/"/g, '\\"');
      const tryTerminal = (index) => {
        if (index >= terminals.length) {
          new import_obsidian5.Notice("No supported terminal found. Please install a terminal application or configure one in settings.");
          return;
        }
        const currentTerminal = terminals[index];
        const terminalName = currentTerminal.split(" ")[0];
        exec(`which ${terminalName}`, (error) => {
          if (!error) {
            let command;
            if (currentTerminal.includes("gnome-terminal")) {
              command = `gnome-terminal --working-directory="${projectPathEscaped}"`;
            } else if (currentTerminal.includes("konsole")) {
              command = `konsole --workdir "${projectPathEscaped}"`;
            } else {
              command = `${currentTerminal} -e "cd \\"${projectPathEscaped}\\" && bash"`;
            }
            terminalLogger.log("Linux launch", { command, terminal: currentTerminal, projectPath });
            exec(command, (execError) => {
              if (execError && index < terminals.length - 1) {
                terminalLogger.log("Terminal launch failed, trying next", { terminal: currentTerminal, error: execError.message });
                tryTerminal(index + 1);
              } else if (execError) {
                new import_obsidian5.Notice(`Error opening terminal: ${execError.message || "Unknown error"}`);
              }
            });
          } else {
            terminalLogger.log("Terminal not found, trying next", { terminal: currentTerminal });
            tryTerminal(index + 1);
          }
        });
      };
      tryTerminal(0);
    }
  } catch (error) {
    terminalLogger.log("Unexpected error", { error });
    new import_obsidian5.Notice(`Error opening terminal: ${error instanceof Error ? error.message : String(error)}`);
  }
}
async function openConfigFile(app, settings) {
  try {
    const fs = require("fs");
    const path = require("path");
    const { shell } = require("electron");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    if (!settings.configFilePath || !settings.configFilePath.trim()) {
      new import_obsidian5.Notice("Please specify a config file path in settings.");
      return;
    }
    const configPath = path.resolve(vaultPathString, settings.configFilePath);
    if (!fs.existsSync(configPath)) {
      new import_obsidian5.Notice(`Config file not found at: ${configPath}`);
      return;
    }
    await shell.openPath(configPath);
  } catch (error) {
    new import_obsidian5.Notice(`Error opening config file: ${error instanceof Error ? error.message : String(error)}`);
  }
}

// src/ui/settings-tab.ts
var import_obsidian10 = require("obsidian");

// src/ui/components/CommandPickerModal.ts
var import_obsidian6 = require("obsidian");
var CommandPickerModal = class extends import_obsidian6.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    const commandRegistry = this.app.commands;
    const commandMap = /* @__PURE__ */ new Map();
    if (commandRegistry && typeof commandRegistry.listCommands === "function") {
      try {
        const commands = commandRegistry.listCommands();
        for (const command of commands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting commands via listCommands():", e);
      }
    }
    try {
      const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
      if (registry && typeof registry === "object") {
        const allCommands = Object.values(registry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via registry:", e);
    }
    try {
      const internalRegistry = commandRegistry == null ? void 0 : commandRegistry.commandRegistry;
      if (internalRegistry && typeof internalRegistry === "object") {
        const allCommands = Object.values(internalRegistry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via internal registry:", e);
    }
    const commandOptions = Array.from(commandMap.values());
    commandOptions.sort((a, b) => a.name.localeCompare(b.name));
    return commandOptions;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    this.onSelect(item.id);
  }
  // Override to show command name only
  renderSuggestion(match, el) {
    const item = match.item;
    el.createDiv({ cls: "suggestion-title", text: item.name });
  }
};

// src/ui/components/IconPickerModal.ts
var import_obsidian7 = require("obsidian");
var getIconList = () => {
  if (import_obsidian7.requireApiVersion && (0, import_obsidian7.requireApiVersion)("1.7.3") && import_obsidian7.getIconIds) {
    try {
      return (0, import_obsidian7.getIconIds)();
    } catch (e) {
      console.warn("[Astro Composer] Error getting icon IDs from Obsidian:", e);
    }
  }
  return [
    "settings-2",
    "settings",
    "help-circle",
    "info",
    "star",
    "heart",
    "bookmark",
    "home",
    "search",
    "bell",
    "mail",
    "user",
    "users",
    "folder",
    "file",
    "file-text",
    "image",
    "video",
    "music",
    "calendar",
    "clock",
    "edit",
    "pencil",
    "trash",
    "copy",
    "cut",
    "paste",
    "download",
    "upload",
    "save",
    "share",
    "link",
    "external-link",
    "lock",
    "unlock",
    "eye",
    "eye-off",
    "key",
    "shield",
    "check",
    "x",
    "plus",
    "minus",
    "arrow-left",
    "arrow-right",
    "arrow-up",
    "arrow-down",
    "chevron-left",
    "chevron-right",
    "chevron-up",
    "chevron-down",
    "menu",
    "more-horizontal",
    "more-vertical",
    "grid",
    "list",
    "layout",
    "columns",
    "rows",
    "maximize",
    "minimize",
    "zoom-in",
    "zoom-out",
    "refresh-cw",
    "play",
    "pause",
    "stop",
    "sun",
    "moon",
    "cloud",
    "zap",
    "wand-2",
    "wand",
    "wand-sparkles",
    "palette",
    "brush",
    "sliders",
    "power",
    "wifi",
    "bluetooth",
    "monitor",
    "laptop",
    "smartphone",
    "camera",
    "mic",
    "headphones",
    "code",
    "terminal",
    "terminal-square",
    "github",
    "gitlab",
    "git-branch",
    "git-commit",
    "database",
    "server",
    "cloud-download",
    "cloud-upload",
    "tag",
    "tags",
    "flag",
    "pin",
    "map-pin",
    "compass",
    "globe",
    "rocket",
    "car",
    "bike",
    "robot",
    "apple",
    "windows",
    "linux",
    "chrome",
    "firefox",
    "safari",
    "credit-card",
    "wallet",
    "coins",
    "book",
    "book-open",
    "award",
    "trophy",
    "badge",
    "wrench",
    "tool",
    "package",
    "box",
    "archive",
    "send",
    "reply",
    "forward",
    "mail-open",
    "tag-plus",
    "tag-minus",
    "flag-off",
    "pin-off",
    "map-pin-off",
    "navigation",
    "map",
    "earth",
    "plane",
    "ship",
    "anchor",
    "helicopter",
    "drone",
    "android",
    "keyhole",
    "keys",
    "fingerprint",
    "scan",
    "qr-code",
    "barcode",
    "receipt",
    "piggy-bank",
    "banknote"
  ];
};
var LUCIDE_ICONS = getIconList().map((id) => ({
  id,
  name: id.replace(/^lucide-/, "").replace(/-/g, " ").replace(/(^\w{1})|(\s+\w{1})/g, (letter) => letter.toUpperCase())
})).sort((a, b) => a.name.localeCompare(b.name));
var IconPickerModal = class extends import_obsidian7.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    return LUCIDE_ICONS;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    this.onSelect(item.id);
  }
  // Override to show icon preview
  renderSuggestion(match, el) {
    const item = match.item;
    el.addClass("mod-complex");
    const content = el.createDiv({ cls: "suggestion-content" });
    content.createDiv({ cls: "suggestion-title", text: item.name });
    const aux = el.createDiv({ cls: "suggestion-aux" });
    (0, import_obsidian7.setIcon)(aux.createSpan({ cls: "suggestion-flair" }), item.id);
  }
};

// src/ui/components/ConfirmModal.ts
var import_obsidian8 = require("obsidian");
var ConfirmModal = class extends import_obsidian8.Modal {
  constructor(app, message, confirmText = "Confirm", cancelText = "Cancel") {
    super(app);
    this.message = message;
    this.confirmText = confirmText;
    this.cancelText = cancelText;
    this.result = false;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-confirm-modal");
    contentEl.createEl("p", { text: this.message });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const cancelButton = buttonContainer.createEl("button", {
      text: this.cancelText
    });
    cancelButton.onclick = () => {
      this.result = false;
      this.close();
    };
    const confirmButton = buttonContainer.createEl("button", {
      text: this.confirmText,
      cls: "mod-cta mod-warning"
    });
    confirmButton.onclick = () => {
      this.result = true;
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/utils/settings-compat.ts
var import_obsidian9 = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"), 1);
function createSettingsGroup(containerEl, heading, manifestId) {
  if ((0, import_obsidian9.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  if (manifestId) {
    containerEl.addClass(`${manifestId}-settings-compat`);
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian9.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/ui/settings-tab.ts
var AstroComposerSettingTab = class extends import_obsidian10.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.icon = "lucide-pencil-line";
    this.autoRenameContainer = null;
    this.postsFolderContainer = null;
    this.onlyAutomateContainer = null;
    this.creationModeContainer = null;
    this.indexFileContainer = null;
    this.excludedDirsContainer = null;
    this.underscorePrefixContainer = null;
    this.autoInsertContainer = null;
    this.pagesFieldsContainer = null;
    this.pagesIndexFileContainer = null;
    this.pagesOnlyAutomateContainer = null;
    this.terminalCommandContainer = null;
    this.configCommandContainer = null;
    this.customContentTypesContainer = null;
    this.terminalRibbonToggle = null;
    this.configRibbonToggle = null;
    this.terminalRibbonToggleComponent = null;
    this.configRibbonToggleComponent = null;
    this.plugin = plugin;
  }
  /**
   * Refresh just the content types section
   * More efficient than refreshing the entire settings tab
   */
  refreshContentTypes() {
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const settings = this.plugin.settings;
    this.renderSettingsTab(containerEl, settings);
  }
  renderSettingsTab(containerEl, settings) {
    var _a;
    const generalGroup = createSettingsGroup(containerEl, void 0, "astro-composer");
    generalGroup.addSetting((setting) => {
      setting.setName("Date format").setDesc("Format for the date in properties (e.g., yyyy-mm-dd, MMMM D, yyyy, yyyy-mm-dd HH:mm)").addText(
        (text) => text.setPlaceholder("YYYY-MM-DD").setValue(settings.dateFormat).onChange(async (value) => {
          settings.dateFormat = value || "YYYY-MM-DD";
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Enable copy heading links").setDesc("Add right-click context menu option to copy heading links in various formats.").addToggle(
        (toggle) => toggle.setValue(settings.enableCopyHeadingLink).onChange(async (value) => {
          settings.enableCopyHeadingLink = value;
          await this.plugin.saveSettings();
          this.updateCopyHeadingFields();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Default heading link format").setDesc("Choose the default format for copied heading links. Obsidian format respects your Obsidian settings for wikilink vs markdown preference. Astro link uses your link base path from above and converts the heading into kebab-case format as an anchor link").addDropdown(
        (dropdown) => dropdown.addOption("obsidian", "Obsidian link").addOption("astro", "Astro link").setValue(settings.copyHeadingLinkFormat).onChange(async (value) => {
          settings.copyHeadingLinkFormat = value;
          await this.plugin.saveSettings();
        })
      );
      setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableCopyHeadingLink);
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableCopyHeadingLink);
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Add trailing slash to links").setDesc("Add trailing slashes to all converted internal links (e.g., /about/ instead of /about).").addToggle(
        (toggle) => toggle.setValue(settings.addTrailingSlashToLinks).onChange(async (value) => {
          settings.addTrailingSlashToLinks = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Process background file changes").setDesc("Automatically process new files when they're changed in the background (by Git or other plugins). Disable to prevent modal spam when files are already processed on other devices during a sync.").addToggle(
        (toggle) => toggle.setValue(settings.processBackgroundFileChanges).onChange(async (value) => {
          settings.processBackgroundFileChanges = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Show MDX files in file explorer").setDesc("Make .mdx files visible in Obsidian's file explorer. Requires reload to take effect.").addToggle(
        (toggle) => toggle.setValue(settings.showMdxFilesInExplorer).onChange(async (value) => {
          settings.showMdxFilesInExplorer = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Auto-insert properties").setDesc("Automatically insert the properties template when creating new files for any content type.").addToggle(
        (toggle) => toggle.setValue(settings.autoInsertProperties).onChange(async (value) => {
          settings.autoInsertProperties = value;
          await this.plugin.saveSettings();
        })
      );
    });
    const contentTypesGroup = createSettingsGroup(containerEl, "Content types", "astro-composer");
    contentTypesGroup.addSetting((setting) => {
      setting.settingEl.addClass("astro-composer-setting-hidden-elements");
      setting.settingEl.addClass("astro-composer-setting-container-full-width");
      this.customContentTypesContainer = setting.settingEl.createDiv({
        cls: "custom-content-types-container astro-composer-custom-types-container-visible"
      });
    });
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
    if (!import_obsidian10.Platform.isMobile) {
      const developerGroup = createSettingsGroup(containerEl, "Developer commands", "astro-composer");
      developerGroup.addSetting((setting) => {
        setting.setName("Enable open terminal command").setDesc("Enable command to open terminal in project root directory.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenTerminalCommand).onChange(async (value) => {
            settings.enableOpenTerminalCommand = value;
            await this.plugin.saveSettings();
            this.updateTerminalCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.terminalCommandContainer = containerEl.createDiv({ cls: "terminal-command-fields" });
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path relative to the Obsidian vault root folder. Use ../.. for two levels up. Leave blank to use the vault folder" });
        descFragment.createEl("div", { text: "This is where the terminal will open. Absolute paths work also." });
        setting.setName("Project root directory path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../..").setValue(settings.terminalProjectRootPath).onChange(async (value) => {
            settings.terminalProjectRootPath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Leave blank to use platform defaults. On macOS, the default is Terminal. On Windows, it's Windows Terminal (Win 11) or cmd.exe (Win 10). On Linux, it's gnome-terminal, konsole, or xterm" });
        descFragment.createEl("div", { text: "Examples include Terminal, iTerm, PowerShell, and Alacritty" });
        setting.setName("Terminal application name").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("Terminal").setValue(settings.terminalApplicationName).onChange(async (value) => {
            settings.terminalApplicationName = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Enable debug logging").setDesc("Log terminal launch commands and platform decisions to the developer console for troubleshooting.").addToggle(
          (toggle) => toggle.setValue(settings.enableTerminalDebugLogging).onChange(async (value) => {
            settings.enableTerminalDebugLogging = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open terminal ribbon icon").setDesc("Add a ribbon icon to launch the terminal command.").addToggle((toggle) => {
          this.terminalRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableTerminalRibbonIcon).setDisabled(!settings.enableOpenTerminalCommand).onChange(async (value) => {
            this.plugin.settings.enableTerminalRibbonIcon = value;
            settings.enableTerminalRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
        this.terminalRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Enable edit config file command").setDesc("Enable command to open astro config file in default editor.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenConfigFileCommand).onChange(async (value) => {
            settings.enableOpenConfigFileCommand = value;
            await this.plugin.saveSettings();
            this.updateConfigCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.configCommandContainer = containerEl.createDiv({ cls: "config-command-fields" });
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path to the config file relative to the vault root. Use ../config.ts or ../../astro.config.mjs." });
        descFragment.createEl("div", { text: "Absolute paths work also." });
        setting.setName("Config file path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../config.ts").setValue(settings.configFilePath).onChange(async (value) => {
            settings.configFilePath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open config ribbon icon").setDesc("Add a ribbon icon to launch the config file command.").addToggle((toggle) => {
          this.configRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableConfigRibbonIcon).setDisabled(!settings.enableOpenConfigFileCommand).onChange(async (value) => {
            this.plugin.settings.enableConfigRibbonIcon = value;
            settings.enableConfigRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
        this.configRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Swap out help button for custom action").setDesc("Replace the help button in the vault profile area with a custom action.").addToggle((toggle) => {
          var _a2, _b;
          return toggle.setValue((_b = (_a2 = settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) != null ? _b : false).onChange(async (value) => {
            if (!settings.helpButtonReplacement) {
              settings.helpButtonReplacement = {
                enabled: false,
                commandId: "edit-astro-config",
                iconId: "wrench"
              };
            }
            settings.helpButtonReplacement.enabled = value;
            await this.plugin.saveSettings();
            if (this.plugin.updateHelpButton) {
              await this.plugin.updateHelpButton();
            }
            this.display();
          });
        });
      });
      if ((_a = settings.helpButtonReplacement) == null ? void 0 : _a.enabled) {
        const commandName = this.getCommandName(settings.helpButtonReplacement.commandId);
        developerGroup.addSetting((setting) => {
          setting.setName("Command").setDesc("Select the command to execute when the button is clicked.").addButton((button) => button.setButtonText(commandName || "Select command").onClick(() => {
            const modal = new CommandPickerModal(this.app, (commandId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "wrench"
                  };
                }
                settings.helpButtonReplacement.commandId = commandId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
        const iconName = this.getIconName(settings.helpButtonReplacement.iconId);
        developerGroup.addSetting((setting) => {
          setting.setName("Icon").setDesc("Select the icon to display on the button.").addButton((button) => button.setButtonText(iconName || "Select icon...").onClick(() => {
            const modal = new IconPickerModal(this.app, (iconId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "wrench"
                  };
                }
                settings.helpButtonReplacement.iconId = iconId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
      }
    }
    this.updateCopyHeadingFields();
    if (!import_obsidian10.Platform.isMobile) {
      this.updateTerminalCommandFields();
      this.updateConfigCommandFields();
    }
  }
  updateCopyHeadingFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableCopyHeadingLink;
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl && ((_a = nameEl.textContent) == null ? void 0 : _a.trim()) === "Default heading link format") {
        settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
        settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
      }
    });
  }
  updateTerminalCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenTerminalCommand;
    if (this.terminalCommandContainer) {
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Project root directory path" || name === "Show open terminal ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.terminalRibbonToggleComponent) {
      this.terminalRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenTerminalCommand);
    }
  }
  updateConfigCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenConfigFileCommand;
    if (this.configCommandContainer) {
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Config file path" || name === "Show open config ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.configRibbonToggleComponent) {
      this.configRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenConfigFileCommand);
    }
  }
  checkForFolderConflicts() {
    const settings = this.plugin.settings;
    const blankFolders = [];
    const folderConflicts = {};
    const contentTypes = settings.contentTypes || [];
    for (const contentType of contentTypes) {
      if (contentType.enabled) {
        if (!contentType.folder || contentType.folder.trim() === "") {
          blankFolders.push(contentType.name || "Content");
        } else {
          if (!folderConflicts[contentType.folder]) {
            folderConflicts[contentType.folder] = [];
          }
          folderConflicts[contentType.folder].push(contentType.name || "Content");
        }
      }
    }
  }
  addCustomContentType() {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const newType = {
      id: `content-${Date.now()}`,
      name: `Content ${contentTypes.length + 1}`,
      folder: "",
      linkBasePath: "",
      template: '---\ntitle: "{{title}}"\ndate: {{date}}\n---\n',
      enabled: true,
      creationMode: "file",
      indexFileName: "",
      ignoreSubfolders: false,
      enableUnderscorePrefix: false,
      useMdxExtension: false
    };
    contentTypes.push(newType);
    settings.contentTypes = contentTypes;
    void this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
    registerContentTypeCommands(this.plugin, settings);
  }
  renderCustomContentTypes() {
    if (!this.customContentTypesContainer) return;
    this.customContentTypesContainer.empty();
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    contentTypes.forEach((customType, index) => {
      var _a, _b;
      if (!this.customContentTypesContainer) return;
      const typeContainer = this.customContentTypesContainer.createDiv({
        cls: "custom-content-type-item",
        attr: { "data-type-id": customType.id }
      });
      const header = typeContainer.createDiv({ cls: "custom-content-type-header" });
      header.classList.add("astro-composer-custom-type-header");
      const collapseButton = header.createEl("button", {
        cls: "astro-composer-collapse-button",
        attr: { "aria-label": "Collapse/expand" }
      });
      const isCollapsed = (_a = customType.collapsed) != null ? _a : false;
      (0, import_obsidian10.setIcon)(collapseButton, "chevron-down");
      if (isCollapsed) {
        collapseButton.classList.add("is-collapsed");
      }
      collapseButton.addEventListener("click", () => {
        void this.toggleContentTypeCollapse(customType.id);
        const updatedType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
        if (updatedType) {
          if (updatedType.collapsed) {
            collapseButton.classList.add("is-collapsed");
          } else {
            collapseButton.classList.remove("is-collapsed");
          }
        }
      });
      const headerName = header.createDiv({ cls: "astro-composer-header-name" });
      headerName.createEl("div", { text: customType.name || `Content ${index + 1}`, cls: "setting-item-name" });
      const reorderContainer = header.createDiv({ cls: "astro-composer-reorder-buttons" });
      const upButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move up" }
      });
      (0, import_obsidian10.setIcon)(upButton, "chevron-up");
      upButton.disabled = index === 0;
      upButton.addEventListener("click", () => {
        void this.moveContentTypeUp(customType.id);
      });
      const downButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move down" }
      });
      (0, import_obsidian10.setIcon)(downButton, "chevron-down");
      downButton.disabled = index === contentTypes.length - 1;
      downButton.addEventListener("click", () => {
        void this.moveContentTypeDown(customType.id);
      });
      const toggleContainer = header.createDiv({ cls: "checkbox-container" });
      if (customType.enabled) {
        toggleContainer.classList.add("is-enabled");
      }
      const toggle = toggleContainer.createEl("input", { type: "checkbox", cls: "checkbox-input" });
      toggle.checked = customType.enabled;
      toggleContainer.addEventListener("click", (e) => {
        void (async () => {
          e.preventDefault();
          const newValue = !customType.enabled;
          customType.enabled = newValue;
          toggle.checked = newValue;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (newValue) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, newValue);
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        })();
      });
      toggle.addEventListener("change", (e) => {
        void (async () => {
          const value = e.target.checked;
          customType.enabled = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (value) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, value);
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        })();
      });
      const settingsContainer = typeContainer.createDiv({
        cls: "custom-content-type-settings",
        attr: { "data-type-id": customType.id }
      });
      const initiallyCollapsed = (_b = customType.collapsed) != null ? _b : false;
      const initiallyVisible = customType.enabled && !initiallyCollapsed;
      if (initiallyVisible) {
        settingsContainer.classList.add("astro-composer-setting-container-visible");
      } else {
        settingsContainer.classList.add("astro-composer-setting-container-hidden");
      }
      const nameContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(nameContainer).setName("Content type name").setDesc("Display name for this content type (e.g., 'projects', 'notes', 'tutorials')").addText((text) => {
        text.setPlaceholder("Enter content type name").setValue(customType.name).onChange(async (value) => {
          customType.name = value;
          await this.plugin.saveSettings();
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        });
      });
      const folderContainer = settingsContainer.createDiv();
      const folderSetting = new import_obsidian10.Setting(folderContainer).setName("Folder location").setDesc("Folder path where this content type will be created. Leave blank to use the vault folder. Supports wildcards like directory/* or directory/*/* to match specific folder depths.").addText((text) => {
        text.setPlaceholder("Enter folder path (e.g., 'docs', 'docs/*', 'docs/*/*') or leave blank for vault root").setValue(customType.folder).onChange(async (value) => {
          customType.folder = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          this.updateCustomContentTypeIgnoreSubfoldersField(customType.id);
          const allContentTypes = this.plugin.settings.contentTypes || [];
          for (const ct of allContentTypes) {
            this.updateFolderConflictWarning(ct.id, null);
          }
        });
      });
      folderContainer.createDiv({ cls: "astro-composer-conflict-warning hidden", attr: { "data-type-id": customType.id } });
      this.updateFolderConflictWarning(customType.id, folderSetting);
      const ignoreSubfoldersContainer = settingsContainer.createDiv({ cls: "custom-ignore-subfolders-field" });
      ignoreSubfoldersContainer.setAttribute("data-type-id", customType.id);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder);
      new import_obsidian10.Setting(ignoreSubfoldersContainer).setName("Ignore subfolders").setDesc("When enabled, automation will only trigger for new .md files within this content type's folder and one level down (for folder-based content). Files in deeper subfolders will be ignored.").addToggle(
        (toggle2) => toggle2.setValue(customType.ignoreSubfolders || false).onChange(async (value) => {
          customType.ignoreSubfolders = value;
          await this.plugin.saveSettings();
        })
      );
      const underscorePrefixContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(underscorePrefixContainer).setName("Use underscore prefix for drafts").setDesc("Add an underscore prefix (_content-title) to new notes by default when enabled. This hides them from astro, which can be helpful for drafts").addToggle(
        (toggle2) => toggle2.setValue(customType.enableUnderscorePrefix || false).onChange(async (value) => {
          customType.enableUnderscorePrefix = value;
          await this.plugin.saveSettings();
        })
      );
      const linkContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(linkContainer).setName("Link base path").setDesc("Base path for converted links (e.g., '/projects/', '/notes/tutorials/', leave blank for root /).").addText((text) => {
        text.setPlaceholder("Enter link base path").setValue(customType.linkBasePath || "").onChange(async (value) => {
          customType.linkBasePath = value;
          await this.plugin.saveSettings();
        });
      });
      const creationModeContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(creationModeContainer).setName("Creation mode").setDesc("How to create new entries: file-based or folder-based with an index file.").addDropdown(
        (dropdown) => dropdown.addOption("file", "File-based (content-title.md)").addOption("folder", "Folder-based (content-title/index.md)").setValue(customType.creationMode).onChange(async (value) => {
          customType.creationMode = value;
          await this.plugin.saveSettings();
          this.updateCustomContentTypeIndexFileField(customType.id);
        })
      );
      const useMdxContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(useMdxContainer).setName("Use MDX instead of MD").setDesc("Create files with .mdx extension instead of .md extension.").addToggle(
        (toggle2) => toggle2.setValue(customType.useMdxExtension || false).onChange(async (value) => {
          customType.useMdxExtension = value;
          await this.plugin.saveSettings();
        })
      );
      const indexFileContainer = settingsContainer.createDiv({ cls: "custom-index-file-field" });
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
      new import_obsidian10.Setting(indexFileContainer).setName("Index file name").setDesc("Name for index files in folder-based content (without .md extension). Defaults to 'index' if left blank.").addText(
        (text) => text.setPlaceholder("Index").setValue(customType.indexFileName).onChange(async (value) => {
          customType.indexFileName = value;
          await this.plugin.saveSettings();
        })
      );
      const templateContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(templateContainer).setName("Properties template").addTextArea((text) => {
        text.setPlaceholder('---\ntitle: "{{title}}"\ndate: {{date}}\n---\n').setValue(customType.template).onChange(async (value) => {
          customType.template = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.classList.add("astro-composer-template-textarea");
        return text;
      }).then((setting) => {
        setting.descEl.empty();
        const descDiv = setting.descEl.createEl("div");
        descDiv.createEl("div", { text: "Template for new files of this content type." });
        descDiv.createEl("div", { text: "Variables include {{title}}, {{date}}, and {{slug}}." });
        descDiv.createEl("div", { text: "Do not wrap {{date}} in quotes as it represents a datetime value, not a string." });
      });
      const removeContainer = settingsContainer.createDiv();
      const removeSetting = new import_obsidian10.Setting(removeContainer).setName("").addButton((button) => {
        button.setButtonText("Remove").setWarning().onClick(async () => {
          const contentType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
          const typeName = (contentType == null ? void 0 : contentType.name) || "content type";
          const modal = new ConfirmModal(
            this.app,
            `Are you sure you want to remove "${typeName}"? This action cannot be undone.`,
            "Remove",
            "Cancel"
          );
          const confirmed = await modal.waitForResult();
          if (confirmed) {
            await this.removeCustomContentType(customType.id);
          }
        });
      });
      removeSetting.settingEl.classList.add("astro-composer-remove-setting");
      this.updateCustomContentTypeVisibility(customType.id, customType.enabled);
    });
    contentTypes.forEach((customType) => {
      this.updateFolderConflictWarning(customType.id, null);
    });
    const addButtonContainer = this.customContentTypesContainer.createDiv({ cls: "astro-composer-add-button-container" });
    const addButton = addButtonContainer.createEl("button", {
      cls: "mod-cta",
      text: "Add content type"
    });
    addButton.addEventListener("click", () => {
      this.addCustomContentType();
    });
  }
  updateCustomContentTypeVisibility(typeId, enabled) {
    var _a, _b;
    const settingsContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-content-type-settings`);
    if (settingsContainer) {
      const contentTypes = this.plugin.settings.contentTypes || [];
      const contentType = contentTypes.find((ct) => ct.id === typeId);
      const isCollapsed = (_b = contentType == null ? void 0 : contentType.collapsed) != null ? _b : false;
      const shouldBeVisible = enabled && !isCollapsed;
      settingsContainer.classList.toggle("astro-composer-setting-container-visible", shouldBeVisible);
      settingsContainer.classList.toggle("astro-composer-setting-container-hidden", !shouldBeVisible);
    }
  }
  updateCustomContentTypeIndexFileField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType) return;
    const indexFileContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"] .custom-index-file-field`);
    if (indexFileContainer) {
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
    }
  }
  updateCustomContentTypeIgnoreSubfoldersField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType) return;
    const ignoreSubfoldersContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-ignore-subfolders-field`);
    if (ignoreSubfoldersContainer) {
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder && customType.folder.trim() !== "");
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder || customType.folder.trim() === "");
    }
  }
  updateFolderConflictWarning(typeId, setting) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const currentType = contentTypes.find((type) => type.id === typeId);
    if (!currentType) return;
    const conflictWarningEl = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].astro-composer-conflict-warning`);
    if (!conflictWarningEl) return;
    const currentFolder = (currentType.folder || "").trim();
    const conflictingTypes = [];
    for (const otherType of contentTypes) {
      if (otherType.id === typeId || !otherType.enabled) continue;
      const otherFolder = (otherType.folder || "").trim();
      if (currentFolder === "" && otherFolder === "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      } else if (currentFolder === otherFolder && currentFolder !== "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      }
    }
    if (conflictingTypes.length > 0) {
      conflictWarningEl.removeClass("hidden");
      conflictWarningEl.textContent = `Conflict: ${conflictingTypes.join(", ")} also use${conflictingTypes.length === 1 ? "s" : ""} this folder. More specific patterns will take priority.`;
    } else {
      conflictWarningEl.addClass("hidden");
    }
  }
  async moveContentTypeUp(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex <= 0) return;
    [contentTypes[currentIndex], contentTypes[currentIndex - 1]] = [contentTypes[currentIndex - 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async moveContentTypeDown(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex < 0 || currentIndex >= contentTypes.length - 1) return;
    [contentTypes[currentIndex], contentTypes[currentIndex + 1]] = [contentTypes[currentIndex + 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async toggleContentTypeCollapse(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === typeId);
    if (!contentType) return;
    contentType.collapsed = !contentType.collapsed;
    await this.plugin.saveSettings();
    this.updateCustomContentTypeVisibility(typeId, contentType.enabled);
  }
  async removeCustomContentType(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    settings.contentTypes = contentTypes.filter((ct) => ct.id !== typeId);
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
    registerContentTypeCommands(this.plugin, settings);
  }
  getCommandName(commandId) {
    if (!commandId) return "";
    try {
      const commandRegistry = this.app.commands;
      if (commandRegistry && typeof commandRegistry.listCommands === "function") {
        try {
          const allCommands = commandRegistry.listCommands();
          const command = allCommands.find((cmd) => cmd.id === commandId);
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        } catch (e) {
          console.warn("[Astro Composer] Error getting command name via listCommands():", e);
        }
      }
      try {
        const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
        if (registry && typeof registry === "object") {
          const command = registry[commandId];
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting command name via registry:", e);
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting command name:", e);
    }
    return "";
  }
  getIconName(iconId) {
    if (!iconId) return "";
    return iconId.replace(/^lucide-/, "").split("-").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
};

// src/utils/heading-link-generator.ts
var HeadingLinkGenerator = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Converts text to kebab-case slug for URLs
   */
  // Local toKebabCase removed, using imported one instead
  /**
   * Gets the Astro-compatible URL from an internal link (copied from LinkConverter)
   */
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let creationMode = "file";
    let indexFileName = "";
    const contentTypes = this.settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      let matches = false;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!path.includes("/") || path.split("/").length === 1) {
          matches = true;
        }
      } else if (matchesFolderPattern(path, contentType.folder)) {
        matches = true;
      }
      if (matches) {
        contentFolder = contentType.folder || "";
        basePath = contentType.linkBasePath || "";
        creationMode = contentType.creationMode;
        indexFileName = contentType.indexFileName || "";
        break;
      }
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    if (indexFileName && indexFileName.trim() !== "") {
      const parts = path.split("/");
      if (parts[parts.length - 1] === indexFileName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    } else if (creationMode === "folder") {
      const defaultIndexName = "index";
      const parts = path.split("/");
      if (parts[parts.length - 1] === defaultIndexName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) basePath = "/" + basePath;
      if (!basePath.endsWith("/")) basePath += "/";
    }
    const shouldAddTrailingSlash = (this.settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  /**
   * Generates a standard Obsidian link to a heading, respecting user's link format preference
   */
  generateObsidianLink(app, file, heading) {
    const headingText = heading.heading;
    const testLink = app.fileManager.generateMarkdownLink(file, "", "");
    if (testLink.startsWith("[[")) {
      const fileName = file.basename;
      return `[[${fileName}#${headingText}|${headingText}]]`;
    } else {
      const baseLink = app.fileManager.generateMarkdownLink(file, "", "");
      if (baseLink.startsWith("[[")) {
        const fileName = file.basename;
        return `[[${fileName}#${headingText}|${headingText}]]`;
      } else {
        const match = baseLink.match(/\[([^\]]+)\]\(([^)]+)\)/);
        if (match) {
          const [, , path] = match;
          return `[${headingText}](${path}#${encodeURIComponent(headingText)})`;
        } else {
          const encodedFilename = encodeURIComponent(file.name);
          return `[${headingText}](${encodedFilename}#${encodeURIComponent(headingText)})`;
        }
      }
    }
  }
  /**
   * Generates a standard Obsidian wikilink to a heading
   */
  generateObsidianWikilink(file, heading) {
    const headingText = heading.heading;
    const fileName = file.basename;
    return `[[${fileName}#${headingText}|${headingText}]]`;
  }
  /**
   * Generates an Astro-compatible markdown link to a heading
   */
  generateAstroLink(file, heading) {
    const headingText = heading.heading;
    const anchor = toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[${headingText}](${astroUrl})`;
  }
  /**
   * Generates an Astro-compatible wikilink to a heading
   */
  generateAstroWikilink(file, heading) {
    const headingText = heading.heading;
    const anchor = toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[[${headingText}|${astroUrl}]]`;
  }
  /**
   * Extracts the URL from a markdown link or wikilink
   */
  extractUrl(link) {
    const markdownMatch = link.match(/\[([^\]]+)\]\(([^)]+)\)/);
    if (markdownMatch) {
      return markdownMatch[2];
    }
    const wikilinkMatch = link.match(/\[\[([^\]]+)\]\]/);
    if (wikilinkMatch) {
      const content = wikilinkMatch[1];
      const pathPart = content.split("|")[0];
      return pathPart;
    }
    return link;
  }
  /**
   * Generates the appropriate link format based on settings
   */
  generateLink(app, file, heading) {
    if (this.settings.copyHeadingLinkFormat === "astro") {
      return this.generateAstroLink(file, heading);
    } else {
      return this.generateObsidianLink(app, file, heading);
    }
  }
  /**
   * Finds the heading at a specific line in a file
   */
  findHeadingAtLine(app, file, line) {
    const cache = app.metadataCache.getFileCache(file);
    if (!cache || !cache.headings) {
      return null;
    }
    for (let i = cache.headings.length - 1; i >= 0; i--) {
      const heading = cache.headings[i];
      if (heading.position.start.line <= line) {
        return heading;
      }
    }
    return null;
  }
};

// src/services/MigrationService.ts
var import_obsidian12 = require("obsidian");

// src/ui/components/MigrationModal.ts
var import_obsidian11 = require("obsidian");
var MigrationModal = class extends import_obsidian11.Modal {
  constructor(app, conflicts) {
    super(app);
    this.result = null;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-migration-modal");
    contentEl.createEl("h2", { text: "Migration conflict detected" });
    contentEl.createEl("p", {
      text: "You have existing content types with names that conflict with posts or pages. How would you like to proceed?"
    });
    const conflictList = contentEl.createEl("ul");
    conflictList.createEl("li", { text: "Skip migration: keep your existing posts/pages settings (they will be ignored)" });
    conflictList.createEl("li", { text: "Migrate with renamed types: create 'posts (migrated)' and 'pages (migrated)' content types" });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const skipButton = buttonContainer.createEl("button", {
      text: "Skip migration",
      cls: "mod-cta"
    });
    skipButton.onclick = () => {
      this.result = { action: "skip" };
      this.close();
    };
    const migrateButton = buttonContainer.createEl("button", {
      text: "Migrate with renamed types",
      cls: "mod-cta"
    });
    migrateButton.onclick = () => {
      this.result = { action: "migrate" };
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise && this.result) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/services/MigrationService.ts
var MigrationService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
  }
  /**
   * Migrate old posts/pages settings to unified content types
   */
  async migrateSettingsIfNeeded() {
    const settings = this.plugin.settings;
    if (settings.migrationCompleted) {
      return;
    }
    const hasPostsSettings = settings.automatePostCreation !== void 0 && settings.automatePostCreation;
    const hasPagesSettings = settings.enablePages !== void 0 && settings.enablePages;
    if (!hasPostsSettings && !hasPagesSettings) {
      settings.migrationCompleted = true;
      await this.plugin.saveSettings();
      return;
    }
    const legacyContentTypes = settings.customContentTypes;
    const existingContentTypes = settings.contentTypes || legacyContentTypes || [];
    const conflicts = [];
    if (existingContentTypes.some((ct) => ct.name === "Posts")) {
      conflicts.push("Posts");
    }
    if (existingContentTypes.some((ct) => ct.name === "Pages")) {
      conflicts.push("Pages");
    }
    let shouldMigrate = true;
    if (conflicts.length > 0) {
      await new Promise((resolve) => {
        setTimeout(() => {
          void (async () => {
            try {
              const modal = new MigrationModal(this.app, conflicts);
              const timeoutPromise = new Promise((timeoutResolve) => {
                setTimeout(() => {
                  timeoutResolve({ action: "skip" });
                }, 3e4);
              });
              const result = await Promise.race([
                modal.waitForResult(),
                timeoutPromise
              ]);
              if (result.action === "skip") {
                shouldMigrate = false;
                new import_obsidian12.Notice("Migration skipped. Old posts/pages settings will be ignored.");
              }
            } catch (error) {
              console.warn("Migration modal error:", error);
              shouldMigrate = false;
              new import_obsidian12.Notice("Migration skipped due to error. You can migrate manually in settings.");
            }
            resolve();
          })();
        }, 500);
      });
    }
    if (!shouldMigrate) {
      settings.migrationCompleted = true;
      await this.plugin.saveSettings();
      return;
    }
    const migratedTypes = [];
    if (hasPostsSettings && !conflicts.includes("Posts")) {
      const postsType = {
        id: `posts-${Date.now()}`,
        name: "Posts",
        folder: settings.postsFolder || "",
        linkBasePath: settings.postsLinkBasePath || "",
        template: settings.defaultTemplate || '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
        enabled: true,
        creationMode: settings.creationMode || "file",
        indexFileName: settings.indexFileName || "",
        ignoreSubfolders: settings.onlyAutomateInPostsFolder || false,
        enableUnderscorePrefix: settings.enableUnderscorePrefix || false,
        useMdxExtension: false
      };
      migratedTypes.push(postsType);
    }
    if (hasPagesSettings && !conflicts.includes("Pages")) {
      const pagesType = {
        id: `pages-${Date.now()}`,
        name: "Pages",
        folder: settings.pagesFolder || "",
        linkBasePath: settings.pagesLinkBasePath || "",
        template: settings.pageTemplate || '---\ntitle: "{{title}}"\ndescription: ""\n---\n',
        enabled: true,
        creationMode: settings.pagesCreationMode || "file",
        indexFileName: settings.pagesIndexFileName || "",
        ignoreSubfolders: settings.onlyAutomateInPagesFolder || false,
        enableUnderscorePrefix: false,
        useMdxExtension: false
      };
      migratedTypes.push(pagesType);
    }
    const existingFromNew = settings.contentTypes || [];
    const existingFromLegacy = legacyContentTypes || [];
    let existingTypes = existingFromNew.length > 0 ? existingFromNew : existingFromLegacy;
    let finalTypes = [...existingTypes];
    if (migratedTypes.length > 0) {
      const existingNames = new Set(existingTypes.map((ct) => ct.name));
      const newMigratedTypes = migratedTypes.filter((mt) => !existingNames.has(mt.name));
      if (newMigratedTypes.length > 0) {
        finalTypes = [...existingTypes, ...newMigratedTypes];
      }
    }
    settings.contentTypes = finalTypes;
    const legacyFields = [
      "customContentTypes",
      "enableUnderscorePrefix",
      "postsFolder",
      "postsLinkBasePath",
      "automatePostCreation",
      "creationMode",
      "indexFileName",
      "excludedDirectories",
      "onlyAutomateInPostsFolder",
      "enablePages",
      "pagesFolder",
      "pagesLinkBasePath",
      "pagesCreationMode",
      "pagesIndexFileName",
      "pageTemplate",
      "onlyAutomateInPagesFolder"
    ];
    const settingsRecord = settings;
    for (const field of legacyFields) {
      delete settingsRecord[field];
    }
    settings.migrationCompleted = true;
    await this.plugin.saveSettings();
    await this.plugin.loadSettings();
    if (migratedTypes.length > 0) {
      new import_obsidian12.Notice(`Migration completed: ${migratedTypes.length} content type(s) migrated.`);
      setTimeout(() => {
        if (this.plugin.settingsTab instanceof AstroComposerSettingTab) {
          const settingsTab = this.plugin.settingsTab;
          try {
            if (settingsTab.customContentTypesContainer || settingsTab.containerEl) {
              settingsTab.display();
            }
          } catch (e) {
            console.warn("Could not refresh settings tab after migration:", e);
          }
        }
      }, 300);
    }
  }
};

// src/services/CreateEventService.ts
var import_obsidian13 = require("obsidian");
var CreateEventService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    this.lastProcessedFiles = /* @__PURE__ */ new Map();
  }
  handleCreate(file) {
    void (async () => {
      const now = Date.now();
      if (!(file instanceof import_obsidian13.TFile) || file.extension !== "md" && file.extension !== "mdx") {
        return;
      }
      const filePath = file.path;
      const createdTime = this.plugin.pluginCreatedFiles.get(filePath);
      if (createdTime && now - createdTime < 5 * 60 * 1e3) {
        return;
      }
      const lastProcessed = this.lastProcessedFiles.get(filePath) || 0;
      if (lastProcessed > 0 && now - lastProcessed < CONSTANTS.DEBOUNCE_MS) {
        return;
      }
      if (lastProcessed > 0 && now - lastProcessed > 2e3) {
        this.lastProcessedFiles.delete(filePath);
      }
      const periodicCutoff = now - CONSTANTS.DEBOUNCE_MS * 2;
      for (const [path, time] of this.lastProcessedFiles.entries()) {
        if (time < periodicCutoff) {
          this.lastProcessedFiles.delete(path);
        }
      }
      await this.plugin.loadSettings();
      const activeFile = this.app.workspace.getActiveFile();
      const isActiveFile = activeFile && activeFile.path === file.path;
      if (!this.plugin.settings.processBackgroundFileChanges && !isActiveFile) {
        return;
      }
      const contentTypes = this.plugin.settings.contentTypes || [];
      const hasEnabledContentTypes = contentTypes.some((ct) => ct.enabled);
      if (!hasEnabledContentTypes) {
        return;
      }
      const sortedContentTypes = sortByPatternSpecificity(contentTypes);
      let matchedContentTypeId = null;
      const matchingTypes = [];
      for (const contentType of sortedContentTypes) {
        if (!contentType.enabled) continue;
        let matches = false;
        if (!contentType.folder || contentType.folder.trim() === "") {
          if (!filePath.includes("/") || filePath.split("/").length === 1) {
            matches = true;
          }
        } else if (matchesFolderPattern(filePath, contentType.folder)) {
          if (contentType.ignoreSubfolders) {
            const pathSegments = filePath.split("/");
            const pathDepth = pathSegments.length;
            const patternSegments = contentType.folder.split("/");
            const expectedDepth = patternSegments.length;
            if (contentType.creationMode === "folder") {
              const folderDepth = pathDepth - 1;
              if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
                matches = true;
              }
            } else {
              if (pathDepth === expectedDepth) {
                matches = true;
              }
            }
          } else {
            matches = true;
          }
        }
        if (matches) {
          matchingTypes.push(contentType);
          if (!matchedContentTypeId) {
            matchedContentTypeId = contentType.id;
          }
        }
      }
      if (matchingTypes.length > 1) {
        const typeNames = matchingTypes.map((ct) => ct.name || "Unnamed").join(", ");
        new import_obsidian13.Notice(`Multiple content types (${typeNames}) match this file. Using most specific: ${matchingTypes[0].name || "Unnamed"}`);
      }
      if (!matchedContentTypeId) {
        return;
      }
      const stat = await this.app.vault.adapter.stat(file.path);
      const isNewNote = (stat == null ? void 0 : stat.mtime) && now - stat.mtime < CONSTANTS.STAT_MTIME_THRESHOLD;
      if (!isNewNote) {
        return;
      }
      await new Promise((resolve) => setTimeout(resolve, 50));
      let content;
      try {
        content = await this.app.vault.read(file);
      } catch (error) {
        console.error("Error reading file for create detection:", error);
        return;
      }
      if (content.trim().length > 0) {
        if (content.startsWith("---")) {
          const frontmatterEnd = content.indexOf("\n---", 3);
          if (frontmatterEnd !== -1) {
            const frontmatterText = content.slice(4, frontmatterEnd).trim();
            const lines = frontmatterText.split("\n").filter((line) => line.trim().length > 0);
            if (!this.plugin.settings.processBackgroundFileChanges && lines.length > 0) {
              return;
            }
            if (lines.length > 1 || lines.length === 1 && !lines[0].startsWith("title:")) {
              return;
            }
          }
        }
        const contentWithoutFrontmatter = content.startsWith("---") ? content.slice(content.indexOf("\n---", 3) + 4).trim() : content.trim();
        if (contentWithoutFrontmatter.length > 0) {
          return;
        }
      }
      this.lastProcessedFiles.set(file.path, now);
      setTimeout(() => {
        this.lastProcessedFiles.delete(file.path);
      }, CONSTANTS.DEBOUNCE_MS + 100);
      new TitleModal(this.app, file, this.plugin, matchedContentTypeId, false, true).open();
    })();
  }
};

// src/utils/dom.ts
function waitForElement(selector, timeout = 5e3) {
  return new Promise((resolve, reject) => {
    const element = document.querySelector(selector);
    if (element) {
      return resolve(element);
    }
    const observer = new MutationObserver((mutations) => {
      const targetElement = document.querySelector(selector);
      if (targetElement) {
        resolve(targetElement);
        observer.disconnect();
        clearTimeout(timer);
      }
    });
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
    const timer = setTimeout(() => {
      observer.disconnect();
      reject(new Error(`Timeout waiting for element matching selector: ${selector}`));
    }, timeout);
  });
}

// src/main.ts
var AstroComposerPlugin = class extends import_obsidian14.Plugin {
  constructor() {
    super(...arguments);
    this.pluginCreatedFiles = /* @__PURE__ */ new Map();
    this.processedFiles = /* @__PURE__ */ new Map();
    this.terminalRibbonIcon = null;
    this.configRibbonIcon = null;
  }
  /**
   * Migrate old posts/pages settings to unified content types
   */
  async migrateSettingsIfNeeded() {
    if (!this.migrationService) {
      this.migrationService = new MigrationService(this.app, this);
    }
    await this.migrationService.migrateSettingsIfNeeded();
  }
  async onload() {
    await this.loadSettings();
    this.migrationService = new MigrationService(this.app, this);
    this.createEventService = new CreateEventService(this.app, this);
    this.fileOps = new FileOperations(this.app, this.settings, this);
    this.templateParser = new TemplateParser(this.app, this.settings);
    this.headingLinkGenerator = new HeadingLinkGenerator(this.settings);
    if (this.settings.showMdxFilesInExplorer) {
      this.registerExtensions(["mdx"], "markdown");
    }
    this.app.workspace.onLayoutReady(() => {
      this.registerCreateEvent();
      if (!import_obsidian14.Platform.isMobile) {
        void this.updateHelpButton();
      }
      void this.migrateSettingsIfNeeded();
    });
    registerCommands(this, this.settings);
    registerContentTypeCommands(this, this.settings);
    this.settingsTab = new AstroComposerSettingTab(this.app, this);
    this.addSettingTab(this.settingsTab);
    this.registerContextMenu();
    this.registerRibbonIcons();
    this.setupRibbonContextMenuHandling();
  }
  registerCreateEvent() {
    if (this.createEventRef) {
      this.app.vault.offref(this.createEventRef);
      this.createEventRef = void 0;
    }
    const createEventRef = this.app.vault.on("create", (file) => {
      if (file instanceof import_obsidian14.TFile) {
        this.createEventService.handleCreate(file);
        this.cleanupPluginCreatedFiles();
      }
    });
    this.registerEvent(createEventRef);
    this.createEventRef = createEventRef;
  }
  cleanupPluginCreatedFiles() {
    const now = Date.now();
    const ttl = 5 * 60 * 1e3;
    for (const [path, timestamp] of this.pluginCreatedFiles.entries()) {
      if (now - timestamp > ttl) {
        this.pluginCreatedFiles.delete(path);
      }
    }
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData);
    if (!this.settings.contentTypes || !Array.isArray(this.settings.contentTypes)) {
      this.settings.contentTypes = [];
    }
    if (!this.settings.migrationCompleted) {
      const legacySettings = this.settings;
      const hasLegacyTypes = legacySettings.customContentTypes && Array.isArray(legacySettings.customContentTypes) && legacySettings.customContentTypes.length > 0;
      const hasNewTypes = this.settings.contentTypes && Array.isArray(this.settings.contentTypes) && this.settings.contentTypes.length > 0;
      if (hasLegacyTypes && !hasNewTypes) {
        this.settings.contentTypes = legacySettings.customContentTypes || [];
      }
    } else {
      const legacyFields = [
        "customContentTypes",
        "enableUnderscorePrefix",
        "postsFolder",
        "postsLinkBasePath",
        "automatePostCreation",
        "creationMode",
        "indexFileName",
        "excludedDirectories",
        "onlyAutomateInPostsFolder",
        "enablePages",
        "pagesFolder",
        "pagesLinkBasePath",
        "pagesCreationMode",
        "pagesIndexFileName",
        "pageTemplate",
        "onlyAutomateInPagesFolder"
      ];
      const settingsRecord = this.settings;
      for (const field of legacyFields) {
        if (settingsRecord[field] !== void 0) {
          delete settingsRecord[field];
        }
      }
      await this.saveSettings();
    }
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  registerContextMenu() {
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        if (!this.settings.enableCopyHeadingLink) {
          return;
        }
        const cursor = editor.getCursor();
        const file = view.file;
        if (!(file instanceof import_obsidian14.TFile)) {
          return;
        }
        const heading = this.headingLinkGenerator.findHeadingAtLine(this.app, file, cursor.line);
        if (heading) {
          const fullLink = this.headingLinkGenerator.generateLink(this.app, file, heading);
          const urlOnly = this.headingLinkGenerator.extractUrl(fullLink);
          menu.addItem((item) => {
            item.setTitle("Copy heading link").setIcon("link-2").onClick(async () => {
              await navigator.clipboard.writeText(urlOnly);
              new import_obsidian14.Notice("Heading link copied to clipboard");
            });
          });
          menu.addItem((item) => {
            item.setTitle("Copy heading link with text").setIcon("heading").onClick(async () => {
              await navigator.clipboard.writeText(fullLink);
              new import_obsidian14.Notice("Heading link with text copied to clipboard");
            });
          });
        }
      })
    );
  }
  renameContentByPath(filePath) {
    renameContentByPath(this.app, filePath, this.settings, this);
  }
  registerRibbonIcons() {
    if (import_obsidian14.Platform.isMobile) {
      if (this.terminalRibbonIcon) {
        try {
          if (this.terminalRibbonIcon.parentNode) this.terminalRibbonIcon.remove();
        } catch (e) {
        }
        this.terminalRibbonIcon = null;
      }
      if (this.configRibbonIcon) {
        try {
          if (this.configRibbonIcon.parentNode) this.configRibbonIcon.remove();
        } catch (e) {
        }
        this.configRibbonIcon = null;
      }
      try {
        const terminalIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]');
        terminalIcons.forEach((icon) => icon.remove());
        const configIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]');
        configIcons.forEach((icon) => icon.remove());
      } catch (e) {
      }
      return;
    }
    const terminalShouldExist = this.settings.enableTerminalRibbonIcon && this.settings.enableOpenTerminalCommand;
    const configShouldExist = this.settings.enableConfigRibbonIcon && this.settings.enableOpenConfigFileCommand;
    if (this.terminalRibbonIcon) {
      try {
        if (this.terminalRibbonIcon.parentNode) this.terminalRibbonIcon.remove();
      } catch (e) {
      }
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      try {
        if (this.configRibbonIcon.parentNode) this.configRibbonIcon.remove();
      } catch (e) {
      }
      this.configRibbonIcon = null;
    }
    try {
      document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]').forEach((el) => el.remove());
      document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]').forEach((el) => el.remove());
    } catch (e) {
    }
    if (terminalShouldExist) {
      this.terminalRibbonIcon = this.addRibbonIcon("terminal-square", "Open project terminal", () => {
        if (!this.settings.enableOpenTerminalCommand) {
          new import_obsidian14.Notice("Open terminal command is disabled.");
          return;
        }
        openTerminalInProjectRoot(this.app, this.settings);
      });
      if (this.terminalRibbonIcon) this.terminalRibbonIcon.setAttribute("data-astro-composer-terminal-ribbon", "true");
    }
    if (configShouldExist) {
      this.configRibbonIcon = this.addRibbonIcon("wrench", "Edit astro config", async () => {
        if (!this.settings.enableOpenConfigFileCommand) {
          new import_obsidian14.Notice("Edit config file command is disabled.");
          return;
        }
        await openConfigFile(this.app, this.settings);
      });
      if (this.configRibbonIcon) this.configRibbonIcon.setAttribute("data-astro-composer-config-ribbon", "true");
    }
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
  }
  onunload() {
    if (this.terminalRibbonIcon) {
      this.terminalRibbonIcon.remove();
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      this.configRibbonIcon.remove();
      this.configRibbonIcon = null;
    }
    if (this.ribbonContextMenuObserver) {
      this.ribbonContextMenuObserver.disconnect();
      this.ribbonContextMenuObserver = void 0;
    }
    document.body.removeClass("astro-composer-hide-terminal-icon");
    document.body.removeClass("astro-composer-hide-config-icon");
    if (this.helpButtonObserver) {
      this.helpButtonObserver.disconnect();
      this.helpButtonObserver = void 0;
    }
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  setupRibbonContextMenuHandling() {
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
  }
  updateRibbonContextMenuCSS() {
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (terminalShouldBeHidden) document.body.addClass("astro-composer-hide-terminal-icon");
    else document.body.removeClass("astro-composer-hide-terminal-icon");
    if (configShouldBeHidden) document.body.addClass("astro-composer-hide-config-icon");
    else document.body.removeClass("astro-composer-hide-config-icon");
  }
  setupRibbonContextMenuObserver() {
    if (this.ribbonContextMenuObserver) this.ribbonContextMenuObserver.disconnect();
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (!terminalShouldBeHidden && !configShouldBeHidden) return;
    this.ribbonContextMenuObserver = new MutationObserver((mutations) => {
      for (const mutation of mutations) {
        if (mutation.addedNodes.length > 0) {
          for (const node of Array.from(mutation.addedNodes)) {
            if (node instanceof HTMLElement) {
              if (node.classList.contains("menu") || node.querySelector(".menu")) {
                this.removeRibbonIconsFromContextMenu(node);
              }
            }
          }
        }
      }
    });
    this.ribbonContextMenuObserver.observe(document.body, { childList: true, subtree: true });
  }
  updateHelpButtonCSS() {
    var _a;
    if ((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled) document.body.addClass("astro-composer-hide-help-button");
    else document.body.removeClass("astro-composer-hide-help-button");
  }
  async updateHelpButton() {
    var _a, _b, _c;
    if (import_obsidian14.Platform.isMobile) {
      this.restoreHelpButton();
      return;
    }
    if (this.helpButtonObserver) this.helpButtonObserver.disconnect();
    await this.loadSettings();
    this.updateHelpButtonCSS();
    if (!((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled)) {
      this.restoreHelpButton();
      this.setupHelpButtonObserver();
      return;
    }
    try {
      const helpButton = await waitForElement(".workspace-drawer-vault-actions .clickable-icon svg.help", 1e4).then((svg) => svg.parentElement);
      if (!helpButton) {
        this.setupHelpButtonObserver();
        return;
      }
      this.helpButtonElement = helpButton;
      if (this.customHelpButton && this.customHelpButton.parentElement && document.body.contains(this.customHelpButton) && this.customHelpButton.hasAttribute("data-astro-composer-help-replacement")) {
        this.customHelpButton.remove();
      }
      this.customHelpButton = void 0;
      const customButton = helpButton.cloneNode(true);
      customButton.addClass("astro-composer-help-replacement");
      customButton.removeAttribute("aria-label");
      customButton.setAttribute("data-astro-composer-help-replacement", "true");
      customButton.classList.add("astro-composer-help-replacement");
      customButton.onclick = null;
      const iconContainer = ((_b = customButton.querySelector("svg")) == null ? void 0 : _b.parentElement) || customButton;
      try {
        if (iconContainer instanceof HTMLElement) {
          (0, import_obsidian14.setIcon)(iconContainer, this.settings.helpButtonReplacement.iconId);
        }
      } catch (error) {
        console.warn("[Astro Composer] Error setting icon:", error);
      }
      customButton.addEventListener("click", (evt) => {
        var _a2;
        evt.preventDefault();
        evt.stopPropagation();
        const commandId = (_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.commandId;
        if (commandId) {
          void (async () => {
            var _a3;
            try {
              const appWithCommands = this.app;
              if ((_a3 = appWithCommands.commands) == null ? void 0 : _a3.executeCommandById) {
                await appWithCommands.commands.executeCommandById(commandId);
              }
            } catch (error) {
              console.warn("[Astro Composer] Error executing command:", error);
              new import_obsidian14.Notice(`Failed to execute command: ${commandId}`);
            }
          })();
        }
      }, true);
      (_c = helpButton.parentElement) == null ? void 0 : _c.insertBefore(customButton, helpButton);
      this.customHelpButton = customButton;
      setTimeout(() => {
        var _a2;
        if ((_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) this.setupHelpButtonObserver();
      }, 1e3);
    } catch (error) {
      console.warn("[Astro Composer] Error updating help button:", error);
      this.setupHelpButtonObserver();
    }
  }
  setupHelpButtonObserver() {
    var _a;
    if (this.helpButtonObserver) this.helpButtonObserver.disconnect();
    if (!((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled)) return;
    let updateTimeout = null;
    this.helpButtonObserver = new MutationObserver(() => {
      if (updateTimeout) clearTimeout(updateTimeout);
      updateTimeout = window.setTimeout(() => {
        const vaultActions2 = document.querySelector(".workspace-drawer-vault-actions");
        if (!vaultActions2) return;
        const customButtonExists = this.customHelpButton && this.customHelpButton.parentElement && document.body.contains(this.customHelpButton) && this.customHelpButton.hasAttribute("data-astro-composer-help-replacement");
        if (!customButtonExists) {
          if (this.customHelpButton && (!document.body.contains(this.customHelpButton) || !this.customHelpButton.hasAttribute("data-astro-composer-help-replacement"))) {
            this.customHelpButton = void 0;
          }
          void this.updateHelpButton();
        }
      }, 100);
    });
    const vaultActions = document.querySelector(".workspace-drawer-vault-actions");
    if (vaultActions) this.helpButtonObserver.observe(vaultActions, { childList: true, subtree: true });
    const vaultProfile = document.querySelector(".workspace-sidedock-vault-profile");
    if (vaultProfile) this.helpButtonObserver.observe(vaultProfile, { childList: true, subtree: true });
    if (!vaultActions && !vaultProfile) {
      const workspace = document.querySelector(".workspace-split");
      if (workspace) this.helpButtonObserver.observe(workspace, { childList: true, subtree: true });
      else this.helpButtonObserver.observe(document.body, { childList: true, subtree: true });
    }
  }
  restoreHelpButton() {
    document.body.removeClass("astro-composer-hide-help-button");
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  removeRibbonIconsFromContextMenu(menuElement) {
    var _a, _b;
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    const menuItems = menuElement.querySelectorAll(".menu-item");
    for (const item of Array.from(menuItems)) {
      const svg = item.querySelector("svg");
      if (svg) {
        const iconName = svg.getAttribute("data-lucide") || svg.getAttribute("xmlns:lucide") || (svg.classList.contains("lucide-terminal-square") ? "terminal-square" : null) || (svg.classList.contains("lucide-wrench") ? "wrench" : null);
        if (terminalShouldBeHidden && iconName === "terminal-square") {
          if ((_a = item.textContent) == null ? void 0 : _a.toLowerCase().includes("terminal")) item.remove();
        }
        if (configShouldBeHidden && iconName === "wrench") {
          if ((_b = item.textContent) == null ? void 0 : _b.toLowerCase().includes("config")) item.remove();
        }
      }
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvY29tbWFuZHMvaW5kZXgudHMiLCAic3JjL3V0aWxzL2ZpbGUtb3BlcmF0aW9ucy50cyIsICJzcmMvdXRpbHMvcGF0aC1tYXRjaGluZy50cyIsICJzcmMvdXRpbHMvc3RyaW5nLXV0aWxzLnRzIiwgInNyYy91dGlscy90ZW1wbGF0ZS1wYXJzaW5nLnRzIiwgInNyYy91dGlscy9saW5rLWNvbnZlcnNpb24udHMiLCAic3JjL3VpL3RpdGxlLW1vZGFsLnRzIiwgInNyYy91aS9zZXR0aW5ncy10YWIudHMiLCAic3JjL3VpL2NvbXBvbmVudHMvQ29tbWFuZFBpY2tlck1vZGFsLnRzIiwgInNyYy91aS9jb21wb25lbnRzL0ljb25QaWNrZXJNb2RhbC50cyIsICJzcmMvdWkvY29tcG9uZW50cy9Db25maXJtTW9kYWwudHMiLCAic3JjL3V0aWxzL3NldHRpbmdzLWNvbXBhdC50cyIsICJzcmMvdXRpbHMvaGVhZGluZy1saW5rLWdlbmVyYXRvci50cyIsICJzcmMvc2VydmljZXMvTWlncmF0aW9uU2VydmljZS50cyIsICJzcmMvdWkvY29tcG9uZW50cy9NaWdyYXRpb25Nb2RhbC50cyIsICJzcmMvc2VydmljZXMvQ3JlYXRlRXZlbnRTZXJ2aWNlLnRzIiwgInNyYy91dGlscy9kb20udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7XHJcblx0UGx1Z2luLFxyXG5cdFRGaWxlLFxyXG5cdE5vdGljZSxcclxuXHRzZXRJY29uLFxyXG5cdFBsYXRmb3JtLFxyXG5cdEV2ZW50UmVmLFxyXG59IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgQ29udGVudFR5cGUgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5pbXBvcnQgeyByZWdpc3RlckNvbW1hbmRzLCByZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHMsIHJlbmFtZUNvbnRlbnRCeVBhdGggYXMgcmVuYW1lQ29udGVudEJ5UGF0aEZ1bmN0aW9uLCBvcGVuVGVybWluYWxJblByb2plY3RSb290LCBvcGVuQ29uZmlnRmlsZSB9IGZyb20gXCIuL2NvbW1hbmRzXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiIH0gZnJvbSBcIi4vdWkvc2V0dGluZ3MtdGFiXCI7XHJcbmltcG9ydCB7IEZpbGVPcGVyYXRpb25zIH0gZnJvbSBcIi4vdXRpbHMvZmlsZS1vcGVyYXRpb25zXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSBcIi4vdXRpbHMvdGVtcGxhdGUtcGFyc2luZ1wiO1xyXG5pbXBvcnQgeyBIZWFkaW5nTGlua0dlbmVyYXRvciB9IGZyb20gXCIuL3V0aWxzL2hlYWRpbmctbGluay1nZW5lcmF0b3JcIjtcclxuaW1wb3J0IHsgTWlncmF0aW9uU2VydmljZSB9IGZyb20gXCIuL3NlcnZpY2VzL01pZ3JhdGlvblNlcnZpY2VcIjtcclxuaW1wb3J0IHsgQ3JlYXRlRXZlbnRTZXJ2aWNlIH0gZnJvbSBcIi4vc2VydmljZXMvQ3JlYXRlRXZlbnRTZXJ2aWNlXCI7XHJcbmltcG9ydCB7IHdhaXRGb3JFbGVtZW50IH0gZnJvbSBcIi4vdXRpbHMvZG9tXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBc3Ryb0NvbXBvc2VyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIGltcGxlbWVudHMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB7XHJcblx0c2V0dGluZ3MhOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3M7XHJcblx0cHJpdmF0ZSBjcmVhdGVFdmVudFJlZj86IEV2ZW50UmVmO1xyXG5cdHByaXZhdGUgZmlsZU9wcyE6IEZpbGVPcGVyYXRpb25zO1xyXG5cdHByaXZhdGUgdGVtcGxhdGVQYXJzZXIhOiBUZW1wbGF0ZVBhcnNlcjtcclxuXHRwcml2YXRlIGhlYWRpbmdMaW5rR2VuZXJhdG9yITogSGVhZGluZ0xpbmtHZW5lcmF0b3I7XHJcblx0cHVibGljIHBsdWdpbkNyZWF0ZWRGaWxlczogTWFwPHN0cmluZywgbnVtYmVyPiA9IG5ldyBNYXAoKTtcclxuXHRwcml2YXRlIHByb2Nlc3NlZEZpbGVzOiBNYXA8c3RyaW5nLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xyXG5cdHByaXZhdGUgdGVybWluYWxSaWJib25JY29uOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHByaXZhdGUgY29uZmlnUmliYm9uSWNvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRwcml2YXRlIHJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXI/OiBNdXRhdGlvbk9ic2VydmVyO1xyXG5cdHByaXZhdGUgaGVscEJ1dHRvbk9ic2VydmVyPzogTXV0YXRpb25PYnNlcnZlcjtcclxuXHRwcml2YXRlIGhlbHBCdXR0b25FbGVtZW50PzogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBjdXN0b21IZWxwQnV0dG9uPzogSFRNTEVsZW1lbnQ7XHJcblx0cHVibGljIHNldHRpbmdzVGFiPzogQXN0cm9Db21wb3NlclNldHRpbmdUYWI7XHJcblxyXG5cdHByaXZhdGUgbWlncmF0aW9uU2VydmljZSE6IE1pZ3JhdGlvblNlcnZpY2U7XHJcblx0cHJpdmF0ZSBjcmVhdGVFdmVudFNlcnZpY2UhOiBDcmVhdGVFdmVudFNlcnZpY2U7XHJcblxyXG5cdC8qKlxyXG5cdCAqIE1pZ3JhdGUgb2xkIHBvc3RzL3BhZ2VzIHNldHRpbmdzIHRvIHVuaWZpZWQgY29udGVudCB0eXBlc1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgYXN5bmMgbWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRpZiAoIXRoaXMubWlncmF0aW9uU2VydmljZSkge1xyXG5cdFx0XHR0aGlzLm1pZ3JhdGlvblNlcnZpY2UgPSBuZXcgTWlncmF0aW9uU2VydmljZSh0aGlzLmFwcCwgdGhpcyk7XHJcblx0XHR9XHJcblx0XHRhd2FpdCB0aGlzLm1pZ3JhdGlvblNlcnZpY2UubWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG5cdFx0Ly8gSW5pdGlhbGl6ZSBzZXJ2aWNlcyBhbmQgdXRpbGl0aWVzXHJcblx0XHR0aGlzLm1pZ3JhdGlvblNlcnZpY2UgPSBuZXcgTWlncmF0aW9uU2VydmljZSh0aGlzLmFwcCwgdGhpcyk7XHJcblx0XHR0aGlzLmNyZWF0ZUV2ZW50U2VydmljZSA9IG5ldyBDcmVhdGVFdmVudFNlcnZpY2UodGhpcy5hcHAsIHRoaXMpO1xyXG5cdFx0dGhpcy5maWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLCB0aGlzKTtcclxuXHRcdHRoaXMudGVtcGxhdGVQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MpO1xyXG5cdFx0dGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvciA9IG5ldyBIZWFkaW5nTGlua0dlbmVyYXRvcih0aGlzLnNldHRpbmdzKTtcclxuXHJcblx0XHQvLyBSZWdpc3RlciBNRFggZmlsZSB2aXNpYmlsaXR5IGlmIGVuYWJsZWRcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLnNob3dNZHhGaWxlc0luRXhwbG9yZXIpIHtcclxuXHRcdFx0dGhpcy5yZWdpc3RlckV4dGVuc2lvbnMoW1wibWR4XCJdLCBcIm1hcmtkb3duXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFdhaXQgZm9yIHRoZSB2YXVsdCB0byBiZSBmdWxseSBsb2FkZWQgYmVmb3JlIHJlZ2lzdGVyaW5nIHRoZSBjcmVhdGUgZXZlbnRcclxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcclxuXHRcdFx0dGhpcy5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHRcdC8vIEluaXRpYWxpemUgaGVscCBidXR0b24gcmVwbGFjZW1lbnQgKGRlc2t0b3Agb25seSlcclxuXHRcdFx0aWYgKCFQbGF0Zm9ybS5pc01vYmlsZSkge1xyXG5cdFx0XHRcdHZvaWQgdGhpcy51cGRhdGVIZWxwQnV0dG9uKCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIFJ1biBtaWdyYXRpb24gYWZ0ZXIgcGx1Z2luIGlzIGZ1bGx5IGxvYWRlZCAobm9uLWJsb2NraW5nKVxyXG5cdFx0XHR2b2lkIHRoaXMubWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFJlZ2lzdGVyIGNvbW1hbmRzXHJcblx0XHRyZWdpc3RlckNvbW1hbmRzKHRoaXMsIHRoaXMuc2V0dGluZ3MpO1xyXG5cclxuXHRcdC8vIFJlZ2lzdGVyIGNvbnRlbnQgdHlwZSBjb21tYW5kc1xyXG5cdFx0cmVnaXN0ZXJDb250ZW50VHlwZUNvbW1hbmRzKHRoaXMsIHRoaXMuc2V0dGluZ3MpO1xyXG5cclxuXHRcdC8vIEFkZCBzZXR0aW5ncyB0YWIgYW5kIHN0b3JlIHJlZmVyZW5jZSBmb3IgcmVmcmVzaCBhZnRlciBtaWdyYXRpb25cclxuXHRcdHRoaXMuc2V0dGluZ3NUYWIgPSBuZXcgQXN0cm9Db21wb3NlclNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpO1xyXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKHRoaXMuc2V0dGluZ3NUYWIpO1xyXG5cclxuXHRcdC8vIFJlZ2lzdGVyIGNvbnRleHQgbWVudSBmb3IgY29weSBoZWFkaW5nIGxpbmtzXHJcblx0XHR0aGlzLnJlZ2lzdGVyQ29udGV4dE1lbnUoKTtcclxuXHJcblx0XHQvLyBSZWdpc3RlciByaWJib24gaWNvbnMgaWYgZW5hYmxlZFxyXG5cdFx0dGhpcy5yZWdpc3RlclJpYmJvbkljb25zKCk7XHJcblxyXG5cdFx0Ly8gU2V0dXAgcmliYm9uIGNvbnRleHQgbWVudSBoYW5kbGluZ1xyXG5cdFx0dGhpcy5zZXR1cFJpYmJvbkNvbnRleHRNZW51SGFuZGxpbmcoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyByZWdpc3RlckNyZWF0ZUV2ZW50KCkge1xyXG5cdFx0aWYgKHRoaXMuY3JlYXRlRXZlbnRSZWYpIHtcclxuXHRcdFx0dGhpcy5hcHAudmF1bHQub2ZmcmVmKHRoaXMuY3JlYXRlRXZlbnRSZWYpO1xyXG5cdFx0XHR0aGlzLmNyZWF0ZUV2ZW50UmVmID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGNyZWF0ZUV2ZW50UmVmID0gdGhpcy5hcHAudmF1bHQub24oXCJjcmVhdGVcIiwgKGZpbGUpID0+IHtcclxuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdHRoaXMuY3JlYXRlRXZlbnRTZXJ2aWNlLmhhbmRsZUNyZWF0ZShmaWxlKTtcclxuXHRcdFx0XHR0aGlzLmNsZWFudXBQbHVnaW5DcmVhdGVkRmlsZXMoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoY3JlYXRlRXZlbnRSZWYpO1xyXG5cdFx0dGhpcy5jcmVhdGVFdmVudFJlZiA9IGNyZWF0ZUV2ZW50UmVmO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBjbGVhbnVwUGx1Z2luQ3JlYXRlZEZpbGVzKCkge1xyXG5cdFx0Y29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuXHRcdGNvbnN0IHR0bCA9IDUgKiA2MCAqIDEwMDA7IC8vIDUgbWludXRlc1xyXG5cdFx0Zm9yIChjb25zdCBbcGF0aCwgdGltZXN0YW1wXSBvZiB0aGlzLnBsdWdpbkNyZWF0ZWRGaWxlcy5lbnRyaWVzKCkpIHtcclxuXHRcdFx0aWYgKG5vdyAtIHRpbWVzdGFtcCA+IHR0bCkge1xyXG5cdFx0XHRcdHRoaXMucGx1Z2luQ3JlYXRlZEZpbGVzLmRlbGV0ZShwYXRoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG5cdFx0Y29uc3QgbG9hZGVkRGF0YSA9IChhd2FpdCB0aGlzLmxvYWREYXRhKCkpIGFzIHVua25vd247XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgbG9hZGVkRGF0YSBhcyBQYXJ0aWFsPEFzdHJvQ29tcG9zZXJTZXR0aW5ncz4gfCBudWxsIHwgdW5kZWZpbmVkKTtcclxuXHJcblx0XHQvLyBFbnN1cmUgY29udGVudFR5cGVzIGlzIGFsd2F5cyBhbiBhcnJheSAobmV2ZXIgdW5kZWZpbmVkIG9yIG51bGwpXHJcblx0XHRpZiAoIXRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8ICFBcnJheS5pc0FycmF5KHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzKSkge1xyXG5cdFx0XHR0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyA9IFtdO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5taWdyYXRpb25Db21wbGV0ZWQpIHtcclxuXHRcdFx0Y29uc3QgbGVnYWN5U2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzIGFzIHVua25vd24gYXMgeyBjdXN0b21Db250ZW50VHlwZXM/OiBDb250ZW50VHlwZVtdIH07XHJcblx0XHRcdGNvbnN0IGhhc0xlZ2FjeVR5cGVzID0gbGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzICYmIEFycmF5LmlzQXJyYXkobGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzKSAmJiBsZWdhY3lTZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMubGVuZ3RoID4gMDtcclxuXHRcdFx0Y29uc3QgaGFzTmV3VHlwZXMgPSB0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyAmJiBBcnJheS5pc0FycmF5KHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzKSAmJiB0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcy5sZW5ndGggPiAwO1xyXG5cclxuXHRcdFx0aWYgKGhhc0xlZ2FjeVR5cGVzICYmICFoYXNOZXdUeXBlcykge1xyXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzID0gbGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRjb25zdCBsZWdhY3lGaWVsZHMgPSBbXHJcblx0XHRcdFx0J2N1c3RvbUNvbnRlbnRUeXBlcycsICdlbmFibGVVbmRlcnNjb3JlUHJlZml4JywgJ3Bvc3RzRm9sZGVyJywgJ3Bvc3RzTGlua0Jhc2VQYXRoJyxcclxuXHRcdFx0XHQnYXV0b21hdGVQb3N0Q3JlYXRpb24nLCAnY3JlYXRpb25Nb2RlJywgJ2luZGV4RmlsZU5hbWUnLCAnZXhjbHVkZWREaXJlY3RvcmllcycsXHJcblx0XHRcdFx0J29ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXInLCAnZW5hYmxlUGFnZXMnLCAncGFnZXNGb2xkZXInLCAncGFnZXNMaW5rQmFzZVBhdGgnLFxyXG5cdFx0XHRcdCdwYWdlc0NyZWF0aW9uTW9kZScsICdwYWdlc0luZGV4RmlsZU5hbWUnLCAncGFnZVRlbXBsYXRlJywgJ29ubHlBdXRvbWF0ZUluUGFnZXNGb2xkZXInLFxyXG5cdFx0XHRdO1xyXG5cclxuXHRcdFx0Y29uc3Qgc2V0dGluZ3NSZWNvcmQgPSB0aGlzLnNldHRpbmdzIGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XHJcblx0XHRcdGZvciAoY29uc3QgZmllbGQgb2YgbGVnYWN5RmllbGRzKSB7XHJcblx0XHRcdFx0aWYgKHNldHRpbmdzUmVjb3JkW2ZpZWxkXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRkZWxldGUgc2V0dGluZ3NSZWNvcmRbZmllbGRdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVnaXN0ZXJDb250ZXh0TWVudSgpIHtcclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51LCBlZGl0b3IsIHZpZXcpID0+IHtcclxuXHRcdFx0XHRpZiAoIXRoaXMuc2V0dGluZ3MuZW5hYmxlQ29weUhlYWRpbmdMaW5rKSB7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcclxuXHJcblx0XHRcdFx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Y29uc3QgaGVhZGluZyA9IHRoaXMuaGVhZGluZ0xpbmtHZW5lcmF0b3IuZmluZEhlYWRpbmdBdExpbmUodGhpcy5hcHAsIGZpbGUsIGN1cnNvci5saW5lKTtcclxuXHJcblx0XHRcdFx0aWYgKGhlYWRpbmcpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGZ1bGxMaW5rID0gdGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvci5nZW5lcmF0ZUxpbmsodGhpcy5hcHAsIGZpbGUsIGhlYWRpbmcpO1xyXG5cdFx0XHRcdFx0Y29uc3QgdXJsT25seSA9IHRoaXMuaGVhZGluZ0xpbmtHZW5lcmF0b3IuZXh0cmFjdFVybChmdWxsTGluayk7XHJcblxyXG5cdFx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcblx0XHRcdFx0XHRcdGl0ZW1cclxuXHRcdFx0XHRcdFx0XHQuc2V0VGl0bGUoJ0NvcHkgaGVhZGluZyBsaW5rJylcclxuXHRcdFx0XHRcdFx0XHQuc2V0SWNvbignbGluay0yJylcclxuXHRcdFx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh1cmxPbmx5KTtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoJ0hlYWRpbmcgbGluayBjb3BpZWQgdG8gY2xpcGJvYXJkJyk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuXHRcdFx0XHRcdFx0aXRlbVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRUaXRsZSgnQ29weSBoZWFkaW5nIGxpbmsgd2l0aCB0ZXh0JylcclxuXHRcdFx0XHRcdFx0XHQuc2V0SWNvbignaGVhZGluZycpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZnVsbExpbmspO1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnSGVhZGluZyBsaW5rIHdpdGggdGV4dCBjb3BpZWQgdG8gY2xpcGJvYXJkJyk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0cmVuYW1lQ29udGVudEJ5UGF0aChmaWxlUGF0aDogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRyZW5hbWVDb250ZW50QnlQYXRoRnVuY3Rpb24odGhpcy5hcHAsIGZpbGVQYXRoLCB0aGlzLnNldHRpbmdzLCB0aGlzKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyByZWdpc3RlclJpYmJvbkljb25zKCkge1xyXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xyXG5cdFx0XHRcdHRyeSB7IGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5wYXJlbnROb2RlKSB0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5yZW1vdmUoKTsgfSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24pIHtcclxuXHRcdFx0XHR0cnkgeyBpZiAodGhpcy5jb25maWdSaWJib25JY29uLnBhcmVudE5vZGUpIHRoaXMuY29uZmlnUmliYm9uSWNvbi5yZW1vdmUoKTsgfSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdFx0dGhpcy5jb25maWdSaWJib25JY29uID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGNvbnN0IHRlcm1pbmFsSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIk9wZW4gcHJvamVjdCB0ZXJtaW5hbFwiXScpO1xyXG5cdFx0XHRcdHRlcm1pbmFsSWNvbnMuZm9yRWFjaCgoaWNvbjogRWxlbWVudCkgPT4gaWNvbi5yZW1vdmUoKSk7XHJcblx0XHRcdFx0Y29uc3QgY29uZmlnSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIkVkaXQgYXN0cm8gY29uZmlnXCJdJyk7XHJcblx0XHRcdFx0Y29uZmlnSWNvbnMuZm9yRWFjaCgoaWNvbjogRWxlbWVudCkgPT4gaWNvbi5yZW1vdmUoKSk7XHJcblx0XHRcdH0gY2F0Y2ggeyAvKiBJZ25vcmUgKi8gfVxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgdGVybWluYWxTaG91bGRFeGlzdCA9IHRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcclxuXHRcdGNvbnN0IGNvbmZpZ1Nob3VsZEV4aXN0ID0gdGhpcy5zZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xyXG5cdFx0XHR0cnkgeyBpZiAodGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucGFyZW50Tm9kZSkgdGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucmVtb3ZlKCk7IH0gY2F0Y2ggeyAvKiBJZ25vcmUgKi8gfVxyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uSWNvbikge1xyXG5cdFx0XHR0cnkgeyBpZiAodGhpcy5jb25maWdSaWJib25JY29uLnBhcmVudE5vZGUpIHRoaXMuY29uZmlnUmliYm9uSWNvbi5yZW1vdmUoKTsgfSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtZG9jay1yaWJib24tYWN0aW9uW2FyaWEtbGFiZWw9XCJPcGVuIHByb2plY3QgdGVybWluYWxcIl0nKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZSgpKTtcclxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtZG9jay1yaWJib24tYWN0aW9uW2FyaWEtbGFiZWw9XCJFZGl0IGFzdHJvIGNvbmZpZ1wiXScpLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlKCkpO1xyXG5cdFx0fSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblxyXG5cdFx0aWYgKHRlcm1pbmFsU2hvdWxkRXhpc3QpIHtcclxuXHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ3Rlcm1pbmFsLXNxdWFyZScsICdPcGVuIHByb2plY3QgdGVybWluYWwnLCAoKSA9PiB7XHJcblx0XHRcdFx0aWYgKCF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJPcGVuIHRlcm1pbmFsIGNvbW1hbmQgaXMgZGlzYWJsZWQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRvcGVuVGVybWluYWxJblByb2plY3RSb290KHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikgdGhpcy50ZXJtaW5hbFJpYmJvbkljb24uc2V0QXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLXRlcm1pbmFsLXJpYmJvbicsICd0cnVlJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGNvbmZpZ1Nob3VsZEV4aXN0KSB7XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbignd3JlbmNoJywgJ0VkaXQgYXN0cm8gY29uZmlnJywgYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJFZGl0IGNvbmZpZyBmaWxlIGNvbW1hbmQgaXMgZGlzYWJsZWQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhd2FpdCBvcGVuQ29uZmlnRmlsZSh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZiAodGhpcy5jb25maWdSaWJib25JY29uKSB0aGlzLmNvbmZpZ1JpYmJvbkljb24uc2V0QXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLWNvbmZpZy1yaWJib24nLCAndHJ1ZScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMudXBkYXRlUmliYm9uQ29udGV4dE1lbnVDU1MoKTtcclxuXHRcdHRoaXMuc2V0dXBSaWJib25Db250ZXh0TWVudU9ic2VydmVyKCk7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5yZW1vdmUoKTtcclxuXHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSBudWxsO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uSWNvbikge1xyXG5cdFx0XHR0aGlzLmNvbmZpZ1JpYmJvbkljb24ucmVtb3ZlKCk7XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyKSB7XHJcblx0XHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcblx0XHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlciA9IHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtdGVybWluYWwtaWNvbicpO1xyXG5cdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS1jb25maWctaWNvbicpO1xyXG5cdFx0aWYgKHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyKSB7XHJcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHRcdFx0dGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5jdXN0b21IZWxwQnV0dG9uKSB7XHJcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5yZW1vdmUoKTtcclxuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5oZWxwQnV0dG9uRWxlbWVudCA9IHVuZGVmaW5lZDtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgc2V0dXBSaWJib25Db250ZXh0TWVudUhhbmRsaW5nKCkge1xyXG5cdFx0dGhpcy51cGRhdGVSaWJib25Db250ZXh0TWVudUNTUygpO1xyXG5cdFx0dGhpcy5zZXR1cFJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIoKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgdXBkYXRlUmliYm9uQ29udGV4dE1lbnVDU1MoKSB7XHJcblx0XHRjb25zdCB0ZXJtaW5hbFNob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uIHx8ICF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ7XHJcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdGlmICh0ZXJtaW5hbFNob3VsZEJlSGlkZGVuKSBkb2N1bWVudC5ib2R5LmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLXRlcm1pbmFsLWljb24nKTtcclxuXHRcdGVsc2UgZG9jdW1lbnQuYm9keS5yZW1vdmVDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS10ZXJtaW5hbC1pY29uJyk7XHJcblxyXG5cdFx0aWYgKGNvbmZpZ1Nob3VsZEJlSGlkZGVuKSBkb2N1bWVudC5ib2R5LmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWNvbmZpZy1pY29uJyk7XHJcblx0XHRlbHNlIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtY29uZmlnLWljb24nKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgc2V0dXBSaWJib25Db250ZXh0TWVudU9ic2VydmVyKCkge1xyXG5cdFx0aWYgKHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlcikgdGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHJcblx0XHRjb25zdCB0ZXJtaW5hbFNob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uIHx8ICF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ7XHJcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdGlmICghdGVybWluYWxTaG91bGRCZUhpZGRlbiAmJiAhY29uZmlnU2hvdWxkQmVIaWRkZW4pIHJldHVybjtcclxuXHJcblx0XHR0aGlzLnJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XHJcblx0XHRcdGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XHJcblx0XHRcdFx0aWYgKG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBub2RlIG9mIEFycmF5LmZyb20obXV0YXRpb24uYWRkZWROb2RlcykpIHtcclxuXHRcdFx0XHRcdFx0aWYgKG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygnbWVudScpIHx8IG5vZGUucXVlcnlTZWxlY3RvcignLm1lbnUnKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5yZW1vdmVSaWJib25JY29uc0Zyb21Db250ZXh0TWVudShub2RlKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVIZWxwQnV0dG9uQ1NTKCkge1xyXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSBkb2N1bWVudC5ib2R5LmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWhlbHAtYnV0dG9uJyk7XHJcblx0XHRlbHNlIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtaGVscC1idXR0b24nKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBhc3luYyB1cGRhdGVIZWxwQnV0dG9uKCkge1xyXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdHRoaXMucmVzdG9yZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLmhlbHBCdXR0b25PYnNlcnZlcikgdGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG5cclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnVwZGF0ZUhlbHBCdXR0b25DU1MoKTtcclxuXHJcblx0XHRpZiAoIXRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSB7XHJcblx0XHRcdHRoaXMucmVzdG9yZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0dGhpcy5zZXR1cEhlbHBCdXR0b25PYnNlcnZlcigpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgaGVscEJ1dHRvbiA9IGF3YWl0IHdhaXRGb3JFbGVtZW50KCcud29ya3NwYWNlLWRyYXdlci12YXVsdC1hY3Rpb25zIC5jbGlja2FibGUtaWNvbiBzdmcuaGVscCcsIDEwMDAwKVxyXG5cdFx0XHRcdC50aGVuKHN2ZyA9PiBzdmcucGFyZW50RWxlbWVudCBhcyBIVE1MRWxlbWVudCk7XHJcblxyXG5cdFx0XHRpZiAoIWhlbHBCdXR0b24pIHtcclxuXHRcdFx0XHR0aGlzLnNldHVwSGVscEJ1dHRvbk9ic2VydmVyKCk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLmhlbHBCdXR0b25FbGVtZW50ID0gaGVscEJ1dHRvbjtcclxuXHJcblx0XHRcdGlmICh0aGlzLmN1c3RvbUhlbHBCdXR0b24gJiYgdGhpcy5jdXN0b21IZWxwQnV0dG9uLnBhcmVudEVsZW1lbnQgJiYgZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmN1c3RvbUhlbHBCdXR0b24pICYmXHJcblx0XHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uLmhhc0F0dHJpYnV0ZSgnZGF0YS1hc3Ryby1jb21wb3Nlci1oZWxwLXJlcGxhY2VtZW50JykpIHtcclxuXHRcdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24ucmVtb3ZlKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gdW5kZWZpbmVkO1xyXG5cclxuXHRcdFx0Y29uc3QgY3VzdG9tQnV0dG9uID0gaGVscEJ1dHRvbi5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnQ7XHJcblx0XHRcdGN1c3RvbUJ1dHRvbi5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnRcIik7XHJcblx0XHRcdGN1c3RvbUJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnKTtcclxuXHRcdFx0Y3VzdG9tQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1hc3Ryby1jb21wb3Nlci1oZWxwLXJlcGxhY2VtZW50JywgJ3RydWUnKTtcclxuXHRcdFx0Y3VzdG9tQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnQnKTtcclxuXHRcdFx0Y3VzdG9tQnV0dG9uLm9uY2xpY2sgPSBudWxsO1xyXG5cclxuXHRcdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IGN1c3RvbUJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzdmcnKT8ucGFyZW50RWxlbWVudCB8fCBjdXN0b21CdXR0b247XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0aWYgKGljb25Db250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG5cdFx0XHRcdFx0c2V0SWNvbihpY29uQ29udGFpbmVyLCB0aGlzLnNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudC5pY29uSWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3Igc2V0dGluZyBpY29uOicsIGVycm9yKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Y3VzdG9tQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xyXG5cdFx0XHRcdGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcblx0XHRcdFx0Y29uc3QgY29tbWFuZElkID0gdGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmNvbW1hbmRJZDtcclxuXHRcdFx0XHRpZiAoY29tbWFuZElkKSB7XHJcblx0XHRcdFx0XHR2b2lkIChhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgYXBwV2l0aENvbW1hbmRzID0gdGhpcy5hcHAgYXMgdW5rbm93biBhcyB7IGNvbW1hbmRzPzogeyBleGVjdXRlQ29tbWFuZEJ5SWQ/OiAoaWQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPiB9IH07XHJcblx0XHRcdFx0XHRcdFx0aWYgKGFwcFdpdGhDb21tYW5kcy5jb21tYW5kcz8uZXhlY3V0ZUNvbW1hbmRCeUlkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCBhcHBXaXRoQ29tbWFuZHMuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKGNvbW1hbmRJZCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBleGVjdXRpbmcgY29tbWFuZDonLCBlcnJvcik7XHJcblx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGV4ZWN1dGUgY29tbWFuZDogJHtjb21tYW5kSWR9YCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCB0cnVlKTtcclxuXHJcblx0XHRcdGhlbHBCdXR0b24ucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKGN1c3RvbUJ1dHRvbiwgaGVscEJ1dHRvbik7XHJcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbiA9IGN1c3RvbUJ1dHRvbjtcclxuXHJcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudD8uZW5hYmxlZCkgdGhpcy5zZXR1cEhlbHBCdXR0b25PYnNlcnZlcigpO1xyXG5cdFx0XHR9LCAxMDAwKTtcclxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciB1cGRhdGluZyBoZWxwIGJ1dHRvbjonLCBlcnJvcik7XHJcblx0XHRcdHRoaXMuc2V0dXBIZWxwQnV0dG9uT2JzZXJ2ZXIoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgc2V0dXBIZWxwQnV0dG9uT2JzZXJ2ZXIoKSB7XHJcblx0XHRpZiAodGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIpIHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQpIHJldHVybjtcclxuXHJcblx0XHRsZXQgdXBkYXRlVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XHJcblx0XHR0aGlzLmhlbHBCdXR0b25PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcclxuXHRcdFx0aWYgKHVwZGF0ZVRpbWVvdXQpIGNsZWFyVGltZW91dCh1cGRhdGVUaW1lb3V0KTtcclxuXHRcdFx0dXBkYXRlVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0XHRjb25zdCB2YXVsdEFjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLWRyYXdlci12YXVsdC1hY3Rpb25zJyk7XHJcblx0XHRcdFx0aWYgKCF2YXVsdEFjdGlvbnMpIHJldHVybjtcclxuXHJcblx0XHRcdFx0Y29uc3QgY3VzdG9tQnV0dG9uRXhpc3RzID0gdGhpcy5jdXN0b21IZWxwQnV0dG9uICYmIHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5wYXJlbnRFbGVtZW50ICYmIGRvY3VtZW50LmJvZHkuY29udGFpbnModGhpcy5jdXN0b21IZWxwQnV0dG9uKSAmJlxyXG5cdFx0XHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uLmhhc0F0dHJpYnV0ZSgnZGF0YS1hc3Ryby1jb21wb3Nlci1oZWxwLXJlcGxhY2VtZW50Jyk7XHJcblxyXG5cdFx0XHRcdGlmICghY3VzdG9tQnV0dG9uRXhpc3RzKSB7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5jdXN0b21IZWxwQnV0dG9uICYmICghZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmN1c3RvbUhlbHBCdXR0b24pIHx8ICF0aGlzLmN1c3RvbUhlbHBCdXR0b24uaGFzQXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnQnKSkpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gdW5kZWZpbmVkO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dm9pZCB0aGlzLnVwZGF0ZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIDEwMCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRjb25zdCB2YXVsdEFjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLWRyYXdlci12YXVsdC1hY3Rpb25zJyk7XHJcblx0XHRpZiAodmF1bHRBY3Rpb25zKSB0aGlzLmhlbHBCdXR0b25PYnNlcnZlci5vYnNlcnZlKHZhdWx0QWN0aW9ucywgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XHJcblxyXG5cdFx0Y29uc3QgdmF1bHRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1zaWRlZG9jay12YXVsdC1wcm9maWxlJyk7XHJcblx0XHRpZiAodmF1bHRQcm9maWxlKSB0aGlzLmhlbHBCdXR0b25PYnNlcnZlci5vYnNlcnZlKHZhdWx0UHJvZmlsZSwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XHJcblxyXG5cdFx0aWYgKCF2YXVsdEFjdGlvbnMgJiYgIXZhdWx0UHJvZmlsZSkge1xyXG5cdFx0XHRjb25zdCB3b3Jrc3BhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXNwbGl0Jyk7XHJcblx0XHRcdGlmICh3b3Jrc3BhY2UpIHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLm9ic2VydmUod29ya3NwYWNlLCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcclxuXHRcdFx0ZWxzZSB0aGlzLmhlbHBCdXR0b25PYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSByZXN0b3JlSGVscEJ1dHRvbigpIHtcclxuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtaGVscC1idXR0b24nKTtcclxuXHRcdGlmICh0aGlzLmN1c3RvbUhlbHBCdXR0b24pIHtcclxuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uLnJlbW92ZSgpO1xyXG5cdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24gPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblx0XHR0aGlzLmhlbHBCdXR0b25FbGVtZW50ID0gdW5kZWZpbmVkO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSByZW1vdmVSaWJib25JY29uc0Zyb21Db250ZXh0TWVudShtZW51RWxlbWVudDogSFRNTEVsZW1lbnQpIHtcclxuXHRcdGNvbnN0IHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4gPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcclxuXHRcdGNvbnN0IGNvbmZpZ1Nob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlQ29uZmlnUmliYm9uSWNvbiB8fCAhdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ7XHJcblxyXG5cdFx0Y29uc3QgbWVudUl0ZW1zID0gbWVudUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtaXRlbScpO1xyXG5cdFx0Zm9yIChjb25zdCBpdGVtIG9mIEFycmF5LmZyb20obWVudUl0ZW1zKSkge1xyXG5cdFx0XHRjb25zdCBzdmcgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpO1xyXG5cdFx0XHRpZiAoc3ZnKSB7XHJcblx0XHRcdFx0Y29uc3QgaWNvbk5hbWUgPSBzdmcuZ2V0QXR0cmlidXRlKCdkYXRhLWx1Y2lkZScpIHx8IHN2Zy5nZXRBdHRyaWJ1dGUoJ3htbG5zOmx1Y2lkZScpIHx8XHJcblx0XHRcdFx0XHQoc3ZnLmNsYXNzTGlzdC5jb250YWlucygnbHVjaWRlLXRlcm1pbmFsLXNxdWFyZScpID8gJ3Rlcm1pbmFsLXNxdWFyZScgOiBudWxsKSB8fFxyXG5cdFx0XHRcdFx0KHN2Zy5jbGFzc0xpc3QuY29udGFpbnMoJ2x1Y2lkZS13cmVuY2gnKSA/ICd3cmVuY2gnIDogbnVsbCk7XHJcblxyXG5cdFx0XHRcdGlmICh0ZXJtaW5hbFNob3VsZEJlSGlkZGVuICYmIGljb25OYW1lID09PSAndGVybWluYWwtc3F1YXJlJykge1xyXG5cdFx0XHRcdFx0aWYgKGl0ZW0udGV4dENvbnRlbnQ/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Rlcm1pbmFsJykpIGl0ZW0ucmVtb3ZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChjb25maWdTaG91bGRCZUhpZGRlbiAmJiBpY29uTmFtZSA9PT0gJ3dyZW5jaCcpIHtcclxuXHRcdFx0XHRcdGlmIChpdGVtLnRleHRDb250ZW50Py50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjb25maWcnKSkgaXRlbS5yZW1vdmUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlLCBQbHVnaW5TZXR0aW5nVGFiIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB7XHJcblx0ZGVmYXVsdFRlbXBsYXRlOiBzdHJpbmc7IC8vIEtlcHQgdGVtcG9yYXJpbHkgZm9yIG1pZ3JhdGlvblxyXG5cdGF1dG9JbnNlcnRQcm9wZXJ0aWVzOiBib29sZWFuO1xyXG5cdGRhdGVGb3JtYXQ6IHN0cmluZztcclxuXHRlbmFibGVDb3B5SGVhZGluZ0xpbms6IGJvb2xlYW47XHJcblx0Y29weUhlYWRpbmdMaW5rRm9ybWF0OiBcIm9ic2lkaWFuXCIgfCBcImFzdHJvXCI7XHJcblx0YWRkVHJhaWxpbmdTbGFzaFRvTGlua3M6IGJvb2xlYW47XHJcblx0ZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDogYm9vbGVhbjtcclxuXHR0ZXJtaW5hbFByb2plY3RSb290UGF0aDogc3RyaW5nO1xyXG5cdHRlcm1pbmFsQXBwbGljYXRpb25OYW1lOiBzdHJpbmc7XHJcblx0ZW5hYmxlVGVybWluYWxEZWJ1Z0xvZ2dpbmc6IGJvb2xlYW47XHJcblx0ZW5hYmxlVGVybWluYWxSaWJib25JY29uOiBib29sZWFuO1xyXG5cdGVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZDogYm9vbGVhbjtcclxuXHRjb25maWdGaWxlUGF0aDogc3RyaW5nO1xyXG5cdGVuYWJsZUNvbmZpZ1JpYmJvbkljb246IGJvb2xlYW47XHJcblx0Y29udGVudFR5cGVzOiBDb250ZW50VHlwZVtdO1xyXG5cdGhlbHBCdXR0b25SZXBsYWNlbWVudDogSGVscEJ1dHRvblJlcGxhY2VtZW50U2V0dGluZ3M7XHJcblx0bWlncmF0aW9uQ29tcGxldGVkOiBib29sZWFuO1xyXG5cdHNob3dNZHhGaWxlc0luRXhwbG9yZXI6IGJvb2xlYW47XHJcblx0cHJvY2Vzc0JhY2tncm91bmRGaWxlQ2hhbmdlczogYm9vbGVhbjtcclxuXHQvLyBMZWdhY3kgZmllbGRzIChrZXB0IGZvciBtaWdyYXRpb24sIGlnbm9yZWQgYWZ0ZXIgbWlncmF0aW9uKVxyXG5cdGVuYWJsZVVuZGVyc2NvcmVQcmVmaXg/OiBib29sZWFuO1xyXG5cdHBvc3RzRm9sZGVyPzogc3RyaW5nO1xyXG5cdHBvc3RzTGlua0Jhc2VQYXRoPzogc3RyaW5nO1xyXG5cdGF1dG9tYXRlUG9zdENyZWF0aW9uPzogYm9vbGVhbjtcclxuXHRjcmVhdGlvbk1vZGU/OiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XHJcblx0aW5kZXhGaWxlTmFtZT86IHN0cmluZztcclxuXHRleGNsdWRlZERpcmVjdG9yaWVzPzogc3RyaW5nO1xyXG5cdG9ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXI/OiBib29sZWFuO1xyXG5cdGVuYWJsZVBhZ2VzPzogYm9vbGVhbjtcclxuXHRwYWdlc0ZvbGRlcj86IHN0cmluZztcclxuXHRwYWdlc0xpbmtCYXNlUGF0aD86IHN0cmluZztcclxuXHRwYWdlc0NyZWF0aW9uTW9kZT86IFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcclxuXHRwYWdlc0luZGV4RmlsZU5hbWU/OiBzdHJpbmc7XHJcblx0cGFnZVRlbXBsYXRlPzogc3RyaW5nO1xyXG5cdG9ubHlBdXRvbWF0ZUluUGFnZXNGb2xkZXI/OiBib29sZWFuO1xyXG5cdGN1c3RvbUNvbnRlbnRUeXBlcz86IENvbnRlbnRUeXBlW107IC8vIExlZ2FjeSBuYW1lXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSGVscEJ1dHRvblJlcGxhY2VtZW50U2V0dGluZ3Mge1xyXG5cdGVuYWJsZWQ6IGJvb2xlYW47XHJcblx0Y29tbWFuZElkOiBzdHJpbmc7XHJcblx0aWNvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2VkRnJvbnRtYXR0ZXIge1xyXG5cdHByb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjtcclxuXHRwcm9wZXJ0aWVzVGV4dDogc3RyaW5nO1xyXG5cdHByb3BlcnRpZXNFbmQ6IG51bWJlcjtcclxuXHRib2R5Q29udGVudDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRlbXBsYXRlVmFsdWVzIHtcclxuXHRba2V5OiBzdHJpbmddOiBzdHJpbmdbXSB8IHN0cmluZztcclxufVxyXG5cclxuLy8gQ29udGVudFR5cGUgaXMgbm93IGp1c3QgYSBzdHJpbmcgSUQgLSBubyBkaXN0aW5jdGlvbiBiZXR3ZWVuIGJ1aWx0LWluIGFuZCBjdXN0b20gdHlwZXNcclxuZXhwb3J0IHR5cGUgQ29udGVudFR5cGVJZCA9IHN0cmluZztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29udGVudFR5cGUge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG5cdGZvbGRlcjogc3RyaW5nO1xyXG5cdGxpbmtCYXNlUGF0aDogc3RyaW5nO1xyXG5cdHRlbXBsYXRlOiBzdHJpbmc7XHJcblx0ZW5hYmxlZDogYm9vbGVhbjtcclxuXHRjcmVhdGlvbk1vZGU6IFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcclxuXHRpbmRleEZpbGVOYW1lOiBzdHJpbmc7XHJcblx0aWdub3JlU3ViZm9sZGVyczogYm9vbGVhbjtcclxuXHRlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBib29sZWFuO1xyXG5cdHVzZU1keEV4dGVuc2lvbjogYm9vbGVhbjtcclxuXHRjb2xsYXBzZWQ/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZpbGVDcmVhdGlvbk9wdGlvbnMge1xyXG5cdGZpbGU6IFRGaWxlO1xyXG5cdHRpdGxlOiBzdHJpbmc7XHJcblx0dHlwZTogQ29udGVudFR5cGVJZDsgLy8gQ29udGVudCB0eXBlIElEIChzdHJpbmcpXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVuYW1lT3B0aW9ucyB7XHJcblx0ZmlsZTogVEZpbGU7XHJcblx0dGl0bGU6IHN0cmluZztcclxuXHR0eXBlOiBDb250ZW50VHlwZUlkOyAvLyBDb250ZW50IHR5cGUgSUQgKHN0cmluZylcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IEtOT1dOX0FSUkFZX0tFWVMgPSBbJ3RhZ3MnLCAnYWxpYXNlcycsICdjc3NjbGFzc2VzJ10gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgQ09OU1RBTlRTID0ge1xyXG5cdERFQk9VTkNFX01TOiA1MDAsXHJcblx0U1RBVF9NVElNRV9USFJFU0hPTEQ6IDEwMDAsXHJcblx0RURJVE9SX1NUQUJJTElaRV9ERUxBWTogMTAwLFxyXG5cdEZJTEVfRVhQTE9SRVJfUkVWRUFMX0RFTEFZOiAyMDAsXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2Uge1xyXG5cdHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3M7XHJcblx0c2F2ZVNldHRpbmdzKCk6IFByb21pc2U8dm9pZD47XHJcblx0bG9hZFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD47XHJcblx0cmVnaXN0ZXJDcmVhdGVFdmVudCgpOiB2b2lkO1xyXG5cdHBsdWdpbkNyZWF0ZWRGaWxlczogTWFwPHN0cmluZywgbnVtYmVyPjtcclxuXHRzZXR0aW5nc1RhYj86IFBsdWdpblNldHRpbmdUYWI7XHJcblx0cmVnaXN0ZXJSaWJib25JY29ucz8oKTogdm9pZDtcclxuXHR1cGRhdGVIZWxwQnV0dG9uPygpOiBQcm9taXNlPHZvaWQ+O1xyXG59IiwgImltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB9IGZyb20gXCIuL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgdHlwZSB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB9IGZyb20gXCIuL3R5cGVzXCI7XHJcbmV4cG9ydCB7IENPTlNUQU5UUyB9IGZyb20gXCIuL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogQXN0cm9Db21wb3NlclNldHRpbmdzID0ge1xyXG5cdGRlZmF1bHRUZW1wbGF0ZTpcclxuXHRcdCctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxudGFnczogW11cXG4tLS1cXG4nLFxyXG5cdGF1dG9JbnNlcnRQcm9wZXJ0aWVzOiB0cnVlLFxyXG5cdGRhdGVGb3JtYXQ6IFwiWVlZWS1NTS1ERFwiLFxyXG5cdGVuYWJsZUNvcHlIZWFkaW5nTGluazogdHJ1ZSxcclxuXHRjb3B5SGVhZGluZ0xpbmtGb3JtYXQ6IFwib2JzaWRpYW5cIixcclxuXHRhZGRUcmFpbGluZ1NsYXNoVG9MaW5rczogZmFsc2UsXHJcblx0ZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDogZmFsc2UsXHJcblx0dGVybWluYWxQcm9qZWN0Um9vdFBhdGg6IFwiXCIsXHJcblx0dGVybWluYWxBcHBsaWNhdGlvbk5hbWU6IFwiXCIsXHJcblx0ZW5hYmxlVGVybWluYWxEZWJ1Z0xvZ2dpbmc6IGZhbHNlLFxyXG5cdGVuYWJsZVRlcm1pbmFsUmliYm9uSWNvbjogZmFsc2UsXHJcblx0ZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kOiBmYWxzZSxcclxuXHRjb25maWdGaWxlUGF0aDogXCJcIixcclxuXHRlbmFibGVDb25maWdSaWJib25JY29uOiBmYWxzZSxcclxuXHRjb250ZW50VHlwZXM6IFtdLFxyXG5cdG1pZ3JhdGlvbkNvbXBsZXRlZDogZmFsc2UsXHJcblx0aGVscEJ1dHRvblJlcGxhY2VtZW50OiB7XHJcblx0XHRlbmFibGVkOiBmYWxzZSxcclxuXHRcdGNvbW1hbmRJZDogJ2VkaXQtYXN0cm8tY29uZmlnJyxcclxuXHRcdGljb25JZDogJ3dyZW5jaCcsXHJcblx0fSxcclxuXHRzaG93TWR4RmlsZXNJbkV4cGxvcmVyOiBmYWxzZSxcclxuXHRwcm9jZXNzQmFja2dyb3VuZEZpbGVDaGFuZ2VzOiB0cnVlLFxyXG59O1xyXG4iLCAiaW1wb3J0IHsgUGx1Z2luLCBFZGl0b3IsIE1hcmtkb3duVmlldywgVEZpbGUsIE5vdGljZSwgQXBwLCBNYXJrZG93bkZpbGVJbmZvLCBQbGF0Zm9ybSwgVEZvbGRlciB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgRmlsZU9wZXJhdGlvbnMgfSBmcm9tIFwiLi4vdXRpbHMvZmlsZS1vcGVyYXRpb25zXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSBcIi4uL3V0aWxzL3RlbXBsYXRlLXBhcnNpbmdcIjtcclxuaW1wb3J0IHsgTGlua0NvbnZlcnRlciB9IGZyb20gXCIuLi91dGlscy9saW5rLWNvbnZlcnNpb25cIjtcclxuaW1wb3J0IHsgVGl0bGVNb2RhbCB9IGZyb20gXCIuLi91aS90aXRsZS1tb2RhbFwiO1xyXG5pbXBvcnQgeyB0b0tlYmFiQ2FzZSB9IGZyb20gXCIuLi91dGlscy9zdHJpbmctdXRpbHNcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckNvbW1hbmRzKHBsdWdpbjogUGx1Z2luLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogdm9pZCB7XHJcblx0Ly8gVGVybWluYWwgYW5kIGNvbmZpZyBjb21tYW5kcyBhcmUgZGVza3RvcC1vbmx5IC0gTkVWRVIgcmVnaXN0ZXIgb24gbW9iaWxlXHJcblx0Ly8gQ2hlY2sgUGxhdGZvcm0uaXNNb2JpbGUgLSBpZiB0cnVlLCB0aGVzZSBjb21tYW5kcyBtdXN0IE5FVkVSIGJlIHJlZ2lzdGVyZWRcclxuXHRjb25zdCBpc01vYmlsZSA9IFBsYXRmb3JtLmlzTW9iaWxlO1xyXG5cclxuXHQvLyBJZiBvbiBtb2JpbGUsIGFic29sdXRlbHkgZG8gbm90IHJlZ2lzdGVyIHRlcm1pbmFsL2NvbmZpZyBjb21tYW5kc1xyXG5cdC8vIFRoZXkgdXNlIE5vZGUuanMvRWxlY3Ryb24gQVBJcyB0aGF0IGRvbid0IGV4aXN0IG9uIG1vYmlsZVxyXG5cdGlmIChpc01vYmlsZSkge1xyXG5cdFx0Ly8gT24gbW9iaWxlLCBvbmx5IHJlZ2lzdGVyIHRoZSBzYWZlIGNvbW1hbmRzIHRoYXQgd29yayBvbiBtb2JpbGVcclxuXHRcdGNvbnN0IHBsdWdpbkludGVyZmFjZSA9IHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XHJcblx0XHRjb25zdCBmaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKHBsdWdpbi5hcHAsIHNldHRpbmdzLCBwbHVnaW5JbnRlcmZhY2UpO1xyXG5cdFx0Y29uc3QgbGlua0NvbnZlcnRlciA9IG5ldyBMaW5rQ29udmVydGVyKHNldHRpbmdzLCBwbHVnaW5JbnRlcmZhY2UpO1xyXG5cclxuXHRcdC8vIFJlZ2lzdGVyIG9ubHkgbW9iaWxlLXNhZmUgY29tbWFuZHNcclxuXHRcdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IFwic3RhbmRhcmRpemUtcHJvcGVydGllc1wiLFxyXG5cdFx0XHRuYW1lOiBcIlN0YW5kYXJkaXplIHByb3BlcnRpZXNcIixcclxuXHRcdFx0aWNvbjogXCJmaWxlLWNoZWNrXCIsXHJcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHRcdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpblxyXG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gcGx1Z2luSW50ZXJmYWNlLnNldHRpbmdzIHx8IHNldHRpbmdzO1xyXG5cdFx0XHRcdFx0dm9pZCBzdGFuZGFyZGl6ZVByb3BlcnRpZXMocGx1Z2luLmFwcCwgY3VycmVudFNldHRpbmdzLCBmaWxlLCBwbHVnaW5JbnRlcmZhY2UsIGVkaXRvcik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJjb252ZXJ0LXdpa2lsaW5rcy1hc3Ryb1wiLFxyXG5cdFx0XHRuYW1lOiBcIkNvbnZlcnQgaW50ZXJuYWwgbGlua3MgZm9yIGFzdHJvXCIsXHJcblx0XHRcdGljb246IFwibGluay0yXCIsXHJcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHRcdGxpbmtDb252ZXJ0ZXIuY29udmVydFdpa2lsaW5rc0ZvckFzdHJvKGVkaXRvciwgZmlsZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gSGVscGVyIGZ1bmN0aW9uIGZvciByZW5hbWUgY29tbWFuZCAobW9iaWxlIHZlcnNpb24pXHJcblx0XHQvLyBVc2VzIHRoZSBzYW1lIGxvZ2ljIGFzIEZpbGVPcGVyYXRpb25zLmRldGVybWluZVR5cGUoKSB0byBlbnN1cmUgY29uc2lzdGVuY3lcclxuXHRcdGZ1bmN0aW9uIGhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZTogVEZpbGUsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiBib29sZWFuIHtcclxuXHRcdFx0Y29uc3QgdHlwZSA9IGZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHRcdFx0Ly8gSWYgZGV0ZXJtaW5lVHlwZSByZXR1cm5zIFwibm90ZVwiLCBpdCBtZWFucyBubyBjb250ZW50IHR5cGUgbWF0Y2hlZFxyXG5cdFx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIG1hdGNoZWQgY29udGVudCB0eXBlIGlzIGVuYWJsZWRcclxuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSBmaWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0XHRyZXR1cm4gY29udGVudFR5cGUgIT09IG51bGwgJiYgY29udGVudFR5cGUuZW5hYmxlZDtcclxuXHRcdH1cclxuXHJcblx0XHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcInJlbmFtZS1jb250ZW50XCIsXHJcblx0XHRcdG5hbWU6IFwiUmVuYW1lIGN1cnJlbnQgY29udGVudFwiLFxyXG5cdFx0XHRpY29uOiBcInBlbmNpbFwiLFxyXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0XHRjb25zdCBmaWxlID0gY3R4IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ID8gY3R4LmZpbGUgOiBjdHguZmlsZTtcclxuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0XHRpZiAoIWhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZSwgc2V0dGluZ3MpKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiB0aGlzIGZpbGUgaXMgbm90IHBhcnQgb2YgYSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXIuXCIpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0Y29uc3QgdHlwZSA9IGZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHRcdFx0XHRcdGNvbnN0IGNhY2hlID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuXHRcdFx0XHRcdGNvbnN0IHRpdGxlS2V5ID0gZmlsZU9wcy5nZXRUaXRsZUtleSh0eXBlKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoIWNhY2hlPy5mcm9udG1hdHRlciB8fCAhKHRpdGxlS2V5IGluIGNhY2hlLmZyb250bWF0dGVyKSkge1xyXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBDYW5ub3QgcmVuYW1lOiBObyAke3RpdGxlS2V5fSBmb3VuZCBpbiBwcm9wZXJ0aWVzYCk7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRuZXcgVGl0bGVNb2RhbChwbHVnaW4uYXBwLCBmaWxlLCBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCB0eXBlLCB0cnVlKS5vcGVuKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gRE8gTk9UIHJlZ2lzdGVyIHRlcm1pbmFsIG9yIGNvbmZpZyBjb21tYW5kcyBvbiBtb2JpbGUgLSByZXR1cm4gZWFybHlcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdC8vIERlc2t0b3A6IHJlZ2lzdGVyIGFsbCBjb21tYW5kcyBpbmNsdWRpbmcgdGVybWluYWwgYW5kIGNvbmZpZ1xyXG5cdGNvbnN0IHBsdWdpbkludGVyZmFjZSA9IHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XHJcblxyXG5cclxuXHQvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgaWYgYSBmaWxlIG1hdGNoZXMgYW55IGNvbmZpZ3VyZWQgY29udGVudCB0eXBlXHJcblx0Ly8gVXNlcyB0aGUgc2FtZSBsb2dpYyBhcyBGaWxlT3BlcmF0aW9ucy5kZXRlcm1pbmVUeXBlKCkgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XHJcblx0Ly8gR2V0cyBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiB0byBlbnN1cmUgd2UgY2hlY2sgYWdhaW5zdCBjdXJyZW50IGNvbnRlbnQgdHlwZXNcclxuXHRmdW5jdGlvbiBoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGU6IFRGaWxlLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogYm9vbGVhbiB7XHJcblx0XHQvLyBHZXQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gaWYgYXZhaWxhYmxlXHJcblx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSAocGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSk/LnNldHRpbmdzIHx8IHNldHRpbmdzO1xyXG5cdFx0Ly8gQ3JlYXRlIGEgdGVtcG9yYXJ5IEZpbGVPcGVyYXRpb25zIHdpdGggZnJlc2ggc2V0dGluZ3NcclxuXHRcdGNvbnN0IHRlbXBGaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKHBsdWdpbi5hcHAsIGN1cnJlbnRTZXR0aW5ncywgcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSk7XHJcblx0XHRjb25zdCB0eXBlID0gdGVtcEZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHRcdC8vIElmIGRldGVybWluZVR5cGUgcmV0dXJucyBcIm5vdGVcIiwgaXQgbWVhbnMgbm8gY29udGVudCB0eXBlIG1hdGNoZWRcclxuXHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHQvLyBDaGVjayBpZiB0aGUgbWF0Y2hlZCBjb250ZW50IHR5cGUgaXMgZW5hYmxlZFxyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSB0ZW1wRmlsZU9wcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcclxuXHRcdHJldHVybiBjb250ZW50VHlwZSAhPT0gbnVsbCAmJiBjb250ZW50VHlwZS5lbmFibGVkO1xyXG5cdH1cclxuXHJcblx0Ly8gU3RhbmRhcmRpemUgUHJvcGVydGllcyBjb21tYW5kXHJcblx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0aWQ6IFwic3RhbmRhcmRpemUtcHJvcGVydGllc1wiLFxyXG5cdFx0bmFtZTogXCJTdGFuZGFyZGl6ZSBwcm9wZXJ0aWVzXCIsXHJcblx0XHRpY29uOiBcImZpbGUtY2hlY2tcIixcclxuXHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xyXG5cdFx0XHRjb25zdCBmaWxlID0gY3R4IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ID8gY3R4LmZpbGUgOiBjdHguZmlsZTtcclxuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdHZvaWQgc3RhbmRhcmRpemVQcm9wZXJ0aWVzKHBsdWdpbi5hcHAsIHNldHRpbmdzLCBmaWxlLCBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBlZGl0b3IpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdH0pO1xyXG5cclxuXHQvLyBDb252ZXJ0IFdpa2lsaW5rcyBjb21tYW5kXHJcblx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0aWQ6IFwiY29udmVydC13aWtpbGlua3MtYXN0cm9cIixcclxuXHRcdG5hbWU6IFwiQ29udmVydCBpbnRlcm5hbCBsaW5rcyBmb3IgYXN0cm9cIixcclxuXHRcdGljb246IFwibGluay0yXCIsXHJcblx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHQvLyBHZXQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gYW5kIGNyZWF0ZSBMaW5rQ29udmVydGVyIHdpdGggaXRcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSBwbHVnaW5JbnRlcmZhY2Uuc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHRcdFx0Y29uc3QgY3VycmVudExpbmtDb252ZXJ0ZXIgPSBuZXcgTGlua0NvbnZlcnRlcihjdXJyZW50U2V0dGluZ3MsIHBsdWdpbkludGVyZmFjZSk7XHJcblx0XHRcdFx0Y3VycmVudExpbmtDb252ZXJ0ZXIuY29udmVydFdpa2lsaW5rc0ZvckFzdHJvKGVkaXRvciwgZmlsZSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0fSk7XHJcblxyXG5cdC8vIFJlbmFtZSBDb250ZW50IGNvbW1hbmRcclxuXHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRpZDogXCJyZW5hbWUtY29udGVudFwiLFxyXG5cdFx0bmFtZTogXCJSZW5hbWUgY3VycmVudCBjb250ZW50XCIsXHJcblx0XHRpY29uOiBcInBlbmNpbFwiLFxyXG5cdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luXHJcblx0XHRcdFx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gcGx1Z2luSW50ZXJmYWNlLnNldHRpbmdzIHx8IHNldHRpbmdzO1xyXG5cdFx0XHRcdC8vIENyZWF0ZSBGaWxlT3BlcmF0aW9ucyB3aXRoIGZyZXNoIHNldHRpbmdzXHJcblx0XHRcdFx0Y29uc3QgY3VycmVudEZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMocGx1Z2luLmFwcCwgY3VycmVudFNldHRpbmdzLCBwbHVnaW5JbnRlcmZhY2UpO1xyXG5cclxuXHRcdFx0XHQvLyBDaGVjayBpZiB0aGlzIGZpbGUgbWF0Y2hlcyBhbnkgY29uZmlndXJlZCBjb250ZW50IHR5cGVcclxuXHRcdFx0XHRpZiAoIWhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZSwgY3VycmVudFNldHRpbmdzKSkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHRoaXMgZmlsZSBpcyBub3QgcGFydCBvZiBhIGNvbmZpZ3VyZWQgY29udGVudCB0eXBlIGZvbGRlci5cIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBEZXRlcm1pbmUgY29udGVudCB0eXBlIGZyb20gZm9sZGVyIHN0cnVjdHVyZVxyXG5cdFx0XHRcdGNvbnN0IHR5cGUgPSBjdXJyZW50RmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cclxuXHRcdFx0XHQvLyBBbHdheXMgb3BlbiB0aGUgbW9kYWwgLSBpdCB3aWxsIGhhbmRsZSBmaWxlcyB3aXRob3V0IGZyb250bWF0dGVyIG9yIHRpdGxlIGtleVxyXG5cdFx0XHRcdC8vIElmIHRoZXJlJ3Mgbm8gdGl0bGUgaW4gZnJvbnRtYXR0ZXIsIHRoZSBtb2RhbCB3aWxsIHVzZSB0aGUgZmlsZW5hbWUgYXMgZmFsbGJhY2tcclxuXHRcdFx0XHQvLyBhbmQgdGhlIHJlbmFtZSB3aWxsIHByb2NlZWQgd2l0aCBrZWJhYi1jYXNlIHZlcnNpb24gb2Ygd2hhdCB1c2VyIHR5cGVzXHJcblx0XHRcdFx0bmV3IFRpdGxlTW9kYWwocGx1Z2luLmFwcCwgZmlsZSwgcGx1Z2luSW50ZXJmYWNlLCB0eXBlLCB0cnVlKS5vcGVuKCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0fSk7XHJcblxyXG5cdC8vIE9wZW4gVGVybWluYWwgY29tbWFuZCAoZGVza3RvcCBvbmx5IC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGUpXHJcblx0aWYgKCFpc01vYmlsZSkge1xyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJvcGVuLXByb2plY3QtdGVybWluYWxcIixcclxuXHRcdFx0bmFtZTogXCJPcGVuIHByb2plY3QgdGVybWluYWxcIixcclxuXHRcdFx0aWNvbjogXCJ0ZXJtaW5hbC1zcXVhcmVcIixcclxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSAocGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSkuc2V0dGluZ3M7XHJcblx0XHRcdFx0aWYgKCFjdXJyZW50U2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIk9wZW4gdGVybWluYWwgY29tbWFuZCBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHNldHRpbmdzIHRvIHVzZSB0aGlzIGNvbW1hbmQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRvcGVuVGVybWluYWxJblByb2plY3RSb290KHBsdWdpbi5hcHAsIGN1cnJlbnRTZXR0aW5ncyk7XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8vIEVkaXQgQ29uZmlnIEZpbGUgY29tbWFuZCAoZGVza3RvcCBvbmx5IC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGUpXHJcblx0aWYgKCFpc01vYmlsZSkge1xyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJlZGl0LWFzdHJvLWNvbmZpZ1wiLFxyXG5cdFx0XHRuYW1lOiBcIkVkaXQgYXN0cm8gY29uZmlnXCIsXHJcblx0XHRcdGljb246IFwid3JlbmNoXCIsXHJcblx0XHRcdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gKHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpLnNldHRpbmdzO1xyXG5cdFx0XHRcdGlmICghY3VycmVudFNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIkVkaXQgY29uZmlnIGZpbGUgY29tbWFuZCBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHNldHRpbmdzIHRvIHVzZSB0aGlzIGNvbW1hbmQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhd2FpdCBvcGVuQ29uZmlnRmlsZShwbHVnaW4uYXBwLCBjdXJyZW50U2V0dGluZ3MpO1xyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblx0fVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzdGFuZGFyZGl6ZVByb3BlcnRpZXMoYXBwOiBBcHAsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIGZpbGU6IFRGaWxlLCBwbHVnaW4/OiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBlZGl0b3I/OiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHQvLyBHZXQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gaWYgYXZhaWxhYmxlXHJcblx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gcGx1Z2luPy5zZXR0aW5ncyB8fCBzZXR0aW5ncztcclxuXHRjb25zdCB0ZW1wbGF0ZVBhcnNlciA9IG5ldyBUZW1wbGF0ZVBhcnNlcihhcHAsIGN1cnJlbnRTZXR0aW5ncyk7XHJcblx0Y29uc3QgZmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhhcHAsIGN1cnJlbnRTZXR0aW5ncywgcGx1Z2luKTtcclxuXHJcblx0Ly8gUHJlc2VydmUgY3Vyc29yIHBvc2l0aW9uIGlmIGVkaXRvciBpcyBwcm92aWRlZFxyXG5cdGxldCBjdXJzb3JQb3NpdGlvbjogeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfSB8IG51bGwgPSBudWxsO1xyXG5cdGxldCBvcmlnaW5hbENvbnRlbnQgPSBcIlwiO1xyXG5cdGlmIChlZGl0b3IpIHtcclxuXHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcclxuXHRcdGN1cnNvclBvc2l0aW9uID0geyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCB9O1xyXG5cdFx0b3JpZ2luYWxDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XHJcblx0fVxyXG5cclxuXHQvLyBEZXRlcm1pbmUgY29udGVudCB0eXBlIHVzaW5nIHRoZSBleGlzdGluZyBsb2dpY1xyXG5cdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblxyXG5cdC8vIENoZWNrIGlmIHRoaXMgZmlsZSBoYXMgYSB2YWxpZCBjb250ZW50IHR5cGUgKG5vdCBqdXN0IFwibm90ZVwiKVxyXG5cdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0bmV3IE5vdGljZShcIk5vIHByb3BlcnRpZXMgdGVtcGxhdGUgc3BlY2lmaWVkIGZvciB0aGlzIGNvbnRlbnQuIFRoaXMgZmlsZSBkb2Vzbid0IG1hdGNoIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXJzLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdGxldCB0ZW1wbGF0ZVN0cmluZzogc3RyaW5nO1xyXG5cclxuXHQvLyBEZXRlcm1pbmUgdGVtcGxhdGUgYmFzZWQgb24gY29udGVudCB0eXBlXHJcblx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XHJcblx0XHRuZXcgTm90aWNlKFwiTm8gcHJvcGVydGllcyB0ZW1wbGF0ZSBzcGVjaWZpZWQgZm9yIHRoaXMgY29udGVudC4gVGhpcyBmaWxlIGRvZXNuJ3QgbWF0Y2ggYW55IGNvbmZpZ3VyZWQgY29udGVudCB0eXBlIGZvbGRlcnMuXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0Y29uc3QgY29udGVudFR5cGUgPSBmaWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdGlmICghY29udGVudFR5cGUpIHtcclxuXHRcdG5ldyBOb3RpY2UoXCJDb250ZW50IHR5cGUgbm90IGZvdW5kLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdHRlbXBsYXRlU3RyaW5nID0gY29udGVudFR5cGUudGVtcGxhdGU7XHJcblxyXG5cdC8vIFdhaXQgYnJpZWZseSB0byBhbGxvdyBlZGl0b3Igc3RhdGUgdG8gc3RhYmlsaXplXHJcblx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpO1xyXG5cclxuXHQvLyBSZS1yZWFkIGNvbnRlbnQgdG8gZW5zdXJlIGxhdGVzdCBzdGF0ZSBhZnRlciBlZGl0b3IgY2hhbmdlc1xyXG5cdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKTtcclxuXHRjb25zdCB0aXRsZSA9IGZpbGUuYmFzZW5hbWUucmVwbGFjZSgvXl8vLCBcIlwiKTtcclxuXHJcblx0Y29uc3QgcGFyc2VkID0gdGVtcGxhdGVQYXJzZXIucGFyc2VGcm9udG1hdHRlcihjb250ZW50KTtcclxuXHRjb25zdCB7IHRlbXBsYXRlUHJvcHMsIHRlbXBsYXRlVmFsdWVzIH0gPSB0ZW1wbGF0ZVBhcnNlci5wYXJzZVRlbXBsYXRlKHRlbXBsYXRlU3RyaW5nLCB0aXRsZSk7XHJcblxyXG5cdC8vIE1lcmdlIHRlbXBsYXRlIHByb3BlcnRpZXMgd2l0aCBleGlzdGluZyBvbmVzLCBwcmVzZXJ2aW5nIGFsbCBleGlzdGluZ1xyXG5cdGNvbnN0IGZpbmFsUHJvcHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHsgLi4ucGFyc2VkLnByb3BlcnRpZXMgfTtcclxuXHRjb25zdCBhcnJheUtleXMgPSBuZXcgU2V0PHN0cmluZz4oKTsgLy8gVHJhY2sgd2hpY2gga2V5cyBhcmUgYXJyYXlzXHJcblxyXG5cdC8vIEdlbmVyYXRlIHNsdWcgZnJvbSB0aXRsZSBmb3Igc2x1ZyBwcm9wZXJ0eSBhdXRvLXBvcHVsYXRpb25cclxuXHRjb25zdCBzbHVnID0gdG9LZWJhYkNhc2UodGl0bGUpO1xyXG5cclxuXHRmb3IgKGNvbnN0IGtleSBvZiB0ZW1wbGF0ZVByb3BzKSB7XHJcblx0XHRpZiAoIShrZXkgaW4gcGFyc2VkLnByb3BlcnRpZXMpKSB7XHJcblx0XHRcdC8vIFByb3BlcnR5IGRvZXNuJ3QgZXhpc3QsIGFkZCBpdCBmcm9tIHRlbXBsYXRlXHJcblx0XHRcdGNvbnN0IHRlbXBsYXRlVmFsdWUgPSB0ZW1wbGF0ZVZhbHVlc1trZXldO1xyXG5cdFx0XHRpZiAoQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZVZhbHVlKSkge1xyXG5cdFx0XHRcdGZpbmFsUHJvcHNba2V5XSA9IHRlbXBsYXRlVmFsdWU7XHJcblx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIGFzIGFycmF5XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZmluYWxQcm9wc1trZXldID0gW3RlbXBsYXRlVmFsdWUgfHwgXCJcIl07XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIFByb3BlcnR5IGV4aXN0cywgY2hlY2sgaWYgaXQncyBhbiBhcnJheSB0eXBlXHJcblx0XHRcdGNvbnN0IHRlbXBsYXRlVmFsdWUgPSB0ZW1wbGF0ZVZhbHVlc1trZXldO1xyXG5cdFx0XHRjb25zdCBpc0FycmF5VmFsdWUgPSBBcnJheS5pc0FycmF5KHRlbXBsYXRlVmFsdWUpO1xyXG5cclxuXHRcdFx0aWYgKGlzQXJyYXlWYWx1ZSkge1xyXG5cdFx0XHRcdC8vIFRoaXMgaXMgYW4gYXJyYXkgcHJvcGVydHkgLSBwcmVzZXJ2ZSBleGlzdGluZyB2YWx1ZXMgYW5kIG1lcmdlIHdpdGggdGVtcGxhdGVcclxuXHRcdFx0XHRjb25zdCBleGlzdGluZ0l0ZW1zID0gcGFyc2VkLnByb3BlcnRpZXNba2V5XSB8fCBbXTtcclxuXHRcdFx0XHRjb25zdCBuZXdJdGVtcyA9IHRlbXBsYXRlVmFsdWUuZmlsdGVyKGl0ZW0gPT4gIWV4aXN0aW5nSXRlbXMuaW5jbHVkZXMoaXRlbSkpO1xyXG5cdFx0XHRcdGZpbmFsUHJvcHNba2V5XSA9IFsuLi5leGlzdGluZ0l0ZW1zLCAuLi5uZXdJdGVtc107XHJcblx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIGFzIGFycmF5XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gRm9yIG5vbi1hcnJheSB2YWx1ZXMsIGNoZWNrIGlmIGl0J3Mgc2x1ZyBhbmQgbmVlZHMgYXV0by1wb3B1bGF0aW9uXHJcblx0XHRcdFx0aWYgKGtleSA9PT0gXCJzbHVnXCIpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGV4aXN0aW5nU2x1ZyA9IHBhcnNlZC5wcm9wZXJ0aWVzW2tleV1bMF0gfHwgXCJcIjtcclxuXHRcdFx0XHRcdC8vIE9ubHkgYXV0by1wb3B1bGF0ZSBpZiBzbHVnIGlzIGVtcHR5IG9yIG1pc3NpbmdcclxuXHRcdFx0XHRcdGlmICghZXhpc3RpbmdTbHVnIHx8IGV4aXN0aW5nU2x1Zy50cmltKCkgPT09IFwiXCIpIHtcclxuXHRcdFx0XHRcdFx0ZmluYWxQcm9wc1trZXldID0gW3NsdWddO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gSWYgc2x1ZyBoYXMgYSB2YWx1ZSwgcHJlc2VydmUgaXQgKGRvbid0IG92ZXJ3cml0ZSlcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gRm9yIG90aGVyIG5vbi1hcnJheSB2YWx1ZXMsIGtlZXAgZXhpc3RpbmcgdmFsdWUgKGRvbid0IG92ZXJ3cml0ZSlcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gQWxzbyBjaGVjayBpZiBzbHVnIHByb3BlcnR5IGV4aXN0cyBpbiBmcm9udG1hdHRlciBidXQgaXMgZW1wdHkgKGV2ZW4gaWYgbm90IGluIHRlbXBsYXRlKVxyXG5cdC8vIE9ubHkgYXV0by1wb3B1bGF0ZSBpZiB0ZW1wbGF0ZSBoYXMge3tzbHVnfX0gcGxhY2Vob2xkZXJcclxuXHRpZiAoXCJzbHVnXCIgaW4gcGFyc2VkLnByb3BlcnRpZXMgJiYgdGVtcGxhdGVTdHJpbmcuaW5jbHVkZXMoXCJ7e3NsdWd9fVwiKSkge1xyXG5cdFx0Y29uc3QgZXhpc3RpbmdTbHVnID0gcGFyc2VkLnByb3BlcnRpZXNbXCJzbHVnXCJdWzBdIHx8IFwiXCI7XHJcblx0XHRpZiAoIWV4aXN0aW5nU2x1ZyB8fCBleGlzdGluZ1NsdWcudHJpbSgpID09PSBcIlwiKSB7XHJcblx0XHRcdC8vIFNsdWcgZXhpc3RzIGJ1dCBpcyBlbXB0eSwgYW5kIHRlbXBsYXRlIGhhcyB7e3NsdWd9fSAtIGF1dG8tcG9wdWxhdGUgaXRcclxuXHRcdFx0ZmluYWxQcm9wc1tcInNsdWdcIl0gPSBbc2x1Z107XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBBbHNvIGFkZCBhbnkgZXhpc3RpbmcgYXJyYXkga2V5cyB0aGF0IHdlcmVuJ3QgaW4gdGhlIHRlbXBsYXRlXHJcblx0Zm9yIChjb25zdCBrZXkgaW4gcGFyc2VkLnByb3BlcnRpZXMpIHtcclxuXHRcdGlmIChwYXJzZWQucHJvcGVydGllc1trZXldLmxlbmd0aCA+IDEpIHtcclxuXHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Y29uc3QgbmV3Q29udGVudCA9IHRlbXBsYXRlUGFyc2VyLmJ1aWxkRnJvbnRtYXR0ZXJDb250ZW50KGZpbmFsUHJvcHMsIGFycmF5S2V5cykgKyBwYXJzZWQuYm9keUNvbnRlbnQ7XHJcblxyXG5cdGF3YWl0IGFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XHJcblxyXG5cdC8vIFJlc3RvcmUgY3Vyc29yIHBvc2l0aW9uIGlmIGVkaXRvciB3YXMgcHJvdmlkZWQgYW5kIGZpbGUgaXMgc3RpbGwgb3BlblxyXG5cdGlmIChlZGl0b3IgJiYgY3Vyc29yUG9zaXRpb24pIHtcclxuXHRcdC8vIFdhaXQgZm9yIE9ic2lkaWFuIHRvIHJlbG9hZCB0aGUgZmlsZSBpbiB0aGUgZWRpdG9yXHJcblx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTApKTtcclxuXHJcblx0XHQvLyBUcnkgdG8gZ2V0IHRoZSBhY3RpdmUgZWRpdG9yIGZvciB0aGlzIGZpbGVcclxuXHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHRcdGlmIChhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZmlsZSA9PT0gZmlsZSAmJiBhY3RpdmVWaWV3LmVkaXRvcikge1xyXG5cdFx0XHRjb25zdCBhY3RpdmVFZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcclxuXHRcdFx0Y29uc3QgbmV3TGluZUNvdW50ID0gbmV3Q29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoO1xyXG5cdFx0XHRjb25zdCBvcmlnaW5hbExpbmVDb3VudCA9IG9yaWdpbmFsQ29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoO1xyXG5cclxuXHRcdFx0Ly8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb25cclxuXHRcdFx0bGV0IG5ld0xpbmUgPSBjdXJzb3JQb3NpdGlvbi5saW5lO1xyXG5cdFx0XHRsZXQgbmV3Q2ggPSBjdXJzb3JQb3NpdGlvbi5jaDtcclxuXHJcblx0XHRcdC8vIEFkanVzdCBmb3IgY29udGVudCBjaGFuZ2VzXHJcblx0XHRcdGlmIChuZXdMaW5lQ291bnQgIT09IG9yaWdpbmFsTGluZUNvdW50KSB7XHJcblx0XHRcdFx0Ly8gSWYgbGluZXMgd2VyZSBhZGRlZC9yZW1vdmVkLCBhZGp1c3QgbGluZSBudW1iZXJcclxuXHRcdFx0XHRpZiAobmV3TGluZSA+PSBuZXdMaW5lQ291bnQpIHtcclxuXHRcdFx0XHRcdG5ld0xpbmUgPSBNYXRoLm1heCgwLCBuZXdMaW5lQ291bnQgLSAxKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEFkanVzdCBjb2x1bW4gcG9zaXRpb24gaWYgbGluZSBsZW5ndGggY2hhbmdlZFxyXG5cdFx0XHRjb25zdCBuZXdMaW5lTGVuZ3RoID0gbmV3Q29udGVudC5zcGxpdCgnXFxuJylbbmV3TGluZV0/Lmxlbmd0aCB8fCAwO1xyXG5cdFx0XHRpZiAobmV3Q2ggPiBuZXdMaW5lTGVuZ3RoKSB7XHJcblx0XHRcdFx0bmV3Q2ggPSBNYXRoLm1heCgwLCBuZXdMaW5lTGVuZ3RoKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb25cclxuXHRcdFx0YWN0aXZlRWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IG5ld0xpbmUsIGNoOiBuZXdDaCB9KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdG5ldyBOb3RpY2UoXCJQcm9wZXJ0aWVzIHN0YW5kYXJkaXplZCB1c2luZyB0ZW1wbGF0ZS5cIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW5hbWUgYSBmaWxlIGJ5IHBhdGggKGZvciBwcm9ncmFtbWF0aWMgdXNlLCBlLmcuLCBmcm9tIG90aGVyIHBsdWdpbnMpXHJcbiAqIFRoaXMgYWxsb3dzIHRoZSByZW5hbWUgbW9kYWwgdG8gYXBwZWFyIHdpdGhvdXQgb3BlbmluZyB0aGUgZmlsZSBmaXJzdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmFtZUNvbnRlbnRCeVBhdGgoXHJcblx0YXBwOiBBcHAsXHJcblx0ZmlsZVBhdGg6IHN0cmluZyxcclxuXHRzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzLFxyXG5cdHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZVxyXG4pOiB2b2lkIHtcclxuXHRjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XHJcblx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG5cdFx0bmV3IE5vdGljZShgRmlsZSBub3QgZm91bmQ6ICR7ZmlsZVBhdGh9YCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRjb25zdCBmaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKGFwcCwgc2V0dGluZ3MsIHBsdWdpbik7XHJcblxyXG5cdC8vIEhlbHBlciBmdW5jdGlvbiB0byBjaGVjayBpZiBmaWxlIG1hdGNoZXMgY29udGVudCB0eXBlXHJcblx0Ly8gVXNlcyB0aGUgc2FtZSBsb2dpYyBhcyBGaWxlT3BlcmF0aW9ucy5kZXRlcm1pbmVUeXBlKCkgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XHJcblx0ZnVuY3Rpb24gaGFzTWF0Y2hpbmdDb250ZW50VHlwZShmaWxlOiBURmlsZSwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IGJvb2xlYW4ge1xyXG5cdFx0Y29uc3QgdHlwZSA9IGZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHRcdC8vIElmIGRldGVybWluZVR5cGUgcmV0dXJucyBcIm5vdGVcIiwgaXQgbWVhbnMgbm8gY29udGVudCB0eXBlIG1hdGNoZWRcclxuXHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHQvLyBDaGVjayBpZiB0aGUgbWF0Y2hlZCBjb250ZW50IHR5cGUgaXMgZW5hYmxlZFxyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSBmaWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0cmV0dXJuIGNvbnRlbnRUeXBlICE9PSBudWxsICYmIGNvbnRlbnRUeXBlLmVuYWJsZWQ7XHJcblx0fVxyXG5cclxuXHRpZiAoIWhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZSwgc2V0dGluZ3MpKSB7XHJcblx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogdGhpcyBmaWxlIGlzIG5vdCBwYXJ0IG9mIGEgY29uZmlndXJlZCBjb250ZW50IHR5cGUgZm9sZGVyLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblxyXG5cdC8vIEFsd2F5cyBvcGVuIHRoZSBtb2RhbCAtIGl0IHdpbGwgaGFuZGxlIGZpbGVzIHdpdGhvdXQgZnJvbnRtYXR0ZXIgb3IgdGl0bGUga2V5XHJcblx0Ly8gSWYgdGhlcmUncyBubyB0aXRsZSBpbiBmcm9udG1hdHRlciwgdGhlIG1vZGFsIHdpbGwgdXNlIHRoZSBmaWxlbmFtZSBhcyBmYWxsYmFja1xyXG5cdC8vIGFuZCB0aGUgcmVuYW1lIHdpbGwgcHJvY2VlZCB3aXRoIGtlYmFiLWNhc2UgdmVyc2lvbiBvZiB3aGF0IHVzZXIgdHlwZXNcclxuXHRuZXcgVGl0bGVNb2RhbChhcHAsIGZpbGUsIHBsdWdpbiwgdHlwZSwgdHJ1ZSkub3BlbigpO1xyXG59XHJcblxyXG4vKipcclxuICogUmVnaXN0ZXIgY29tbWFuZHMgZm9yIGVhY2ggZW5hYmxlZCBjb250ZW50IHR5cGVcclxuICogRWFjaCBjb21tYW5kIGNyZWF0ZXMgYSBuZXcgZmlsZSBpbiB0aGUgY29udGVudCB0eXBlJ3MgZm9sZGVyIGFuZCBvcGVucyB0aGUgVGl0bGVNb2RhbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyhwbHVnaW46IFBsdWdpbiwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IHZvaWQge1xyXG5cdGNvbnN0IHBsdWdpbkludGVyZmFjZSA9IHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XHJcblx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cclxuXHQvLyBSZWdpc3RlciBhIGNvbW1hbmQgZm9yIGVhY2ggZW5hYmxlZCBjb250ZW50IHR5cGVcclxuXHRmb3IgKGNvbnN0IGNvbnRlbnRUeXBlIG9mIGNvbnRlbnRUeXBlcykge1xyXG5cdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSB7XHJcblx0XHRcdGNvbnRpbnVlOyAvLyBTa2lwIGRpc2FibGVkIGNvbnRlbnQgdHlwZXNcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBjb21tYW5kSWQgPSBgY3JlYXRlLWNvbnRlbnQtdHlwZS0ke2NvbnRlbnRUeXBlLmlkfWA7XHJcblx0XHRjb25zdCBjb21tYW5kTmFtZSA9IGBDcmVhdGUgbmV3IGNvbnRlbnQgdHlwZTogJHtjb250ZW50VHlwZS5uYW1lfWA7XHJcblxyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogY29tbWFuZElkLFxyXG5cdFx0XHRuYW1lOiBjb21tYW5kTmFtZSxcclxuXHRcdFx0Y2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHQvLyBEZXRlcm1pbmUgdGFyZ2V0IGZvbGRlciBmcm9tIGNvbnRlbnQgdHlwZSAob3IgdmF1bHQgcm9vdCBpZiBibGFuaylcclxuXHRcdFx0XHRsZXQgdGFyZ2V0Rm9sZGVyID0gY29udGVudFR5cGUuZm9sZGVyIHx8IFwiXCI7XHJcblxyXG5cdFx0XHRcdC8vIENyZWF0ZSBmb2xkZXIgaWYgaXQgZG9lc24ndCBleGlzdCBhbmQgaXMgc3BlY2lmaWVkXHJcblx0XHRcdFx0aWYgKHRhcmdldEZvbGRlciAmJiB0YXJnZXRGb2xkZXIudHJpbSgpICE9PSBcIlwiKSB7XHJcblx0XHRcdFx0XHRjb25zdCBmb2xkZXIgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0YXJnZXRGb2xkZXIpO1xyXG5cdFx0XHRcdFx0aWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcclxuXHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcih0YXJnZXRGb2xkZXIpO1xyXG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcclxuXHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gY3JlYXRlIGZvbGRlcjogJHtlcnJvck1lc3NhZ2V9YCk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBDcmVhdGUgYSB0ZW1wb3JhcnkgZmlsZSBpbiB0aGUgdGFyZ2V0IGZvbGRlclxyXG5cdFx0XHRcdGNvbnN0IHRlbXBGaWxlTmFtZSA9IFwiVW50aXRsZWQubWRcIjtcclxuXHRcdFx0XHRjb25zdCBmaWxlUGF0aCA9IHRhcmdldEZvbGRlciA/IGAke3RhcmdldEZvbGRlcn0vJHt0ZW1wRmlsZU5hbWV9YCA6IHRlbXBGaWxlTmFtZTtcclxuXHJcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgZmlsZSBhbHJlYWR5IGV4aXN0cyAodW5saWtlbHkgYnV0IHBvc3NpYmxlKVxyXG5cdFx0XHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcclxuXHRcdFx0XHRpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHRcdC8vIElmIGZpbGUgZXhpc3RzLCB1c2UgaXQgZGlyZWN0bHlcclxuXHRcdFx0XHRcdG5ldyBUaXRsZU1vZGFsKHBsdWdpbi5hcHAsIGV4aXN0aW5nRmlsZSwgcGx1Z2luSW50ZXJmYWNlLCBjb250ZW50VHlwZS5pZCwgZmFsc2UsIHRydWUpLm9wZW4oKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIE1hcmsgdGhhdCB0aGlzIGZpbGUgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBwbHVnaW5cclxuXHRcdFx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcclxuXHRcdFx0XHRpZiAocGx1Z2luSW50ZXJmYWNlICYmICdwbHVnaW5DcmVhdGVkRmlsZXMnIGluIHBsdWdpbkludGVyZmFjZSkge1xyXG5cdFx0XHRcdFx0cGx1Z2luSW50ZXJmYWNlLnBsdWdpbkNyZWF0ZWRGaWxlcy5zZXQoZmlsZVBhdGgsIERhdGUubm93KCkpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdC8vIENyZWF0ZSB0aGUgdGVtcG9yYXJ5IGZpbGVcclxuXHRcdFx0XHRcdGNvbnN0IHRlbXBGaWxlID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIFwiXCIpO1xyXG5cclxuXHRcdFx0XHRcdC8vIE9wZW4gdGhlIFRpdGxlTW9kYWwgd2l0aCB0aGUgZmlsZSwgY29udGVudCB0eXBlIElELCBhbmQgaXNOZXdOb3RlIGZsYWdcclxuXHRcdFx0XHRcdG5ldyBUaXRsZU1vZGFsKHBsdWdpbi5hcHAsIHRlbXBGaWxlLCBwbHVnaW5JbnRlcmZhY2UsIGNvbnRlbnRUeXBlLmlkLCBmYWxzZSwgdHJ1ZSkub3BlbigpO1xyXG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gY3JlYXRlIGZpbGU6ICR7ZXJyb3JNZXNzYWdlfWApO1xyXG5cclxuXHRcdFx0XHRcdC8vIENsZWFuIHVwIHRoZSB0cmFja2luZyBpZiBmaWxlIGNyZWF0aW9uIGZhaWxlZFxyXG5cdFx0XHRcdFx0aWYgKHBsdWdpbkludGVyZmFjZSAmJiAncGx1Z2luQ3JlYXRlZEZpbGVzJyBpbiBwbHVnaW5JbnRlcmZhY2UpIHtcclxuXHRcdFx0XHRcdFx0cGx1Z2luSW50ZXJmYWNlLnBsdWdpbkNyZWF0ZWRGaWxlcy5kZWxldGUoZmlsZVBhdGgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIERlYnVnIGxvZ2dlciBmb3IgdGVybWluYWwgY29tbWFuZHNcclxuICovXHJcbmNvbnN0IHRlcm1pbmFsTG9nZ2VyID0ge1xyXG5cdGVuYWJsZWQ6IGZhbHNlLFxyXG5cdHNldEVuYWJsZWQodmFsdWU6IGJvb2xlYW4pIHtcclxuXHRcdHRoaXMuZW5hYmxlZCA9IHZhbHVlO1xyXG5cdH0sXHJcblx0bG9nKC4uLmFyZ3M6IHVua25vd25bXSkge1xyXG5cdFx0aWYgKHRoaXMuZW5hYmxlZCkge1xyXG5cdFx0XHRjb25zb2xlLmRlYnVnKFwiW2FzdHJvLWNvbXBvc2VyOnRlcm1pbmFsXVwiLCAuLi5hcmdzKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IGRlZmF1bHQgdGVybWluYWwgYXBwbGljYXRpb24gbmFtZSBiYXNlZCBvbiBwbGF0Zm9ybVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdFRlcm1pbmFsQXBwKCk6IHN0cmluZyB7XHJcblx0aWYgKCFQbGF0Zm9ybS5pc0Rlc2t0b3BBcHApIHtcclxuXHRcdHJldHVybiBcIlwiO1xyXG5cdH1cclxuXHRpZiAoUGxhdGZvcm0uaXNNYWNPUykge1xyXG5cdFx0cmV0dXJuIFwiVGVybWluYWxcIjtcclxuXHR9XHJcblx0aWYgKFBsYXRmb3JtLmlzV2luKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZiAtLSBSZXF1aXJlZCBmb3IgT1MgcmVsZWFzZSBkZXRlY3Rpb24gb24gZGVza3RvcFxyXG5cdFx0XHRjb25zdCBvcyA9IHJlcXVpcmUoJ29zJykgYXMgeyByZWxlYXNlOiAoKSA9PiBzdHJpbmcgfTtcclxuXHRcdFx0Y29uc3QgcmVsZWFzZSA9IG9zLnJlbGVhc2UoKTtcclxuXHRcdFx0Ly8gV2luZG93cyAxMSBidWlsZCBudW1iZXJzIHN0YXJ0IGF0IDIyMDAwXHJcblx0XHRcdGNvbnN0IG1ham9yVmVyc2lvbiA9IHBhcnNlSW50KHJlbGVhc2Uuc3BsaXQoJy4nKVswXSk7XHJcblx0XHRcdGNvbnN0IGJ1aWxkTnVtYmVyID0gcGFyc2VJbnQocmVsZWFzZS5zcGxpdCgnLicpWzJdKTtcclxuXHJcblx0XHRcdGlmIChtYWpvclZlcnNpb24gPiAxMCB8fCAobWFqb3JWZXJzaW9uID09PSAxMCAmJiBidWlsZE51bWJlciA+PSAyMjAwMCkpIHtcclxuXHRcdFx0XHRyZXR1cm4gXCJ3dC5leGVcIjtcclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdC8vIEZhbGxiYWNrIHRvIGNtZC5leGUgaWYgT1MgZGV0ZWN0aW9uIGZhaWxzXHJcblx0XHR9XHJcblx0XHRyZXR1cm4gXCJjbWQuZXhlXCI7XHJcblx0fVxyXG5cdGlmIChQbGF0Zm9ybS5pc0xpbnV4KSB7XHJcblx0XHRyZXR1cm4gXCJnbm9tZS10ZXJtaW5hbFwiO1xyXG5cdH1cclxuXHRyZXR1cm4gXCJcIjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNhbml0aXplIHRlcm1pbmFsIGFwcGxpY2F0aW9uIG5hbWUgKHRyaW0gd2hpdGVzcGFjZSlcclxuICovXHJcbmZ1bmN0aW9uIHNhbml0aXplVGVybWluYWxBcHAodmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0cmV0dXJuIHZhbHVlLnRyaW0oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVzY2FwZSBkb3VibGUgcXVvdGVzIGluIGEgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBlc2NhcGVEb3VibGVRdW90ZXModmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0cmV0dXJuIHZhbHVlLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9wZW4gdGVybWluYWwgaW4gcHJvamVjdCByb290IGRpcmVjdG9yeVxyXG4gKiBFeHBvcnRlZCBmb3IgdXNlIGJ5IHJpYmJvbiBpY29uc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5UZXJtaW5hbEluUHJvamVjdFJvb3QoYXBwOiBBcHAsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiB2b2lkIHtcclxuXHQvLyBVcGRhdGUgbG9nZ2VyIHN0YXRlXHJcblx0dGVybWluYWxMb2dnZXIuc2V0RW5hYmxlZChzZXR0aW5ncy5lbmFibGVUZXJtaW5hbERlYnVnTG9nZ2luZyk7XHJcblxyXG5cdHRyeSB7XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZiAtLSBjaGlsZF9wcm9jZXNzIGlzIHJlcXVpcmVkIGZvciB0ZXJtaW5hbCBjb21tYW5kcyBvbiBkZXNrdG9wXHJcblx0XHRjb25zdCB7IGV4ZWMgfSA9IHJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKSBhcyB7IGV4ZWM6IChjb21tYW5kOiBzdHJpbmcsIGNhbGxiYWNrOiAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4gdm9pZCkgPT4gdm9pZCB9O1xyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1ub2RlanMtbW9kdWxlcywgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWYgLS0gcGF0aCBpcyByZXF1aXJlZCBmb3IgcmVzb2x2aW5nIHBhdGhzIG9uIGRlc2t0b3BcclxuXHRcdGNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJykgYXMgeyByZXNvbHZlOiAoLi4uYXJnczogc3RyaW5nW10pID0+IHN0cmluZyB9O1xyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1ub2RlanMtbW9kdWxlcywgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWYgLS0gZnMgaXMgcmVxdWlyZWQgZm9yIHZlcmlmeWluZyBwYXRocyBvbiBkZXNrdG9wXHJcblx0XHRjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJykgYXMgeyBleGlzdHNTeW5jOiAocGF0aDogc3RyaW5nKSA9PiBib29sZWFuIH07XHJcblxyXG5cdFx0Ly8gR2V0IHRoZSBhY3R1YWwgdmF1bHQgcGF0aCBzdHJpbmcgZnJvbSB0aGUgYWRhcHRlclxyXG5cdFx0Y29uc3QgYWRhcHRlciA9IGFwcC52YXVsdC5hZGFwdGVyIGFzIHVua25vd24gYXMgeyBiYXNlUGF0aD86IHN0cmluZzsgcGF0aD86IHN0cmluZyB9O1xyXG5cdFx0Y29uc3QgdmF1bHRQYXRoID0gYWRhcHRlci5iYXNlUGF0aCB8fCBhZGFwdGVyLnBhdGg7XHJcblx0XHRjb25zdCB2YXVsdFBhdGhTdHJpbmcgPSB0eXBlb2YgdmF1bHRQYXRoID09PSAnc3RyaW5nJyA/IHZhdWx0UGF0aCA6IFN0cmluZyh2YXVsdFBhdGgpO1xyXG5cclxuXHRcdC8vIFJlc29sdmUgcHJvamVjdCByb290IHBhdGhcclxuXHRcdGxldCBwcm9qZWN0UGF0aDogc3RyaW5nO1xyXG5cdFx0aWYgKHNldHRpbmdzLnRlcm1pbmFsUHJvamVjdFJvb3RQYXRoICYmIHNldHRpbmdzLnRlcm1pbmFsUHJvamVjdFJvb3RQYXRoLnRyaW0oKSkge1xyXG5cdFx0XHQvLyBVc2UgY3VzdG9tIHBhdGggcmVsYXRpdmUgdG8gdmF1bHRcclxuXHRcdFx0cHJvamVjdFBhdGggPSBwYXRoLnJlc29sdmUodmF1bHRQYXRoU3RyaW5nLCBzZXR0aW5ncy50ZXJtaW5hbFByb2plY3RSb290UGF0aCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBEZWZhdWx0OiB2YXVsdCBmb2xkZXIgaXRzZWxmXHJcblx0XHRcdHByb2plY3RQYXRoID0gdmF1bHRQYXRoU3RyaW5nO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFZlcmlmeSB0aGUgcGF0aCBleGlzdHNcclxuXHRcdGlmICghZnMuZXhpc3RzU3luYyhwcm9qZWN0UGF0aCkpIHtcclxuXHRcdFx0bmV3IE5vdGljZShgUHJvamVjdCByb290IGRpcmVjdG9yeSBub3QgZm91bmQgYXQ6ICR7cHJvamVjdFBhdGh9YCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBHZXQgdGVybWluYWwgYXBwbGljYXRpb24gbmFtZSAodXNlIGNvbmZpZ3VyZWQgb3IgZGVmYXVsdClcclxuXHRcdGNvbnN0IGNvbmZpZ3VyZWRBcHAgPSBzYW5pdGl6ZVRlcm1pbmFsQXBwKHNldHRpbmdzLnRlcm1pbmFsQXBwbGljYXRpb25OYW1lIHx8IFwiXCIpO1xyXG5cdFx0Y29uc3QgdGVybWluYWxBcHAgPSBjb25maWd1cmVkQXBwIHx8IGdldERlZmF1bHRUZXJtaW5hbEFwcCgpO1xyXG5cclxuXHRcdC8vIFdhcm4gaWYgdGVybWluYWwgYXBwIG5hbWUgaXMgZW1wdHkgKGJ1dCBzdGlsbCB0cnkgdG8gdXNlIGRlZmF1bHRzKVxyXG5cdFx0aWYgKCFjb25maWd1cmVkQXBwICYmICF0ZXJtaW5hbEFwcCkge1xyXG5cdFx0XHRuZXcgTm90aWNlKFwiVGVybWluYWwgYXBwbGljYXRpb24gbmFtZSBpcyBlbXB0eS4gUGxlYXNlIGNvbmZpZ3VyZSBpdCBpbiBzZXR0aW5ncy5cIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYgLS0gcHJvY2VzcyBpcyBhIGdsb2JhbCBpbiB0aGUgRWxlY3Ryb24gcmVuZGVyZXIgcHJvY2Vzc1xyXG5cdFx0Y29uc3QgcGxhdGZvcm0gPSBwcm9jZXNzLnBsYXRmb3JtO1xyXG5cdFx0dGVybWluYWxMb2dnZXIubG9nKFwiT3BlbmluZyB0ZXJtaW5hbFwiLCB7IHBsYXRmb3JtLCB0ZXJtaW5hbEFwcCwgcHJvamVjdFBhdGggfSk7XHJcblxyXG5cdFx0aWYgKHBsYXRmb3JtID09PSAnd2luMzInKSB7XHJcblx0XHRcdC8vIFdpbmRvd3M6IFVzZSBzdGFydCBjb21tYW5kIHdpdGggY29uZmlndXJhYmxlIHRlcm1pbmFsXHJcblx0XHRcdGNvbnN0IGVzY2FwZWRQYXRoID0gcHJvamVjdFBhdGgucmVwbGFjZSgvXCIvZywgJ1wiJyk7XHJcblx0XHRcdGNvbnN0IGxvd2VyQXBwID0gdGVybWluYWxBcHAudG9Mb3dlckNhc2UoKTtcclxuXHJcblx0XHRcdGlmIChsb3dlckFwcCA9PT0gXCJ3dC5leGVcIiB8fCBsb3dlckFwcCA9PT0gXCJ3dFwiIHx8IGxvd2VyQXBwID09PSBcIndpbmRvd3MgdGVybWluYWxcIikge1xyXG5cdFx0XHRcdC8vIFdpbmRvd3MgVGVybWluYWxcclxuXHRcdFx0XHRleGVjKCd3aGVyZSB3dCcsIChlcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRpZiAoIWVycm9yKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGNvbW1hbmQgPSBgc3RhcnQgXCJcIiB3dC5leGUgLWQgXCIke2VzY2FwZWRQYXRofVwiYDtcclxuXHRcdFx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiV2luZG93cyBsYXVuY2ggKHd0KVwiLCB7IGNvbW1hbmQsIHByb2plY3RQYXRoIH0pO1xyXG5cdFx0XHRcdFx0XHRleGVjKGNvbW1hbmQsIChleGVjRXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChleGVjRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIldpbmRvd3MgVGVybWluYWwgZmFpbGVkLCBmYWxsaW5nIGJhY2sgdG8gY21kXCIsIHsgZXJyb3I6IGV4ZWNFcnJvci5tZXNzYWdlIH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gRmFsbGJhY2sgdG8gY21kXHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBmYWxsYmFja0NvbW1hbmQgPSBgc3RhcnQgXCJcIiBjbWQuZXhlIC9LIFwiY2QgL2QgXCIke2VzY2FwZWRQYXRofVwiXCJgO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZXhlYyhmYWxsYmFja0NvbW1hbmQsIChjbWRFcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChjbWRFcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7Y21kRXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBXaW5kb3dzIFRlcm1pbmFsIG5vdCBmb3VuZCwgZmFsbGJhY2sgdG8gY21kXHJcblx0XHRcdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIldpbmRvd3MgVGVybWluYWwgbm90IGZvdW5kLCB1c2luZyBjbWRcIiwge30pO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBmYWxsYmFja0NvbW1hbmQgPSBgc3RhcnQgXCJcIiBjbWQuZXhlIC9LIFwiY2QgL2QgXCIke2VzY2FwZWRQYXRofVwiXCJgO1xyXG5cdFx0XHRcdFx0XHRleGVjKGZhbGxiYWNrQ29tbWFuZCwgKGNtZEVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoY21kRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7Y21kRXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIGlmIChsb3dlckFwcCA9PT0gXCJwb3dlcnNoZWxsXCIgfHwgbG93ZXJBcHAgPT09IFwicG93ZXJzaGVsbC5leGVcIikge1xyXG5cdFx0XHRcdC8vIFBvd2VyU2hlbGxcclxuXHRcdFx0XHRjb25zdCBlc2NhcGVkUGF0aEZvclBTID0gcHJvamVjdFBhdGgucmVwbGFjZSgvJy9nLCBcIicnXCIpO1xyXG5cdFx0XHRcdGNvbnN0IGNvbW1hbmQgPSBgc3RhcnQgXCJcIiBwb3dlcnNoZWxsIC1Ob0V4aXQgLUNvbW1hbmQgXCJTZXQtTG9jYXRpb24gJyR7ZXNjYXBlZFBhdGhGb3JQU30nO1wiYDtcclxuXHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJXaW5kb3dzIGxhdW5jaCAocG93ZXJzaGVsbClcIiwgeyBjb21tYW5kLCBwcm9qZWN0UGF0aCB9KTtcclxuXHRcdFx0XHRleGVjKGNvbW1hbmQsIChlcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtlcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIGlmIChsb3dlckFwcCA9PT0gXCJjbWQuZXhlXCIgfHwgbG93ZXJBcHAgPT09IFwiY21kXCIpIHtcclxuXHRcdFx0XHQvLyBDb21tYW5kIFByb21wdFxyXG5cdFx0XHRcdGNvbnN0IGNvbW1hbmQgPSBgc3RhcnQgXCJcIiBjbWQuZXhlIC9LIFwiY2QgL2QgXCIke2VzY2FwZWRQYXRofVwiXCJgO1xyXG5cdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIldpbmRvd3MgbGF1bmNoIChjbWQpXCIsIHsgY29tbWFuZCwgcHJvamVjdFBhdGggfSk7XHJcblx0XHRcdFx0ZXhlYyhjb21tYW5kLCAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKGVycm9yKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7ZXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gR2VuZXJpYyB0ZXJtaW5hbCAtIHRyeSB0byBsYXVuY2ggaXQgZGlyZWN0bHlcclxuXHRcdFx0XHRjb25zdCBjb21tYW5kID0gYHN0YXJ0IFwiXCIgXCIke3Rlcm1pbmFsQXBwfVwiYDtcclxuXHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJXaW5kb3dzIGxhdW5jaCAoZ2VuZXJpYylcIiwgeyBjb21tYW5kLCB0ZXJtaW5hbEFwcCwgcHJvamVjdFBhdGggfSk7XHJcblx0XHRcdFx0ZXhlYyhjb21tYW5kLCAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKGVycm9yKSB7XHJcblx0XHRcdFx0XHRcdC8vIEZhbGxiYWNrIHRvIGNtZCBpZiBnZW5lcmljIGxhdW5jaCBmYWlsc1xyXG5cdFx0XHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJHZW5lcmljIHRlcm1pbmFsIGZhaWxlZCwgZmFsbGluZyBiYWNrIHRvIGNtZFwiLCB7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBmYWxsYmFja0NvbW1hbmQgPSBgc3RhcnQgXCJcIiBjbWQuZXhlIC9LIFwiY2QgL2QgXCIke2VzY2FwZWRQYXRofVwiXCJgO1xyXG5cdFx0XHRcdFx0XHRleGVjKGZhbGxiYWNrQ29tbWFuZCwgKGNtZEVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoY21kRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7Y21kRXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChwbGF0Zm9ybSA9PT0gJ2RhcndpbicpIHtcclxuXHRcdFx0Ly8gbWFjT1M6IFVzZSBvcGVuIC1hIChzaW1wbGVyIHRoYW4gb3Nhc2NyaXB0KVxyXG5cdFx0XHRjb25zdCBlc2NhcGVkQXBwID0gZXNjYXBlRG91YmxlUXVvdGVzKHRlcm1pbmFsQXBwKTtcclxuXHRcdFx0Y29uc3QgZXNjYXBlZFBhdGggPSBlc2NhcGVEb3VibGVRdW90ZXMocHJvamVjdFBhdGgpO1xyXG5cdFx0XHRjb25zdCBjb21tYW5kID0gYG9wZW4gLW5hIFwiJHtlc2NhcGVkQXBwfVwiIFwiJHtlc2NhcGVkUGF0aH1cImA7XHJcblx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIm1hY09TIGxhdW5jaFwiLCB7IGNvbW1hbmQsIHRlcm1pbmFsQXBwLCBwcm9qZWN0UGF0aCB9KTtcclxuXHRcdFx0ZXhlYyhjb21tYW5kLCAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdGlmIChlcnJvcikge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtlcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gTGludXg6IFRyeSBjb25maWd1cmFibGUgdGVybWluYWwgd2l0aCBmYWxsYmFjayBjaGFpblxyXG5cdFx0XHRjb25zdCB0ZXJtaW5hbHMgPSB0ZXJtaW5hbEFwcCA/IFt0ZXJtaW5hbEFwcF0gOiBbXCJnbm9tZS10ZXJtaW5hbFwiLCBcImtvbnNvbGVcIiwgXCJ4dGVybVwiXTtcclxuXHRcdFx0Y29uc3QgcHJvamVjdFBhdGhFc2NhcGVkID0gcHJvamVjdFBhdGgucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpO1xyXG5cclxuXHRcdFx0Ly8gVHJ5IGVhY2ggdGVybWluYWwgdW50aWwgb25lIHdvcmtzXHJcblx0XHRcdGNvbnN0IHRyeVRlcm1pbmFsID0gKGluZGV4OiBudW1iZXIpID0+IHtcclxuXHRcdFx0XHRpZiAoaW5kZXggPj0gdGVybWluYWxzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnTm8gc3VwcG9ydGVkIHRlcm1pbmFsIGZvdW5kLiBQbGVhc2UgaW5zdGFsbCBhIHRlcm1pbmFsIGFwcGxpY2F0aW9uIG9yIGNvbmZpZ3VyZSBvbmUgaW4gc2V0dGluZ3MuJyk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zdCBjdXJyZW50VGVybWluYWwgPSB0ZXJtaW5hbHNbaW5kZXhdO1xyXG5cdFx0XHRcdGNvbnN0IHRlcm1pbmFsTmFtZSA9IGN1cnJlbnRUZXJtaW5hbC5zcGxpdCgnICcpWzBdO1xyXG5cclxuXHRcdFx0XHQvLyBDaGVjayBpZiB0ZXJtaW5hbCBleGlzdHNcclxuXHRcdFx0XHRleGVjKGB3aGljaCAke3Rlcm1pbmFsTmFtZX1gLCAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKCFlcnJvcikge1xyXG5cdFx0XHRcdFx0XHQvLyBUZXJtaW5hbCBmb3VuZCwgdHJ5IHRvIGxhdW5jaCBpdFxyXG5cdFx0XHRcdFx0XHRsZXQgY29tbWFuZDogc3RyaW5nO1xyXG5cdFx0XHRcdFx0XHRpZiAoY3VycmVudFRlcm1pbmFsLmluY2x1ZGVzKFwiZ25vbWUtdGVybWluYWxcIikpIHtcclxuXHRcdFx0XHRcdFx0XHRjb21tYW5kID0gYGdub21lLXRlcm1pbmFsIC0td29ya2luZy1kaXJlY3Rvcnk9XCIke3Byb2plY3RQYXRoRXNjYXBlZH1cImA7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoY3VycmVudFRlcm1pbmFsLmluY2x1ZGVzKFwia29uc29sZVwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbW1hbmQgPSBga29uc29sZSAtLXdvcmtkaXIgXCIke3Byb2plY3RQYXRoRXNjYXBlZH1cImA7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gR2VuZXJpYyB0ZXJtaW5hbFxyXG5cdFx0XHRcdFx0XHRcdGNvbW1hbmQgPSBgJHtjdXJyZW50VGVybWluYWx9IC1lIFwiY2QgXFxcXFwiJHtwcm9qZWN0UGF0aEVzY2FwZWR9XFxcXFwiICYmIGJhc2hcImA7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiTGludXggbGF1bmNoXCIsIHsgY29tbWFuZCwgdGVybWluYWw6IGN1cnJlbnRUZXJtaW5hbCwgcHJvamVjdFBhdGggfSk7XHJcblx0XHRcdFx0XHRcdGV4ZWMoY29tbWFuZCwgKGV4ZWNFcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGV4ZWNFcnJvciAmJiBpbmRleCA8IHRlcm1pbmFscy5sZW5ndGggLSAxKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJUZXJtaW5hbCBsYXVuY2ggZmFpbGVkLCB0cnlpbmcgbmV4dFwiLCB7IHRlcm1pbmFsOiBjdXJyZW50VGVybWluYWwsIGVycm9yOiBleGVjRXJyb3IubWVzc2FnZSB9KTtcclxuXHRcdFx0XHRcdFx0XHRcdHRyeVRlcm1pbmFsKGluZGV4ICsgMSk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChleGVjRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7ZXhlY0Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBUZXJtaW5hbCBub3QgZm91bmQsIHRyeSBuZXh0XHJcblx0XHRcdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIlRlcm1pbmFsIG5vdCBmb3VuZCwgdHJ5aW5nIG5leHRcIiwgeyB0ZXJtaW5hbDogY3VycmVudFRlcm1pbmFsIH0pO1xyXG5cdFx0XHRcdFx0XHR0cnlUZXJtaW5hbChpbmRleCArIDEpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0dHJ5VGVybWluYWwoMCk7XHJcblx0XHR9XHJcblx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIlVuZXhwZWN0ZWQgZXJyb3JcIiwgeyBlcnJvciB9KTtcclxuXHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIE9wZW4gY29uZmlnIGZpbGUgaW4gZGVmYXVsdCBlZGl0b3JcclxuICogRXhwb3J0ZWQgZm9yIHVzZSBieSByaWJib24gaWNvbnNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuQ29uZmlnRmlsZShhcHA6IEFwcCwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IFByb21pc2U8dm9pZD4ge1xyXG5cdHRyeSB7XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZiAtLSBmcyBpcyByZXF1aXJlZCBmb3IgdmVyaWZ5aW5nIGNvbmZpZyBmaWxlIGV4aXN0cyBvbiBkZXNrdG9wXHJcblx0XHRjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJykgYXMgeyBleGlzdHNTeW5jOiAocGF0aDogc3RyaW5nKSA9PiBib29sZWFuIH07XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZiAtLSBwYXRoIGlzIHJlcXVpcmVkIGZvciByZXNvbHZpbmcgcGF0aHMgb24gZGVza3RvcFxyXG5cdFx0Y29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKSBhcyB7IHJlc29sdmU6ICguLi5hcmdzOiBzdHJpbmdbXSkgPT4gc3RyaW5nIH07XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWYgLS0gZWxlY3Ryb24gc2hlbGwgaXMgcmVxdWlyZWQgdG8gb3BlbiBmaWxlcyBpbiBkZWZhdWx0IGVkaXRvclxyXG5cdFx0Y29uc3QgeyBzaGVsbCB9ID0gcmVxdWlyZSgnZWxlY3Ryb24nKSBhcyB7IHNoZWxsOiB7IG9wZW5QYXRoOiAocGF0aDogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZz4gfSB9O1xyXG5cclxuXHRcdC8vIEdldCB0aGUgYWN0dWFsIHZhdWx0IHBhdGggc3RyaW5nIGZyb20gdGhlIGFkYXB0ZXJcclxuXHRcdGNvbnN0IGFkYXB0ZXIgPSBhcHAudmF1bHQuYWRhcHRlciBhcyB1bmtub3duIGFzIHsgYmFzZVBhdGg/OiBzdHJpbmc7IHBhdGg/OiBzdHJpbmcgfTtcclxuXHRcdGNvbnN0IHZhdWx0UGF0aCA9IGFkYXB0ZXIuYmFzZVBhdGggfHwgYWRhcHRlci5wYXRoO1xyXG5cdFx0Y29uc3QgdmF1bHRQYXRoU3RyaW5nID0gdHlwZW9mIHZhdWx0UGF0aCA9PT0gJ3N0cmluZycgPyB2YXVsdFBhdGggOiBTdHJpbmcodmF1bHRQYXRoKTtcclxuXHJcblx0XHQvLyBSZXNvbHZlIGNvbmZpZyBmaWxlIHBhdGhcclxuXHRcdGlmICghc2V0dGluZ3MuY29uZmlnRmlsZVBhdGggfHwgIXNldHRpbmdzLmNvbmZpZ0ZpbGVQYXRoLnRyaW0oKSkge1xyXG5cdFx0XHRuZXcgTm90aWNlKFwiUGxlYXNlIHNwZWNpZnkgYSBjb25maWcgZmlsZSBwYXRoIGluIHNldHRpbmdzLlwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFVzZSBjdXN0b20gcGF0aCByZWxhdGl2ZSB0byB2YXVsdFxyXG5cdFx0Y29uc3QgY29uZmlnUGF0aCA9IHBhdGgucmVzb2x2ZSh2YXVsdFBhdGhTdHJpbmcsIHNldHRpbmdzLmNvbmZpZ0ZpbGVQYXRoKTtcclxuXHJcblx0XHQvLyBDaGVjayBpZiBmaWxlIGV4aXN0c1xyXG5cdFx0aWYgKCFmcy5leGlzdHNTeW5jKGNvbmZpZ1BhdGgpKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoYENvbmZpZyBmaWxlIG5vdCBmb3VuZCBhdDogJHtjb25maWdQYXRofWApO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVXNlIEVsZWN0cm9uJ3Mgc2hlbGwgdG8gb3BlbiB0aGUgZmlsZSB3aXRoIHRoZSBkZWZhdWx0IGVkaXRvclxyXG5cdFx0YXdhaXQgc2hlbGwub3BlblBhdGgoY29uZmlnUGF0aCk7XHJcblx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgY29uZmlnIGZpbGU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xyXG5cdH1cclxufSIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBURm9sZGVyLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgRmlsZUNyZWF0aW9uT3B0aW9ucywgUmVuYW1lT3B0aW9ucywgQ29udGVudFR5cGUsIENvbnRlbnRUeXBlSWQsIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgfSBmcm9tIFwiLi4vdHlwZXNcIjtcbmltcG9ydCB7IG1hdGNoZXNGb2xkZXJQYXR0ZXJuLCBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkgfSBmcm9tIFwiLi9wYXRoLW1hdGNoaW5nXCI7XG5pbXBvcnQgeyB0b0tlYmFiQ2FzZSB9IGZyb20gXCIuL3N0cmluZy11dGlsc1wiO1xuXG5leHBvcnQgY2xhc3MgRmlsZU9wZXJhdGlvbnMge1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBwcml2YXRlIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIHByaXZhdGUgcGx1Z2luPzogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSkgeyB9XG5cblx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBzdG9yZWQgc2V0dGluZ3Ncblx0cHJpdmF0ZSBnZXRTZXR0aW5ncygpOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3Mge1xuXHRcdC8vIEFsd2F5cyBwcmVmZXIgcGx1Z2luIHNldHRpbmdzICh0aGV5J3JlIGtlcHQgdXAgdG8gZGF0ZSlcblx0XHRpZiAodGhpcy5wbHVnaW4/LnNldHRpbmdzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnNldHRpbmdzO1xuXHR9XG5cblx0Z2VuZXJhdGVGaWxlbmFtZSh0aXRsZTogc3RyaW5nLCBlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBib29sZWFuID0gZmFsc2UpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGtlYmFiVGl0bGUgPSB0b0tlYmFiQ2FzZSh0aXRsZSk7XG5cdFx0Ly8gSWYga2ViYWIgY2FzZSByZXN1bHRzIGluIGVtcHR5IHN0cmluZywgdXNlIGEgZmFsbGJhY2tcblx0XHRjb25zdCBzYWZlS2ViYWJUaXRsZSA9IGtlYmFiVGl0bGUgfHwgXCJ1bnRpdGxlZFwiO1xuXHRcdGNvbnN0IHByZWZpeCA9IGVuYWJsZVVuZGVyc2NvcmVQcmVmaXggPyBcIl9cIiA6IFwiXCI7XG5cdFx0cmV0dXJuIGAke3ByZWZpeH0ke3NhZmVLZWJhYlRpdGxlfWA7XG5cdH1cblxuXHRkZXRlcm1pbmVUeXBlKGZpbGU6IFRGaWxlKTogQ29udGVudFR5cGVJZCB7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cblx0XHQvLyBDaGVjayBhbGwgY29udGVudCB0eXBlcywgc29ydGVkIGJ5IHBhdHRlcm4gc3BlY2lmaWNpdHkgKG1vcmUgc3BlY2lmaWMgZmlyc3QpXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IHNvcnRlZFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XG5cblx0XHRmb3IgKGNvbnN0IGNvbnRlbnRUeXBlIG9mIHNvcnRlZFR5cGVzKSB7XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmVuYWJsZWQpIGNvbnRpbnVlO1xuXG5cdFx0XHQvLyBIYW5kbGUgYmxhbmsgZm9sZGVyIChyb290KSAtIG1hdGNoZXMgZmlsZXMgaW4gdmF1bHQgcm9vdCBvbmx5XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmZvbGRlciB8fCBjb250ZW50VHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKSB7XG5cdFx0XHRcdGlmICghZmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IGZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRyZXR1cm4gY29udGVudFR5cGUuaWQ7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGgsIGNvbnRlbnRUeXBlLmZvbGRlcikpIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWdub3JlU3ViZm9sZGVycyBpZiBmb2xkZXIgaXMgc3BlY2lmaWVkXG5cdFx0XHRcdGlmIChjb250ZW50VHlwZS5pZ25vcmVTdWJmb2xkZXJzKSB7XG5cdFx0XHRcdFx0Y29uc3QgcGF0aFNlZ21lbnRzID0gZmlsZVBhdGguc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhEZXB0aCA9IHBhdGhTZWdtZW50cy5sZW5ndGg7XG5cdFx0XHRcdFx0Y29uc3QgcGF0dGVyblNlZ21lbnRzID0gY29udGVudFR5cGUuZm9sZGVyLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBleHBlY3RlZERlcHRoID0gcGF0dGVyblNlZ21lbnRzLmxlbmd0aDtcblxuXHRcdFx0XHRcdGlmIChjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmb2xkZXItYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBvbmUgbGV2ZWwgZGVlcGVyIChlLmcuLCB0ZXN0L215LWZpbGUvaW5kZXgubWQpXG5cdFx0XHRcdFx0XHQvLyBTbyB3ZSBuZWVkIHRvIGFsbG93IG9uZSBleHRyYSBsZXZlbCBiZXlvbmQgdGhlIHBhdHRlcm4gZGVwdGhcblx0XHRcdFx0XHRcdGNvbnN0IGZvbGRlckRlcHRoID0gcGF0aERlcHRoIC0gMTsgLy8gU3VidHJhY3QgMSBmb3IgdGhlIGluZGV4Lm1kIGZpbGVcblx0XHRcdFx0XHRcdGlmIChmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCB8fCBmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCArIDEpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbnRlbnRUeXBlLmlkO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBGb3IgZmlsZS1iYXNlZCBjcmVhdGlvbiwgZmlsZXMgYXJlIGF0IHRoZSBzYW1lIGRlcHRoIGFzIHRoZSBwYXR0ZXJuXG5cdFx0XHRcdFx0XHRpZiAocGF0aERlcHRoID09PSBleHBlY3RlZERlcHRoKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBjb250ZW50VHlwZS5pZDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNvbnRlbnRUeXBlLmlkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gSWYgbm8gY29udGVudCB0eXBlIG1hdGNoZXMsIHJldHVybiBcIm5vdGVcIiBhcyBmYWxsYmFja1xuXHRcdHJldHVybiBcIm5vdGVcIjtcblx0fVxuXG5cdGdldENvbnRlbnRUeXBlKHR5cGVJZDogQ29udGVudFR5cGVJZCk6IENvbnRlbnRUeXBlIHwgbnVsbCB7XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdHJldHVybiBjb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gdHlwZUlkKSB8fCBudWxsO1xuXHR9XG5cblx0Z2V0VGl0bGVLZXkodHlwZTogQ29udGVudFR5cGVJZCk6IHN0cmluZyB7XG5cdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIGFsd2F5cyB1c2UgXCJ0aXRsZVwiXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gXCJ0aXRsZVwiO1xuXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xuXHRcdGlmICghY29udGVudFR5cGUpIHJldHVybiBcInRpdGxlXCI7XG5cblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xuXHRcdGNvbnN0IGxpbmVzID0gdGVtcGxhdGUuc3BsaXQoXCJcXG5cIik7XG5cdFx0bGV0IGluUHJvcGVydGllcyA9IGZhbHNlO1xuXHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0Y29uc3QgdHJpbW1lZCA9IGxpbmUudHJpbSgpO1xuXHRcdFx0aWYgKHRyaW1tZWQgPT09IFwiLS0tXCIpIHtcblx0XHRcdFx0aW5Qcm9wZXJ0aWVzID0gIWluUHJvcGVydGllcztcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAoaW5Qcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZC5tYXRjaCgvXihcXHcrKTpcXHMqKC4rKSQvKTtcblx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRcdFx0Y29uc3Qga2V5ID0gbWF0Y2hbMV07XG5cdFx0XHRcdFx0Y29uc3QgdmFsdWUgPSBtYXRjaFsyXTtcblx0XHRcdFx0XHRpZiAodmFsdWUuaW5jbHVkZXMoXCJ7e3RpdGxlfX1cIikpIHtcblx0XHRcdFx0XHRcdHJldHVybiBrZXk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBcInRpdGxlXCI7XG5cdH1cblxuXHRhc3luYyBjcmVhdGVGaWxlKG9wdGlvbnM6IEZpbGVDcmVhdGlvbk9wdGlvbnMpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IHsgZmlsZSwgdGl0bGUsIHR5cGUgfSA9IG9wdGlvbnM7XG5cblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBUaXRsZSBpcyByZXF1aXJlZCB0byBjcmVhdGUgYSAke3R5cGV9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gR2V0IGNvbnRlbnQgdHlwZSBzZXR0aW5nc1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRpZiAoIWNvbnRlbnRUeXBlICYmIHR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb250ZW50IHR5cGUgJHt0eXBlfSBub3QgZm91bmQuYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBrZWJhYlRpdGxlID0gdG9LZWJhYkNhc2UodGl0bGUpO1xuXHRcdGNvbnN0IGVuYWJsZVVuZGVyc2NvcmVQcmVmaXggPSBjb250ZW50VHlwZT8uZW5hYmxlVW5kZXJzY29yZVByZWZpeCB8fCBmYWxzZTtcblx0XHRjb25zdCBwcmVmaXggPSBlbmFibGVVbmRlcnNjb3JlUHJlZml4ID8gXCJfXCIgOiBcIlwiO1xuXG5cdFx0bGV0IHRhcmdldEZvbGRlciA9IFwiXCI7XG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3Rlcywga2VlcCB0aGVtIGluIHRoZWlyIGN1cnJlbnQgbG9jYXRpb25cblx0XHRcdHRhcmdldEZvbGRlciA9IFwiXCI7XG5cdFx0fSBlbHNlIGlmIChjb250ZW50VHlwZSkge1xuXHRcdFx0Ly8gR2V0IHRoZSBkaXJlY3Rvcnkgd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxuXHRcdFx0Y29uc3Qgb3JpZ2luYWxEaXIgPSBmaWxlLnBhcmVudD8ucGF0aCB8fCBcIlwiO1xuXG5cdFx0XHQvLyBSZXNwZWN0IHRoZSB1c2VyJ3MgY2hvc2VuIGxvY2F0aW9uIChzdWJmb2xkZXIpXG5cdFx0XHQvLyBPbmx5IHVzZSB0aGUgY29uZmlndXJlZCBmb2xkZXIgaWYgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZSBpbiB0aGUgdmF1bHQgcm9vdFxuXHRcdFx0aWYgKG9yaWdpbmFsRGlyID09PSBcIlwiIHx8IG9yaWdpbmFsRGlyID09PSBcIi9cIikge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBjb250ZW50VHlwZS5mb2xkZXIgfHwgXCJcIjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRhcmdldEZvbGRlciA9IG9yaWdpbmFsRGlyO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICh0YXJnZXRGb2xkZXIpIHtcblx0XHRcdGNvbnN0IGZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0YXJnZXRGb2xkZXIpO1xuXHRcdFx0aWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKHRhcmdldEZvbGRlcik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y29uc3QgY3JlYXRpb25Nb2RlID0gY29udGVudFR5cGU/LmNyZWF0aW9uTW9kZSB8fCBcImZpbGVcIjtcblx0XHRpZiAoY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVGb2xkZXJTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCB0YXJnZXRGb2xkZXIsIHR5cGUsIGNvbnRlbnRUeXBlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRmlsZVN0cnVjdHVyZShmaWxlLCBrZWJhYlRpdGxlLCBwcmVmaXgsIHRhcmdldEZvbGRlciwgY29udGVudFR5cGUpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRm9sZGVyU3RydWN0dXJlKGZpbGU6IFRGaWxlLCBrZWJhYlRpdGxlOiBzdHJpbmcsIHByZWZpeDogc3RyaW5nLCB0YXJnZXRGb2xkZXI6IHN0cmluZywgdHlwZTogQ29udGVudFR5cGVJZCwgY29udGVudFR5cGU6IENvbnRlbnRUeXBlIHwgbnVsbCk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0Y29uc3QgZm9sZGVyTmFtZSA9IGAke3ByZWZpeH0ke2tlYmFiVGl0bGV9YDtcblx0XHRsZXQgZm9sZGVyUGF0aDogc3RyaW5nO1xuXG5cdFx0aWYgKHRhcmdldEZvbGRlcikge1xuXHRcdFx0Ly8gTW92ZSB0byB0YXJnZXQgZm9sZGVyXG5cdFx0XHRmb2xkZXJQYXRoID0gYCR7dGFyZ2V0Rm9sZGVyfS8ke2ZvbGRlck5hbWV9YDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gS2VlcCBpbiBjdXJyZW50IGxvY2F0aW9uXG5cdFx0XHRjb25zdCBjdXJyZW50RGlyID0gZmlsZS5wYXJlbnQgPyBmaWxlLnBhcmVudC5wYXRoIDogXCJcIjtcblx0XHRcdGlmIChjdXJyZW50RGlyICYmIGN1cnJlbnREaXIgIT09IFwiL1wiKSB7XG5cdFx0XHRcdGZvbGRlclBhdGggPSBgJHtjdXJyZW50RGlyfS8ke2ZvbGRlck5hbWV9YDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbGUgaXMgaW4gdmF1bHQgcm9vdCwganVzdCB1c2UgZm9sZGVyIG5hbWVcblx0XHRcdFx0Zm9sZGVyUGF0aCA9IGZvbGRlck5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKTtcblx0XHRcdGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIHtcblx0XHRcdC8vIEZvbGRlciBtaWdodCBhbHJlYWR5IGV4aXN0LCBwcm9jZWVkXG5cdFx0fVxuXG5cdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIjtcblx0XHRjb25zdCBleHRlbnNpb24gPSBjb250ZW50VHlwZT8udXNlTWR4RXh0ZW5zaW9uID8gXCIubWR4XCIgOiBcIi5tZFwiO1xuXHRcdGNvbnN0IGZpbGVOYW1lID0gYCR7aW5kZXhGaWxlTmFtZX0ke2V4dGVuc2lvbn1gO1xuXHRcdGNvbnN0IG5ld1BhdGggPSBgJHtmb2xkZXJQYXRofS8ke2ZpbGVOYW1lfWA7XG5cblx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0aWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3UGF0aH0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBCRUZPUkUgcmVuYW1pbmdcblx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRpZiAodGhpcy5wbHVnaW4pIHtcblx0XHRcdHRoaXMucGx1Z2luLnBsdWdpbkNyZWF0ZWRGaWxlcy5zZXQobmV3UGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbGVFeHBsb3JlciA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJmaWxlLWV4cGxvcmVyXCIpWzBdO1xuXHRcdFx0XHRpZiAoZmlsZUV4cGxvcmVyICYmIGZpbGVFeHBsb3Jlci52aWV3KSB7XG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGZpbGVFeHBsb3Jlci52aWV3O1xuXHRcdFx0XHRcdGlmICh2aWV3ICYmIHR5cGVvZiB2aWV3ID09PSAnb2JqZWN0JyAmJiAndHJlZScgaW4gdmlldykge1xuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZVRyZWUgPSAodmlldyBhcyB7IHRyZWU/OiB7IHJldmVhbEZpbGU/OiAoZmlsZTogVEZpbGUpID0+IHZvaWQgfSB9KS50cmVlO1xuXHRcdFx0XHRcdFx0aWYgKGZpbGVUcmVlICYmIG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB0eXBlb2YgZmlsZVRyZWUucmV2ZWFsRmlsZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0XHRmaWxlVHJlZS5yZXZlYWxGaWxlKG5ld0ZpbGUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSwgMjAwKTtcblxuXHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUobmV3RmlsZSk7XG5cblx0XHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCB0aGUgZW5kIG9mIGNvbnRlbnQgYWZ0ZXIgZWRpdG9yIGlzIHJlYWR5XG5cdFx0XHRjb25zdCBwb3NpdGlvbkN1cnNvciA9ICgpID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldztcblx0XHRcdFx0aWYgKHZpZXcgJiYgJ2VkaXRvcicgaW4gdmlldykge1xuXHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9ICh2aWV3IGFzIHsgZWRpdG9yPzogeyBzZXRDdXJzb3I6IChwb3M6IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0pID0+IHZvaWQ7IGdldFZhbHVlOiAoKSA9PiBzdHJpbmc7IGZvY3VzOiAoKSA9PiB2b2lkIH0gfSkuZWRpdG9yO1xuXHRcdFx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRcdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGFzdExpbmVMZW5ndGggPSBsaW5lc1tsYXN0TGluZV0/Lmxlbmd0aCB8fCAwO1xuXHRcdFx0XHRcdFx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9KTtcblx0XHRcdFx0XHRcdFx0ZWRpdG9yLmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9O1xuXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKCFwb3NpdGlvbkN1cnNvcigpKSB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbkN1cnNvcigpO1xuXHRcdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIDEwMCk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gY3JlYXRlIGZvbGRlciBzdHJ1Y3R1cmU6ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRmlsZVN0cnVjdHVyZShmaWxlOiBURmlsZSwga2ViYWJUaXRsZTogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgdGFyZ2V0Rm9sZGVyOiBzdHJpbmcsIGNvbnRlbnRUeXBlOiBDb250ZW50VHlwZSB8IG51bGwpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IGV4dGVuc2lvbiA9IGNvbnRlbnRUeXBlPy51c2VNZHhFeHRlbnNpb24gPyBcIi5tZHhcIiA6IFwiLm1kXCI7XG5cdFx0Y29uc3QgbmV3TmFtZSA9IGAke3ByZWZpeH0ke2tlYmFiVGl0bGV9JHtleHRlbnNpb259YDtcblx0XHRsZXQgbmV3UGF0aDogc3RyaW5nO1xuXG5cdFx0aWYgKHRhcmdldEZvbGRlcikge1xuXHRcdFx0Ly8gTW92ZSB0byB0YXJnZXQgZm9sZGVyXG5cdFx0XHRuZXdQYXRoID0gYCR7dGFyZ2V0Rm9sZGVyfS8ke25ld05hbWV9YDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gS2VlcCBpbiBjdXJyZW50IGxvY2F0aW9uLCBqdXN0IHJlbmFtZSB0aGUgZmlsZVxuXHRcdFx0Y29uc3QgY3VycmVudERpciA9IGZpbGUucGFyZW50ID8gZmlsZS5wYXJlbnQucGF0aCA6IFwiXCI7XG5cdFx0XHRpZiAoY3VycmVudERpciAmJiBjdXJyZW50RGlyICE9PSBcIi9cIikge1xuXHRcdFx0XHRuZXdQYXRoID0gYCR7Y3VycmVudERpcn0vJHtuZXdOYW1lfWA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGaWxlIGlzIGluIHZhdWx0IHJvb3QsIGp1c3QgdXNlIG5ldyBuYW1lXG5cdFx0XHRcdG5ld1BhdGggPSBuZXdOYW1lO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZXhpc3RpbmdGaWxlICE9PSBmaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIHdpdGggbmFtZSBcIiR7bmV3TmFtZX1cIiBhbHJlYWR5IGV4aXN0cy5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdC8vIFRyYWNrIHRoYXQgdGhpcyBmaWxlIHdpbGwgYmUgY3JlYXRlZCBieSB0aGUgcGx1Z2luIEJFRk9SRSByZW5hbWluZ1xuXHRcdC8vIFRoaXMgcHJldmVudHMgdGhlIGNyZWF0ZSBldmVudCBmcm9tIHRyaWdnZXJpbmcgYW5vdGhlciBtb2RhbFxuXHRcdGlmICh0aGlzLnBsdWdpbikge1xuXHRcdFx0dGhpcy5wbHVnaW4ucGx1Z2luQ3JlYXRlZEZpbGVzLnNldChuZXdQYXRoLCBEYXRlLm5vdygpKTtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Ly8gVXNlIGZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoKSB3aGljaCByZXNwZWN0cyB1c2VyIHNldHRpbmdzIGFuZCBoYW5kbGVzIGFsbCBsaW5rIGZvcm1hdHNcblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuXHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZShuZXdGaWxlKTtcblxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IHRoZSBlbmQgb2YgY29udGVudCBhZnRlciBlZGl0b3IgaXMgcmVhZHlcblx0XHRcdGNvbnN0IHBvc2l0aW9uQ3Vyc29yID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuXHRcdFx0XHRpZiAodmlldyAmJiAnZWRpdG9yJyBpbiB2aWV3KSB7XG5cdFx0XHRcdFx0Y29uc3QgZWRpdG9yID0gKHZpZXcgYXMgeyBlZGl0b3I/OiB7IHNldEN1cnNvcjogKHBvczogeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfSkgPT4gdm9pZDsgZ2V0VmFsdWU6ICgpID0+IHN0cmluZzsgZm9jdXM6ICgpID0+IHZvaWQgfSB9KS5lZGl0b3I7XG5cdFx0XHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRcdFx0Y29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuXHRcdFx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGFzdExpbmUgPSBsaW5lcy5sZW5ndGggLSAxO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBsYXN0TGluZUxlbmd0aCA9IGxpbmVzW2xhc3RMaW5lXT8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdFx0XHRcdGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBsYXN0TGluZSwgY2g6IGxhc3RMaW5lTGVuZ3RoIH0pO1xuXHRcdFx0XHRcdFx0XHRlZGl0b3IuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH07XG5cblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRpZiAoIXBvc2l0aW9uQ3Vyc29yKCkpIHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdHBvc2l0aW9uQ3Vyc29yKCk7XG5cdFx0XHRcdFx0fSwgMjAwKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgMTAwKTtcblxuXHRcdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcblx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZW5hbWUgZmlsZTogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblxuXHRhc3luYyByZW5hbWVGaWxlKG9wdGlvbnM6IFJlbmFtZU9wdGlvbnMpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IHsgZmlsZSwgdGl0bGUsIHR5cGUgfSA9IG9wdGlvbnM7XG5cblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBUaXRsZSBpcyByZXF1aXJlZCB0byByZW5hbWUgdGhlIGNvbnRlbnQuYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZ2V0Q29udGVudFR5cGUodHlwZSk7XG5cdFx0aWYgKCFjb250ZW50VHlwZSAmJiB0eXBlICE9PSBcIm5vdGVcIikge1xuXHRcdFx0bmV3IE5vdGljZShgQ29udGVudCB0eXBlICR7dHlwZX0gbm90IGZvdW5kLmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Y29uc3Qga2ViYWJUaXRsZSA9IHRvS2ViYWJDYXNlKHRpdGxlKTtcblx0XHRjb25zdCBwcmVmaXggPSBcIlwiO1xuXG5cdFx0Y29uc3QgY3JlYXRpb25Nb2RlID0gY29udGVudFR5cGU/LmNyZWF0aW9uTW9kZSB8fCBcImZpbGVcIjtcblx0XHRpZiAoY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yZW5hbWVGb2xkZXJTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCB0eXBlLCBjb250ZW50VHlwZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLnJlbmFtZUZpbGVTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCBjb250ZW50VHlwZSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZW5hbWVGb2xkZXJTdHJ1Y3R1cmUoZmlsZTogVEZpbGUsIGtlYmFiVGl0bGU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQsIGNvbnRlbnRUeXBlOiBDb250ZW50VHlwZSB8IG51bGwpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogdHJlYXQgYXMgaW5kZXggaWYgZmlsZW5hbWUgbWF0Y2hlcyB0aGUgaW5kZXggZmlsZSBuYW1lXG5cdFx0Ly8gRGVmYXVsdCB0byBcImluZGV4XCIgd2hlbiBpbmRleEZpbGVOYW1lIGlzIGJsYW5rXG5cdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIjtcblx0XHRjb25zdCBpc0luZGV4ID0gZmlsZS5iYXNlbmFtZSA9PT0gaW5kZXhGaWxlTmFtZTtcblx0XHRpZiAoaXNJbmRleCkge1xuXHRcdFx0aWYgKCFmaWxlLnBhcmVudCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogZmlsZSBoYXMgbm8gcGFyZW50IGZvbGRlci5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0cHJlZml4ID0gZmlsZS5wYXJlbnQubmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld0ZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0XHRjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudC5wYXJlbnQ7XG5cdFx0XHRpZiAoIXBhcmVudEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogcGFyZW50IGZvbGRlciBoYXMgbm8gcGFyZW50LlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHQvLyBGaXggcGF0aCBjb25zdHJ1Y3Rpb24gdG8gYXZvaWQgZG91YmxlIHNsYXNoZXNcblx0XHRcdGxldCBuZXdGb2xkZXJQYXRoOiBzdHJpbmc7XG5cdFx0XHRpZiAocGFyZW50Rm9sZGVyLnBhdGggPT09IFwiXCIgfHwgcGFyZW50Rm9sZGVyLnBhdGggPT09IFwiL1wiKSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyB2YXVsdCByb290XG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBuZXdGb2xkZXJOYW1lO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gUGFyZW50IGlzIGluIGEgc3ViZm9sZGVyXG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBgJHtwYXJlbnRGb2xkZXIucGF0aH0vJHtuZXdGb2xkZXJOYW1lfWA7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0aWYgKGV4aXN0aW5nRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGb2xkZXIgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdGb2xkZXJQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZS5wYXJlbnQsIG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmVuYW1lIGZvbGRlcjogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgbmV3RmlsZVBhdGggPSBgJHtuZXdGb2xkZXJQYXRofS8ke2ZpbGUubmFtZX1gO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGaWxlUGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIWZpbGUucGFyZW50KSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiBmaWxlIGhhcyBubyBwYXJlbnQgZm9sZGVyLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRwcmVmaXggPSBmaWxlLmJhc2VuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpID8gXCJfXCIgOiBcIlwiO1xuXHRcdFx0Ly8gUHJlc2VydmUgdGhlIG9yaWdpbmFsIGZpbGUgZXh0ZW5zaW9uXG5cdFx0XHRjb25zdCBleHRlbnNpb24gPSBmaWxlLmV4dGVuc2lvbjtcblx0XHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS4ke2V4dGVuc2lvbn1gO1xuXHRcdFx0Y29uc3QgbmV3UGF0aCA9IGAke2ZpbGUucGFyZW50LnBhdGh9LyR7bmV3TmFtZX1gO1xuXG5cdFx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0XHRpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZXhpc3RpbmdGaWxlICE9PSBmaWxlKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZpbGUgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFVzZSBmaWxlTWFuYWdlci5yZW5hbWVGaWxlKCkgd2hpY2ggYXV0b21hdGljYWxseSB1cGRhdGVzIGxpbmtzXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2NhdGUgcmVuYW1lZCBmaWxlLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblxuXHRcdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZW5hbWVGaWxlU3RydWN0dXJlKGZpbGU6IFRGaWxlLCBrZWJhYlRpdGxlOiBzdHJpbmcsIHByZWZpeDogc3RyaW5nLCBjb250ZW50VHlwZTogQ29udGVudFR5cGUgfCBudWxsKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHRpZiAoIWZpbGUucGFyZW50KSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogZmlsZSBoYXMgbm8gcGFyZW50IGZvbGRlci5cIik7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGFuIGluZGV4IGZpbGUgLSBpZiBzbywgcmVuYW1lIHRoZSBwYXJlbnQgZm9sZGVyIGluc3RlYWRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IG9ubHkgdHJlYXQgYXMgaW5kZXggaWYgaW5kZXhGaWxlTmFtZSBpcyBzcGVjaWZpZWQgYW5kIG1hdGNoZXNcblx0XHRjb25zdCBpbmRleEZpbGVOYW1lID0gY29udGVudFR5cGU/LmluZGV4RmlsZU5hbWUgfHwgXCJcIjtcblx0XHRjb25zdCBpc0luZGV4ID0gaW5kZXhGaWxlTmFtZSAmJlxuXHRcdFx0aW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiZcblx0XHRcdGZpbGUuYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWU7XG5cblx0XHRpZiAoaXNJbmRleCkge1xuXHRcdFx0cHJlZml4ID0gZmlsZS5wYXJlbnQubmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld0ZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0XHRjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudC5wYXJlbnQ7XG5cdFx0XHRpZiAoIXBhcmVudEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogcGFyZW50IGZvbGRlciBoYXMgbm8gcGFyZW50LlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHQvLyBGaXggcGF0aCBjb25zdHJ1Y3Rpb24gdG8gYXZvaWQgZG91YmxlIHNsYXNoZXNcblx0XHRcdGxldCBuZXdGb2xkZXJQYXRoOiBzdHJpbmc7XG5cdFx0XHRpZiAocGFyZW50Rm9sZGVyLnBhdGggPT09IFwiXCIgfHwgcGFyZW50Rm9sZGVyLnBhdGggPT09IFwiL1wiKSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyB2YXVsdCByb290XG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBuZXdGb2xkZXJOYW1lO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gUGFyZW50IGlzIGluIGEgc3ViZm9sZGVyXG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBgJHtwYXJlbnRGb2xkZXIucGF0aH0vJHtuZXdGb2xkZXJOYW1lfWA7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0aWYgKGV4aXN0aW5nRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGb2xkZXIgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdGb2xkZXJQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENhbGN1bGF0ZSB0aGUgbmV3IGZpbGUgcGF0aCBiZWZvcmUgcmVuYW1pbmdcblx0XHRcdGNvbnN0IG5ld0ZpbGVQYXRoID0gYCR7bmV3Rm9sZGVyUGF0aH0vJHtmaWxlLm5hbWV9YDtcblxuXHRcdFx0Ly8gVHJhY2sgdGhhdCB0aGlzIGZpbGUgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBwbHVnaW4gQkVGT1JFIHJlbmFtaW5nXG5cdFx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRcdGlmICh0aGlzLnBsdWdpbikge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5wbHVnaW5DcmVhdGVkRmlsZXMuc2V0KG5ld0ZpbGVQYXRoLCBEYXRlLm5vdygpKTtcblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZShmaWxlLnBhcmVudCwgbmV3Rm9sZGVyUGF0aCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdGaWxlT3BlcmF0aW9uczogRm9sZGVyIHJlbmFtZSBmYWlsZWQ6JywgZXJyb3IpO1xuXHRcdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZW5hbWUgZm9sZGVyOiAke2Vycm9yTWVzc2FnZX0uYCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZpbGVQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2NhdGUgcmVuYW1lZCBmaWxlLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH1cblxuXHRcdC8vIEZvciBub24taW5kZXggZmlsZXMsIHJlbmFtZSB0aGUgZmlsZSBpdHNlbGZcblx0XHRwcmVmaXggPSBmaWxlLmJhc2VuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpID8gXCJfXCIgOiBcIlwiO1xuXHRcdC8vIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBmaWxlIGV4dGVuc2lvblxuXHRcdGNvbnN0IGV4dGVuc2lvbiA9IGZpbGUuZXh0ZW5zaW9uO1xuXHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS4ke2V4dGVuc2lvbn1gO1xuXG5cdFx0Ly8gRml4IHBhdGggY29uc3RydWN0aW9uIHRvIGF2b2lkIGRvdWJsZSBzbGFzaGVzXG5cdFx0bGV0IG5ld1BhdGg6IHN0cmluZztcblx0XHRpZiAoZmlsZS5wYXJlbnQucGF0aCA9PT0gXCJcIiB8fCBmaWxlLnBhcmVudC5wYXRoID09PSBcIi9cIikge1xuXHRcdFx0Ly8gRmlsZSBpcyBpbiB2YXVsdCByb290XG5cdFx0XHRuZXdQYXRoID0gbmV3TmFtZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRmlsZSBpcyBpbiBhIHN1YmZvbGRlclxuXHRcdFx0bmV3UGF0aCA9IGAke2ZpbGUucGFyZW50LnBhdGh9LyR7bmV3TmFtZX1gO1xuXHRcdH1cblxuXHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZXhpc3RpbmdGaWxlICE9PSBmaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3UGF0aH0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBCRUZPUkUgcmVuYW1pbmdcblx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRpZiAodGhpcy5wbHVnaW4pIHtcblx0XHRcdHRoaXMucGx1Z2luLnBsdWdpbkNyZWF0ZWRGaWxlcy5zZXQobmV3UGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0ZpbGVPcGVyYXRpb25zOiBGaWxlIHJlbmFtZSBmYWlsZWQ6JywgZXJyb3IpO1xuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIHJlbmFtZSBmaWxlOiAke2Vycm9yTWVzc2FnZX0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3RmlsZTtcblx0fVxufVxuIiwgIi8qKlxyXG4gKiBVdGlsaXR5IGZ1bmN0aW9ucyBmb3IgbWF0Y2hpbmcgZmlsZSBwYXRocyBhZ2FpbnN0IGZvbGRlciBwYXR0ZXJucyB3aXRoIHdpbGRjYXJkIHN1cHBvcnQuXHJcbiAqIFxyXG4gKiBXaWxkY2FyZCBwYXR0ZXJuczpcclxuICogLSBgZG9jc2AgbWF0Y2hlcyBgZG9jcy9gIGFuZCBhbnl0aGluZyB1bmRlciBpdFxyXG4gKiAtIGBkb2NzL3thc3Rlcmlza31gIG1hdGNoZXMgYGRvY3MvYW55dGhpbmcvYCBhbmQgYW55dGhpbmcgdW5kZXIgaXQgKG9uZSBsZXZlbCBkZWVwKVxyXG4gKiAtIGBkb2NzL3thc3Rlcmlza30ve2FzdGVyaXNrfWAgbWF0Y2hlcyBgZG9jcy9hbnl0aGluZy9hbnl0aGluZy9gIGFuZCBhbnl0aGluZyB1bmRlciBpdCAodHdvIGxldmVscyBkZWVwKVxyXG4gKiAtIGV0Yy5cclxuICogXHJcbiAqIE5vdGU6IHthc3Rlcmlza30gcmVwcmVzZW50cyB0aGUgd2lsZGNhcmQgY2hhcmFjdGVyICpcclxuICovXHJcblxyXG4vKipcclxuICogQ2hlY2tzIGlmIGEgZmlsZSBwYXRoIG1hdGNoZXMgYSBmb2xkZXIgcGF0dGVybiAoc3VwcG9ydHMgd2lsZGNhcmRzKVxyXG4gKiBAcGFyYW0gZmlsZVBhdGggVGhlIGZpbGUgcGF0aCB0byBjaGVjayAoZS5nLiwgXCJkb2NzL2V4YW1wbGUtYS9nZXR0aW5nLXN0YXJ0ZWQubWRcIilcclxuICogQHBhcmFtIGZvbGRlclBhdHRlcm4gVGhlIGZvbGRlciBwYXR0ZXJuIC0gdXNlIGFzdGVyaXNrIGZvciB3aWxkY2FyZHMgKGUuZy4sIFwiZG9jc1wiLCBcImRvY3MvYXN0ZXJpc2tcIiwgXCJkb2NzL2FzdGVyaXNrL2FzdGVyaXNrXCIpXHJcbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGZpbGUgcGF0aCBtYXRjaGVzIHRoZSBwYXR0ZXJuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGg6IHN0cmluZywgZm9sZGVyUGF0dGVybjogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0Ly8gTm9ybWFsaXplIGZvciBjYXNlLWluc2Vuc2l0aXZlIG1hdGNoaW5nXHJcblx0Y29uc3Qgbm9ybWFsaXplZEZpbGVQYXRoID0gZmlsZVBhdGgudG9Mb3dlckNhc2UoKTtcclxuXHRjb25zdCBub3JtYWxpemVkUGF0dGVybiA9IGZvbGRlclBhdHRlcm4udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9eXFwvfFxcLyQvZywgXCJcIik7XHJcblxyXG5cdC8vIEhhbmRsZSBlbXB0eSBmb2xkZXIgcGF0dGVybiAocm9vdCBmb2xkZXIpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcclxuXHRpZiAoIW5vcm1hbGl6ZWRQYXR0ZXJuIHx8IG5vcm1hbGl6ZWRQYXR0ZXJuLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0cmV0dXJuICFub3JtYWxpemVkRmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IChub3JtYWxpemVkRmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSk7XHJcblx0fVxyXG5cclxuXHQvLyBJZiBwYXR0ZXJuIGRvZXNuJ3QgY29udGFpbiB3aWxkY2FyZHMsIHVzZSBzaW1wbGUgcHJlZml4IG1hdGNoaW5nXHJcblx0aWYgKCFub3JtYWxpemVkUGF0dGVybi5pbmNsdWRlcyhcIipcIikpIHtcclxuXHRcdHJldHVybiBub3JtYWxpemVkRmlsZVBhdGggPT09IG5vcm1hbGl6ZWRQYXR0ZXJuIHx8IG5vcm1hbGl6ZWRGaWxlUGF0aC5zdGFydHNXaXRoKG5vcm1hbGl6ZWRQYXR0ZXJuICsgXCIvXCIpO1xyXG5cdH1cclxuXHJcblx0Ly8gQ29udmVydCB3aWxkY2FyZCBwYXR0ZXJuIHRvIHJlZ2V4XHJcblx0Ly8gRXNjYXBlIHNwZWNpYWwgcmVnZXggY2hhcmFjdGVycyBleGNlcHQgKlxyXG5cdGNvbnN0IGVzY2FwZWRQYXR0ZXJuID0gbm9ybWFsaXplZFBhdHRlcm5cclxuXHRcdC5yZXBsYWNlKC9bLis/XiR7fSgpfFtcXF1cXFxcXS9nLCBcIlxcXFwkJlwiKVxyXG5cdFx0LnJlcGxhY2UoL1xcKi9nLCBcIlteL10rXCIpOyAvLyBXaWxkY2FyZCBtYXRjaGVzIGFueSBwYXRoIHNlZ21lbnQgKG5vbi1zbGFzaCBjaGFyYWN0ZXJzKVxyXG5cclxuXHQvLyBDcmVhdGUgcmVnZXggdGhhdCBtYXRjaGVzIHRoZSBwYXR0ZXJuIGFuZCBhbnl0aGluZyBhZnRlciBpdFxyXG5cdGNvbnN0IHJlZ2V4UGF0dGVybiA9IGBeJHtlc2NhcGVkUGF0dGVybn0oPzovfCQpYDtcclxuXHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocmVnZXhQYXR0ZXJuKTtcclxuXHRyZXR1cm4gcmVnZXgudGVzdChub3JtYWxpemVkRmlsZVBhdGgpO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgZGVwdGggb2YgYSBmb2xkZXIgcGF0dGVybiAobnVtYmVyIG9mIHNlZ21lbnRzKVxyXG4gKiBVc2VkIGZvciBwcmlvcml0aXppbmcgbW9yZSBzcGVjaWZpYyBwYXR0ZXJuc1xyXG4gKiBCbGFuay9yb290IGZvbGRlciBoYXMgZGVwdGggMCAobGVhc3Qgc3BlY2lmaWMpXHJcbiAqIEBwYXJhbSBmb2xkZXJQYXR0ZXJuIFRoZSBmb2xkZXIgcGF0dGVyblxyXG4gKiBAcmV0dXJucyBUaGUgbnVtYmVyIG9mIHBhdGggc2VnbWVudHMgaW4gdGhlIHBhdHRlcm4gKDAgZm9yIHJvb3QvYmxhbmspXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGF0dGVybkRlcHRoKGZvbGRlclBhdHRlcm46IHN0cmluZyk6IG51bWJlciB7XHJcblx0aWYgKCFmb2xkZXJQYXR0ZXJuIHx8IGZvbGRlclBhdHRlcm4udHJpbSgpID09PSBcIlwiKSByZXR1cm4gMDtcclxuXHRyZXR1cm4gZm9sZGVyUGF0dGVybi5zcGxpdChcIi9cIikubGVuZ3RoO1xyXG59XHJcblxyXG4vKipcclxuICogU29ydHMgY29udGVudCB0eXBlcyBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIHBhdHRlcm5zIGZpcnN0KVxyXG4gKiBUaGlzIGVuc3VyZXMgdGhhdCBtb3JlIHNwZWNpZmljIHBhdHRlcm5zIGFyZSBjaGVja2VkIGJlZm9yZSBsZXNzIHNwZWNpZmljIG9uZXNcclxuICogQmxhbmsvcm9vdCBmb2xkZXIgcGF0dGVybnMgKGRlcHRoIDApIGFyZSBzb3J0ZWQgbGFzdCAobGVhc3Qgc3BlY2lmaWMpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5PFQgZXh0ZW5kcyB7IGZvbGRlcjogc3RyaW5nIH0+KHR5cGVzOiBUW10pOiBUW10ge1xyXG5cdHJldHVybiBbLi4udHlwZXNdLnNvcnQoKGEsIGIpID0+IHtcclxuXHRcdGNvbnN0IGRlcHRoQSA9IGdldFBhdHRlcm5EZXB0aChhLmZvbGRlcik7XHJcblx0XHRjb25zdCBkZXB0aEIgPSBnZXRQYXR0ZXJuRGVwdGgoYi5mb2xkZXIpO1xyXG5cdFx0Ly8gTW9yZSBzcGVjaWZpYyAoZGVlcGVyKSBwYXR0ZXJucyBmaXJzdFxyXG5cdFx0Ly8gQmxhbmsgcGF0dGVybnMgKGRlcHRoIDApIHdpbGwgYmUgc29ydGVkIGxhc3RcclxuXHRcdHJldHVybiBkZXB0aEIgLSBkZXB0aEE7XHJcblx0fSk7XHJcbn1cclxuXHJcbiIsICIvKipcclxuICogQ29udmVydHMgYSBzdHJpbmcgdG8ga2ViYWItY2FzZS5cclxuICogQHBhcmFtIHN0ciBUaGUgc3RyaW5nIHRvIGNvbnZlcnRcclxuICogQHJldHVybnMgS2ViYWItY2FzZSBzdHJpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0b0tlYmFiQ2FzZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgLnJlcGxhY2UoLyhbYS16MC05XSkoW0EtWl0pL2csICckMS0kMicpXHJcbiAgICAgICAgLnJlcGxhY2UoLyhbQS1aXSkoW0EtWl1bYS16XSkvZywgJyQxLSQyJDMnKVxyXG4gICAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgLnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgXCJcIilcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xccysvZywgXCItXCIpXHJcbiAgICAgICAgLnJlcGxhY2UoLy0rL2csIFwiLVwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC9eLXwtJC9nLCBcIlwiKTtcclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgUGFyc2VkRnJvbnRtYXR0ZXIsIFRlbXBsYXRlVmFsdWVzLCBLTk9XTl9BUlJBWV9LRVlTLCBDb250ZW50VHlwZUlkIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgVGVtcGxhdGVQYXJzZXIge1xyXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIHByaXZhdGUgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncykge31cclxuXHJcblx0LyoqXHJcblx0ICogQ29udmVydCBhIHN0cmluZyB0byBrZWJhYi1jYXNlIGZvciBzbHVnIGdlbmVyYXRpb25cclxuXHQgKi9cclxuXHRwcml2YXRlIHRvS2ViYWJDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBzdHJcclxuXHRcdFx0LnRvTG93ZXJDYXNlKClcclxuXHRcdFx0LnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgXCJcIilcclxuXHRcdFx0LnRyaW0oKVxyXG5cdFx0XHQucmVwbGFjZSgvXFxzKy9nLCBcIi1cIilcclxuXHRcdFx0LnJlcGxhY2UoLy0rL2csIFwiLVwiKVxyXG5cdFx0XHQucmVwbGFjZSgvXi18LSQvZywgXCJcIik7XHJcblx0fVxyXG5cclxuXHRwYXJzZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZyk6IFBhcnNlZEZyb250bWF0dGVyIHtcclxuXHRcdGxldCBwcm9wZXJ0aWVzRW5kID0gMDtcclxuXHRcdGxldCBwcm9wZXJ0aWVzVGV4dCA9IFwiXCI7XHJcblx0XHRjb25zdCBleGlzdGluZ1Byb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHt9O1xyXG5cclxuXHRcdC8vIFBhcnNlIGV4aXN0aW5nIHByb3BlcnRpZXMgd2l0aCBmYWxsYmFjayBmb3IgbWlzc2luZyBzZWNvbmQgLS0tXHJcblx0XHRpZiAoY29udGVudC5zdGFydHNXaXRoKFwiLS0tXCIpKSB7XHJcblx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50LmluZGV4T2YoXCJcXG4tLS1cIiwgMyk7XHJcblx0XHRcdGlmIChwcm9wZXJ0aWVzRW5kID09PSAtMSkge1xyXG5cdFx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50Lmxlbmd0aDsgLy8gVHJlYXQgZW50aXJlIGNvbnRlbnQgYXMgcHJvcGVydGllcyBpZiBubyBzZWNvbmQgLS0tXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCArPSA0OyAvLyBNb3ZlIHBhc3QgdGhlIHNlY29uZCAtLS1cclxuXHRcdFx0fVxyXG5cdFx0XHRwcm9wZXJ0aWVzVGV4dCA9IGNvbnRlbnQuc2xpY2UoNCwgcHJvcGVydGllc0VuZCAtIDQpLnRyaW0oKTtcclxuXHRcdFx0XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGN1cnJlbnRLZXk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cdFx0XHRcdGNvbnN0IGFycmF5S2V5cyA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBUcmFjayB3aGljaCBrZXlzIGFyZSBhcnJheXNcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRwcm9wZXJ0aWVzVGV4dC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBNYXRjaCBwcm9wZXJ0eSBsaW5lcyAtIG1vcmUgZmxleGlibGUgcmVnZXggdG8gaGFuZGxlIHZhcmlvdXMgcHJvcGVydHkgbmFtZXNcclxuXHRcdFx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW2EtekEtWl9dW2EtekEtWjAtOV8tXSopOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0XHRcdGN1cnJlbnRLZXkgPSBrZXk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IHRyaW1tZWRWYWx1ZSA9IHZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIjtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdC8vIENoZWNrIGZvciBicmFja2V0LXN5bnRheCBhcnJheXM6IFtpdGVtXSBvciBbXCJpdGVtMVwiLCBcIml0ZW0yXCJdIG9yIFtpdGVtMSwgaXRlbTJdXHJcblx0XHRcdFx0XHRcdGNvbnN0IGJyYWNrZXRBcnJheU1hdGNoID0gdHJpbW1lZFZhbHVlLm1hdGNoKC9eXFxbKC4qKVxcXSQvKTtcclxuXHRcdFx0XHRcdFx0aWYgKGJyYWNrZXRBcnJheU1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIGJyYWNrZXQtZm9ybWF0IGFycmF5XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgYXJyYXlDb250ZW50ID0gYnJhY2tldEFycmF5TWF0Y2hbMV0udHJpbSgpO1xyXG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW107XHJcblx0XHRcdFx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIHRoaXMga2V5IGFzIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0aWYgKGFycmF5Q29udGVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgYXJyYXkgaXRlbXMgLSBoYW5kbGUgYm90aCBxdW90ZWQgYW5kIHVucXVvdGVkIHZhbHVlc1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgYnkgY29tbWEsIGJ1dCByZXNwZWN0IHF1b3Rlc1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXRlbXM6IHN0cmluZ1tdID0gW107XHJcblx0XHRcdFx0XHRcdFx0XHRsZXQgY3VycmVudEl0ZW0gPSBcIlwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0bGV0IGluUXVvdGVzID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHRsZXQgcXVvdGVDaGFyID0gJyc7XHJcblx0XHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlDb250ZW50Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNoYXIgPSBhcnJheUNvbnRlbnRbaV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIWluUXVvdGVzICYmIChjaGFyID09PSAnXCInIHx8IGNoYXIgPT09IFwiJ1wiKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGluUXVvdGVzID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRxdW90ZUNoYXIgPSBjaGFyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGluUXVvdGVzICYmIGNoYXIgPT09IHF1b3RlQ2hhcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgZXNjYXBlZFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChpID4gMCAmJiBhcnJheUNvbnRlbnRbaSAtIDFdID09PSAnXFxcXCcpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRJdGVtICs9IGNoYXI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGluUXVvdGVzID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRxdW90ZUNoYXIgPSAnJztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIWluUXVvdGVzICYmIGNoYXIgPT09ICcsJykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEVuZCBvZiBjdXJyZW50IGl0ZW1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCB0cmltbWVkSXRlbSA9IGN1cnJlbnRJdGVtLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodHJpbW1lZEl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlbW92ZSBzdXJyb3VuZGluZyBxdW90ZXMgaWYgcHJlc2VudFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgdW5xdW90ZWQgPSB0cmltbWVkSXRlbS5yZXBsYWNlKC9eW1wiJ118W1wiJ10kL2csICcnKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGl0ZW1zLnB1c2godW5xdW90ZWQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50SXRlbSA9IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudEl0ZW0gKz0gY2hhcjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBBZGQgdGhlIGxhc3QgaXRlbVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRJdGVtLnRyaW0oKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCB0cmltbWVkSXRlbSA9IGN1cnJlbnRJdGVtLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgdW5xdW90ZWQgPSB0cmltbWVkSXRlbS5yZXBsYWNlKC9eW1wiJ118W1wiJ10kL2csICcnKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aXRlbXMucHVzaCh1bnF1b3RlZCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gaXRlbXM7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vIE5vdCBhIGJyYWNrZXQgYXJyYXksIGNoZWNrIGZvciBvdGhlciBhcnJheSBmb3JtYXRzXHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXNLbm93bkFycmF5S2V5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXNFbXB0eUFycmF5ID0gIXRyaW1tZWRWYWx1ZSB8fCB0cmltbWVkVmFsdWUgPT09IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIHRoaXMga2V5IGFzIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFN0cmlwIHN1cnJvdW5kaW5nIHF1b3RlcyBmcm9tIHN0cmluZyB2YWx1ZXNcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHVucXVvdGVkVmFsdWUgPSB0cmltbWVkVmFsdWUucmVwbGFjZSgvXltcIiddfFtcIiddJC9nLCAnJyk7XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFt1bnF1b3RlZFZhbHVlXTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoY3VycmVudEtleSAmJiB0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiLSBcIikpIHtcclxuXHRcdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgY3VycmVudCBrZXkgaXMgYW4gYXJyYXkgcHJvcGVydHlcclxuXHRcdFx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gYXJyYXlLZXlzLmhhcyhjdXJyZW50S2V5KTtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdGlmIChpc0FycmF5UHJvcGVydHkpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBpdGVtID0gdHJpbW1lZExpbmUucmVwbGFjZSgvXi1cXHMqLywgXCJcIik7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGl0ZW0pIGV4aXN0aW5nUHJvcGVydGllc1tjdXJyZW50S2V5XS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHRyaW1tZWRMaW5lICYmICF0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiLSBcIikgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XHJcblx0XHRcdFx0XHRcdC8vIEhhbmRsZSB1bnJlY29nbml6ZWQgcHJvcGVydGllcyB0aGF0IGRvbid0IG1hdGNoIHRoZSBzdGFuZGFyZCBmb3JtYXRcclxuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIGZhbGxiYWNrIHRvIHByZXNlcnZlIHByb3BlcnRpZXMgdGhhdCBtaWdodCBoYXZlIHNwZWNpYWwgZm9ybWF0dGluZ1xyXG5cdFx0XHRcdFx0XHRjb25zdCBrZXlNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKFteOl0rKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRcdFx0aWYgKGtleU1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgWywga2V5LCB2YWx1ZV0gPSBrZXlNYXRjaDtcclxuXHRcdFx0XHRcdFx0XHRpZiAoIWV4aXN0aW5nUHJvcGVydGllc1trZXldKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFt2YWx1ZSA/IHZhbHVlLnRyaW0oKSA6IFwiXCJdO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdC8vIFByZXNlcnZlIGFycmF5IGtleXMgaWYgdGhleSBleGlzdCB3aXRob3V0IHZhbHVlc1xyXG5cdFx0XHRcdEtOT1dOX0FSUkFZX0tFWVMuZm9yRWFjaChrZXkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKHByb3BlcnRpZXNUZXh0LmluY2x1ZGVzKGtleSArICc6JykgJiYgIWV4aXN0aW5nUHJvcGVydGllc1trZXldKSB7XHJcblx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW107XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRcdC8vIEZhbGxiYWNrIHRvIHRlbXBsYXRlIGlmIHBhcnNpbmcgZmFpbHNcclxuXHRcdFx0XHRuZXcgTm90aWNlKFwiRmFsbGluZyBiYWNrIHRvIHRlbXBsYXRlIGR1ZSB0byBwYXJzaW5nIGVycm9yLlwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGJvZHlDb250ZW50ID0gY29udGVudC5zbGljZShwcm9wZXJ0aWVzRW5kKTtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHByb3BlcnRpZXM6IGV4aXN0aW5nUHJvcGVydGllcyxcclxuXHRcdFx0cHJvcGVydGllc1RleHQsXHJcblx0XHRcdHByb3BlcnRpZXNFbmQsXHJcblx0XHRcdGJvZHlDb250ZW50XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0cGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZVN0cmluZzogc3RyaW5nLCB0aXRsZTogc3RyaW5nKTogeyB0ZW1wbGF0ZVByb3BzOiBzdHJpbmdbXTsgdGVtcGxhdGVWYWx1ZXM6IFRlbXBsYXRlVmFsdWVzIH0ge1xyXG5cdFx0Y29uc3QgdGVtcGxhdGVMaW5lcyA9IHRlbXBsYXRlU3RyaW5nLnNwbGl0KFwiXFxuXCIpO1xyXG5cdFx0Y29uc3QgdGVtcGxhdGVQcm9wczogc3RyaW5nW10gPSBbXTtcclxuXHRcdGNvbnN0IHRlbXBsYXRlVmFsdWVzOiBUZW1wbGF0ZVZhbHVlcyA9IHt9O1xyXG5cdFx0bGV0IGluUHJvcGVydGllcyA9IGZhbHNlO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcGxhdGVMaW5lcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRjb25zdCBsaW5lID0gdGVtcGxhdGVMaW5lc1tpXS50cmltKCk7XHJcblx0XHRcdGlmIChsaW5lID09PSBcIi0tLVwiKSB7XHJcblx0XHRcdFx0aW5Qcm9wZXJ0aWVzID0gIWluUHJvcGVydGllcztcclxuXHRcdFx0XHRpZiAoIWluUHJvcGVydGllcykge1xyXG5cdFx0XHRcdFx0YnJlYWs7IC8vIFN0b3AgYXQgc2Vjb25kIC0tLSB0byBleGNsdWRlIHBvc3QtcHJvcGVydHkgY29udGVudFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaW5Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKFxcdyspOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3QgWywga2V5LCB2YWx1ZV0gPSBtYXRjaDtcclxuXHRcdFx0XHRcdHRlbXBsYXRlUHJvcHMucHVzaChrZXkpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGFuIGFycmF5IHByb3BlcnR5IChrbm93biBhcnJheSBrZXlzIG9yIFlBTUwgbGlzdCBmb3JtYXQpXHJcblx0XHRcdFx0XHRjb25zdCBpc0tub3duQXJyYXlLZXkgPSBLTk9XTl9BUlJBWV9LRVlTLmluY2x1ZGVzKGtleSBhcyB0eXBlb2YgS05PV05fQVJSQVlfS0VZU1tudW1iZXJdKTtcclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSBZQU1MIGxpc3QgZm9ybWF0IChubyB2YWx1ZSBhZnRlciBjb2xvbiwgZW1wdHkgYnJhY2tldHMsIG9yIGVtcHR5IHZhbHVlIG1lYW5zIGl0J3MgYW4gYXJyYXkpXHJcblx0XHRcdFx0XHRjb25zdCBpc0VtcHR5QXJyYXkgPSAhdmFsdWUgfHwgdmFsdWUudHJpbSgpID09PSBcIlwiIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJbXVwiO1xyXG5cdFx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHQvLyBIYW5kbGUgYXJyYXkgcHJvcGVydGllc1xyXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgJiYgdmFsdWUuc3RhcnRzV2l0aChcIltcIikpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBIYW5kbGUgYnJhY2tldCBmb3JtYXQ6IFtcIml0ZW0xXCIsIFwiaXRlbTJcIl1cclxuXHRcdFx0XHRcdFx0XHRjb25zdCBpdGVtcyA9IHZhbHVlXHJcblx0XHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvW1tcXF1dL2csIFwiXCIpXHJcblx0XHRcdFx0XHRcdFx0XHQuc3BsaXQoXCIsXCIpXHJcblx0XHRcdFx0XHRcdFx0XHQubWFwKHQgPT4gdC50cmltKCkpXHJcblx0XHRcdFx0XHRcdFx0XHQuZmlsdGVyKHQgPT4gdCk7XHJcblx0XHRcdFx0XHRcdFx0dGVtcGxhdGVWYWx1ZXNba2V5XSA9IGl0ZW1zO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vIEhhbmRsZSBZQU1MIGxpc3QgZm9ybWF0OiBlbXB0eSBvciB3aXRoIC0gaXRlbXNcclxuXHRcdFx0XHRcdFx0XHR0ZW1wbGF0ZVZhbHVlc1trZXldID0gW107XHJcblx0XHRcdFx0XHRcdFx0Ly8gTG9vayBhaGVhZCBmb3IgaXRlbSBsaXN0XHJcblx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgdGVtcGxhdGVMaW5lcy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbmV4dExpbmUgPSB0ZW1wbGF0ZUxpbmVzW2pdLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmIChuZXh0TGluZS5zdGFydHNXaXRoKFwiLSBcIikpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXRlbSA9IG5leHRMaW5lLnJlcGxhY2UoL14tXFxzKi8sIFwiXCIpLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBhcnJheVZhbHVlID0gdGVtcGxhdGVWYWx1ZXNba2V5XTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoQXJyYXkuaXNBcnJheShhcnJheVZhbHVlKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YXJyYXlWYWx1ZS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChuZXh0TGluZSA9PT0gXCItLS1cIiB8fCAobmV4dExpbmUgJiYgIW5leHRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSAmJiBuZXh0TGluZS5pbmNsdWRlcyhcIjpcIikpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFN0b3AgYXQgbmV4dCBwcm9wZXJ0eSBvciBlbmQgb2YgcHJvcGVydGllcyBzZWN0aW9uXHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIHN0cmluZyBwcm9wZXJ0eSwgbm90IGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdGNvbnN0IHNsdWcgPSB0aGlzLnRvS2ViYWJDYXNlKHRpdGxlKTtcclxuXHRcdFx0XHRcdFx0Y29uc3Qgc3RyaW5nVmFsdWUgPSAodmFsdWUgfHwgXCJcIilcclxuXHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpXHJcblx0XHRcdFx0XHRcdFx0LnJlcGxhY2UoL1xce1xce2RhdGVcXH1cXH0vZywgd2luZG93Lm1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQodGhpcy5zZXR0aW5ncy5kYXRlRm9ybWF0KSlcclxuXHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvXFx7XFx7c2x1Z1xcfVxcfS9nLCBzbHVnKTtcclxuXHRcdFx0XHRcdFx0Ly8gU3RvcmUgYXMgYSBzaW5nbGUgc3RyaW5nIHZhbHVlLCBub3QgaW4gYW4gYXJyYXlcclxuXHRcdFx0XHRcdFx0dGVtcGxhdGVWYWx1ZXNba2V5XSA9IHN0cmluZ1ZhbHVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7IHRlbXBsYXRlUHJvcHMsIHRlbXBsYXRlVmFsdWVzIH07XHJcblx0fVxyXG5cclxuXHRidWlsZEZyb250bWF0dGVyQ29udGVudChmaW5hbFByb3BzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4sIGFycmF5S2V5cz86IFNldDxzdHJpbmc+KTogc3RyaW5nIHtcclxuXHRcdGxldCBuZXdDb250ZW50ID0gXCItLS1cXG5cIjtcclxuXHRcdGZvciAoY29uc3Qga2V5IGluIGZpbmFsUHJvcHMpIHtcclxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhbiBhcnJheSBwcm9wZXJ0eVxyXG5cdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBLTk9XTl9BUlJBWV9LRVlTLmluY2x1ZGVzKGtleSBhcyB0eXBlb2YgS05PV05fQVJSQVlfS0VZU1tudW1iZXJdKSB8fCBcclxuXHRcdFx0XHQoYXJyYXlLZXlzICYmIGFycmF5S2V5cy5oYXMoa2V5KSk7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0bmV3Q29udGVudCArPSBgJHtrZXl9OlxcbmA7XHJcblx0XHRcdFx0aWYgKGZpbmFsUHJvcHNba2V5XS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRmaW5hbFByb3BzW2tleV0uZm9yRWFjaChpdGVtID0+IHtcclxuXHRcdFx0XHRcdFx0bmV3Q29udGVudCArPSBgICAtICR7aXRlbX1cXG5gO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTogJHtmaW5hbFByb3BzW2tleV1bMF0gfHwgXCJcIn1cXG5gO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRuZXdDb250ZW50ICs9IFwiLS0tXCI7XHJcblx0XHRyZXR1cm4gbmV3Q29udGVudDtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHVwZGF0ZVRpdGxlSW5Gcm9udG1hdHRlcihmaWxlOiBURmlsZSwgbmV3VGl0bGU6IHN0cmluZywgdHlwZTogQ29udGVudFR5cGVJZCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0Ly8gQ2hlY2sgaWYgdGVtcGxhdGUgaGFzIHt7dGl0bGV9fSAtIGlmIG5vdCwgZG9uJ3QgdXBkYXRlIGZyb250bWF0dGVyIGF0IGFsbFxyXG5cdFx0Y29uc3QgdGl0bGVLZXkgPSB0aGlzLmdldFRpdGxlS2V5KHR5cGUpO1xyXG5cdFx0Y29uc3QgaGFzVGl0bGVJblRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZUhhc1RpdGxlKHR5cGUpO1xyXG5cdFx0XHJcblx0XHQvLyBJZiB0ZW1wbGF0ZSBkb2Vzbid0IGhhdmUge3t0aXRsZX19LCBkb24ndCBtb2RpZnkgZnJvbnRtYXR0ZXJcclxuXHRcdGlmICghaGFzVGl0bGVJblRlbXBsYXRlKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Y29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcblx0XHRsZXQgcHJvcGVydGllc0VuZCA9IDA7XHJcblx0XHRsZXQgcHJvcGVydGllc1RleHQgPSBcIlwiO1xyXG5cdFx0bGV0IGhhc0Zyb250bWF0dGVyID0gZmFsc2U7XHJcblxyXG5cdFx0aWYgKGNvbnRlbnQuc3RhcnRzV2l0aChcIi0tLVwiKSkge1xyXG5cdFx0XHRoYXNGcm9udG1hdHRlciA9IHRydWU7XHJcblx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50LmluZGV4T2YoXCJcXG4tLS1cIiwgMyk7XHJcblx0XHRcdGlmIChwcm9wZXJ0aWVzRW5kID09PSAtMSkge1xyXG5cdFx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50Lmxlbmd0aDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRwcm9wZXJ0aWVzRW5kICs9IDQ7XHJcblx0XHRcdH1cclxuXHRcdFx0cHJvcGVydGllc1RleHQgPSBjb250ZW50LnNsaWNlKDQsIHByb3BlcnRpZXNFbmQgLSA0KS50cmltKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgcHJvcE9yZGVyOiBzdHJpbmdbXSA9IFtdO1xyXG5cdFx0Y29uc3QgZXhpc3Rpbmc6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHN0cmluZ1tdPiA9IHt9O1xyXG5cdFx0bGV0IGN1cnJlbnRLZXk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cdFx0bGV0IHRpdGxlS2V5UG9zaXRpb24gPSAtMTsgLy8gVHJhY2sgdGhlIG9yaWdpbmFsIHBvc2l0aW9uIG9mIHRoZSB0aXRsZSBrZXlcclxuXHJcblx0XHRjb25zdCBhcnJheUtleXMgPSBuZXcgU2V0PHN0cmluZz4oKTsgLy8gVHJhY2sgd2hpY2gga2V5cyBhcmUgYXJyYXlzXHJcblx0XHRcclxuXHRcdHByb3BlcnRpZXNUZXh0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XHJcblx0XHRcdGNvbnN0IHRyaW1tZWRMaW5lID0gbGluZS50cmltKCk7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBNYXRjaCBwcm9wZXJ0eSBsaW5lcyAtIG1vcmUgZmxleGlibGUgcmVnZXggdG8gaGFuZGxlIHZhcmlvdXMgcHJvcGVydHkgbmFtZXNcclxuXHRcdFx0Y29uc3QgbWF0Y2ggPSB0cmltbWVkTGluZS5tYXRjaCgvXihbYS16QS1aX11bYS16QS1aMC05Xy1dKik6XFxzKiguKikkLyk7XHJcblx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0cHJvcE9yZGVyLnB1c2goa2V5KTtcclxuXHRcdFx0XHRjdXJyZW50S2V5ID0ga2V5O1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vIFRyYWNrIHRoZSBvcmlnaW5hbCBwb3NpdGlvbiBvZiB0aGUgdGl0bGUga2V5XHJcblx0XHRcdFx0aWYgKGtleSA9PT0gdGl0bGVLZXkpIHtcclxuXHRcdFx0XHRcdHRpdGxlS2V5UG9zaXRpb24gPSBpbmRleDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Y29uc3QgaXNLbm93bkFycmF5S2V5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSk7XHJcblx0XHRcdFx0Y29uc3QgaXNFbXB0eUFycmF5ID0gIXZhbHVlIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJcIiB8fCB2YWx1ZS50cmltKCkgPT09IFwiW11cIjtcclxuXHRcdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBpc0tub3duQXJyYXlLZXkgfHwgaXNFbXB0eUFycmF5O1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmIChpc0FycmF5UHJvcGVydHkpIHtcclxuXHRcdFx0XHRcdGV4aXN0aW5nW2tleV0gPSBbXTtcclxuXHRcdFx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTsgLy8gTWFyayB0aGlzIGtleSBhcyBhbiBhcnJheVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRleGlzdGluZ1trZXldID0gdmFsdWUgPyB2YWx1ZS50cmltKCkgOiBcIlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIGlmIChjdXJyZW50S2V5ICYmIGFycmF5S2V5cy5oYXMoY3VycmVudEtleSkgJiYgdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIi0gXCIpKSB7XHJcblx0XHRcdFx0Ly8gSGFuZGxlIGFycmF5IGl0ZW1zXHJcblx0XHRcdFx0Y29uc3QgaXRlbSA9IHRyaW1tZWRMaW5lLnJlcGxhY2UoL14tXFxzKi8sIFwiXCIpO1xyXG5cdFx0XHRcdGlmIChpdGVtKSAoZXhpc3RpbmdbY3VycmVudEtleV0gYXMgc3RyaW5nW10pLnB1c2goaXRlbSk7XHJcblx0XHRcdH0gZWxzZSBpZiAodHJpbW1lZExpbmUgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSAmJiAhdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIiNcIikpIHtcclxuXHRcdFx0XHQvLyBIYW5kbGUgdW5yZWNvZ25pemVkIHByb3BlcnRpZXMgdGhhdCBkb24ndCBtYXRjaCB0aGUgc3RhbmRhcmQgZm9ybWF0XHJcblx0XHRcdFx0Ly8gVGhpcyBpcyBhIGZhbGxiYWNrIHRvIHByZXNlcnZlIHByb3BlcnRpZXMgdGhhdCBtaWdodCBoYXZlIHNwZWNpYWwgZm9ybWF0dGluZ1xyXG5cdFx0XHRcdGNvbnN0IGtleU1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW146XSspOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdGlmIChrZXlNYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3QgWywga2V5LCB2YWx1ZV0gPSBrZXlNYXRjaDtcclxuXHRcdFx0XHRcdGlmICghcHJvcE9yZGVyLmluY2x1ZGVzKGtleSkpIHtcclxuXHRcdFx0XHRcdFx0cHJvcE9yZGVyLnB1c2goa2V5KTtcclxuXHRcdFx0XHRcdFx0ZXhpc3Rpbmdba2V5XSA9IHZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFByb3Blcmx5IGVzY2FwZSBZQU1MIHN0cmluZyB2YWx1ZXNcclxuXHRcdC8vIFlBTUwgc3RyaW5ncyB3aXRoIHF1b3RlcyBuZWVkIHRvIGJlIHdyYXBwZWQgaW4gc2luZ2xlIHF1b3RlcyBvciBlc2NhcGVkIHByb3Blcmx5XHJcblx0XHRsZXQgdGl0bGVWYWw6IHN0cmluZztcclxuXHRcdGlmIChuZXdUaXRsZS5pbmNsdWRlcygnXCInKSB8fCBuZXdUaXRsZS5pbmNsdWRlcyhcIidcIikgfHwgbmV3VGl0bGUuaW5jbHVkZXMoJ1xcbicpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKCdcXFxcJykpIHtcclxuXHRcdFx0Ly8gRm9yIHN0cmluZ3Mgd2l0aCBxdW90ZXMsIG5ld2xpbmVzLCBvciBiYWNrc2xhc2hlcywgdXNlIHNpbmdsZSBxdW90ZXMgYW5kIGVzY2FwZSBzaW5nbGUgcXVvdGVzXHJcblx0XHRcdHRpdGxlVmFsID0gYCcke25ld1RpdGxlLnJlcGxhY2UoLycvZywgXCInJ1wiKX0nYDtcclxuXHRcdH0gZWxzZSBpZiAobmV3VGl0bGUuaW5jbHVkZXMoXCIgXCIpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKFwiOlwiKSB8fCBuZXdUaXRsZS5pbmNsdWRlcyhcIiNcIikgfHwgbmV3VGl0bGUuaW5jbHVkZXMoXCJAXCIpKSB7XHJcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggc3BhY2VzIG9yIHNwZWNpYWwgWUFNTCBjaGFyYWN0ZXJzLCB3cmFwIGluIGRvdWJsZSBxdW90ZXMgYW5kIGVzY2FwZSBkb3VibGUgcXVvdGVzXHJcblx0XHRcdHRpdGxlVmFsID0gYFwiJHtuZXdUaXRsZS5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyl9XCJgO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gRm9yIHNpbXBsZSBzdHJpbmdzLCBubyBxdW90ZXMgbmVlZGVkXHJcblx0XHRcdHRpdGxlVmFsID0gbmV3VGl0bGU7XHJcblx0XHR9XHJcblx0XHRleGlzdGluZ1t0aXRsZUtleV0gPSB0aXRsZVZhbDtcclxuXHRcdFxyXG5cdFx0Ly8gQWxzbyB1cGRhdGUgc2x1ZyBpZiBpdCBleGlzdHMgaW4gZnJvbnRtYXR0ZXJcclxuXHRcdGlmIChcInNsdWdcIiBpbiBleGlzdGluZykge1xyXG5cdFx0XHRjb25zdCBuZXdTbHVnID0gdGhpcy50b0tlYmFiQ2FzZShuZXdUaXRsZSk7XHJcblx0XHRcdGV4aXN0aW5nW1wic2x1Z1wiXSA9IG5ld1NsdWc7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gSWYgdGl0bGUga2V5IHdhcyBmb3VuZCBpbiBvcmlnaW5hbCBwcm9wZXJ0aWVzLCBwcmVzZXJ2ZSBpdHMgcG9zaXRpb25cclxuXHRcdC8vIE90aGVyd2lzZSwgYWRkIGl0IGF0IHRoZSBlbmRcclxuXHRcdGlmICh0aXRsZUtleVBvc2l0aW9uID09PSAtMSkge1xyXG5cdFx0XHQvLyBUaXRsZSBrZXkgbm90IGZvdW5kIGluIG9yaWdpbmFsIHByb3BlcnRpZXMsIGFkZCBpdCBhdCB0aGUgZW5kXHJcblx0XHRcdHByb3BPcmRlci5wdXNoKHRpdGxlS2V5KTtcclxuXHRcdH1cclxuXHRcdC8vIElmIHRpdGxlS2V5UG9zaXRpb24gPj0gMCwgdGhlIHRpdGxlIGtleSBpcyBhbHJlYWR5IGluIHByb3BPcmRlciBhdCB0aGUgY29ycmVjdCBwb3NpdGlvblxyXG5cclxuXHRcdC8vIE9ubHkgY3JlYXRlL3VwZGF0ZSBmcm9udG1hdHRlciBpZiBpdCBhbHJlYWR5IGV4aXN0c1xyXG5cdFx0Ly8gRG9uJ3QgY3JlYXRlIGZyb250bWF0dGVyIGZyb20gc2NyYXRjaCBpZiBmaWxlIGhhZCBub25lXHJcblx0XHRpZiAoIWhhc0Zyb250bWF0dGVyKSB7XHJcblx0XHRcdC8vIEZpbGUgaGFkIG5vIGZyb250bWF0dGVyIC0gZG9uJ3QgY3JlYXRlIGl0LCBqdXN0IHJldHVyblxyXG5cdFx0XHQvLyBUaGUgcmVuYW1lIGFscmVhZHkgaGFwcGVuZWQsIHdlIGp1c3QgZG9uJ3QgdXBkYXRlIGZyb250bWF0dGVyXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBCdWlsZCBuZXcgY29udGVudCB3aXRoIGZyb250bWF0dGVyXHJcblx0XHRsZXQgbmV3Q29udGVudCA9IFwiLS0tXFxuXCI7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBvZiBwcm9wT3JkZXIpIHtcclxuXHRcdFx0Y29uc3QgdmFsID0gZXhpc3Rpbmdba2V5XTtcclxuXHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodmFsKSkge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTpcXG5gO1xyXG5cdFx0XHRcdGlmICh2YWwubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0dmFsLmZvckVhY2goKGl0ZW06IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRuZXdDb250ZW50ICs9IGAgIC0gJHtpdGVtfVxcbmA7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bmV3Q29udGVudCArPSBgJHtrZXl9OiAke3ZhbCB8fCBcIlwifVxcbmA7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdG5ld0NvbnRlbnQgKz0gXCItLS1cXG5cIjtcclxuXHJcblx0XHQvLyBHZXQgYm9keSBjb250ZW50IChmcm9udG1hdHRlciBhbHJlYWR5IGV4aXN0ZWQsIHNvIHdlIGtub3cgcHJvcGVydGllc0VuZCBpcyBzZXQpXHJcblx0XHRjb25zdCBib2R5Q29udGVudCA9IGNvbnRlbnQuc2xpY2UocHJvcGVydGllc0VuZCk7XHJcblx0XHRuZXdDb250ZW50ICs9IGJvZHlDb250ZW50O1xyXG5cclxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0VGl0bGVLZXkodHlwZTogQ29udGVudFR5cGVJZCk6IHN0cmluZyB7XHJcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHJldHVybiBcInRpdGxlXCI7XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gdHlwZSk7XHJcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm4gXCJ0aXRsZVwiO1xyXG5cdFx0XHJcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xyXG5cdFx0Y29uc3QgbGluZXMgPSB0ZW1wbGF0ZS5zcGxpdChcIlxcblwiKTtcclxuXHRcdGxldCBpblByb3BlcnRpZXMgPSBmYWxzZTtcclxuXHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xyXG5cdFx0XHRjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7XHJcblx0XHRcdGlmICh0cmltbWVkID09PSBcIi0tLVwiKSB7XHJcblx0XHRcdFx0aW5Qcm9wZXJ0aWVzID0gIWluUHJvcGVydGllcztcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaW5Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSB0cmltbWVkLm1hdGNoKC9eKFxcdyspOlxccyooLispJC8pO1xyXG5cdFx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3Qga2V5ID0gbWF0Y2hbMV07XHJcblx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IG1hdGNoWzJdO1xyXG5cdFx0XHRcdFx0aWYgKHZhbHVlLmluY2x1ZGVzKFwie3t0aXRsZX19XCIpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBrZXk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gXCJ0aXRsZVwiO1xyXG5cdH1cclxuXHRcclxuXHQvLyBDaGVjayBpZiB0aGUgdGVtcGxhdGUgZm9yIHRoaXMgY29udGVudCB0eXBlIGhhcyB7e3RpdGxlfX1cclxuXHRwcml2YXRlIHRlbXBsYXRlSGFzVGl0bGUodHlwZTogQ29udGVudFR5cGVJZCk6IGJvb2xlYW4ge1xyXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gdHJ1ZTsgLy8gTm90ZXMgYWx3YXlzIGhhdmUgdGl0bGVcclxuXHRcdFxyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKGN0ID0+IGN0LmlkID09PSB0eXBlKTtcclxuXHRcdGlmICghY29udGVudFR5cGUpIHJldHVybiB0cnVlOyAvLyBEZWZhdWx0IHRvIHRydWUgZm9yIHNhZmV0eVxyXG5cdFx0XHJcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xyXG5cdFx0cmV0dXJuIHRlbXBsYXRlLmluY2x1ZGVzKFwie3t0aXRsZX19XCIpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcblxuaW1wb3J0IHsgbWF0Y2hlc0ZvbGRlclBhdHRlcm4sIHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eSB9IGZyb20gXCIuL3BhdGgtbWF0Y2hpbmdcIjtcbmltcG9ydCB7IHRvS2ViYWJDYXNlIH0gZnJvbSBcIi4vc3RyaW5nLXV0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBMaW5rQ29udmVydGVyIHtcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzLCBwcml2YXRlIHBsdWdpbj86IHsgc2V0dGluZ3M/OiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSkgeyB9XG5cblx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBzdG9yZWQgc2V0dGluZ3Ncblx0cHJpdmF0ZSBnZXRTZXR0aW5ncygpOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3Mge1xuXHRcdC8vIEFsd2F5cyBwcmVmZXIgcGx1Z2luIHNldHRpbmdzICh0aGV5J3JlIGtlcHQgdXAgdG8gZGF0ZSlcblx0XHRpZiAodGhpcy5wbHVnaW4/LnNldHRpbmdzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnNldHRpbmdzO1xuXHR9XG5cblx0Ly8gTG9jYWwgdG9LZWJhYkNhc2UgcmVtb3ZlZCwgdXNpbmcgaW1wb3J0ZWQgb25lIGluc3RlYWRcblxuXHRnZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsobGluazogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBoYXNoSW5kZXggPSBsaW5rLmluZGV4T2YoJyMnKTtcblx0XHRsZXQgcGF0aCA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZSgwLCBoYXNoSW5kZXgpIDogbGluaztcblx0XHRjb25zdCBhbmNob3IgPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoaGFzaEluZGV4KSA6ICcnO1xuXG5cdFx0Ly8gVVJMIGRlY29kZSB0aGUgcGF0aCB0byBoYW5kbGUgZW5jb2RlZCBjaGFyYWN0ZXJzIGxpa2UgJTIwXG5cdFx0cGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXRoKTtcblx0XHRwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCBcIlwiKTtcblxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aCB1c2luZyBwYXR0ZXJuIHNwZWNpZmljaXR5XG5cdFx0Ly8gU3VwcG9ydCBib3RoIC5tZCBhbmQgLm1keCBleHRlbnNpb25zXG5cdFx0Y29uc3QgZmlsZUV4dGVuc2lvbiA9IGxpbmsuZW5kc1dpdGgoJy5tZHgnKSA/ICcubWR4JyA6ICcubWQnO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlSW5mbyA9IHRoaXMuZ2V0Q29udGVudFR5cGVGb3JQYXRoKHBhdGggKyBmaWxlRXh0ZW5zaW9uKTtcblx0XHRsZXQgYmFzZVBhdGggPSBjb250ZW50VHlwZUluZm8uYmFzZVBhdGggfHwgXCJcIjtcblx0XHRsZXQgY29udGVudEZvbGRlciA9IGNvbnRlbnRUeXBlSW5mby5jb250ZW50Rm9sZGVyIHx8IFwiXCI7XG5cdFx0bGV0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZUluZm8uaW5kZXhGaWxlTmFtZSB8fCBcIlwiO1xuXG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblxuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogaWYgdGhlIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZSAocmVnYXJkbGVzcyBvZiBjcmVhdGlvbiBtb2RlKSxcblx0XHQvLyB0cmVhdCBpdCBhcyBmb2xkZXItYmFzZWQgbG9naWNcblx0XHQvLyBOb3RlOiBXZSBvbmx5IHNldCBhZGRUcmFpbGluZ1NsYXNoIGhlcmU7IHRoZSBmaW5hbCBjaGVjayB3aWxsIHByZXZlbnQgaXQgaWYgdGhlcmUncyBhbiBhbmNob3Jcblx0XHRjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcblx0XHRjb25zdCBsYXN0UGFydCA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGxhc3QgcGFydCBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgaW5kZXggZmlsZSBuYW1lXG5cdFx0aWYgKGluZGV4RmlsZU5hbWUgJiYgaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgbGFzdFBhcnQgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdH1cblx0XHQvLyBDaGVjayBpZiB0aGUgbGFzdCBwYXJ0IG1hdGNoZXMgdGhlIGRlZmF1bHQgXCJpbmRleFwiICh3aGVuIG5vIGluZGV4RmlsZU5hbWUgaXMgc3BlY2lmaWVkKVxuXHRcdGVsc2UgaWYgKCghaW5kZXhGaWxlTmFtZSB8fCBpbmRleEZpbGVOYW1lLnRyaW0oKSA9PT0gXCJcIikgJiYgbGFzdFBhcnQgPT09IFwiaW5kZXhcIikge1xuXHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3Qgc2x1Z1BhcnRzID0gcGF0aC5zcGxpdCgnLycpLm1hcChwYXJ0ID0+IHRvS2ViYWJDYXNlKHBhcnQpKTtcblx0XHRjb25zdCBzbHVnID0gc2x1Z1BhcnRzLmpvaW4oJy8nKTtcblxuXHRcdC8vIEZvcm1hdCBiYXNlIHBhdGhcblx0XHRpZiAoYmFzZVBhdGgpIHtcblx0XHRcdC8vIEFkZCBsZWFkaW5nIHNsYXNoIGlmIG5vdCBwcmVzZW50IHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRpZiAoIWJhc2VQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcblx0XHRcdH1cblx0XHRcdC8vIEFkZCB0cmFpbGluZyBzbGFzaCBpZiBub3QgcHJlc2VudFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5lbmRzV2l0aChcIi9cIikpIHtcblx0XHRcdFx0YmFzZVBhdGggKz0gXCIvXCI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFdoZW4gbm8gYmFzZSBwYXRoIGlzIHNwZWNpZmllZCwgYWRkIGxlYWRpbmcgc2xhc2ggdG8gbWFrZSBpdCBhYnNvbHV0ZSBmcm9tIHJvb3Rcblx0XHRcdGJhc2VQYXRoID0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBhZGQgdHJhaWxpbmcgc2xhc2hcblx0XHQvLyBDUklUSUNBTDogTmV2ZXIgYWRkIHRyYWlsaW5nIHNsYXNoIGJlZm9yZSBhbiBhbmNob3IgKGUuZy4sIC9hYm91dCNoZWFkaW5nIG5vdCAvYWJvdXQvI2hlYWRpbmcpXG5cdFx0Ly8gVGhpcyBpcyBlc3BlY2lhbGx5IGltcG9ydGFudCBmb3IgYW5jaG9yIGxpbmtzIGZyb20gY29weSBoZWFkaW5nIFVSTCBmdW5jdGlvbmFsaXR5XG5cdFx0Ly8gQW5jaG9yIGxpbmtzIHNob3VsZCBORVZFUiBoYXZlIHRyYWlsaW5nIHNsYXNoZXMsIHJlZ2FyZGxlc3Mgb2Ygc2V0dGluZ3Ncblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBzaG91bGRBZGRUcmFpbGluZ1NsYXNoID0gKHNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzIHx8IGFkZFRyYWlsaW5nU2xhc2gpICYmICFhbmNob3I7XG5cblx0XHRyZXR1cm4gYCR7YmFzZVBhdGh9JHtzbHVnfSR7c2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA/ICcvJyA6ICcnfSR7YW5jaG9yfWA7XG5cdH1cblxuXHRwcml2YXRlIGdldEFzdHJvVXJsRnJvbUludGVybmFsTGlua1dpdGhDb250ZXh0KGxpbms6IHN0cmluZywgY3VycmVudEZpbGVQYXRoOiBzdHJpbmcsIGN1cnJlbnRGaWxlQ29udGVudFR5cGU6IHsgYmFzZVBhdGg6IHN0cmluZzsgY3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7IGluZGV4RmlsZU5hbWU6IHN0cmluZzsgY29udGVudEZvbGRlcjogc3RyaW5nIH0pOiBzdHJpbmcge1xuXG5cdFx0Y29uc3QgaGFzaEluZGV4ID0gbGluay5pbmRleE9mKCcjJyk7XG5cdFx0bGV0IHBhdGggPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoMCwgaGFzaEluZGV4KSA6IGxpbms7XG5cdFx0Y29uc3QgYW5jaG9yID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKGhhc2hJbmRleCkgOiAnJztcblxuXHRcdC8vIFVSTCBkZWNvZGUgdGhlIHBhdGggdG8gaGFuZGxlIGVuY29kZWQgY2hhcmFjdGVycyBsaWtlICUyMFxuXHRcdHBhdGggPSBkZWNvZGVVUklDb21wb25lbnQocGF0aCk7XG5cdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgXCJcIik7XG5cblxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aFxuXHRcdGxldCBiYXNlUGF0aCA9IFwiXCI7XG5cdFx0bGV0IGNvbnRlbnRGb2xkZXIgPSBcIlwiO1xuXHRcdGxldCBpbmRleEZpbGVOYW1lID0gXCJcIjtcblxuXHRcdC8vIFVzZSB0aGUgc2FtZSBsb2dpYyBhcyBnZXRDb250ZW50VHlwZUZvclBhdGggYnV0IGZvciB0aGUgdGFyZ2V0IGxpbmtcblx0XHQvLyBTdXBwb3J0IGJvdGggLm1kIGFuZCAubWR4IGV4dGVuc2lvbnMgLSB0cnkgLm1keCBmaXJzdCBpZiBsaW5rIHN1Z2dlc3RzIGl0XG5cdFx0Y29uc3QgZmlsZUV4dGVuc2lvbiA9IGxpbmsuZW5kc1dpdGgoJy5tZHgnKSA/ICcubWR4JyA6ICcubWQnO1xuXHRcdGNvbnN0IHRhcmdldENvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZUZvclBhdGgocGF0aCArIGZpbGVFeHRlbnNpb24pO1xuXG5cdFx0Ly8gSWYgdGFyZ2V0IGxpbmsgZG9lc24ndCBoYXZlIGEgY2xlYXIgY29udGVudCB0eXBlIChubyBmb2xkZXIgcGF0aCksIHVzZSBjdXJyZW50IGZpbGUncyBjb250ZW50IHR5cGVcblx0XHRpZiAoIXRhcmdldENvbnRlbnRUeXBlLmJhc2VQYXRoICYmIGN1cnJlbnRGaWxlQ29udGVudFR5cGUuYmFzZVBhdGgpIHtcblx0XHRcdGJhc2VQYXRoID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5iYXNlUGF0aDtcblx0XHRcdGluZGV4RmlsZU5hbWUgPSBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWU7XG5cdFx0XHRjb250ZW50Rm9sZGVyID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5jb250ZW50Rm9sZGVyO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRiYXNlUGF0aCA9IHRhcmdldENvbnRlbnRUeXBlLmJhc2VQYXRoO1xuXHRcdFx0aW5kZXhGaWxlTmFtZSA9IHRhcmdldENvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWU7XG5cdFx0XHRjb250ZW50Rm9sZGVyID0gdGFyZ2V0Q29udGVudFR5cGUuY29udGVudEZvbGRlcjtcblx0XHR9XG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblxuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogaWYgdGhlIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZSAocmVnYXJkbGVzcyBvZiBjcmVhdGlvbiBtb2RlKSxcblx0XHQvLyB0cmVhdCBpdCBhcyBmb2xkZXItYmFzZWQgbG9naWNcblx0XHQvLyBOb3RlOiBXZSBvbmx5IHNldCBhZGRUcmFpbGluZ1NsYXNoIGhlcmU7IHRoZSBmaW5hbCBjaGVjayB3aWxsIHByZXZlbnQgaXQgaWYgdGhlcmUncyBhbiBhbmNob3Jcblx0XHRjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcblx0XHRjb25zdCBsYXN0UGFydCA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGxhc3QgcGFydCBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgaW5kZXggZmlsZSBuYW1lXG5cdFx0aWYgKGluZGV4RmlsZU5hbWUgJiYgaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgbGFzdFBhcnQgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdH1cblx0XHQvLyBDaGVjayBpZiB0aGUgbGFzdCBwYXJ0IG1hdGNoZXMgdGhlIGRlZmF1bHQgXCJpbmRleFwiICh3aGVuIG5vIGluZGV4RmlsZU5hbWUgaXMgc3BlY2lmaWVkKVxuXHRcdGVsc2UgaWYgKCghaW5kZXhGaWxlTmFtZSB8fCBpbmRleEZpbGVOYW1lLnRyaW0oKSA9PT0gXCJcIikgJiYgbGFzdFBhcnQgPT09IFwiaW5kZXhcIikge1xuXHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3Qgc2x1Z1BhcnRzID0gcGF0aC5zcGxpdCgnLycpLm1hcChwYXJ0ID0+IHRvS2ViYWJDYXNlKHBhcnQpKTtcblx0XHRjb25zdCBzbHVnID0gc2x1Z1BhcnRzLmpvaW4oJy8nKTtcblxuXHRcdC8vIEZvcm1hdCBiYXNlIHBhdGhcblx0XHRpZiAoYmFzZVBhdGgpIHtcblx0XHRcdC8vIEFkZCBsZWFkaW5nIHNsYXNoIGlmIG5vdCBwcmVzZW50IHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRpZiAoIWJhc2VQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcblx0XHRcdH1cblx0XHRcdC8vIEFkZCB0cmFpbGluZyBzbGFzaCBpZiBub3QgcHJlc2VudFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5lbmRzV2l0aChcIi9cIikpIHtcblx0XHRcdFx0YmFzZVBhdGggKz0gXCIvXCI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFdoZW4gbm8gYmFzZSBwYXRoIGlzIHNwZWNpZmllZCwgYWRkIGxlYWRpbmcgc2xhc2ggdG8gbWFrZSBpdCBhYnNvbHV0ZSBmcm9tIHJvb3Rcblx0XHRcdGJhc2VQYXRoID0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBhZGQgdHJhaWxpbmcgc2xhc2hcblx0XHQvLyBDUklUSUNBTDogTmV2ZXIgYWRkIHRyYWlsaW5nIHNsYXNoIGJlZm9yZSBhbiBhbmNob3IgKGUuZy4sIC9hYm91dCNoZWFkaW5nIG5vdCAvYWJvdXQvI2hlYWRpbmcpXG5cdFx0Ly8gVGhpcyBpcyBlc3BlY2lhbGx5IGltcG9ydGFudCBmb3IgYW5jaG9yIGxpbmtzIGZyb20gY29weSBoZWFkaW5nIFVSTCBmdW5jdGlvbmFsaXR5XG5cdFx0Ly8gQW5jaG9yIGxpbmtzIHNob3VsZCBORVZFUiBoYXZlIHRyYWlsaW5nIHNsYXNoZXMsIHJlZ2FyZGxlc3Mgb2Ygc2V0dGluZ3Ncblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBzaG91bGRBZGRUcmFpbGluZ1NsYXNoID0gKHNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzIHx8IGFkZFRyYWlsaW5nU2xhc2gpICYmICFhbmNob3I7XG5cblx0XHRyZXR1cm4gYCR7YmFzZVBhdGh9JHtzbHVnfSR7c2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA/ICcvJyA6ICcnfSR7YW5jaG9yfWA7XG5cdH1cblxuXHRwcml2YXRlIGlzSW5Db25maWd1cmVkQ29udGVudERpcmVjdG9yeShmaWxlUGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Ly8gQ2hlY2sgYWxsIGNvbnRlbnQgdHlwZXMsIHNvcnRlZCBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIGZpcnN0KVxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5nZXRTZXR0aW5ncygpO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRjb25zdCBzb3J0ZWRUeXBlcyA9IHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eShjb250ZW50VHlwZXMpO1xuXG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRUeXBlcykge1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcblxuXHRcdFx0Ly8gSGFuZGxlIGJsYW5rIGZvbGRlciAocm9vdCkgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xuXHRcdFx0XHRpZiAoIWZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCBmaWxlUGF0aC5zcGxpdChcIi9cIikubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGgsIGNvbnRlbnRUeXBlLmZvbGRlcikpIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWdub3JlU3ViZm9sZGVycyBpZiBmb2xkZXIgaXMgc3BlY2lmaWVkXG5cdFx0XHRcdGlmIChjb250ZW50VHlwZS5pZ25vcmVTdWJmb2xkZXJzKSB7XG5cdFx0XHRcdFx0Y29uc3QgcGF0aFNlZ21lbnRzID0gZmlsZVBhdGguc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhEZXB0aCA9IHBhdGhTZWdtZW50cy5sZW5ndGg7XG5cdFx0XHRcdFx0Y29uc3QgcGF0dGVyblNlZ21lbnRzID0gY29udGVudFR5cGUuZm9sZGVyLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBleHBlY3RlZERlcHRoID0gcGF0dGVyblNlZ21lbnRzLmxlbmd0aDtcblxuXHRcdFx0XHRcdGlmIChjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmb2xkZXItYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBvbmUgbGV2ZWwgZGVlcGVyIChlLmcuLCB0ZXN0L215LWZpbGUvaW5kZXgubWQpXG5cdFx0XHRcdFx0XHQvLyBTbyB3ZSBuZWVkIHRvIGFsbG93IG9uZSBleHRyYSBsZXZlbCBiZXlvbmQgdGhlIHBhdHRlcm4gZGVwdGhcblx0XHRcdFx0XHRcdGNvbnN0IGZvbGRlckRlcHRoID0gcGF0aERlcHRoIC0gMTsgLy8gU3VidHJhY3QgMSBmb3IgdGhlIGluZGV4Lm1kIGZpbGVcblx0XHRcdFx0XHRcdGlmIChmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCB8fCBmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCArIDEpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmaWxlLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgYXQgdGhlIHNhbWUgZGVwdGggYXMgdGhlIHBhdHRlcm5cblx0XHRcdFx0XHRcdGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRDb250ZW50VHlwZUZvclBhdGgoZmlsZVBhdGg6IHN0cmluZyk6IHsgYmFzZVBhdGg6IHN0cmluZzsgY3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7IGluZGV4RmlsZU5hbWU6IHN0cmluZzsgY29udGVudEZvbGRlcjogc3RyaW5nIH0ge1xuXHRcdC8vIENoZWNrIGFsbCBjb250ZW50IHR5cGVzLCBzb3J0ZWQgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9yZSBzcGVjaWZpYyBmaXJzdClcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3Qgc29ydGVkVHlwZXMgPSBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkoY29udGVudFR5cGVzKTtcblxuXHRcdGZvciAoY29uc3QgY29udGVudFR5cGUgb2Ygc29ydGVkVHlwZXMpIHtcblx0XHRcdGlmICghY29udGVudFR5cGUuZW5hYmxlZCkgY29udGludWU7XG5cblx0XHRcdC8vIEhhbmRsZSBibGFuayBmb2xkZXIgKHJvb3QpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcblx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcblx0XHRcdFx0aWYgKCFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgZmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRiYXNlUGF0aDogY29udGVudFR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdGNvbnRlbnRGb2xkZXI6IFwiXCJcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlnbm9yZVN1YmZvbGRlcnMgaWYgZm9sZGVyIGlzIHNwZWNpZmllZFxuXHRcdFx0XHRpZiAoY29udGVudFR5cGUuaWdub3JlU3ViZm9sZGVycykge1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhTZWdtZW50cyA9IGZpbGVQYXRoLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBwYXRoRGVwdGggPSBwYXRoU2VnbWVudHMubGVuZ3RoO1xuXHRcdFx0XHRcdGNvbnN0IHBhdHRlcm5TZWdtZW50cyA9IGNvbnRlbnRUeXBlLmZvbGRlci5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgZXhwZWN0ZWREZXB0aCA9IHBhdHRlcm5TZWdtZW50cy5sZW5ndGg7XG5cblx0XHRcdFx0XHRpZiAoY29udGVudFR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRcdFx0XHQvLyBGb3IgZm9sZGVyLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgb25lIGxldmVsIGRlZXBlciAoZS5nLiwgdGVzdC9teS1maWxlL2luZGV4Lm1kKVxuXHRcdFx0XHRcdFx0Ly8gU28gd2UgbmVlZCB0byBhbGxvdyBvbmUgZXh0cmEgbGV2ZWwgYmV5b25kIHRoZSBwYXR0ZXJuIGRlcHRoXG5cdFx0XHRcdFx0XHRjb25zdCBmb2xkZXJEZXB0aCA9IHBhdGhEZXB0aCAtIDE7IC8vIFN1YnRyYWN0IDEgZm9yIHRoZSBpbmRleC5tZCBmaWxlXG5cdFx0XHRcdFx0XHRpZiAoZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggfHwgZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggKyAxKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRcdFx0YmFzZVBhdGg6IGNvbnRlbnRUeXBlLmxpbmtCYXNlUGF0aCB8fCBcIlwiLFxuXHRcdFx0XHRcdFx0XHRcdGNyZWF0aW9uTW9kZTogY29udGVudFR5cGUuY3JlYXRpb25Nb2RlLFxuXHRcdFx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdFx0XHRjb250ZW50Rm9sZGVyOiBjb250ZW50VHlwZS5mb2xkZXJcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gRm9yIGZpbGUtYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBhdCB0aGUgc2FtZSBkZXB0aCBhcyB0aGUgcGF0dGVyblxuXHRcdFx0XHRcdFx0aWYgKHBhdGhEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdGJhc2VQYXRoOiBjb250ZW50VHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIixcblx0XHRcdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdFx0XHRpbmRleEZpbGVOYW1lOiBjb250ZW50VHlwZS5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRcdFx0Y29udGVudEZvbGRlcjogY29udGVudFR5cGUuZm9sZGVyXG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRiYXNlUGF0aDogY29udGVudFR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdGNvbnRlbnRGb2xkZXI6IGNvbnRlbnRUeXBlLmZvbGRlclxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBEZWZhdWx0IGZhbGxiYWNrXG5cdFx0cmV0dXJuIHtcblx0XHRcdGJhc2VQYXRoOiBcIlwiLFxuXHRcdFx0Y3JlYXRpb25Nb2RlOiBcImZpbGVcIixcblx0XHRcdGluZGV4RmlsZU5hbWU6IFwiXCIsXG5cdFx0XHRjb250ZW50Rm9sZGVyOiBcIlwiXG5cdFx0fTtcblx0fVxuXG5cdGNvbnZlcnRXaWtpbGlua3NGb3JBc3RybyhlZGl0b3I6IEVkaXRvciwgZmlsZTogVEZpbGUgfCBudWxsKTogdm9pZCB7XG5cdFx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0bmV3IE5vdGljZShcIk5vIGFjdGl2ZSBmaWxlLlwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQcmVzZXJ2ZSBjdXJzb3IgcG9zaXRpb24gYmVmb3JlIG1vZGlmeWluZyBjb250ZW50XG5cdFx0Y29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHRcdGNvbnN0IG9yaWdpbmFsTGluZSA9IGN1cnNvci5saW5lO1xuXHRcdGNvbnN0IG9yaWdpbmFsQ2ggPSBjdXJzb3IuY2g7XG5cdFx0Y29uc3Qgb3JpZ2luYWxDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG5cdFx0Y29uc3Qgb3JpZ2luYWxMaW5lQ291bnQgPSBvcmlnaW5hbENvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcblx0XHRjb25zdCBvcmlnaW5hbExpbmVMZW5ndGggPSBvcmlnaW5hbENvbnRlbnQuc3BsaXQoJ1xcbicpW29yaWdpbmFsTGluZV0/Lmxlbmd0aCB8fCAwO1xuXG5cdFx0Y29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuXHRcdGxldCBuZXdDb250ZW50ID0gY29udGVudDtcblx0XHRsZXQgY29udmVydGVkQ291bnQgPSAwO1xuXHRcdGxldCBza2lwcGVkQ291bnQgPSAwO1xuXHRcdGNvbnN0IHNraXBwZWRMaW5rczogc3RyaW5nW10gPSBbXTtcblxuXHRcdC8vIERldGVybWluZSB0aGUgY3VycmVudCBmaWxlJ3MgY29udGVudCB0eXBlIGZvciByZWxhdGl2ZSBsaW5rc1xuXHRcdGNvbnN0IGN1cnJlbnRGaWxlQ29udGVudFR5cGUgPSB0aGlzLmdldENvbnRlbnRUeXBlRm9yUGF0aChmaWxlLnBhdGgpO1xuXG5cdFx0Ly8gRGVmaW5lIGNvbW1vbiBpbWFnZSBleHRlbnNpb25zXG5cdFx0Y29uc3QgaW1hZ2VFeHRlbnNpb25zID0gL1xcLihwbmd8anBnfGpwZWd8Z2lmfHN2ZykkL2k7XG5cblx0XHQvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgaWYgYSBsaW5rIGNhbiBiZSByZWxpYWJseSBjb252ZXJ0ZWRcblx0XHRjb25zdCBjYW5Db252ZXJ0TGluayA9IChsaW5rVGV4dDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGlmIGl0J3MgYW4gaW1hZ2Vcblx0XHRcdGlmIChpbWFnZUV4dGVuc2lvbnMudGVzdChsaW5rVGV4dCkpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGV4dGVybmFsIGxpbmtzXG5cdFx0XHRpZiAobGlua1RleHQubWF0Y2goL15odHRwcz86XFwvXFwvLykpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGlmIGl0J3Mgbm90IGEgLm1kIG9yIC5tZHggZmlsZSBhbmQgZG9lc24ndCBsb29rIGxpa2UgYSB2YWxpZCBpbnRlcm5hbCBsaW5rXG5cdFx0XHRpZiAoIWxpbmtUZXh0LmluY2x1ZGVzKCcubWQnKSAmJiAhbGlua1RleHQuaW5jbHVkZXMoJy5tZHgnKSAmJiAhbGlua1RleHQubWF0Y2goL15bYS16QS1aMC05Xy1dKyhcXC9bYS16QS1aMC05Xy1dKykqJC8pKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIHRhcmdldCBmaWxlIGlzIGluIGFueSBjb25maWd1cmVkIGNvbnRlbnQgZGlyZWN0b3J5XG5cdFx0XHQvLyBTdXBwb3J0IGJvdGggLm1kIGFuZCAubWR4IGV4dGVuc2lvbnNcblx0XHRcdGxldCB0YXJnZXRQYXRoOiBzdHJpbmc7XG5cdFx0XHRpZiAobGlua1RleHQuZW5kc1dpdGgoJy5tZCcpIHx8IGxpbmtUZXh0LmVuZHNXaXRoKCcubWR4JykpIHtcblx0XHRcdFx0dGFyZ2V0UGF0aCA9IGxpbmtUZXh0O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRGVmYXVsdCB0byAubWQgaWYgbm8gZXh0ZW5zaW9uIHNwZWNpZmllZFxuXHRcdFx0XHR0YXJnZXRQYXRoID0gbGlua1RleHQgKyAnLm1kJztcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBpbiBhIGNvbmZpZ3VyZWQgY29udGVudCBkaXJlY3Rvcnlcblx0XHRcdGNvbnN0IGlzSW5Db25maWd1cmVkRGlyZWN0b3J5ID0gdGhpcy5pc0luQ29uZmlndXJlZENvbnRlbnREaXJlY3RvcnkodGFyZ2V0UGF0aCk7XG5cblx0XHRcdC8vIEFsc28gY2hlY2sgaWYgaXQncyBhIHNpbXBsZSBmaWxlbmFtZSAobm8gcGF0aCkgYW5kIGN1cnJlbnQgZmlsZSBoYXMgYSBjb250ZW50IHR5cGVcblx0XHRcdGNvbnN0IGlzU2ltcGxlRmlsZW5hbWUgPSAhdGFyZ2V0UGF0aC5pbmNsdWRlcygnLycpO1xuXHRcdFx0Y29uc3QgaGFzQ3VycmVudENvbnRlbnRUeXBlID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5iYXNlUGF0aCAhPT0gXCJcIiB8fCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSAhPT0gXCJmaWxlXCIgfHwgY3VycmVudEZpbGVDb250ZW50VHlwZS5pbmRleEZpbGVOYW1lICE9PSBcIlwiO1xuXG5cdFx0XHRyZXR1cm4gaXNJbkNvbmZpZ3VyZWREaXJlY3RvcnkgfHwgKGlzU2ltcGxlRmlsZW5hbWUgJiYgaGFzQ3VycmVudENvbnRlbnRUeXBlKTtcblx0XHR9O1xuXG5cdFx0Ly8gSGFuZGxlIHJlZ3VsYXIgV2lraWxpbmtzIChub24taW1hZ2UpXG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZShcblx0XHRcdC9cXFtcXFsoW15cXF18XSspKFxcfChbXlxcXV0rKSk/XFxdXFxdL2csXG5cdFx0XHQobWF0Y2g6IHN0cmluZywgbGlua1RleHQ6IHN0cmluZywgX3BpcGU6IHN0cmluZyB8IHVuZGVmaW5lZCwgZGlzcGxheVRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuXHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGFuIGltYWdlIFdpa2lsaW5rXG5cdFx0XHRcdGlmIChpbWFnZUV4dGVuc2lvbnMudGVzdChsaW5rVGV4dCkpIHtcblx0XHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChsaW5rVGV4dCk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgYW5kIHJldHVybiBvcmlnaW5hbCBpbWFnZSBXaWtpbGlua1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgd2UgY2FuIHJlbGlhYmx5IGNvbnZlcnQgdGhpcyBsaW5rXG5cdFx0XHRcdGlmICghY2FuQ29udmVydExpbmsobGlua1RleHQpKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGlua1RleHQpO1xuXHRcdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gUmV0dXJuIG9yaWdpbmFsIGlmIHdlIGNhbid0IGNvbnZlcnQgcmVsaWFibHlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGRpc3BsYXkgPSBkaXNwbGF5VGV4dCB8fCBsaW5rVGV4dC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCBcIlwiKTtcblxuXHRcdFx0XHQvLyBGb3IgcmVsYXRpdmUgbGlua3MgKG5vIGZvbGRlciBwYXRoKSwgdXNlIGN1cnJlbnQgZmlsZSdzIGNvbnRlbnQgdHlwZVxuXHRcdFx0XHRjb25zdCB1cmwgPSB0aGlzLmdldEFzdHJvVXJsRnJvbUludGVybmFsTGlua1dpdGhDb250ZXh0KGxpbmtUZXh0LCBmaWxlLnBhdGgsIGN1cnJlbnRGaWxlQ29udGVudFR5cGUpO1xuXG5cdFx0XHRcdGNvbnZlcnRlZENvdW50Kys7XG5cdFx0XHRcdHJldHVybiBgWyR7ZGlzcGxheX1dKCR7dXJsfSlgO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHQvLyBIYW5kbGUgc3RhbmRhcmQgTWFya2Rvd24gbGlua3MgKG5vbi1pbWFnZSwgbm9uLWV4dGVybmFsKVxuXHRcdC8vIE9ubHkgcHJvY2VzcyBsaW5rcyB0aGF0IGNvbnRhaW4gLm1kIG9yIC5tZHggdG8gYXZvaWQgcHJvY2Vzc2luZyBhbHJlYWR5LWNvbnZlcnRlZCBsaW5rc1xuXHRcdG5ld0NvbnRlbnQgPSBuZXdDb250ZW50LnJlcGxhY2UoXG5cdFx0XHQvXFxbKFteXFxdXSspXFxdXFwoKFteKV0rXFwuKG1kfG1keClbXildKilcXCkvZyxcblx0XHRcdChtYXRjaDogc3RyaW5nLCBkaXNwbGF5VGV4dDogc3RyaW5nLCBsaW5rOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhbiBpbWFnZSBsaW5rIG9yIGV4dGVybmFsIGxpbmtcblx0XHRcdFx0aWYgKGxpbmsubWF0Y2goL15odHRwcz86XFwvXFwvLykgfHwgaW1hZ2VFeHRlbnNpb25zLnRlc3QobGluaykpIHtcblx0XHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIElnbm9yZSBleHRlcm5hbCBvciBpbWFnZSBsaW5rc1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgd2UgY2FuIHJlbGlhYmx5IGNvbnZlcnQgdGhpcyBsaW5rXG5cdFx0XHRcdGlmICghY2FuQ29udmVydExpbmsobGluaykpIHtcblx0XHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIFJldHVybiBvcmlnaW5hbCBpZiB3ZSBjYW4ndCBjb252ZXJ0IHJlbGlhYmx5XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCB1cmwgPSB0aGlzLmdldEFzdHJvVXJsRnJvbUludGVybmFsTGlua1dpdGhDb250ZXh0KGxpbmssIGZpbGUucGF0aCwgY3VycmVudEZpbGVDb250ZW50VHlwZSk7XG5cblx0XHRcdFx0Y29udmVydGVkQ291bnQrKztcblx0XHRcdFx0cmV0dXJuIGBbJHtkaXNwbGF5VGV4dH1dKCR7dXJsfSlgO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHQvLyBIYW5kbGUgaW1hZ2UgbGlua3MgaW4gTWFya2Rvd24gZm9ybWF0IChlLmcuLCAhW0ltYWdlXShtb3VudGFpbnMucG5nKSlcblx0XHRuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKFxuXHRcdFx0LyFcXFsoLio/KVxcXVxcKChbXildKylcXCkvZyxcblx0XHRcdChtYXRjaDogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdHNraXBwZWRDb3VudCsrO1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIElnbm9yZSBhbGwgaW1hZ2UgbGlua3Ncblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0Ly8gSGFuZGxlIHt7ZW1iZWR9fSBzeW50YXhcblx0XHRuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKC9cXHtcXHsoW159XSspXFx9XFx9L2csIChtYXRjaDogc3RyaW5nLCBmaWxlTmFtZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRpZiAoaW1hZ2VFeHRlbnNpb25zLnRlc3QoZmlsZU5hbWUpKSB7XG5cdFx0XHRcdHNraXBwZWRDb3VudCsrO1xuXHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChmaWxlTmFtZSk7XG5cdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gSWdub3JlIGVtYmVkZGVkIGltYWdlc1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGVjayBpZiB3ZSBjYW4gcmVsaWFibHkgY29udmVydCB0aGlzIGxpbmtcblx0XHRcdGlmICghY2FuQ29udmVydExpbmsoZmlsZU5hbWUpKSB7XG5cdFx0XHRcdHNraXBwZWRDb3VudCsrO1xuXHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChmaWxlTmFtZSk7XG5cdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gUmV0dXJuIG9yaWdpbmFsIGlmIHdlIGNhbid0IGNvbnZlcnQgcmVsaWFibHlcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChmaWxlTmFtZSwgZmlsZS5wYXRoLCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlKTtcblxuXHRcdFx0Y29udmVydGVkQ291bnQrKztcblx0XHRcdHJldHVybiBgW0VtYmVkZGVkOiAke2ZpbGVOYW1lfV0oJHt1cmx9KWA7XG5cdFx0fSk7XG5cblx0XHRlZGl0b3Iuc2V0VmFsdWUobmV3Q29udGVudCk7XG5cblx0XHQvLyBSZXN0b3JlIGN1cnNvciBwb3NpdGlvbiwgYWRqdXN0aW5nIGZvciBjb250ZW50IGNoYW5nZXNcblx0XHRjb25zdCBuZXdMaW5lQ291bnQgPSBuZXdDb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG5cdFx0Y29uc3QgbmV3TGluZUxlbmd0aCA9IG5ld0NvbnRlbnQuc3BsaXQoJ1xcbicpW29yaWdpbmFsTGluZV0/Lmxlbmd0aCB8fCAwO1xuXG5cdFx0Ly8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb25cblx0XHRsZXQgbmV3TGluZSA9IG9yaWdpbmFsTGluZTtcblx0XHRsZXQgbmV3Q2ggPSBvcmlnaW5hbENoO1xuXG5cdFx0Ly8gSWYgY29udGVudCBsZW5ndGggY2hhbmdlZCwgYWRqdXN0IGN1cnNvciBwb3NpdGlvblxuXHRcdGlmIChuZXdMaW5lQ291bnQgIT09IG9yaWdpbmFsTGluZUNvdW50KSB7XG5cdFx0XHQvLyBJZiBsaW5lcyB3ZXJlIGFkZGVkL3JlbW92ZWQgYmVmb3JlIGN1cnNvciwgYWRqdXN0IGxpbmUgbnVtYmVyXG5cdFx0XHQvLyBGb3Igc2ltcGxpY2l0eSwga2VlcCBzYW1lIGxpbmUgaWYgaXQgc3RpbGwgZXhpc3RzLCBvdGhlcndpc2UgY2xhbXAgdG8gZW5kXG5cdFx0XHRpZiAobmV3TGluZSA+PSBuZXdMaW5lQ291bnQpIHtcblx0XHRcdFx0bmV3TGluZSA9IE1hdGgubWF4KDAsIG5ld0xpbmVDb3VudCAtIDEpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkanVzdCBjb2x1bW4gcG9zaXRpb24gaWYgbGluZSBsZW5ndGggY2hhbmdlZFxuXHRcdGlmIChuZXdMaW5lTGVuZ3RoICE9PSBvcmlnaW5hbExpbmVMZW5ndGgpIHtcblx0XHRcdC8vIElmIGxpbmUgZ290IHNob3J0ZXIsIGNsYW1wIHRvIGVuZCBvZiBsaW5lXG5cdFx0XHRpZiAobmV3Q2ggPiBuZXdMaW5lTGVuZ3RoKSB7XG5cdFx0XHRcdG5ld0NoID0gTWF0aC5tYXgoMCwgbmV3TGluZUxlbmd0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb25cblx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbmV3TGluZSwgY2g6IG5ld0NoIH0pO1xuXG5cdFx0Ly8gU2hvdyBhcHByb3ByaWF0ZSBub3RpY2UgYmFzZWQgb24gcmVzdWx0c1xuXHRcdGlmIChjb252ZXJ0ZWRDb3VudCA+IDAgJiYgc2tpcHBlZENvdW50ID09PSAwKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb252ZXJ0ZWQgJHtjb252ZXJ0ZWRDb3VudH0gaW50ZXJuYWwgbGluayR7Y29udmVydGVkQ291bnQgPiAxID8gJ3MnIDogJyd9IGZvciBBc3Ryby5gKTtcblx0XHR9IGVsc2UgaWYgKGNvbnZlcnRlZENvdW50ID4gMCAmJiBza2lwcGVkQ291bnQgPiAwKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb252ZXJ0ZWQgJHtjb252ZXJ0ZWRDb3VudH0gbGluayR7Y29udmVydGVkQ291bnQgPiAxID8gJ3MnIDogJyd9IGZvciBBc3Ryby4gU2tpcHBlZCAke3NraXBwZWRDb3VudH0gbGluayR7c2tpcHBlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBvdXRzaWRlIGNvbmZpZ3VyZWQgY29udGVudCBkaXJlY3Rvcmllcy5gKTtcblx0XHR9IGVsc2UgaWYgKHNraXBwZWRDb3VudCA+IDApIHtcblx0XHRcdG5ldyBOb3RpY2UoYE5vIGxpbmtzIGNvbnZlcnRlZC4gQWxsICR7c2tpcHBlZENvdW50fSBsaW5rJHtza2lwcGVkQ291bnQgPiAxID8gJ3MnIDogJyd9IGFyZSBvdXRzaWRlIGNvbmZpZ3VyZWQgY29udGVudCBkaXJlY3RvcmllcyBvciBhcmUgaW1hZ2VzL2V4dGVybmFsIGxpbmtzLmApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiTm8gaW50ZXJuYWwgbGlua3MgZm91bmQgdG8gY29udmVydC5cIik7XG5cdFx0fVxuXHR9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgVEZpbGUsIE5vdGljZSwgUGxhdGZvcm0sIE1hcmtkb3duVmlldyB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgQ29udGVudFR5cGVJZCB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgRmlsZU9wZXJhdGlvbnMgfSBmcm9tIFwiLi4vdXRpbHMvZmlsZS1vcGVyYXRpb25zXCI7XG5pbXBvcnQgeyBUZW1wbGF0ZVBhcnNlciB9IGZyb20gXCIuLi91dGlscy90ZW1wbGF0ZS1wYXJzaW5nXCI7XG5pbXBvcnQgeyB0b0tlYmFiQ2FzZSB9IGZyb20gXCIuLi91dGlscy9zdHJpbmctdXRpbHNcIjtcblxuZXhwb3J0IGNsYXNzIFRpdGxlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cdGZpbGU6IFRGaWxlIHwgbnVsbDtcblx0cGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xuXHR0eXBlOiBDb250ZW50VHlwZUlkO1xuXHRpc1JlbmFtZTogYm9vbGVhbjtcblx0aXNOZXdOb3RlOiBib29sZWFuO1xuXHR0aXRsZUlucHV0ITogSFRNTElucHV0RWxlbWVudDtcblx0cHJpdmF0ZSBmaWxlT3BzOiBGaWxlT3BlcmF0aW9ucztcblx0cHJpdmF0ZSB0ZW1wbGF0ZVBhcnNlcjogVGVtcGxhdGVQYXJzZXI7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlIHwgbnVsbCwgcGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCB0eXBlOiBDb250ZW50VHlwZUlkLCBpc1JlbmFtZSA9IGZhbHNlLCBpc05ld05vdGUgPSBmYWxzZSkge1xuXHRcdHN1cGVyKGFwcCk7XG5cdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLnR5cGUgPSB0eXBlO1xuXHRcdHRoaXMuaXNSZW5hbWUgPSBpc1JlbmFtZTtcblx0XHR0aGlzLmlzTmV3Tm90ZSA9IGlzTmV3Tm90ZTtcblxuXHRcdC8vIEluaXRpYWxpemUgdXRpbGl0aWVzIHdpdGggY3VycmVudCBzZXR0aW5nc1xuXHRcdC8vIEZpbGVPcGVyYXRpb25zIHdpbGwgZ2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGR5bmFtaWNhbGx5XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSBwbHVnaW4uc2V0dGluZ3M7XG5cdFx0dGhpcy5maWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKGFwcCwgc2V0dGluZ3MsIHBsdWdpbik7XG5cdFx0dGhpcy50ZW1wbGF0ZVBhcnNlciA9IG5ldyBUZW1wbGF0ZVBhcnNlcihhcHAsIHNldHRpbmdzKTtcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRUaXRsZUFzeW5jKCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmZpbGUpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdC8vIFJlYWQgdGhlIGZpbGUgY29udGVudCBkaXJlY3RseSB0byBlbnN1cmUgd2UgaGF2ZSB0aGUgbGF0ZXN0IHRpdGxlXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSk7XG5cdFx0XHRjb25zdCB0aXRsZUtleSA9IHRoaXMuZmlsZU9wcy5nZXRUaXRsZUtleSh0aGlzLnR5cGUpO1xuXHRcdFx0Y29uc3QgeyBwcm9wZXJ0aWVzIH0gPSB0aGlzLnRlbXBsYXRlUGFyc2VyLnBhcnNlRnJvbnRtYXR0ZXIoY29udGVudCk7XG5cblx0XHRcdGlmICh0aXRsZUtleSBpbiBwcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdGNvbnN0IHRpdGxlVmFsdWUgPSBwcm9wZXJ0aWVzW3RpdGxlS2V5XTtcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodGl0bGVWYWx1ZSkgJiYgdGl0bGVWYWx1ZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0cmV0dXJuIFN0cmluZyh0aXRsZVZhbHVlWzBdKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAodGl0bGVWYWx1ZSAhPT0gbnVsbCAmJiB0aXRsZVZhbHVlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRyZXR1cm4gU3RyaW5nKHRpdGxlVmFsdWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZWFkaW5nIGZpbGUgZm9yIHRpdGxlOlwiLCBlcnJvcik7XG5cdFx0fVxuXG5cdFx0Ly8gRmFsbCBiYWNrIHRvIGZpbGVuYW1lLWJhc2VkIHRpdGxlXG5cdFx0cmV0dXJuIHRoaXMuZ2V0RmFsbGJhY2tUaXRsZSgpO1xuXHR9XG5cblx0Z2V0Q3VycmVudFRpdGxlKCk6IHN0cmluZyB7XG5cdFx0aWYgKCF0aGlzLmZpbGUpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdGNvbnN0IHRpdGxlS2V5ID0gdGhpcy5maWxlT3BzLmdldFRpdGxlS2V5KHRoaXMudHlwZSk7XG5cdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpO1xuXG5cdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiB0aXRsZUtleSBpbiBjYWNoZS5mcm9udG1hdHRlcikge1xuXHRcdFx0Y29uc3QgdGl0bGVWYWx1ZSA9IGNhY2hlLmZyb250bWF0dGVyW3RpdGxlS2V5XSBhcyB1bmtub3duO1xuXHRcdFx0aWYgKHR5cGVvZiB0aXRsZVZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRyZXR1cm4gdGl0bGVWYWx1ZTtcblx0XHRcdH1cblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHRpdGxlVmFsdWUpICYmIHRpdGxlVmFsdWUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCBmaXJzdFZhbHVlID0gdGl0bGVWYWx1ZVswXSBhcyB1bmtub3duO1xuXHRcdFx0XHRpZiAodHlwZW9mIGZpcnN0VmFsdWUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZpcnN0VmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGZpcnN0VmFsdWUgIT0gbnVsbCkge1xuXHRcdFx0XHRcdGlmICh0eXBlb2YgZmlyc3RWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGZpcnN0VmFsdWUgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRcdFx0cmV0dXJuIFN0cmluZyhmaXJzdFZhbHVlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBmaXJzdFZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZpcnN0VmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAodGl0bGVWYWx1ZSA9PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybiAnJztcblx0XHRcdH1cblx0XHRcdGlmICh0eXBlb2YgdGl0bGVWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHRpdGxlVmFsdWUgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRyZXR1cm4gU3RyaW5nKHRpdGxlVmFsdWUpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHR5cGVvZiB0aXRsZVZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRyZXR1cm4gdGl0bGVWYWx1ZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiAnJztcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuZ2V0RmFsbGJhY2tUaXRsZSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRGYWxsYmFja1RpdGxlKCk6IHN0cmluZyB7XG5cdFx0aWYgKCF0aGlzLmZpbGUpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdGxldCBiYXNlbmFtZSA9IHRoaXMuZmlsZS5iYXNlbmFtZTtcblx0XHRpZiAodGhpcy5maWxlLnBhcmVudCAmJiB0aGlzLnR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0XHRpZiAoaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdFx0YmFzZW5hbWUgPSB0aGlzLmZpbGUucGFyZW50Lm5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChiYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSkge1xuXHRcdFx0YmFzZW5hbWUgPSBiYXNlbmFtZS5zbGljZSgxKTtcblx0XHR9XG5cdFx0cmV0dXJuIGJhc2VuYW1lLnJlcGxhY2UoLy0vZywgXCIgXCIpLnNwbGl0KFwiIFwiKS5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSkuam9pbihcIiBcIik7XG5cdH1cblxuXHQvKipcblx0ICogRXh0cmFjdHMgYSBzdWdnZXN0ZWQgdGl0bGUgZnJvbSB0aGUgZmlsZSBiYXNlbmFtZSBmb3IgbmV3bHkgY3JlYXRlZCBmaWxlcy5cblx0ICogVGhpcyBpcyB1c2VkIHdoZW4gYSBmaWxlIGlzIGNyZWF0ZWQgZnJvbSBhIGxpbmsgKGUuZy4sIFtbc0Vmc2xlaWZdXSkuXG5cdCAqIFByZXNlcnZlcyB0aGUgb3JpZ2luYWwgdGV4dCBhcyBtdWNoIGFzIHBvc3NpYmxlLlxuXHQgKi9cblx0Z2V0U3VnZ2VzdGVkVGl0bGVGcm9tQmFzZW5hbWUoKTogc3RyaW5nIHtcblx0XHRpZiAoIXRoaXMuZmlsZSkge1xuXHRcdFx0cmV0dXJuIFwiXCI7XG5cdFx0fVxuXG5cdFx0bGV0IGJhc2VuYW1lID0gdGhpcy5maWxlLmJhc2VuYW1lO1xuXG5cdFx0Ly8gSGFuZGxlIGluZGV4IGZpbGUgbmFtZXMgLSB1c2UgcGFyZW50IGZvbGRlciBuYW1lIGluc3RlYWRcblx0XHRpZiAodGhpcy5maWxlLnBhcmVudCAmJiB0aGlzLnR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0XHRpZiAoaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdFx0YmFzZW5hbWUgPSB0aGlzLmZpbGUucGFyZW50Lm5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGxlYWRpbmcgdW5kZXJzY29yZSBpZiBwcmVzZW50XG5cdFx0aWYgKGJhc2VuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpKSB7XG5cdFx0XHRiYXNlbmFtZSA9IGJhc2VuYW1lLnNsaWNlKDEpO1xuXHRcdH1cblxuXHRcdC8vIFJldHVybiB0aGUgYmFzZW5hbWUgYXMtaXMgdG8gcHJlc2VydmUgdXNlcidzIG9yaWdpbmFsIGlucHV0XG5cdFx0Ly8gKGUuZy4sIFwic0Vmc2xlaWZcIiBzdGF5cyBhcyBcInNFZnNsZWlmXCIpXG5cdFx0cmV0dXJuIGJhc2VuYW1lO1xuXHR9XG5cblx0b25PcGVuKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXG5cdFx0Ly8gQWRkIG1vYmlsZS1mcmllbmRseSBwb3NpdGlvbmluZyBjbGFzcyAtIGNoZWNrIGJvdGggd2lkdGggYW5kIHBsYXRmb3JtXG5cdFx0Y29uc3QgaXNNb2JpbGUgPSB3aW5kb3cuaW5uZXJXaWR0aCA8PSA3NjggfHwgUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHR0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLW1vYmlsZS1tb2RhbCcpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmlzUmVuYW1lKSB7XG5cdFx0XHRjb25zdCB0eXBlTmFtZSA9IHRoaXMuZ2V0VHlwZURpc3BsYXlOYW1lKCk7XG5cblx0XHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHRcdC8vIEZvciBnZW5lcmljIG5vdGVzIG91dHNpZGUgb2YgYW55IGtub3duIGNvbnRlbnQgdHlwZVxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiUmVuYW1lIGNvbnRlbnRcIiB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiRW50ZXIgYSB0aXRsZSBmb3IgdGhpcyBjb250ZW50OlwiIH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBgUmVuYW1lICR7dHlwZU5hbWV9IGNvbnRlbnRgIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYEVudGVyIG5ldyB0aXRsZSBmb3IgeW91ciAke3R5cGVOYW1lfSBjb250ZW50OmAgfSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMudGl0bGVJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcblx0XHRcdFx0dHlwZTogXCJ0ZXh0XCIsXG5cdFx0XHRcdHBsYWNlaG9sZGVyOiBcIk5ldyBUaXRsZVwiLFxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItdGl0bGUtaW5wdXRcIlxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEFzeW5jIGxvYWQgdGhlIGN1cnJlbnQgdGl0bGUgZnJvbSBmaWxlXG5cdFx0XHR2b2lkIHRoaXMuZ2V0Q3VycmVudFRpdGxlQXN5bmMoKS50aGVuKHRpdGxlID0+IHtcblx0XHRcdFx0dGhpcy50aXRsZUlucHV0LnZhbHVlID0gdGl0bGU7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYgKHRoaXMuaXNOZXdOb3RlKSB7XG5cdFx0XHRjb25zdCB0eXBlTmFtZSA9IHRoaXMuZ2V0VHlwZURpc3BsYXlOYW1lKCk7XG5cblx0XHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJOZXcgY29udGVudFwiIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJFbnRlciBhIHRpdGxlIGZvciB0aGlzIGNvbnRlbnQ6XCIgfSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IGBDcmVhdGUgbmV3ICR7dHlwZU5hbWV9IGNvbnRlbnRgIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYEVudGVyIGEgdGl0bGUgZm9yIHlvdXIgbmV3ICR7dHlwZU5hbWV9IGNvbnRlbnQ6YCB9KTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy50aXRsZUlucHV0ID0gY29udGVudEVsLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuXHRcdFx0XHR0eXBlOiBcInRleHRcIixcblx0XHRcdFx0cGxhY2Vob2xkZXI6IFwiTmV3IFRpdGxlXCIsXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci10aXRsZS1pbnB1dFwiXG5cdFx0XHR9KTtcblx0XHRcdC8vIExlYXZlIGlucHV0IGVtcHR5IGZvciBuZXcgbm90ZXMgLSB1c2VyIGNhbiB0eXBlIGRpcmVjdGx5XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IHR5cGVOYW1lID0gdGhpcy5nZXRUeXBlRGlzcGxheU5hbWUoKTtcblxuXHRcdFx0aWYgKHRoaXMudHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIk5ldyBjb250ZW50XCIgfSk7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIkVudGVyIGEgdGl0bGUgZm9yIHRoaXMgY29udGVudDpcIiB9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogYENyZWF0ZSBuZXcgJHt0eXBlTmFtZX0gY29udGVudGAgfSk7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBgRW50ZXIgYSB0aXRsZSBmb3IgeW91ciBuZXcgJHt0eXBlTmFtZX0gY29udGVudDpgIH0pO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnRpdGxlSW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG5cdFx0XHRcdHR5cGU6IFwidGV4dFwiLFxuXHRcdFx0XHRwbGFjZWhvbGRlcjogXCJOZXcgVGl0bGVcIixcblx0XHRcdFx0Y2xzOiBcImFzdHJvLWNvbXBvc2VyLXRpdGxlLWlucHV0XCJcblx0XHRcdH0pO1xuXHRcdFx0Ly8gUHJlLXBvcHVsYXRlIHdpdGggc3VnZ2VzdGVkIHRpdGxlIGZyb20gYmFzZW5hbWUgaWYgYXZhaWxhYmxlXG5cdFx0XHQvLyBUaGlzIGhhbmRsZXMgZmlsZXMgY3JlYXRlZCBmcm9tIGxpbmtzIChlLmcuLCBbW3NFZnNsZWlmXV0pXG5cdFx0XHRpZiAodGhpcy5maWxlKSB7XG5cdFx0XHRcdGNvbnN0IHN1Z2dlc3RlZFRpdGxlID0gdGhpcy5nZXRTdWdnZXN0ZWRUaXRsZUZyb21CYXNlbmFtZSgpO1xuXHRcdFx0XHRpZiAoc3VnZ2VzdGVkVGl0bGUpIHtcblx0XHRcdFx0XHR0aGlzLnRpdGxlSW5wdXQudmFsdWUgPSBzdWdnZXN0ZWRUaXRsZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLnRpdGxlSW5wdXQuZm9jdXMoKTtcblx0XHQvLyBGb3IgbmV3IG5vdGVzLCBlbnN1cmUgY3Vyc29yIGlzIGF0IHRoZSBzdGFydCAocG9zaXRpb24gMClcblx0XHRpZiAodGhpcy5pc05ld05vdGUpIHtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRpdGxlSW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgMCk7XG5cdFx0XHR9LCAwKTtcblx0XHR9XG5cblx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImFzdHJvLWNvbXBvc2VyLWJ1dHRvbi1jb250YWluZXJcIiB9KTtcblxuXHRcdGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiQ2FuY2VsXCIsIGNsczogXCJhc3Ryby1jb21wb3Nlci1jYW5jZWwtYnV0dG9uXCIgfSk7XG5cdFx0Y2FuY2VsQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmNsb3NlKCk7XG5cblx0XHRjb25zdCBzdWJtaXRCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiB0aGlzLmlzUmVuYW1lID8gXCJSZW5hbWVcIiA6IFwiQ3JlYXRlXCIsIGNsczogW1wiYXN0cm8tY29tcG9zZXItY3JlYXRlLWJ1dHRvblwiLCBcIm1vZC1jdGFcIl0gfSk7XG5cdFx0c3VibWl0QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnN1Ym1pdCgpO1xuXG5cdFx0dGhpcy50aXRsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlwcmVzc1wiLCAoZSkgPT4ge1xuXHRcdFx0aWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHZvaWQgdGhpcy5zdWJtaXQoKTtcblx0XHR9KTtcblx0fVxuXG5cdGFzeW5jIHN1Ym1pdCgpIHtcblx0XHRjb25zdCB0aXRsZSA9IHRoaXMudGl0bGVJbnB1dC52YWx1ZS50cmltKCk7XG5cblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiUGxlYXNlIGVudGVyIGEgdGl0bGUuXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRsZXQgbmV3RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcblx0XHRcdGlmICh0aGlzLmlzUmVuYW1lKSB7XG5cdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmZpbGVPcHMucmVuYW1lRmlsZSh7IGZpbGU6IHRoaXMuZmlsZSEsIHRpdGxlLCB0eXBlOiB0aGlzLnR5cGUgfSk7XG5cblx0XHRcdFx0aWYgKG5ld0ZpbGUpIHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnRlbXBsYXRlUGFyc2VyLnVwZGF0ZVRpdGxlSW5Gcm9udG1hdHRlcihuZXdGaWxlLCB0aXRsZSwgdGhpcy50eXBlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyByZW5hbWVGaWxlIGFscmVhZHkgc2hvd2VkIGFuIGVycm9yIG5vdGljZSwgY2xvc2UgbW9kYWwgYW5kIHJldHVyblxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAodGhpcy5pc05ld05vdGUpIHtcblx0XHRcdFx0Ly8gUHJvY2VzcyB0aGUgXCJVbnRpdGxlZFwiIGZpbGUgLSByZW5hbWUgaXQgYW5kIGFkZCBwcm9wZXJ0aWVzXG5cdFx0XHRcdC8vIFRoaXMgcmVzcGVjdHMgY3JlYXRpb25Nb2RlIChmb2xkZXIgdnMgZmlsZSkgYW5kIGRvZXNuJ3QgcmVxdWlyZSBkZWxldGlvblxuXHRcdFx0XHRpZiAodGhpcy5maWxlKSB7XG5cdFx0XHRcdFx0bmV3RmlsZSA9IGF3YWl0IHRoaXMuZmlsZU9wcy5jcmVhdGVGaWxlKHsgZmlsZTogdGhpcy5maWxlLCB0aXRsZSwgdHlwZTogdGhpcy50eXBlIH0pO1xuXHRcdFx0XHRcdC8vIEFsd2F5cyBpbnNlcnQgcHJvcGVydGllcyB3aGVuIGF1dG9JbnNlcnRQcm9wZXJ0aWVzIGlzIGVuYWJsZWRcblx0XHRcdFx0XHRjb25zdCBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXM7XG5cblx0XHRcdFx0XHRpZiAobmV3RmlsZSAmJiBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmFkZFByb3BlcnRpZXNUb0ZpbGUobmV3RmlsZSwgdGl0bGUsIHRoaXMudHlwZSk7XG5cdFx0XHRcdFx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYXQgZW5kIGFmdGVyIHByb3BlcnRpZXMgYXJlIGFkZGVkXG5cdFx0XHRcdFx0XHR0aGlzLnBvc2l0aW9uQ3Vyc29yQXRFbmQobmV3RmlsZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMuZmlsZSkge1xuXHRcdFx0XHQvLyBXZSBoYXZlIGFuIGV4aXN0aW5nIGZpbGUsIHByb2Nlc3MgaXRcblx0XHRcdFx0bmV3RmlsZSA9IGF3YWl0IHRoaXMuZmlsZU9wcy5jcmVhdGVGaWxlKHsgZmlsZTogdGhpcy5maWxlLCB0aXRsZSwgdHlwZTogdGhpcy50eXBlIH0pO1xuXHRcdFx0XHQvLyBBbHdheXMgaW5zZXJ0IHByb3BlcnRpZXMgd2hlbiBhdXRvSW5zZXJ0UHJvcGVydGllcyBpcyBlbmFibGVkXG5cdFx0XHRcdGNvbnN0IHNob3VsZEluc2VydFByb3BlcnRpZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvSW5zZXJ0UHJvcGVydGllcztcblxuXHRcdFx0XHRpZiAobmV3RmlsZSAmJiBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5hZGRQcm9wZXJ0aWVzVG9GaWxlKG5ld0ZpbGUsIHRpdGxlLCB0aGlzLnR5cGUpO1xuXHRcdFx0XHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCBlbmQgYWZ0ZXIgcHJvcGVydGllcyBhcmUgYWRkZWRcblx0XHRcdFx0XHR0aGlzLnBvc2l0aW9uQ3Vyc29yQXRFbmQobmV3RmlsZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZhbGxiYWNrIC0gY3JlYXRlIG5ldyBmaWxlXG5cdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmNyZWF0ZU5ld0ZpbGUodGl0bGUpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIW5ld0ZpbGUpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvICR7dGhpcy5pc1JlbmFtZSA/IFwicmVuYW1lXCIgOiBcImNyZWF0ZVwifSAke3RoaXMudHlwZX0uYCk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdUaXRsZU1vZGFsOiBFcnJvciBkdXJpbmcgcHJvY2VzczonLCBlcnJvcik7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvciAke3RoaXMuaXNSZW5hbWUgPyBcInJlbmFtaW5nXCIgOiBcImNyZWF0aW5nXCJ9ICR7dGhpcy50eXBlfTogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY2xvc2UoKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0VHlwZURpc3BsYXlOYW1lKCk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMudHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdHJldHVybiBcIkNvbnRlbnRcIjtcblx0XHR9XG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRyZXR1cm4gY29udGVudFR5cGUgPyBjb250ZW50VHlwZS5uYW1lIDogXCJDb250ZW50XCI7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZU5ld0ZpbGUodGl0bGU6IHN0cmluZyk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0Ly8gRGV0ZXJtaW5lIHRoZSBhcHByb3ByaWF0ZSBmb2xkZXIgYmFzZWQgb24gd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxuXHRcdGxldCB0YXJnZXRGb2xkZXI6IHN0cmluZztcblxuXHRcdC8vIEdldCB0aGUgZGlyZWN0b3J5IHdoZXJlIHRoZSB1c2VyIGNyZWF0ZWQgdGhlIGZpbGVcblx0XHRjb25zdCBvcmlnaW5hbERpciA9IHRoaXMuZmlsZT8ucGFyZW50Py5wYXRoIHx8IFwiXCI7XG5cblx0XHRpZiAodGhpcy50eXBlICE9PSBcIm5vdGVcIikge1xuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRcdC8vIEZvciBjb250ZW50IHR5cGVzLCByZXNwZWN0IHRoZSB1c2VyJ3MgY2hvc2VuIGxvY2F0aW9uIChzdWJmb2xkZXIpXG5cdFx0XHQvLyBPbmx5IHVzZSB0aGUgY29uZmlndXJlZCBmb2xkZXIgaWYgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZSBpbiB0aGUgdmF1bHQgcm9vdFxuXHRcdFx0aWYgKG9yaWdpbmFsRGlyID09PSBcIlwiIHx8IG9yaWdpbmFsRGlyID09PSBcIi9cIikge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBjb250ZW50VHlwZT8uZm9sZGVyIHx8IFwiXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBvcmlnaW5hbERpcjtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRm9yIG5vdGVzLCB1c2UgdGhlIG9yaWdpbmFsIGRpcmVjdG9yeVxuXHRcdFx0dGFyZ2V0Rm9sZGVyID0gb3JpZ2luYWxEaXI7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIHRoZSBmaWxlbmFtZSBmcm9tIHRoZSB0aXRsZVxuXHRcdGNvbnN0IGZpbGVuYW1lID0gdGhpcy5maWxlT3BzLmdlbmVyYXRlRmlsZW5hbWUodGl0bGUpO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5maWxlT3BzLmdldENvbnRlbnRUeXBlKHRoaXMudHlwZSk7XG5cdFx0Y29uc3QgZXh0ZW5zaW9uID0gY29udGVudFR5cGU/LnVzZU1keEV4dGVuc2lvbiA/IFwiLm1keFwiIDogXCIubWRcIjtcblx0XHRjb25zdCBmaWxlUGF0aCA9IHRhcmdldEZvbGRlciA/IGAke3RhcmdldEZvbGRlcn0vJHtmaWxlbmFtZX0ke2V4dGVuc2lvbn1gIDogYCR7ZmlsZW5hbWV9JHtleHRlbnNpb259YDtcblxuXHRcdC8vIFRyYWNrIHRoYXQgdGhpcyBmaWxlIHdpbGwgYmUgY3JlYXRlZCBieSB0aGUgcGx1Z2luIEJFRk9SRSBjcmVhdGluZyBpdFxuXHRcdC8vIFRoaXMgcHJldmVudHMgdGhlIGNyZWF0ZSBldmVudCBmcm9tIHRyaWdnZXJpbmcgYW5vdGhlciBtb2RhbFxuXHRcdGlmICh0aGlzLnBsdWdpbikge1xuXHRcdFx0dGhpcy5wbHVnaW4ucGx1Z2luQ3JlYXRlZEZpbGVzLnNldChmaWxlUGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIHRoZSBmaWxlIHdpdGggaW5pdGlhbCBjb250ZW50XG5cdFx0bGV0IGluaXRpYWxDb250ZW50ID0gXCJcIjtcblx0XHQvLyBBbHdheXMgaW5zZXJ0IHByb3BlcnRpZXMgd2hlbiBhdXRvSW5zZXJ0UHJvcGVydGllcyBpcyBlbmFibGVkXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzKSB7XG5cdFx0XHRpbml0aWFsQ29udGVudCA9IHRoaXMuZ2VuZXJhdGVJbml0aWFsQ29udGVudCh0aXRsZSk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIGluaXRpYWxDb250ZW50KTtcblxuXHRcdFx0Ly8gT3BlbiB0aGUgbmV3IGZpbGVcblx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZShuZXdGaWxlKTtcblxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IHRoZSBlbmQgb2YgY29udGVudCBhZnRlciBlZGl0b3IgaXMgcmVhZHlcblx0XHRcdC8vIFVzZSBtdWx0aXBsZSBhdHRlbXB0cyB0byBlbnN1cmUgaXQgd29ya3MgZXZlbiBpZiBlZGl0b3IgaXNuJ3QgcmVhZHkgaW1tZWRpYXRlbHlcblx0XHRcdGNvbnN0IHBvc2l0aW9uQ3Vyc29yID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuXHRcdFx0XHRpZiAodmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyAmJiB2aWV3LmVkaXRvcikge1xuXHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9IHZpZXcuZWRpdG9yO1xuXHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lTGVuZ3RoID0gbGluZXNbbGFzdExpbmVdPy5sZW5ndGggfHwgMDtcblx0XHRcdFx0XHRcdGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBsYXN0TGluZSwgY2g6IGxhc3RMaW5lTGVuZ3RoIH0pO1xuXHRcdFx0XHRcdFx0Ly8gRm9jdXMgdGhlIGVkaXRvciB0byBlbnN1cmUgY3Vyc29yIGlzIHZpc2libGUgYW5kIGZpbGVuYW1lIGlzbid0IHNlbGVjdGVkXG5cdFx0XHRcdFx0XHRlZGl0b3IuZm9jdXMoKTtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBUcnkgaW1tZWRpYXRlbHlcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRpZiAoIXBvc2l0aW9uQ3Vyc29yKCkpIHtcblx0XHRcdFx0XHQvLyBJZiBpdCBkaWRuJ3Qgd29yaywgdHJ5IGFnYWluIGFmdGVyIGEgbG9uZ2VyIGRlbGF5XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbkN1cnNvcigpO1xuXHRcdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIDEwMCk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgZmlsZTogJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBnZW5lcmF0ZUluaXRpYWxDb250ZW50KHRpdGxlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZGF0ZVN0cmluZyA9IHdpbmRvdy5tb21lbnQobm93KS5mb3JtYXQodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGF0ZUZvcm1hdCk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHRvS2ViYWJDYXNlKHRpdGxlKTtcblxuXHRcdGxldCB0ZW1wbGF0ZTogc3RyaW5nO1xuXHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3RlcywgdXNlIGEgc2ltcGxlIHRlbXBsYXRlXG5cdFx0XHQvLyBQcm9wZXJseSBlc2NhcGUgdGhlIHRpdGxlIGZvciBZQU1MXG5cdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZSkge1xuXHRcdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogJHtlc2NhcGVkVGl0bGV9XFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpO1xuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7ZGF0ZVxcfVxcfS9nLCBkYXRlU3RyaW5nKTtcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3NsdWdcXH1cXH0vZywgc2x1Zyk7XG5cblx0XHRyZXR1cm4gdGVtcGxhdGU7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGFkZFByb3BlcnRpZXNUb0ZpbGUoZmlsZTogVEZpbGUsIHRpdGxlOiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQpIHtcblx0XHRjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXHRcdGNvbnN0IGRhdGVTdHJpbmcgPSB3aW5kb3cubW9tZW50KG5vdykuZm9ybWF0KHRoaXMucGx1Z2luLnNldHRpbmdzLmRhdGVGb3JtYXQpO1xuXHRcdGNvbnN0IHNsdWcgPSB0b0tlYmFiQ2FzZSh0aXRsZSk7XG5cblx0XHRsZXQgdGVtcGxhdGU6IHN0cmluZztcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdC8vIEZvciBnZW5lcmljIG5vdGVzLCB1c2UgYSBzaW1wbGUgdGVtcGxhdGVcblx0XHRcdC8vIFByb3Blcmx5IGVzY2FwZSB0aGUgdGl0bGUgZm9yIFlBTUxcblx0XHRcdGNvbnN0IGVzY2FwZWRUaXRsZSA9IHRoaXMuZXNjYXBlWWFtbFN0cmluZyh0aXRsZSk7XG5cdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogJHtlc2NhcGVkVGl0bGV9XFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5maWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZSkge1xuXHRcdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogJHtlc2NhcGVkVGl0bGV9XFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpO1xuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7ZGF0ZVxcfVxcfS9nLCBkYXRlU3RyaW5nKTtcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3NsdWdcXH1cXH0vZywgc2x1Zyk7XG5cblx0XHQvLyBFbnN1cmUgbm8gZXh0cmEgbmV3bGluZXMgb3IgLS0tIGFyZSBhZGRlZCBiZXlvbmQgdGhlIHRlbXBsYXRlXG5cdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHRlbXBsYXRlKTtcblx0fVxuXG5cdHByaXZhdGUgcG9zaXRpb25DdXJzb3JBdEVuZChmaWxlOiBURmlsZSkge1xuXHRcdGNvbnN0IHBvc2l0aW9uQ3Vyc29yID0gKCkgPT4ge1xuXHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRpZiAodmlldyAmJiB2aWV3LmZpbGUgPT09IGZpbGUgJiYgdmlldy5lZGl0b3IpIHtcblx0XHRcdFx0Y29uc3QgZWRpdG9yID0gdmlldy5lZGl0b3I7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRjb25zdCBsYXN0TGluZUxlbmd0aCA9IGxpbmVzW2xhc3RMaW5lXT8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdFx0ZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGxhc3RMaW5lLCBjaDogbGFzdExpbmVMZW5ndGggfSk7XG5cdFx0XHRcdFx0Ly8gRm9jdXMgdGhlIGVkaXRvciB0byBlbnN1cmUgY3Vyc29yIGlzIHZpc2libGVcblx0XHRcdFx0XHRlZGl0b3IuZm9jdXMoKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH07XG5cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGlmICghcG9zaXRpb25DdXJzb3IoKSkge1xuXHRcdFx0XHQvLyBJZiBpdCBkaWRuJ3Qgd29yaywgdHJ5IGFnYWluIGFmdGVyIGEgbG9uZ2VyIGRlbGF5XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdHBvc2l0aW9uQ3Vyc29yKCk7XG5cdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHR9XG5cdFx0fSwgMTAwKTtcblx0fVxuXG5cdHByaXZhdGUgZXNjYXBlWWFtbFN0cmluZyhzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUHJvcGVybHkgZXNjYXBlIFlBTUwgc3RyaW5nIHZhbHVlc1xuXHRcdC8vIFlBTUwgc3RyaW5ncyB3aXRoIHF1b3RlcyBuZWVkIHRvIGJlIHdyYXBwZWQgaW4gc2luZ2xlIHF1b3RlcyBvciBlc2NhcGVkIHByb3Blcmx5XG5cdFx0aWYgKHN0ci5pbmNsdWRlcygnXCInKSB8fCBzdHIuaW5jbHVkZXMoXCInXCIpIHx8IHN0ci5pbmNsdWRlcygnXFxuJykgfHwgc3RyLmluY2x1ZGVzKCdcXFxcJykpIHtcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggcXVvdGVzLCBuZXdsaW5lcywgb3IgYmFja3NsYXNoZXMsIHVzZSBzaW5nbGUgcXVvdGVzIGFuZCBlc2NhcGUgc2luZ2xlIHF1b3Rlc1xuXHRcdFx0cmV0dXJuIGAnJHtzdHIucmVwbGFjZSgvJy9nLCBcIicnXCIpfSdgO1xuXHRcdH0gZWxzZSBpZiAoc3RyLmluY2x1ZGVzKFwiIFwiKSB8fCBzdHIuaW5jbHVkZXMoXCI6XCIpIHx8IHN0ci5pbmNsdWRlcyhcIiNcIikgfHwgc3RyLmluY2x1ZGVzKFwiQFwiKSkge1xuXHRcdFx0Ly8gRm9yIHN0cmluZ3Mgd2l0aCBzcGFjZXMgb3Igc3BlY2lhbCBZQU1MIGNoYXJhY3RlcnMsIHdyYXAgaW4gZG91YmxlIHF1b3RlcyBhbmQgZXNjYXBlIGRvdWJsZSBxdW90ZXNcblx0XHRcdHJldHVybiBgXCIke3N0ci5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyl9XCJgO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBGb3Igc2ltcGxlIHN0cmluZ3MsIG5vIHF1b3RlcyBuZWVkZWRcblx0XHRcdHJldHVybiBzdHI7XG5cdFx0fVxuXHR9XG5cblx0b25DbG9zZSgpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0fVxufVxuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgUGxhdGZvcm0sIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IENvbnRlbnRUeXBlLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQ29tbWFuZFBpY2tlck1vZGFsIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Db21tYW5kUGlja2VyTW9kYWxcIjtcclxuaW1wb3J0IHsgSWNvblBpY2tlck1vZGFsIH0gZnJvbSBcIi4vY29tcG9uZW50cy9JY29uUGlja2VyTW9kYWxcIjtcclxuaW1wb3J0IHsgQ29uZmlybU1vZGFsIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Db25maXJtTW9kYWxcIjtcclxuaW1wb3J0IHsgY3JlYXRlU2V0dGluZ3NHcm91cCB9IGZyb20gXCIuLi91dGlscy9zZXR0aW5ncy1jb21wYXRcIjtcclxuaW1wb3J0IHsgcmVnaXN0ZXJDb250ZW50VHlwZUNvbW1hbmRzIH0gZnJvbSBcIi4uL2NvbW1hbmRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQXN0cm9Db21wb3NlclNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuXHRwbHVnaW46IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XHJcblx0cHVibGljIGljb24gPSAnbHVjaWRlLXBlbmNpbC1saW5lJztcclxuXHRhdXRvUmVuYW1lQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHBvc3RzRm9sZGVyQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdG9ubHlBdXRvbWF0ZUNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRjcmVhdGlvbk1vZGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0aW5kZXhGaWxlQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGV4Y2x1ZGVkRGlyc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHR1bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGF1dG9JbnNlcnRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNGaWVsZHNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNJbmRleEZpbGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNPbmx5QXV0b21hdGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0dGVybWluYWxDb21tYW5kQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGNvbmZpZ0NvbW1hbmRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0Y3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHRlcm1pbmFsUmliYm9uVG9nZ2xlOiBTZXR0aW5nIHwgbnVsbCA9IG51bGw7XHJcblx0Y29uZmlnUmliYm9uVG9nZ2xlOiBTZXR0aW5nIHwgbnVsbCA9IG51bGw7XHJcblx0cHJpdmF0ZSB0ZXJtaW5hbFJpYmJvblRvZ2dsZUNvbXBvbmVudDogeyBzZXREaXNhYmxlZDogKGRpc2FibGVkOiBib29sZWFuKSA9PiB2b2lkIH0gfCBudWxsID0gbnVsbDtcclxuXHRwcml2YXRlIGNvbmZpZ1JpYmJvblRvZ2dsZUNvbXBvbmVudDogeyBzZXREaXNhYmxlZDogKGRpc2FibGVkOiBib29sZWFuKSA9PiB2b2lkIH0gfCBudWxsID0gbnVsbDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZWZyZXNoIGp1c3QgdGhlIGNvbnRlbnQgdHlwZXMgc2VjdGlvblxyXG5cdCAqIE1vcmUgZWZmaWNpZW50IHRoYW4gcmVmcmVzaGluZyB0aGUgZW50aXJlIHNldHRpbmdzIHRhYlxyXG5cdCAqL1xyXG5cdHB1YmxpYyByZWZyZXNoQ29udGVudFR5cGVzKCk6IHZvaWQge1xyXG5cdFx0aWYgKHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyKSB7XHJcblx0XHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRkaXNwbGF5KCk6IHZvaWQge1xyXG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG5cdFx0Ly8gVXNlIGN1cnJlbnQgcGx1Z2luIHNldHRpbmdzIChhbHJlYWR5IGxvYWRlZCBhbmQgdXAtdG8tZGF0ZSlcclxuXHRcdC8vIEFsd2F5cyByZWFkIGZyZXNoIHNldHRpbmdzIHRvIGVuc3VyZSB3ZSBzaG93IG1pZ3JhdGVkIGNvbnRlbnQgdHlwZXMgaW1tZWRpYXRlbHlcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblxyXG5cdFx0Ly8gUmVuZGVyIHRoZSBzZXR0aW5ncyB0YWIgd2l0aCBjdXJyZW50IHNldHRpbmdzXHJcblx0XHQvLyBUaGlzIHdpbGwgc2hvdyBhbGwgY29udGVudCB0eXBlcyBpbmNsdWRpbmcgbmV3bHkgbWlncmF0ZWQgb25lc1xyXG5cdFx0dGhpcy5yZW5kZXJTZXR0aW5nc1RhYihjb250YWluZXJFbCwgc2V0dGluZ3MpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSByZW5kZXJTZXR0aW5nc1RhYihjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiB2b2lkIHtcclxuXHJcblx0XHQvLyBHbG9iYWwgc2V0dGluZ3MgKGZpcnN0IGdyb3VwIC0gbm8gaGVhZGluZylcclxuXHRcdGNvbnN0IGdlbmVyYWxHcm91cCA9IGNyZWF0ZVNldHRpbmdzR3JvdXAoY29udGFpbmVyRWwsIHVuZGVmaW5lZCwgJ2FzdHJvLWNvbXBvc2VyJyk7XHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJEYXRlIGZvcm1hdFwiKVxyXG5cdFx0XHRcdC8vIERhdGUgZm9ybWF0IGNvZGVzIChNTU1NLCB5eXl5LCBldGMuKSBhcmUgdGVjaG5pY2FsIG5vdGF0aW9uLCBub3QgVUkgdGV4dFxyXG5cdFx0XHRcdC5zZXREZXNjKFwiRm9ybWF0IGZvciB0aGUgZGF0ZSBpbiBwcm9wZXJ0aWVzIChlLmcuLCB5eXl5LW1tLWRkLCBNTU1NIEQsIHl5eXksIHl5eXktbW0tZGQgSEg6bW0pXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC8vIFwiWVlZWS1NTS1ERFwiIGlzIGEgZGF0ZSBmb3JtYXQgcGxhY2Vob2xkZXIsIG5vdCBVSSB0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIllZWVktTU0tRERcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmRhdGVGb3JtYXQpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmRhdGVGb3JtYXQgPSB2YWx1ZSB8fCBcIllZWVktTU0tRERcIjtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiRW5hYmxlIGNvcHkgaGVhZGluZyBsaW5rc1wiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQWRkIHJpZ2h0LWNsaWNrIGNvbnRleHQgbWVudSBvcHRpb24gdG8gY29weSBoZWFkaW5nIGxpbmtzIGluIHZhcmlvdXMgZm9ybWF0cy5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluaylcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ29weUhlYWRpbmdGaWVsZHMoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiRGVmYXVsdCBoZWFkaW5nIGxpbmsgZm9ybWF0XCIpXHJcblx0XHRcdFx0Ly8gXCJBc3Ryb1wiIGlzIGEgcHJvcGVyIG5vdW4gKGZyYW1ld29yayBuYW1lKSBhbmQgc2hvdWxkIGJlIGNhcGl0YWxpemVkXHJcblx0XHRcdFx0LnNldERlc2MoXCJDaG9vc2UgdGhlIGRlZmF1bHQgZm9ybWF0IGZvciBjb3BpZWQgaGVhZGluZyBsaW5rcy4gT2JzaWRpYW4gZm9ybWF0IHJlc3BlY3RzIHlvdXIgT2JzaWRpYW4gc2V0dGluZ3MgZm9yIHdpa2lsaW5rIHZzIG1hcmtkb3duIHByZWZlcmVuY2UuIEFzdHJvIGxpbmsgdXNlcyB5b3VyIGxpbmsgYmFzZSBwYXRoIGZyb20gYWJvdmUgYW5kIGNvbnZlcnRzIHRoZSBoZWFkaW5nIGludG8ga2ViYWItY2FzZSBmb3JtYXQgYXMgYW4gYW5jaG9yIGxpbmtcIilcclxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxyXG5cdFx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdFx0LmFkZE9wdGlvbihcIm9ic2lkaWFuXCIsIFwiT2JzaWRpYW4gbGlua1wiKVxyXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiYXN0cm9cIiwgXCJBc3RybyBsaW5rXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5jb3B5SGVhZGluZ0xpbmtGb3JtYXQpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmNvcHlIZWFkaW5nTGlua0Zvcm1hdCA9IHZhbHVlIGFzIFwib2JzaWRpYW5cIiB8IFwiYXN0cm9cIjtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHQvLyBBZGQgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSBjbGFzc2VzIC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayk7XHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJBZGQgdHJhaWxpbmcgc2xhc2ggdG8gbGlua3NcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCB0cmFpbGluZyBzbGFzaGVzIHRvIGFsbCBjb252ZXJ0ZWQgaW50ZXJuYWwgbGlua3MgKGUuZy4sIC9hYm91dC8gaW5zdGVhZCBvZiAvYWJvdXQpLlwiKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuYWRkVHJhaWxpbmdTbGFzaFRvTGlua3MpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJQcm9jZXNzIGJhY2tncm91bmQgZmlsZSBjaGFuZ2VzXCIpXHJcblx0XHRcdFx0Ly8gVGVjaG5pY2FsIHRlcm1zIGxpa2UgXCJPYnNpZGlhblwiLCBcImdpdFwiIGFyZSBwcm9wZXIgbm91bnMgaW4gdGhpcyBjb250ZXh0XHJcblx0XHRcdFx0LnNldERlc2MoXCJBdXRvbWF0aWNhbGx5IHByb2Nlc3MgbmV3IGZpbGVzIHdoZW4gdGhleSdyZSBjaGFuZ2VkIGluIHRoZSBiYWNrZ3JvdW5kIChieSBHaXQgb3Igb3RoZXIgcGx1Z2lucykuIERpc2FibGUgdG8gcHJldmVudCBtb2RhbCBzcGFtIHdoZW4gZmlsZXMgYXJlIGFscmVhZHkgcHJvY2Vzc2VkIG9uIG90aGVyIGRldmljZXMgZHVyaW5nIGEgc3luYy5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnByb2Nlc3NCYWNrZ3JvdW5kRmlsZUNoYW5nZXMpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5wcm9jZXNzQmFja2dyb3VuZEZpbGVDaGFuZ2VzID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQvLyBcIk1EWFwiIGlzIGEgcHJvcGVyIG5vdW4gKGZpbGUgZm9ybWF0KSBhbmQgc2hvdWxkIGJlIGNhcGl0YWxpemVkXHJcblx0XHRcdFx0LnNldE5hbWUoXCJTaG93IE1EWCBmaWxlcyBpbiBmaWxlIGV4cGxvcmVyXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJNYWtlIC5tZHggZmlsZXMgdmlzaWJsZSBpbiBPYnNpZGlhbidzIGZpbGUgZXhwbG9yZXIuIFJlcXVpcmVzIHJlbG9hZCB0byB0YWtlIGVmZmVjdC5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnNob3dNZHhGaWxlc0luRXhwbG9yZXIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5zaG93TWR4RmlsZXNJbkV4cGxvcmVyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEF1dG8taW5zZXJ0IHByb3BlcnRpZXMgKGdsb2JhbCBzZXR0aW5nKVxyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiQXV0by1pbnNlcnQgcHJvcGVydGllc1wiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQXV0b21hdGljYWxseSBpbnNlcnQgdGhlIHByb3BlcnRpZXMgdGVtcGxhdGUgd2hlbiBjcmVhdGluZyBuZXcgZmlsZXMgZm9yIGFueSBjb250ZW50IHR5cGUuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5hdXRvSW5zZXJ0UHJvcGVydGllcylcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIENvbnRlbnQgdHlwZXNcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlc0dyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCwgXCJDb250ZW50IHR5cGVzXCIsICdhc3Ryby1jb21wb3NlcicpO1xyXG5cclxuXHRcdC8vIEFkZCBjb250YWluZXIgYXMgYSBzZXR0aW5nIC0gaGlkZSB0aGUgc2V0dGluZydzIGRlZmF1bHQgVUksIGFkZCBvdXIgY29udGFpbmVyIGluc2lkZVxyXG5cdFx0Y29udGVudFR5cGVzR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHQvLyBIaWRlIHRoZSBzZXR0aW5nJ3MgZGVmYXVsdCBVSSBlbGVtZW50cyB1c2luZyBDU1MgY2xhc3Nlc1xyXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctaGlkZGVuLWVsZW1lbnRzXCIpO1xyXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWZ1bGwtd2lkdGhcIik7XHJcblx0XHRcdC8vIEFkZCBvdXIgY29udGFpbmVyIGluc2lkZSB0aGUgc2V0dGluZyBlbGVtZW50IC0gZW5zdXJlIGl0J3MgdmlzaWJsZVxyXG5cdFx0XHR0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lciA9IHNldHRpbmcuc2V0dGluZ0VsLmNyZWF0ZURpdih7XHJcblx0XHRcdFx0Y2xzOiBcImN1c3RvbS1jb250ZW50LXR5cGVzLWNvbnRhaW5lciBhc3Ryby1jb21wb3Nlci1jdXN0b20tdHlwZXMtY29udGFpbmVyLXZpc2libGVcIlxyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdFx0Ly8gUmVuZGVyIGNvbnRlbnQgdHlwZXMgYWZ0ZXIgY29udGFpbmVyIGlzIGNyZWF0ZWRcclxuXHRcdGlmICh0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIERldmVsb3BlciBjb21tYW5kcyAoZGVza3RvcCBvbmx5IC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGUpXHJcblx0XHRpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdGNvbnN0IGRldmVsb3Blckdyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCwgXCJEZXZlbG9wZXIgY29tbWFuZHNcIiwgJ2FzdHJvLWNvbXBvc2VyJyk7XHJcblxyXG5cdFx0XHQvLyBUZXJtaW5hbCBjb21tYW5kIHNldHRpbmdzXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBvcGVuIHRlcm1pbmFsIGNvbW1hbmRcIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKFwiRW5hYmxlIGNvbW1hbmQgdG8gb3BlbiB0ZXJtaW5hbCBpbiBwcm9qZWN0IHJvb3QgZGlyZWN0b3J5LlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZClcclxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlVGVybWluYWxDb21tYW5kRmllbGRzKCk7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyByZWdpc3RlclJpYmJvbkljb25zIGNoZWNrcyBib3RoIGNvbW1hbmQgYW5kIGljb24gc2V0dGluZ3NcclxuXHRcdFx0XHRcdFx0XHRcdC8vIElmIGNvbW1hbmQgaXMgZW5hYmxlZCBBTkQgaWNvbiBpcyBlbmFibGVkLCBpdCB3aWxsIHNob3c7IG90aGVyd2lzZSBpdCB3aWxsIGhpZGVcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5yZWdpc3RlclJpYmJvbkljb25zKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBDcmVhdGUgY29udGFpbmVyIGZvciB0ZXJtaW5hbCBjb21tYW5kIGZpZWxkcyAtIGtlZXAgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCB1cGRhdGUgbWV0aG9kc1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJ0ZXJtaW5hbC1jb21tYW5kLWZpZWxkc1wiIH0pO1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0dGhpcy50ZXJtaW5hbENvbW1hbmRDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblxyXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZGVzY0ZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cdFx0XHRcdC8vIFRleHQgaXMgYWxyZWFkeSBpbiBzZW50ZW5jZSBjYXNlOyBcIk9ic2lkaWFuXCIgaXMgYSBwcm9wZXIgbm91blxyXG5cdFx0XHRcdGRlc2NGcmFnbWVudC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiUGF0aCByZWxhdGl2ZSB0byB0aGUgT2JzaWRpYW4gdmF1bHQgcm9vdCBmb2xkZXIuIFVzZSAuLi8uLiBmb3IgdHdvIGxldmVscyB1cC4gTGVhdmUgYmxhbmsgdG8gdXNlIHRoZSB2YXVsdCBmb2xkZXJcIiB9KTtcclxuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlRoaXMgaXMgd2hlcmUgdGhlIHRlcm1pbmFsIHdpbGwgb3Blbi4gQWJzb2x1dGUgcGF0aHMgd29yayBhbHNvLlwiIH0pO1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiUHJvamVjdCByb290IGRpcmVjdG9yeSBwYXRoXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhkZXNjRnJhZ21lbnQpXHJcblx0XHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIi4uLy4uXCIpXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnRlcm1pbmFsUHJvamVjdFJvb3RQYXRoKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MudGVybWluYWxQcm9qZWN0Um9vdFBhdGggPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdC8vIEFkZCBjbGFzcyBmb3IgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRjb25zdCBkZXNjRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblx0XHRcdFx0Ly8gVGV4dCBpcyBhbHJlYWR5IGluIHNlbnRlbmNlIGNhc2U7IHByb3BlciBub3VucyBvciBwcm9kdWN0IG5hbWVzIGxpa2UgXCJtYWNPU1wiLCBcIldpbmRvd3NcIiwgXCJMaW51eFwiXHJcblx0XHRcdFx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJMZWF2ZSBibGFuayB0byB1c2UgcGxhdGZvcm0gZGVmYXVsdHMuIE9uIG1hY09TLCB0aGUgZGVmYXVsdCBpcyBUZXJtaW5hbC4gT24gV2luZG93cywgaXQncyBXaW5kb3dzIFRlcm1pbmFsIChXaW4gMTEpIG9yIGNtZC5leGUgKFdpbiAxMCkuIE9uIExpbnV4LCBpdCdzIGdub21lLXRlcm1pbmFsLCBrb25zb2xlLCBvciB4dGVybVwiIH0pO1xyXG5cdFx0XHRcdC8vIFRleHQgaXMgYWxyZWFkeSBpbiBzZW50ZW5jZSBjYXNlOyBwcm9wZXIgbm91bnMgbGlrZSBcIlRlcm1pbmFsXCIsIFwiaVRlcm1cIiwgXCJQb3dlclNoZWxsXCJcclxuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIkV4YW1wbGVzIGluY2x1ZGUgVGVybWluYWwsIGlUZXJtLCBQb3dlclNoZWxsLCBhbmQgQWxhY3JpdHR5XCIgfSk7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJUZXJtaW5hbCBhcHBsaWNhdGlvbiBuYW1lXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhkZXNjRnJhZ21lbnQpXHJcblx0XHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIlRlcm1pbmFsXCIpXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnRlcm1pbmFsQXBwbGljYXRpb25OYW1lKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MudGVybWluYWxBcHBsaWNhdGlvbk5hbWUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdC8vIEFkZCBjbGFzcyBmb3IgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBkZWJ1ZyBsb2dnaW5nXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhcIkxvZyB0ZXJtaW5hbCBsYXVuY2ggY29tbWFuZHMgYW5kIHBsYXRmb3JtIGRlY2lzaW9ucyB0byB0aGUgZGV2ZWxvcGVyIGNvbnNvbGUgZm9yIHRyb3VibGVzaG9vdGluZy5cIilcclxuXHRcdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmVuYWJsZVRlcm1pbmFsRGVidWdMb2dnaW5nKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZVRlcm1pbmFsRGVidWdMb2dnaW5nID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0KTtcclxuXHRcdFx0XHQvLyBBZGQgY2xhc3MgZm9yIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgLSBrZWVwIHNldHRpbmcgaW4gZ3JvdXBcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJTaG93IG9wZW4gdGVybWluYWwgcmliYm9uIGljb25cIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKFwiQWRkIGEgcmliYm9uIGljb24gdG8gbGF1bmNoIHRoZSB0ZXJtaW5hbCBjb21tYW5kLlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMudGVybWluYWxSaWJib25Ub2dnbGVDb21wb25lbnQgPSB0b2dnbGU7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24pXHJcblx0XHRcdFx0XHRcdFx0LnNldERpc2FibGVkKCFzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBzZXR0aW5ncyBkaXJlY3RseSBvbiBwbHVnaW4gaW5zdGFuY2VcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVRlcm1pbmFsUmliYm9uSWNvbiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBzZXR0aW5ncyBhcmUgc2F2ZWQsIHRoZW4gcmUtcmVnaXN0ZXJcclxuXHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSwgNTApO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciB1cGRhdGluZyBkaXNhYmxlZCBzdGF0ZVxyXG5cdFx0XHRcdHRoaXMudGVybWluYWxSaWJib25Ub2dnbGUgPSBzZXR0aW5nO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIENvbmZpZyBmaWxlIGNvbW1hbmQgc2V0dGluZ3NcclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiRW5hYmxlIGVkaXQgY29uZmlnIGZpbGUgY29tbWFuZFwiKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoXCJFbmFibGUgY29tbWFuZCB0byBvcGVuIGFzdHJvIGNvbmZpZyBmaWxlIGluIGRlZmF1bHQgZWRpdG9yLlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbmZpZ0NvbW1hbmRGaWVsZHMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIHJlZ2lzdGVyUmliYm9uSWNvbnMgY2hlY2tzIGJvdGggY29tbWFuZCBhbmQgaWNvbiBzZXR0aW5nc1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gSWYgY29tbWFuZCBpcyBlbmFibGVkIEFORCBpY29uIGlzIGVuYWJsZWQsIGl0IHdpbGwgc2hvdzsgb3RoZXJ3aXNlIGl0IHdpbGwgaGlkZVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIENyZWF0ZSBjb250YWluZXIgZm9yIGNvbmZpZyBjb21tYW5kIGZpZWxkcyAtIGtlZXAgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCB1cGRhdGUgbWV0aG9kc1xyXG5cdFx0XHR0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwiY29uZmlnLWNvbW1hbmQtZmllbGRzXCIgfSk7XHJcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHR0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRjb25zdCBkZXNjRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblx0XHRcdFx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJQYXRoIHRvIHRoZSBjb25maWcgZmlsZSByZWxhdGl2ZSB0byB0aGUgdmF1bHQgcm9vdC4gVXNlIC4uL2NvbmZpZy50cyBvciAuLi8uLi9hc3Ryby5jb25maWcubWpzLlwiIH0pO1xyXG5cdFx0XHRcdGRlc2NGcmFnbWVudC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiQWJzb2x1dGUgcGF0aHMgd29yayBhbHNvLlwiIH0pO1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiQ29uZmlnIGZpbGUgcGF0aFwiKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoZGVzY0ZyYWdtZW50KVxyXG5cdFx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCIuLi9jb25maWcudHNcIilcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuY29uZmlnRmlsZVBhdGgpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5jb25maWdGaWxlUGF0aCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIlNob3cgb3BlbiBjb25maWcgcmliYm9uIGljb25cIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKFwiQWRkIGEgcmliYm9uIGljb24gdG8gbGF1bmNoIHRoZSBjb25maWcgZmlsZSBjb21tYW5kLlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uVG9nZ2xlQ29tcG9uZW50ID0gdG9nZ2xlO1xyXG5cdFx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlQ29uZmlnUmliYm9uSWNvbilcclxuXHRcdFx0XHRcdFx0XHQuc2V0RGlzYWJsZWQoIXNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZClcclxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBVcGRhdGUgc2V0dGluZ3MgZGlyZWN0bHkgb24gcGx1Z2luIGluc3RhbmNlXHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBzZXR0aW5ncyBhcmUgc2F2ZWQsIHRoZW4gcmUtcmVnaXN0ZXJcclxuXHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSwgNTApO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHRcdC8vIFN0b3JlIHJlZmVyZW5jZSBmb3IgdXBkYXRpbmcgZGlzYWJsZWQgc3RhdGVcclxuXHRcdFx0XHR0aGlzLmNvbmZpZ1JpYmJvblRvZ2dsZSA9IHNldHRpbmc7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gSGVscCBidXR0b24gcmVwbGFjZW1lbnQgdG9nZ2xlIChwYXJ0IG9mIGRldmVsb3BlciBjb21tYW5kcyBncm91cClcclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKCdTd2FwIG91dCBoZWxwIGJ1dHRvbiBmb3IgY3VzdG9tIGFjdGlvbicpXHJcblx0XHRcdFx0XHQuc2V0RGVzYygnUmVwbGFjZSB0aGUgaGVscCBidXR0b24gaW4gdGhlIHZhdWx0IHByb2ZpbGUgYXJlYSB3aXRoIGEgY3VzdG9tIGFjdGlvbi4nKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQgPz8gZmFsc2UpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoIXNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50ID0ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbmFibGVkOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29tbWFuZElkOiAnZWRpdC1hc3Ryby1jb25maWcnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpY29uSWQ6ICd3cmVuY2gnLFxyXG5cdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50LmVuYWJsZWQgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBUcmlnZ2VyIGhlbHAgYnV0dG9uIHJlcGxhY2VtZW50IHVwZGF0ZSAoaXQgd2lsbCByZWxvYWQgc2V0dGluZ3MpXHJcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24pIHtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVuZGVyIHRvIHNob3cvaGlkZSBvcHRpb25zXHJcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XHJcblx0XHRcdFx0XHRcdH0pKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTaG93IGNvbW1hbmQgYW5kIGljb24gcGlja2VycyBvbmx5IGlmIGVuYWJsZWQgKHBhcnQgb2YgZGV2ZWxvcGVyIGNvbW1hbmRzIGdyb3VwKVxyXG5cdFx0XHRpZiAoc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSB7XHJcblx0XHRcdFx0Ly8gQ29tbWFuZCBwaWNrZXJcclxuXHRcdFx0XHRjb25zdCBjb21tYW5kTmFtZSA9IHRoaXMuZ2V0Q29tbWFuZE5hbWUoc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50LmNvbW1hbmRJZCk7XHJcblx0XHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0XHQuc2V0TmFtZSgnQ29tbWFuZCcpXHJcblx0XHRcdFx0XHRcdC5zZXREZXNjKCdTZWxlY3QgdGhlIGNvbW1hbmQgdG8gZXhlY3V0ZSB3aGVuIHRoZSBidXR0b24gaXMgY2xpY2tlZC4nKVxyXG5cdFx0XHRcdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cclxuXHRcdFx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChjb21tYW5kTmFtZSB8fCAnU2VsZWN0IGNvbW1hbmQnKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IG1vZGFsID0gbmV3IENvbW1hbmRQaWNrZXJNb2RhbCh0aGlzLmFwcCwgKGNvbW1hbmRJZCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2b2lkIChhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCA9IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZW5hYmxlZDogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29tbWFuZElkOiAnZWRpdC1hc3Ryby1jb25maWcnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpY29uSWQ6ICd3cmVuY2gnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50LmNvbW1hbmRJZCA9IGNvbW1hbmRJZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUcmlnZ2VyIGhlbHAgYnV0dG9uIHJlcGxhY2VtZW50IHVwZGF0ZSBpbW1lZGlhdGVseSAoaXQgd2lsbCByZWxvYWQgc2V0dGluZ3MpXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVuZGVyIHRvIHNob3cgdXBkYXRlZCBjb21tYW5kIG5hbWVcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSkoKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xyXG5cdFx0XHRcdFx0XHRcdH0pKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0Ly8gSWNvbiBwaWNrZXJcclxuXHRcdFx0XHRjb25zdCBpY29uTmFtZSA9IHRoaXMuZ2V0SWNvbk5hbWUoc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Lmljb25JZCk7XHJcblx0XHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0XHQuc2V0TmFtZSgnSWNvbicpXHJcblx0XHRcdFx0XHRcdC5zZXREZXNjKCdTZWxlY3QgdGhlIGljb24gdG8gZGlzcGxheSBvbiB0aGUgYnV0dG9uLicpXHJcblx0XHRcdFx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxyXG5cdFx0XHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KGljb25OYW1lIHx8ICdTZWxlY3QgaWNvbi4uLicpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbW9kYWwgPSBuZXcgSWNvblBpY2tlck1vZGFsKHRoaXMuYXBwLCAoaWNvbklkKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZvaWQgKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIXNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50ID0ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbmFibGVkOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb21tYW5kSWQ6ICdlZGl0LWFzdHJvLWNvbmZpZycsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGljb25JZDogJ3dyZW5jaCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuaWNvbklkID0gaWNvbklkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRyaWdnZXIgaGVscCBidXR0b24gcmVwbGFjZW1lbnQgdXBkYXRlIGltbWVkaWF0ZWx5IChpdCB3aWxsIHJlbG9hZCBzZXR0aW5ncylcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbigpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZS1yZW5kZXIgdG8gc2hvdyB1cGRhdGVkIGljb24gbmFtZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XHJcblx0XHRcdFx0XHRcdFx0fSkpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy51cGRhdGVDb3B5SGVhZGluZ0ZpZWxkcygpO1xyXG5cdFx0Ly8gT25seSB1cGRhdGUgdGVybWluYWwvY29uZmlnIGZpZWxkcyBpZiBub3Qgb24gbW9iaWxlXHJcblx0XHRpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdHRoaXMudXBkYXRlVGVybWluYWxDb21tYW5kRmllbGRzKCk7XHJcblx0XHRcdHRoaXMudXBkYXRlQ29uZmlnQ29tbWFuZEZpZWxkcygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblxyXG5cdHVwZGF0ZUNvcHlIZWFkaW5nRmllbGRzKCkge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGlzVmlzaWJsZSA9IHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluaztcclxuXHJcblx0XHQvLyBVcGRhdGUgdGhlIFwiRGVmYXVsdCBoZWFkaW5nIGxpbmsgZm9ybWF0XCIgc2V0dGluZyBlbGVtZW50IHZpc2liaWxpdHlcclxuXHRcdGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbDtcclxuXHRcdGNvbnN0IGFsbFNldHRpbmdzID0gY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbCgnLnNldHRpbmctaXRlbScpO1xyXG5cdFx0YWxsU2V0dGluZ3MuZm9yRWFjaCgoc2V0dGluZ0VsKSA9PiB7XHJcblx0XHRcdGNvbnN0IG5hbWVFbCA9IHNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLW5hbWUnKTtcclxuXHRcdFx0aWYgKG5hbWVFbCAmJiBuYW1lRWwudGV4dENvbnRlbnQ/LnRyaW0oKSA9PT0gXCJEZWZhdWx0IGhlYWRpbmcgbGluayBmb3JtYXRcIikge1xyXG5cdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBpc1Zpc2libGUpO1xyXG5cdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHVwZGF0ZVRlcm1pbmFsQ29tbWFuZEZpZWxkcygpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBpc1Zpc2libGUgPSBzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSBjb250YWluZXIgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuXHRcdGlmICh0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBpc1Zpc2libGUpO1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFVwZGF0ZSBpbmRpdmlkdWFsIHNldHRpbmcgZWxlbWVudHMgdGhhdCBhcmUgaW4gdGhlIGdyb3VwXHJcblx0XHQvLyBGaW5kIHNldHRpbmdzIGJ5IHRoZWlyIG5hbWUgdGV4dCBjb250ZW50XHJcblx0XHRjb25zdCBjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWw7XHJcblx0XHRjb25zdCBhbGxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZXR0aW5nLWl0ZW0nKTtcclxuXHRcdGFsbFNldHRpbmdzLmZvckVhY2goKHNldHRpbmdFbCkgPT4ge1xyXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBzZXR0aW5nRWwucXVlcnlTZWxlY3RvcignLnNldHRpbmctaXRlbS1uYW1lJyk7XHJcblx0XHRcdGlmIChuYW1lRWwpIHtcclxuXHRcdFx0XHRjb25zdCBuYW1lID0gbmFtZUVsLnRleHRDb250ZW50Py50cmltKCk7XHJcblx0XHRcdFx0aWYgKG5hbWUgPT09IFwiUHJvamVjdCByb290IGRpcmVjdG9yeSBwYXRoXCIgfHwgbmFtZSA9PT0gXCJTaG93IG9wZW4gdGVybWluYWwgcmliYm9uIGljb25cIikge1xyXG5cdFx0XHRcdFx0c2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGlzVmlzaWJsZSk7XHJcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhaXNWaXNpYmxlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSByaWJib24gdG9nZ2xlIGRpc2FibGVkIHN0YXRlIHVzaW5nIHRoZSB0b2dnbGUgY29tcG9uZW50XHJcblx0XHRpZiAodGhpcy50ZXJtaW5hbFJpYmJvblRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uVG9nZ2xlQ29tcG9uZW50LnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHVwZGF0ZUNvbmZpZ0NvbW1hbmRGaWVsZHMoKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgaXNWaXNpYmxlID0gc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSBjb250YWluZXIgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuXHRcdGlmICh0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIpIHtcclxuXHRcdFx0dGhpcy5jb25maWdDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGlzVmlzaWJsZSk7XHJcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFVwZGF0ZSBpbmRpdmlkdWFsIHNldHRpbmcgZWxlbWVudHMgdGhhdCBhcmUgaW4gdGhlIGdyb3VwXHJcblx0XHQvLyBGaW5kIHNldHRpbmdzIGJ5IHRoZWlyIG5hbWUgdGV4dCBjb250ZW50XHJcblx0XHRjb25zdCBjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWw7XHJcblx0XHRjb25zdCBhbGxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZXR0aW5nLWl0ZW0nKTtcclxuXHRcdGFsbFNldHRpbmdzLmZvckVhY2goKHNldHRpbmdFbCkgPT4ge1xyXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBzZXR0aW5nRWwucXVlcnlTZWxlY3RvcignLnNldHRpbmctaXRlbS1uYW1lJyk7XHJcblx0XHRcdGlmIChuYW1lRWwpIHtcclxuXHRcdFx0XHRjb25zdCBuYW1lID0gbmFtZUVsLnRleHRDb250ZW50Py50cmltKCk7XHJcblx0XHRcdFx0aWYgKG5hbWUgPT09IFwiQ29uZmlnIGZpbGUgcGF0aFwiIHx8IG5hbWUgPT09IFwiU2hvdyBvcGVuIGNvbmZpZyByaWJib24gaWNvblwiKSB7XHJcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgaXNWaXNpYmxlKTtcclxuXHRcdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIHJpYmJvbiB0b2dnbGUgZGlzYWJsZWQgc3RhdGUgdXNpbmcgdGhlIHRvZ2dsZSBjb21wb25lbnRcclxuXHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvblRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aGlzLmNvbmZpZ1JpYmJvblRvZ2dsZUNvbXBvbmVudC5zZXREaXNhYmxlZCghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNoZWNrRm9yRm9sZGVyQ29uZmxpY3RzKCkge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGJsYW5rRm9sZGVyczogc3RyaW5nW10gPSBbXTtcclxuXHRcdGNvbnN0IGZvbGRlckNvbmZsaWN0czogeyBbZm9sZGVyOiBzdHJpbmddOiBzdHJpbmdbXSB9ID0ge307XHJcblxyXG5cdFx0Ly8gQ2hlY2sgY29udGVudCB0eXBlc1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBjb250ZW50VHlwZXMpIHtcclxuXHRcdFx0aWYgKGNvbnRlbnRUeXBlLmVuYWJsZWQpIHtcclxuXHRcdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmZvbGRlciB8fCBjb250ZW50VHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKSB7XHJcblx0XHRcdFx0XHRibGFua0ZvbGRlcnMucHVzaChjb250ZW50VHlwZS5uYW1lIHx8IFwiQ29udGVudFwiKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKCFmb2xkZXJDb25mbGljdHNbY29udGVudFR5cGUuZm9sZGVyXSkge1xyXG5cdFx0XHRcdFx0XHRmb2xkZXJDb25mbGljdHNbY29udGVudFR5cGUuZm9sZGVyXSA9IFtdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Zm9sZGVyQ29uZmxpY3RzW2NvbnRlbnRUeXBlLmZvbGRlcl0ucHVzaChjb250ZW50VHlwZS5uYW1lIHx8IFwiQ29udGVudFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBDaGVjayBmb3IgY29uZmxpY3RzXHJcblx0XHQvLyBXYXJuaW5nIGJveCByZW1vdmVkIC0gY29uZmxpY3RzIGFyZSBzdGlsbCBkZXRlY3RlZCBhdCBydW50aW1lXHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGFkZEN1c3RvbUNvbnRlbnRUeXBlKCkge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IG5ld1R5cGU6IENvbnRlbnRUeXBlID0ge1xyXG5cdFx0XHRpZDogYGNvbnRlbnQtJHtEYXRlLm5vdygpfWAsXHJcblx0XHRcdG5hbWU6IGBDb250ZW50ICR7Y29udGVudFR5cGVzLmxlbmd0aCArIDF9YCxcclxuXHRcdFx0Zm9sZGVyOiBcIlwiLFxyXG5cdFx0XHRsaW5rQmFzZVBhdGg6IFwiXCIsXHJcblx0XHRcdHRlbXBsYXRlOiAnLS0tXFxudGl0bGU6IFwie3t0aXRsZX19XCJcXG5kYXRlOiB7e2RhdGV9fVxcbi0tLVxcbicsXHJcblx0XHRcdGVuYWJsZWQ6IHRydWUsXHJcblx0XHRcdGNyZWF0aW9uTW9kZTogXCJmaWxlXCIsXHJcblx0XHRcdGluZGV4RmlsZU5hbWU6IFwiXCIsXHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnM6IGZhbHNlLFxyXG5cdFx0XHRlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBmYWxzZSxcclxuXHRcdFx0dXNlTWR4RXh0ZW5zaW9uOiBmYWxzZSxcclxuXHRcdH07XHJcblx0XHRjb250ZW50VHlwZXMucHVzaChuZXdUeXBlKTtcclxuXHRcdHNldHRpbmdzLmNvbnRlbnRUeXBlcyA9IGNvbnRlbnRUeXBlcztcclxuXHRcdHZvaWQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIGluY2x1ZGUgdGhlIG5ldyB0eXBlXHJcblx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcy5wbHVnaW4gYXMgdW5rbm93biBhcyBQbHVnaW4sIHNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCkge1xyXG5cdFx0aWYgKCF0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikgcmV0dXJuO1xyXG5cclxuXHRcdHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyLmVtcHR5KCk7XHJcblxyXG5cdFx0Ly8gQWx3YXlzIHJlYWQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gdG8gZW5zdXJlIHdlIGhhdmUgbGF0ZXN0IGRhdGFcclxuXHRcdC8vIFRoaXMgaXMgY3JpdGljYWwgYWZ0ZXIgbWlncmF0aW9uXHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29udGVudFR5cGVzLmZvckVhY2goKGN1c3RvbVR5cGU6IENvbnRlbnRUeXBlLCBpbmRleDogbnVtYmVyKSA9PiB7XHJcblx0XHRcdGlmICghdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIpIHJldHVybjtcclxuXHRcdFx0Y29uc3QgdHlwZUNvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyLmNyZWF0ZURpdih7XHJcblx0XHRcdFx0Y2xzOiBcImN1c3RvbS1jb250ZW50LXR5cGUtaXRlbVwiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gSGVhZGVyIHdpdGggY29udHJvbHNcclxuXHRcdFx0Y29uc3QgaGVhZGVyID0gdHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZS1oZWFkZXJcIiB9KTtcclxuXHRcdFx0aGVhZGVyLmNsYXNzTGlzdC5hZGQoXCJhc3Ryby1jb21wb3Nlci1jdXN0b20tdHlwZS1oZWFkZXJcIik7XHJcblxyXG5cdFx0XHQvLyBMZWZ0IHNpZGUgLSBjb2xsYXBzZS9leHBhbmQgYnV0dG9uXHJcblx0XHRcdGNvbnN0IGNvbGxhcHNlQnV0dG9uID0gaGVhZGVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItY29sbGFwc2UtYnV0dG9uXCIsXHJcblx0XHRcdFx0YXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJDb2xsYXBzZS9leHBhbmRcIiB9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRjb25zdCBpc0NvbGxhcHNlZCA9IGN1c3RvbVR5cGUuY29sbGFwc2VkID8/IGZhbHNlO1xyXG5cdFx0XHQvLyBBbHdheXMgdXNlIGNoZXZyb24tZG93biwgcm90YXRlIGl0IHdoZW4gY29sbGFwc2VkIHRvIHBvaW50IHJpZ2h0XHJcblx0XHRcdHNldEljb24oY29sbGFwc2VCdXR0b24sIFwiY2hldnJvbi1kb3duXCIpO1xyXG5cdFx0XHRpZiAoaXNDb2xsYXBzZWQpIHtcclxuXHRcdFx0XHRjb2xsYXBzZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiaXMtY29sbGFwc2VkXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNvbGxhcHNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRcdFx0dm9pZCB0aGlzLnRvZ2dsZUNvbnRlbnRUeXBlQ29sbGFwc2UoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0Ly8gVXBkYXRlIGNsYXNzIGFmdGVyIHRvZ2dsZSAoaWNvbiBzdGF5cyB0aGUgc2FtZSwganVzdCByb3RhdGVzKVxyXG5cdFx0XHRcdGNvbnN0IHVwZGF0ZWRUeXBlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzLmZpbmQoKGN0OiBDb250ZW50VHlwZSkgPT4gY3QuaWQgPT09IGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHRcdGlmICh1cGRhdGVkVHlwZSkge1xyXG5cdFx0XHRcdFx0aWYgKHVwZGF0ZWRUeXBlLmNvbGxhcHNlZCkge1xyXG5cdFx0XHRcdFx0XHRjb2xsYXBzZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiaXMtY29sbGFwc2VkXCIpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Y29sbGFwc2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImlzLWNvbGxhcHNlZFwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gTWlkZGxlIGxlZnQgLSBjb250ZW50IHR5cGUgbmFtZVxyXG5cdFx0XHRjb25zdCBoZWFkZXJOYW1lID0gaGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1oZWFkZXItbmFtZVwiIH0pO1xyXG5cdFx0XHRoZWFkZXJOYW1lLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogY3VzdG9tVHlwZS5uYW1lIHx8IGBDb250ZW50ICR7aW5kZXggKyAxfWAsIGNsczogXCJzZXR0aW5nLWl0ZW0tbmFtZVwiIH0pO1xyXG5cclxuXHRcdFx0Ly8gTWlkZGxlIHJpZ2h0IC0gdXAvZG93biBidXR0b25zIChzaWRlLWJ5LXNpZGUpXHJcblx0XHRcdGNvbnN0IHJlb3JkZXJDb250YWluZXIgPSBoZWFkZXIuY3JlYXRlRGl2KHsgY2xzOiBcImFzdHJvLWNvbXBvc2VyLXJlb3JkZXItYnV0dG9uc1wiIH0pO1xyXG5cdFx0XHRjb25zdCB1cEJ1dHRvbiA9IHJlb3JkZXJDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci1yZW9yZGVyLWJ1dHRvblwiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTW92ZSB1cFwiIH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHNldEljb24odXBCdXR0b24sIFwiY2hldnJvbi11cFwiKTtcclxuXHRcdFx0dXBCdXR0b24uZGlzYWJsZWQgPSBpbmRleCA9PT0gMDtcclxuXHRcdFx0dXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRcdFx0XHR2b2lkIHRoaXMubW92ZUNvbnRlbnRUeXBlVXAoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y29uc3QgZG93bkJ1dHRvbiA9IHJlb3JkZXJDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci1yZW9yZGVyLWJ1dHRvblwiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTW92ZSBkb3duXCIgfVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0c2V0SWNvbihkb3duQnV0dG9uLCBcImNoZXZyb24tZG93blwiKTtcclxuXHRcdFx0ZG93bkJ1dHRvbi5kaXNhYmxlZCA9IGluZGV4ID09PSBjb250ZW50VHlwZXMubGVuZ3RoIC0gMTtcclxuXHRcdFx0ZG93bkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHRcdHZvaWQgdGhpcy5tb3ZlQ29udGVudFR5cGVEb3duKGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFJpZ2h0IHNpZGUgLSB0b2dnbGVcclxuXHRcdFx0Y29uc3QgdG9nZ2xlQ29udGFpbmVyID0gaGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJjaGVja2JveC1jb250YWluZXJcIiB9KTtcclxuXHRcdFx0aWYgKGN1c3RvbVR5cGUuZW5hYmxlZCkge1xyXG5cdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Y29uc3QgdG9nZ2xlID0gdG9nZ2xlQ29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIiwgeyB0eXBlOiBcImNoZWNrYm94XCIsIGNsczogXCJjaGVja2JveC1pbnB1dFwiIH0pO1xyXG5cdFx0XHR0b2dnbGUuY2hlY2tlZCA9IGN1c3RvbVR5cGUuZW5hYmxlZDtcclxuXHJcblx0XHRcdC8vIEFkZCBjbGljayBldmVudCB0byB0aGUgY29udGFpbmVyIGFzIHdlbGxcclxuXHRcdFx0dG9nZ2xlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0XHRcdHZvaWQgKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0XHRcdGNvbnN0IG5ld1ZhbHVlID0gIWN1c3RvbVR5cGUuZW5hYmxlZDtcclxuXHRcdFx0XHRcdGN1c3RvbVR5cGUuZW5hYmxlZCA9IG5ld1ZhbHVlO1xyXG5cdFx0XHRcdFx0dG9nZ2xlLmNoZWNrZWQgPSBuZXdWYWx1ZTtcclxuXHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHJcblx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIGNvbnRhaW5lciBjbGFzcyBmb3IgdmlzdWFsIGZlZWRiYWNrXHJcblx0XHRcdFx0XHRpZiAobmV3VmFsdWUpIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIFVwZGF0ZSB2aXNpYmlsaXR5XHJcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCBuZXdWYWx1ZSk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIHJlZmxlY3QgZW5hYmxlZC9kaXNhYmxlZCBzdGF0ZVxyXG5cdFx0XHRcdFx0cmVnaXN0ZXJDb250ZW50VHlwZUNvbW1hbmRzKHRoaXMucGx1Z2luIGFzIHVua25vd24gYXMgUGx1Z2luLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gQ29uZmxpY3QgY2hlY2tpbmcgcmVtb3ZlZCBmcm9tIHNldHRpbmdzIFVJXHJcblx0XHRcdFx0fSkoKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBBbHNvIGFkZCBjaGFuZ2UgZXZlbnQgYXMgYmFja3VwXHJcblx0XHRcdHRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlKSA9PiB7XHJcblx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0Y29uc3QgdmFsdWUgPSAoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkuY2hlY2tlZDtcclxuXHRcdFx0XHRcdGN1c3RvbVR5cGUuZW5hYmxlZCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gVXBkYXRlIHRoZSBjb250YWluZXIgY2xhc3MgZm9yIHZpc3VhbCBmZWVkYmFja1xyXG5cdFx0XHRcdFx0aWYgKHZhbHVlKSB7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBVcGRhdGUgdmlzaWJpbGl0eVxyXG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDdXN0b21Db250ZW50VHlwZVZpc2liaWxpdHkoY3VzdG9tVHlwZS5pZCwgdmFsdWUpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFJlLXJlZ2lzdGVyIGNvbnRlbnQgdHlwZSBjb21tYW5kcyB0byByZWZsZWN0IGVuYWJsZWQvZGlzYWJsZWQgc3RhdGVcclxuXHRcdFx0XHRcdHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyh0aGlzLnBsdWdpbiBhcyB1bmtub3duIGFzIFBsdWdpbiwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG5cdFx0XHRcdH0pKCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gU2V0dGluZ3MgY29udGFpbmVyIHRoYXQgY2FuIGJlIGNvbGxhcHNlZFxyXG5cdFx0XHRjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IHR5cGVDb250YWluZXIuY3JlYXRlRGl2KHtcclxuXHRcdFx0XHRjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZS1zZXR0aW5nc1wiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gU2V0IGluaXRpYWwgdmlzaWJpbGl0eSBzdGF0ZSBiYXNlZCBvbiBlbmFibGVkIGFuZCBjb2xsYXBzZWQgc3RhdGVcclxuXHRcdFx0Y29uc3QgaW5pdGlhbGx5Q29sbGFwc2VkID0gY3VzdG9tVHlwZS5jb2xsYXBzZWQgPz8gZmFsc2U7XHJcblx0XHRcdGNvbnN0IGluaXRpYWxseVZpc2libGUgPSBjdXN0b21UeXBlLmVuYWJsZWQgJiYgIWluaXRpYWxseUNvbGxhcHNlZDtcclxuXHRcdFx0aWYgKGluaXRpYWxseVZpc2libGUpIHtcclxuXHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBDb250ZW50IHR5cGUgbmFtZVxyXG5cdFx0XHRjb25zdCBuYW1lQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdG5ldyBTZXR0aW5nKG5hbWVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJDb250ZW50IHR5cGUgbmFtZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBuYW1lIGZvciB0aGlzIGNvbnRlbnQgdHlwZSAoZS5nLiwgJ3Byb2plY3RzJywgJ25vdGVzJywgJ3R1dG9yaWFscycpXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgY29udGVudCB0eXBlIG5hbWVcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUubmFtZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5uYW1lID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIHVwZGF0ZSBjb21tYW5kIG5hbWVcclxuXHRcdFx0XHRcdFx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcy5wbHVnaW4gYXMgdW5rbm93biBhcyBQbHVnaW4sIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBGb2xkZXIgbG9jYXRpb25cclxuXHRcdFx0Y29uc3QgZm9sZGVyQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdGNvbnN0IGZvbGRlclNldHRpbmcgPSBuZXcgU2V0dGluZyhmb2xkZXJDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJGb2xkZXIgbG9jYXRpb25cIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkZvbGRlciBwYXRoIHdoZXJlIHRoaXMgY29udGVudCB0eXBlIHdpbGwgYmUgY3JlYXRlZC4gTGVhdmUgYmxhbmsgdG8gdXNlIHRoZSB2YXVsdCBmb2xkZXIuIFN1cHBvcnRzIHdpbGRjYXJkcyBsaWtlIGRpcmVjdG9yeS8qIG9yIGRpcmVjdG9yeS8qLyogdG8gbWF0Y2ggc3BlY2lmaWMgZm9sZGVyIGRlcHRocy5cIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciBmb2xkZXIgcGF0aCAoZS5nLiwgJ2RvY3MnLCAnZG9jcy8qJywgJ2RvY3MvKi8qJykgb3IgbGVhdmUgYmxhbmsgZm9yIHZhdWx0IHJvb3RcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuZm9sZGVyKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmZvbGRlciA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSWdub3JlU3ViZm9sZGVyc0ZpZWxkKGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBjb25mbGljdCB3YXJuaW5ncyBmb3IgYWxsIGNvbnRlbnQgdHlwZXMgKGZvbGRlciBjaGFuZ2UgbWF5IGFmZmVjdCBvdGhlcnMpXHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgYWxsQ29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0XHRcdFx0XHRcdGZvciAoY29uc3QgY3Qgb2YgYWxsQ29udGVudFR5cGVzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyhjdC5pZCwgbnVsbCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEFkZCBjb25mbGljdCB3YXJuaW5nIGVsZW1lbnRcclxuXHRcdFx0Zm9sZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1jb25mbGljdC13YXJuaW5nIGhpZGRlblwiLCBhdHRyOiB7IFwiZGF0YS10eXBlLWlkXCI6IGN1c3RvbVR5cGUuaWQgfSB9KTtcclxuXHRcdFx0dGhpcy51cGRhdGVGb2xkZXJDb25mbGljdFdhcm5pbmcoY3VzdG9tVHlwZS5pZCwgZm9sZGVyU2V0dGluZyk7XHJcblxyXG5cdFx0XHQvLyBJZ25vcmUgc3ViZm9sZGVycyAob25seSBzaG93IHdoZW4gZm9sZGVyIGlzIHNldClcclxuXHRcdFx0Y29uc3QgaWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjdXN0b20taWdub3JlLXN1YmZvbGRlcnMtZmllbGRcIiB9KTtcclxuXHRcdFx0aWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGUtaWRcIiwgY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgISFjdXN0b21UeXBlLmZvbGRlcik7XHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhY3VzdG9tVHlwZS5mb2xkZXIpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyhpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiSWdub3JlIHN1YmZvbGRlcnNcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgYXV0b21hdGlvbiB3aWxsIG9ubHkgdHJpZ2dlciBmb3IgbmV3IC5tZCBmaWxlcyB3aXRoaW4gdGhpcyBjb250ZW50IHR5cGUncyBmb2xkZXIgYW5kIG9uZSBsZXZlbCBkb3duIChmb3IgZm9sZGVyLWJhc2VkIGNvbnRlbnQpLiBGaWxlcyBpbiBkZWVwZXIgc3ViZm9sZGVycyB3aWxsIGJlIGlnbm9yZWQuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmlnbm9yZVN1YmZvbGRlcnMgfHwgZmFsc2UpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmlnbm9yZVN1YmZvbGRlcnMgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cclxuXHRcdFx0Ly8gVW5kZXJzY29yZSBwcmVmaXhcclxuXHRcdFx0Y29uc3QgdW5kZXJzY29yZVByZWZpeENvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyh1bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiVXNlIHVuZGVyc2NvcmUgcHJlZml4IGZvciBkcmFmdHNcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCBhbiB1bmRlcnNjb3JlIHByZWZpeCAoX2NvbnRlbnQtdGl0bGUpIHRvIG5ldyBub3RlcyBieSBkZWZhdWx0IHdoZW4gZW5hYmxlZC4gVGhpcyBoaWRlcyB0aGVtIGZyb20gYXN0cm8sIHdoaWNoIGNhbiBiZSBoZWxwZnVsIGZvciBkcmFmdHNcIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuZW5hYmxlVW5kZXJzY29yZVByZWZpeCB8fCBmYWxzZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuZW5hYmxlVW5kZXJzY29yZVByZWZpeCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBMaW5rIGJhc2UgcGF0aFxyXG5cdFx0XHRjb25zdCBsaW5rQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdG5ldyBTZXR0aW5nKGxpbmtDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJMaW5rIGJhc2UgcGF0aFwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQmFzZSBwYXRoIGZvciBjb252ZXJ0ZWQgbGlua3MgKGUuZy4sICcvcHJvamVjdHMvJywgJy9ub3Rlcy90dXRvcmlhbHMvJywgbGVhdmUgYmxhbmsgZm9yIHJvb3QgLykuXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgbGluayBiYXNlIHBhdGhcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUubGlua0Jhc2VQYXRoID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gQ3JlYXRpb24gbW9kZVxyXG5cdFx0XHRjb25zdCBjcmVhdGlvbk1vZGVDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcoY3JlYXRpb25Nb2RlQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiQ3JlYXRpb24gbW9kZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiSG93IHRvIGNyZWF0ZSBuZXcgZW50cmllczogZmlsZS1iYXNlZCBvciBmb2xkZXItYmFzZWQgd2l0aCBhbiBpbmRleCBmaWxlLlwiKVxyXG5cdFx0XHRcdC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+XHJcblx0XHRcdFx0XHRkcm9wZG93blxyXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiZmlsZVwiLCBcIkZpbGUtYmFzZWQgKGNvbnRlbnQtdGl0bGUubWQpXCIpXHJcblx0XHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmb2xkZXJcIiwgXCJGb2xkZXItYmFzZWQgKGNvbnRlbnQtdGl0bGUvaW5kZXgubWQpXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmNyZWF0aW9uTW9kZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPSB2YWx1ZSBhcyBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy51cGRhdGVDdXN0b21Db250ZW50VHlwZUluZGV4RmlsZUZpZWxkKGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBVc2UgTURYIGV4dGVuc2lvblxyXG5cdFx0XHRjb25zdCB1c2VNZHhDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcodXNlTWR4Q29udGFpbmVyKVxyXG5cdFx0XHRcdC8vIFwiTURYXCIgaXMgYSBwcm9wZXIgbm91biAoZmlsZSBmb3JtYXQpIGFuZCBzaG91bGQgYmUgY2FwaXRhbGl6ZWRcclxuXHRcdFx0XHQuc2V0TmFtZShcIlVzZSBNRFggaW5zdGVhZCBvZiBNRFwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQ3JlYXRlIGZpbGVzIHdpdGggLm1keCBleHRlbnNpb24gaW5zdGVhZCBvZiAubWQgZXh0ZW5zaW9uLlwiKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS51c2VNZHhFeHRlbnNpb24gfHwgZmFsc2UpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLnVzZU1keEV4dGVuc2lvbiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBJbmRleCBmaWxlIG5hbWUgKG9ubHkgc2hvdyBmb3IgZm9sZGVyLWJhc2VkKVxyXG5cdFx0XHRjb25zdCBpbmRleEZpbGVDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY3VzdG9tLWluZGV4LWZpbGUtZmllbGRcIiB9KTtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKTtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgIT09IFwiZm9sZGVyXCIpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyhpbmRleEZpbGVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJJbmRleCBmaWxlIG5hbWVcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIk5hbWUgZm9yIGluZGV4IGZpbGVzIGluIGZvbGRlci1iYXNlZCBjb250ZW50ICh3aXRob3V0IC5tZCBleHRlbnNpb24pLiBEZWZhdWx0cyB0byAnaW5kZXgnIGlmIGxlZnQgYmxhbmsuXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkluZGV4XCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmluZGV4RmlsZU5hbWUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuaW5kZXhGaWxlTmFtZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBUZW1wbGF0ZVxyXG5cdFx0XHRjb25zdCB0ZW1wbGF0ZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyh0ZW1wbGF0ZUNvbnRhaW5lcilcclxuXHRcdFx0XHQuc2V0TmFtZShcIlByb3BlcnRpZXMgdGVtcGxhdGVcIilcclxuXHRcdFx0XHQuYWRkVGV4dEFyZWEoKHRleHQpID0+IHtcclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxuLS0tXFxuJylcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUudGVtcGxhdGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUudGVtcGxhdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR0ZXh0LmlucHV0RWwuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXRlbXBsYXRlLXRleHRhcmVhXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRleHQ7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQudGhlbigoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdFx0c2V0dGluZy5kZXNjRWwuZW1wdHkoKTtcclxuXHRcdFx0XHRcdGNvbnN0IGRlc2NEaXYgPSBzZXR0aW5nLmRlc2NFbC5jcmVhdGVFbChcImRpdlwiKTtcclxuXHRcdFx0XHRcdGRlc2NEaXYuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlRlbXBsYXRlIGZvciBuZXcgZmlsZXMgb2YgdGhpcyBjb250ZW50IHR5cGUuXCIgfSk7XHJcblx0XHRcdFx0XHRkZXNjRGl2LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJWYXJpYWJsZXMgaW5jbHVkZSB7e3RpdGxlfX0sIHt7ZGF0ZX19LCBhbmQge3tzbHVnfX0uXCIgfSk7XHJcblx0XHRcdFx0XHRkZXNjRGl2LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJEbyBub3Qgd3JhcCB7e2RhdGV9fSBpbiBxdW90ZXMgYXMgaXQgcmVwcmVzZW50cyBhIGRhdGV0aW1lIHZhbHVlLCBub3QgYSBzdHJpbmcuXCIgfSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBSZW1vdmUgYnV0dG9uIGF0IHRoZSBib3R0b20gKG5vIGRpdmlkZXIpXHJcblx0XHRcdGNvbnN0IHJlbW92ZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRjb25zdCByZW1vdmVTZXR0aW5nID0gbmV3IFNldHRpbmcocmVtb3ZlQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiXCIpXHJcblx0XHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcblx0XHRcdFx0XHRidXR0b25cclxuXHRcdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCJSZW1vdmVcIilcclxuXHRcdFx0XHRcdFx0LnNldFdhcm5pbmcoKVxyXG5cdFx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgdHlwZU5hbWUgPSBjb250ZW50VHlwZT8ubmFtZSB8fCBcImNvbnRlbnQgdHlwZVwiO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IG1vZGFsID0gbmV3IENvbmZpcm1Nb2RhbChcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuYXBwLFxyXG5cdFx0XHRcdFx0XHRcdFx0YEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmUgXCIke3R5cGVOYW1lfVwiPyBUaGlzIGFjdGlvbiBjYW5ub3QgYmUgdW5kb25lLmAsXHJcblx0XHRcdFx0XHRcdFx0XHRcIlJlbW92ZVwiLFxyXG5cdFx0XHRcdFx0XHRcdFx0XCJDYW5jZWxcIlxyXG5cdFx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgY29uZmlybWVkID0gYXdhaXQgbW9kYWwud2FpdEZvclJlc3VsdCgpO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjb25maXJtZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucmVtb3ZlQ3VzdG9tQ29udGVudFR5cGUoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEhpZGUgdGhlIGRpdmlkZXIgbGluZSBmb3IgdGhlIHJlbW92ZSBidXR0b25cclxuXHRcdFx0cmVtb3ZlU2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXJlbW92ZS1zZXR0aW5nXCIpO1xyXG5cclxuXHRcdFx0Ly8gU2V0IGluaXRpYWwgdmlzaWJpbGl0eSAoY2hlY2tzIGJvdGggZW5hYmxlZCBhbmQgY29sbGFwc2VkIHN0YXRlKVxyXG5cdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCBjdXN0b21UeXBlLmVuYWJsZWQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIGNvbmZsaWN0IHdhcm5pbmdzIGZvciBhbGwgdHlwZXMgYWZ0ZXIgcmVuZGVyaW5nIChmb2xkZXIgY2hhbmdlcyBtYXkgYWZmZWN0IG90aGVycylcclxuXHRcdGNvbnRlbnRUeXBlcy5mb3JFYWNoKChjdXN0b21UeXBlOiBDb250ZW50VHlwZSkgPT4ge1xyXG5cdFx0XHR0aGlzLnVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyhjdXN0b21UeXBlLmlkLCBudWxsKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEFkZCBmbG9hdGluZyBidXR0b24gZm9yIGNyZWF0aW5nIG5ldyBjdXN0b20gY29udGVudCB0eXBlcyAobm8gc2V0dGluZ3MgYmFja2dyb3VuZClcclxuXHRcdGNvbnN0IGFkZEJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1hZGQtYnV0dG9uLWNvbnRhaW5lclwiIH0pO1xyXG5cdFx0Y29uc3QgYWRkQnV0dG9uID0gYWRkQnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0Y2xzOiBcIm1vZC1jdGFcIixcclxuXHRcdFx0dGV4dDogXCJBZGQgY29udGVudCB0eXBlXCJcclxuXHRcdH0pO1xyXG5cdFx0YWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuYWRkQ3VzdG9tQ29udGVudFR5cGUoKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVDdXN0b21Db250ZW50VHlwZVZpc2liaWxpdHkodHlwZUlkOiBzdHJpbmcsIGVuYWJsZWQ6IGJvb2xlYW4pIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXR5cGUtaWQ9XCIke3R5cGVJZH1cIl0uY3VzdG9tLWNvbnRlbnQtdHlwZS1zZXR0aW5nc2ApIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0aWYgKHNldHRpbmdzQ29udGFpbmVyKSB7XHJcblx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gdHlwZUlkKTtcclxuXHRcdFx0Y29uc3QgaXNDb2xsYXBzZWQgPSBjb250ZW50VHlwZT8uY29sbGFwc2VkID8/IGZhbHNlO1xyXG5cdFx0XHRjb25zdCBzaG91bGRCZVZpc2libGUgPSBlbmFibGVkICYmICFpc0NvbGxhcHNlZDtcclxuXHJcblx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNob3VsZEJlVmlzaWJsZSk7XHJcblx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNob3VsZEJlVmlzaWJsZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSW5kZXhGaWxlRmllbGQodHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IGN1c3RvbVR5cGUgPSBjb250ZW50VHlwZXMuZmluZCh0eXBlID0+IHR5cGUuaWQgPT09IHR5cGVJZCk7XHJcblx0XHRpZiAoIWN1c3RvbVR5cGUpIHJldHVybjtcclxuXHJcblx0XHRjb25zdCBpbmRleEZpbGVDb250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcj8ucXVlcnlTZWxlY3RvcihgW2RhdGEtdHlwZS1pZD1cIiR7dHlwZUlkfVwiXSAuY3VzdG9tLWluZGV4LWZpbGUtZmllbGRgKSBhcyBIVE1MRWxlbWVudDtcclxuXHRcdGlmIChpbmRleEZpbGVDb250YWluZXIpIHtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKTtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgIT09IFwiZm9sZGVyXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVDdXN0b21Db250ZW50VHlwZUlnbm9yZVN1YmZvbGRlcnNGaWVsZCh0eXBlSWQ6IHN0cmluZykge1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY3VzdG9tVHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKHR5cGUgPT4gdHlwZS5pZCA9PT0gdHlwZUlkKTtcclxuXHRcdGlmICghY3VzdG9tVHlwZSkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcj8ucXVlcnlTZWxlY3RvcihgW2RhdGEtdHlwZS1pZD1cIiR7dHlwZUlkfVwiXS5jdXN0b20taWdub3JlLXN1YmZvbGRlcnMtZmllbGRgKSBhcyBIVE1MRWxlbWVudDtcclxuXHRcdGlmIChpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyKSB7XHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgISFjdXN0b21UeXBlLmZvbGRlciAmJiBjdXN0b21UeXBlLmZvbGRlci50cmltKCkgIT09IFwiXCIpO1xyXG5cdFx0XHRpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWN1c3RvbVR5cGUuZm9sZGVyIHx8IGN1c3RvbVR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyh0eXBlSWQ6IHN0cmluZywgc2V0dGluZzogU2V0dGluZyB8IG51bGwpIHtcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IGN1cnJlbnRUeXBlID0gY29udGVudFR5cGVzLmZpbmQodHlwZSA9PiB0eXBlLmlkID09PSB0eXBlSWQpO1xyXG5cdFx0aWYgKCFjdXJyZW50VHlwZSkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGNvbmZsaWN0V2FybmluZ0VsID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXR5cGUtaWQ9XCIke3R5cGVJZH1cIl0uYXN0cm8tY29tcG9zZXItY29uZmxpY3Qtd2FybmluZ2ApIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0aWYgKCFjb25mbGljdFdhcm5pbmdFbCkgcmV0dXJuO1xyXG5cclxuXHRcdC8vIEZpbmQgY29uZmxpY3RzIC0gb3RoZXIgY29udGVudCB0eXBlcyB3aXRoIHRoZSBzYW1lIGZvbGRlciBwYXR0ZXJuXHJcblx0XHRjb25zdCBjdXJyZW50Rm9sZGVyID0gKGN1cnJlbnRUeXBlLmZvbGRlciB8fCBcIlwiKS50cmltKCk7XHJcblx0XHRjb25zdCBjb25mbGljdGluZ1R5cGVzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuXHRcdGZvciAoY29uc3Qgb3RoZXJUeXBlIG9mIGNvbnRlbnRUeXBlcykge1xyXG5cdFx0XHRpZiAob3RoZXJUeXBlLmlkID09PSB0eXBlSWQgfHwgIW90aGVyVHlwZS5lbmFibGVkKSBjb250aW51ZTtcclxuXHJcblx0XHRcdGNvbnN0IG90aGVyRm9sZGVyID0gKG90aGVyVHlwZS5mb2xkZXIgfHwgXCJcIikudHJpbSgpO1xyXG5cclxuXHRcdFx0Ly8gQ2hlY2sgaWYgZm9sZGVycyBjb25mbGljdFxyXG5cdFx0XHQvLyBCb3RoIGJsYW5rID0gY29uZmxpY3QgKGJvdGggbWF0Y2ggdmF1bHQgcm9vdClcclxuXHRcdFx0aWYgKGN1cnJlbnRGb2xkZXIgPT09IFwiXCIgJiYgb3RoZXJGb2xkZXIgPT09IFwiXCIpIHtcclxuXHRcdFx0XHRjb25mbGljdGluZ1R5cGVzLnB1c2gob3RoZXJUeXBlLm5hbWUgfHwgXCJVbm5hbWVkXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFNhbWUgZm9sZGVyID0gY29uZmxpY3RcclxuXHRcdFx0ZWxzZSBpZiAoY3VycmVudEZvbGRlciA9PT0gb3RoZXJGb2xkZXIgJiYgY3VycmVudEZvbGRlciAhPT0gXCJcIikge1xyXG5cdFx0XHRcdGNvbmZsaWN0aW5nVHlwZXMucHVzaChvdGhlclR5cGUubmFtZSB8fCBcIlVubmFtZWRcIik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoY29uZmxpY3RpbmdUeXBlcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdGNvbmZsaWN0V2FybmluZ0VsLnJlbW92ZUNsYXNzKFwiaGlkZGVuXCIpO1xyXG5cdFx0XHRjb25mbGljdFdhcm5pbmdFbC50ZXh0Q29udGVudCA9IGBDb25mbGljdDogJHtjb25mbGljdGluZ1R5cGVzLmpvaW4oXCIsIFwiKX0gYWxzbyB1c2Uke2NvbmZsaWN0aW5nVHlwZXMubGVuZ3RoID09PSAxID8gXCJzXCIgOiBcIlwifSB0aGlzIGZvbGRlci4gTW9yZSBzcGVjaWZpYyBwYXR0ZXJucyB3aWxsIHRha2UgcHJpb3JpdHkuYDtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNvbmZsaWN0V2FybmluZ0VsLmFkZENsYXNzKFwiaGlkZGVuXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblxyXG5cdHByaXZhdGUgYXN5bmMgbW92ZUNvbnRlbnRUeXBlVXAodHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjdXJyZW50SW5kZXggPSBjb250ZW50VHlwZXMuZmluZEluZGV4KChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkID09PSB0eXBlSWQpO1xyXG5cclxuXHRcdGlmIChjdXJyZW50SW5kZXggPD0gMCkgcmV0dXJuOyAvLyBBbHJlYWR5IGF0IHRoZSB0b3BcclxuXHJcblx0XHQvLyBTd2FwIHdpdGggcHJldmlvdXMgaXRlbVxyXG5cdFx0W2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXhdLCBjb250ZW50VHlwZXNbY3VycmVudEluZGV4IC0gMV1dID0gW2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXggLSAxXSwgY29udGVudFR5cGVzW2N1cnJlbnRJbmRleF1dO1xyXG5cdFx0c2V0dGluZ3MuY29udGVudFR5cGVzID0gY29udGVudFR5cGVzO1xyXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyBtb3ZlQ29udGVudFR5cGVEb3duKHR5cGVJZDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY3VycmVudEluZGV4ID0gY29udGVudFR5cGVzLmZpbmRJbmRleCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gdHlwZUlkKTtcclxuXHJcblx0XHRpZiAoY3VycmVudEluZGV4IDwgMCB8fCBjdXJyZW50SW5kZXggPj0gY29udGVudFR5cGVzLmxlbmd0aCAtIDEpIHJldHVybjsgLy8gQWxyZWFkeSBhdCB0aGUgYm90dG9tXHJcblxyXG5cdFx0Ly8gU3dhcCB3aXRoIG5leHQgaXRlbVxyXG5cdFx0W2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXhdLCBjb250ZW50VHlwZXNbY3VycmVudEluZGV4ICsgMV1dID0gW2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXggKyAxXSwgY29udGVudFR5cGVzW2N1cnJlbnRJbmRleF1dO1xyXG5cdFx0c2V0dGluZ3MuY29udGVudFR5cGVzID0gY29udGVudFR5cGVzO1xyXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyB0b2dnbGVDb250ZW50VHlwZUNvbGxhcHNlKHR5cGVJZDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gdHlwZUlkKTtcclxuXHJcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm47XHJcblxyXG5cdFx0Y29udGVudFR5cGUuY29sbGFwc2VkID0gIWNvbnRlbnRUeXBlLmNvbGxhcHNlZDtcclxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy51cGRhdGVDdXN0b21Db250ZW50VHlwZVZpc2liaWxpdHkodHlwZUlkLCBjb250ZW50VHlwZS5lbmFibGVkKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgYXN5bmMgcmVtb3ZlQ3VzdG9tQ29udGVudFR5cGUodHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRzZXR0aW5ncy5jb250ZW50VHlwZXMgPSBjb250ZW50VHlwZXMuZmlsdGVyKChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkICE9PSB0eXBlSWQpO1xyXG5cdFx0Ly8gQ1JJVElDQUw6IEF3YWl0IHRoZSBzYXZlIHRvIGVuc3VyZSBkZWxldGlvbiBpcyBwZXJzaXN0ZWQgYmVmb3JlIGFueSByZWxvYWRzIGhhcHBlblxyXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIHJlbW92ZSB0aGUgZGVsZXRlZCB0eXBlXHJcblx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcy5wbHVnaW4gYXMgdW5rbm93biBhcyBQbHVnaW4sIHNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0Q29tbWFuZE5hbWUoY29tbWFuZElkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdFx0aWYgKCFjb21tYW5kSWQpIHJldHVybiAnJztcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IGNvbW1hbmRSZWdpc3RyeSA9ICh0aGlzLmFwcCBhcyB1bmtub3duIGFzIHsgY29tbWFuZHM/OiB7IGxpc3RDb21tYW5kcz86ICgpID0+IEFycmF5PHsgaWQ6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0+OyBjb21tYW5kcz86IFJlY29yZDxzdHJpbmcsIHsgaWQ6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0+IH0gfSkuY29tbWFuZHM7XHJcblxyXG5cdFx0XHQvLyBNZXRob2QgMTogVHJ5IGxpc3RDb21tYW5kcygpXHJcblx0XHRcdGlmIChjb21tYW5kUmVnaXN0cnkgJiYgdHlwZW9mIGNvbW1hbmRSZWdpc3RyeS5saXN0Q29tbWFuZHMgPT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0Y29uc3QgYWxsQ29tbWFuZHMgPSBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzKCk7XHJcblx0XHRcdFx0XHRjb25zdCBjb21tYW5kID0gYWxsQ29tbWFuZHMuZmluZCgoY21kOiB7IGlkOiBzdHJpbmc7IG5hbWU/OiBzdHJpbmcgfSkgPT4gY21kLmlkID09PSBjb21tYW5kSWQpO1xyXG5cdFx0XHRcdFx0aWYgKGNvbW1hbmQ/Lm5hbWUpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGNvbW1hbmQubmFtZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kIG5hbWUgdmlhIGxpc3RDb21tYW5kcygpOicsIGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gTWV0aG9kIDI6IFRyeSBhY2Nlc3NpbmcgdGhlIGludGVybmFsIGNvbW1hbmRzIHJlZ2lzdHJ5IGRpcmVjdGx5XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Y29uc3QgcmVnaXN0cnkgPSBjb21tYW5kUmVnaXN0cnk/LmNvbW1hbmRzO1xyXG5cdFx0XHRcdGlmIChyZWdpc3RyeSAmJiB0eXBlb2YgcmVnaXN0cnkgPT09ICdvYmplY3QnKSB7XHJcblx0XHRcdFx0XHRjb25zdCBjb21tYW5kID0gKHJlZ2lzdHJ5IGFzIFJlY29yZDxzdHJpbmcsIHsgbmFtZT86IHN0cmluZyB9PilbY29tbWFuZElkXTtcclxuXHRcdFx0XHRcdGlmIChjb21tYW5kPy5uYW1lKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBjb21tYW5kLm5hbWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKCdbQXN0cm8gQ29tcG9zZXJdIEVycm9yIGdldHRpbmcgY29tbWFuZCBuYW1lIHZpYSByZWdpc3RyeTonLCBlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kIG5hbWU6JywgZSk7XHJcblx0XHR9XHJcblx0XHQvLyBSZXR1cm4gZW1wdHkgc3RyaW5nIGlmIGNvbW1hbmQgbm90IGZvdW5kLCBzbyBpdCBzaG93cyBcIlNlbGVjdCBjb21tYW5kLi4uXCIgcGxhY2Vob2xkZXJcclxuXHRcdHJldHVybiAnJztcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0SWNvbk5hbWUoaWNvbklkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdFx0aWYgKCFpY29uSWQpIHJldHVybiAnJztcclxuXHRcdC8vIENvbnZlcnQgaWNvbiBJRCB0byBhIHJlYWRhYmxlIG5hbWUsIHJlbW92aW5nIGx1Y2lkZS0gcHJlZml4IGlmIHByZXNlbnRcclxuXHRcdHJldHVybiBpY29uSWRcclxuXHRcdFx0LnJlcGxhY2UoL15sdWNpZGUtLywgJycpIC8vIFJlbW92ZSBsdWNpZGUtIHByZWZpeFxyXG5cdFx0XHQuc3BsaXQoJy0nKVxyXG5cdFx0XHQubWFwKHdvcmQgPT4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkpXHJcblx0XHRcdC5qb2luKCcgJyk7XHJcblx0fVxyXG59XHJcbiIsICIvKipcclxuICogQ29tbWFuZCBQaWNrZXIgTW9kYWxcclxuICogU2VhcmNoYWJsZSBtb2RhbCBmb3Igc2VsZWN0aW5nIGFuIE9ic2lkaWFuIGNvbW1hbmRcclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW50ZXJmYWNlIENvbW1hbmRPcHRpb24ge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ29tbWFuZFBpY2tlck1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8Q29tbWFuZE9wdGlvbj4ge1xyXG5cdHByaXZhdGUgb25TZWxlY3Q6IChjb21tYW5kSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoY29tbWFuZElkOiBzdHJpbmcpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtcygpOiBDb21tYW5kT3B0aW9uW10ge1xyXG5cdFx0Ly8gR2V0IGFsbCBhdmFpbGFibGUgY29tbWFuZHNcclxuXHRcdC8vIFRyeSBtdWx0aXBsZSBtZXRob2RzIHRvIGVuc3VyZSB3ZSBnZXQgQUxMIGNvbW1hbmRzLCBub3QganVzdCBjb250ZXh0LWZpbHRlcmVkIG9uZXNcclxuXHRcdGNvbnN0IGNvbW1hbmRSZWdpc3RyeSA9ICh0aGlzLmFwcCBhcyB7IGNvbW1hbmRzPzogeyBsaXN0Q29tbWFuZHM/OiAoKSA9PiBDb21tYW5kT3B0aW9uW107IGNvbW1hbmRzPzogUmVjb3JkPHN0cmluZywgQ29tbWFuZE9wdGlvbj47IGNvbW1hbmRSZWdpc3RyeT86IFJlY29yZDxzdHJpbmcsIENvbW1hbmRPcHRpb24+IH0gfSkuY29tbWFuZHM7XHJcblx0XHRcclxuXHRcdC8vIFVzZSBhIFNldCB0byBkZWR1cGxpY2F0ZSBieSBjb21tYW5kIElEXHJcblx0XHRjb25zdCBjb21tYW5kTWFwID0gbmV3IE1hcDxzdHJpbmcsIENvbW1hbmRPcHRpb24+KCk7XHJcblx0XHRcclxuXHRcdC8vIE1ldGhvZCAxOiBUcnkgbGlzdENvbW1hbmRzKCkgLSBidXQgdGhpcyBtaWdodCBiZSBjb250ZXh0LWZpbHRlcmVkXHJcblx0XHRpZiAoY29tbWFuZFJlZ2lzdHJ5ICYmIHR5cGVvZiBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Y29uc3QgY29tbWFuZHMgPSBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzKCk7XHJcblx0XHRcdFx0Zm9yIChjb25zdCBjb21tYW5kIG9mIGNvbW1hbmRzKSB7XHJcblx0XHRcdFx0XHRpZiAoY29tbWFuZCAmJiBjb21tYW5kLmlkICYmIGNvbW1hbmQubmFtZSAmJiAhY29tbWFuZE1hcC5oYXMoY29tbWFuZC5pZCkpIHtcclxuXHRcdFx0XHRcdFx0Y29tbWFuZE1hcC5zZXQoY29tbWFuZC5pZCwge1xyXG5cdFx0XHRcdFx0XHRcdGlkOiBjb21tYW5kLmlkLFxyXG5cdFx0XHRcdFx0XHRcdG5hbWU6IGNvbW1hbmQubmFtZVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kcyB2aWEgbGlzdENvbW1hbmRzKCk6JywgZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gTWV0aG9kIDI6IFRyeSBhY2Nlc3NpbmcgdGhlIGludGVybmFsIGNvbW1hbmRzIHJlZ2lzdHJ5IGRpcmVjdGx5XHJcblx0XHQvLyBUaGlzIHNob3VsZCBnaXZlIHVzIEFMTCBjb21tYW5kcyByZWdhcmRsZXNzIG9mIGNvbnRleHRcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlZ2lzdHJ5ID0gY29tbWFuZFJlZ2lzdHJ5Py5jb21tYW5kcztcclxuXHRcdFx0aWYgKHJlZ2lzdHJ5ICYmIHR5cGVvZiByZWdpc3RyeSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0XHRjb25zdCBhbGxDb21tYW5kcyA9IE9iamVjdC52YWx1ZXMocmVnaXN0cnkpO1xyXG5cdFx0XHRcdGZvciAoY29uc3QgY29tbWFuZCBvZiBhbGxDb21tYW5kcykge1xyXG5cdFx0XHRcdFx0aWYgKGNvbW1hbmQgJiYgY29tbWFuZC5pZCAmJiBjb21tYW5kLm5hbWUgJiYgIWNvbW1hbmRNYXAuaGFzKGNvbW1hbmQuaWQpKSB7XHJcblx0XHRcdFx0XHRcdGNvbW1hbmRNYXAuc2V0KGNvbW1hbmQuaWQsIHtcclxuXHRcdFx0XHRcdFx0XHRpZDogY29tbWFuZC5pZCxcclxuXHRcdFx0XHRcdFx0XHRuYW1lOiBjb21tYW5kLm5hbWVcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmRzIHZpYSByZWdpc3RyeTonLCBlKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gTWV0aG9kIDM6IFRyeSBhY2Nlc3NpbmcgdmlhIGludGVybmFsIHN0cnVjdHVyZSAoZmFsbGJhY2spXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBpbnRlcm5hbFJlZ2lzdHJ5ID0gY29tbWFuZFJlZ2lzdHJ5Py5jb21tYW5kUmVnaXN0cnk7XHJcblx0XHRcdGlmIChpbnRlcm5hbFJlZ2lzdHJ5ICYmIHR5cGVvZiBpbnRlcm5hbFJlZ2lzdHJ5ID09PSAnb2JqZWN0Jykge1xyXG5cdFx0XHRcdGNvbnN0IGFsbENvbW1hbmRzID0gT2JqZWN0LnZhbHVlcyhpbnRlcm5hbFJlZ2lzdHJ5KTtcclxuXHRcdFx0XHRmb3IgKGNvbnN0IGNvbW1hbmQgb2YgYWxsQ29tbWFuZHMpIHtcclxuXHRcdFx0XHRcdGlmIChjb21tYW5kICYmIGNvbW1hbmQuaWQgJiYgY29tbWFuZC5uYW1lICYmICFjb21tYW5kTWFwLmhhcyhjb21tYW5kLmlkKSkge1xyXG5cdFx0XHRcdFx0XHRjb21tYW5kTWFwLnNldChjb21tYW5kLmlkLCB7XHJcblx0XHRcdFx0XHRcdFx0aWQ6IGNvbW1hbmQuaWQsXHJcblx0XHRcdFx0XHRcdFx0bmFtZTogY29tbWFuZC5uYW1lXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kcyB2aWEgaW50ZXJuYWwgcmVnaXN0cnk6JywgZSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbW1hbmRPcHRpb25zID0gQXJyYXkuZnJvbShjb21tYW5kTWFwLnZhbHVlcygpKTtcclxuXHRcdFxyXG5cdFx0Ly8gU29ydCBhbHBoYWJldGljYWxseSBieSBuYW1lXHJcblx0XHRjb21tYW5kT3B0aW9ucy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIGNvbW1hbmRPcHRpb25zO1xyXG5cdH1cclxuXHJcblx0Z2V0SXRlbVRleHQoaXRlbTogQ29tbWFuZE9wdGlvbik6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gaXRlbS5uYW1lO1xyXG5cdH1cclxuXHJcblx0b25DaG9vc2VJdGVtKGl0ZW06IENvbW1hbmRPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuXHRcdHRoaXMub25TZWxlY3QoaXRlbS5pZCk7XHJcblx0fVxyXG5cclxuXHQvLyBPdmVycmlkZSB0byBzaG93IGNvbW1hbmQgbmFtZSBvbmx5XHJcblx0cmVuZGVyU3VnZ2VzdGlvbihtYXRjaDogeyBpdGVtOiBDb21tYW5kT3B0aW9uIH0sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG5cdFx0Y29uc3QgaXRlbSA9IG1hdGNoLml0ZW07XHJcblx0XHRlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJywgdGV4dDogaXRlbS5uYW1lIH0pO1xyXG5cdH1cclxufVxyXG5cclxuIiwgIi8qKlxyXG4gKiBJY29uIFBpY2tlciBNb2RhbFxyXG4gKiBTZWFyY2hhYmxlIG1vZGFsIGZvciBzZWxlY3RpbmcgYSBMdWNpZGUgaWNvblxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgRnV6enlTdWdnZXN0TW9kYWwsIHNldEljb24sIGdldEljb25JZHMsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW50ZXJmYWNlIEljb25PcHRpb24ge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBHZXQgaWNvbiBsaXN0IGZyb20gT2JzaWRpYW4gQVBJIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBmYWxsYmFjayBsaXN0XHJcbmNvbnN0IGdldEljb25MaXN0ID0gKCk6IHN0cmluZ1tdID0+IHtcclxuXHRpZiAocmVxdWlyZUFwaVZlcnNpb24gJiYgcmVxdWlyZUFwaVZlcnNpb24oJzEuNy4zJykgJiYgZ2V0SWNvbklkcykge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0cmV0dXJuIGdldEljb25JZHMoKTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0Y29uc29sZS53YXJuKCdbQXN0cm8gQ29tcG9zZXJdIEVycm9yIGdldHRpbmcgaWNvbiBJRHMgZnJvbSBPYnNpZGlhbjonLCBlKTtcclxuXHRcdH1cclxuXHR9XHJcblx0Ly8gRmFsbGJhY2sgdG8gYSBiYXNpYyBsaXN0IGlmIEFQSSBpcyBub3QgYXZhaWxhYmxlXHJcblx0cmV0dXJuIFtcclxuXHRcdCdzZXR0aW5ncy0yJywgJ3NldHRpbmdzJywgJ2hlbHAtY2lyY2xlJywgJ2luZm8nLCAnc3RhcicsICdoZWFydCcsICdib29rbWFyaycsXHJcblx0XHQnaG9tZScsICdzZWFyY2gnLCAnYmVsbCcsICdtYWlsJywgJ3VzZXInLCAndXNlcnMnLCAnZm9sZGVyJywgJ2ZpbGUnLCAnZmlsZS10ZXh0JyxcclxuXHRcdCdpbWFnZScsICd2aWRlbycsICdtdXNpYycsICdjYWxlbmRhcicsICdjbG9jaycsICdlZGl0JywgJ3BlbmNpbCcsICd0cmFzaCcsXHJcblx0XHQnY29weScsICdjdXQnLCAncGFzdGUnLCAnZG93bmxvYWQnLCAndXBsb2FkJywgJ3NhdmUnLCAnc2hhcmUnLCAnbGluaycsXHJcblx0XHQnZXh0ZXJuYWwtbGluaycsICdsb2NrJywgJ3VubG9jaycsICdleWUnLCAnZXllLW9mZicsICdrZXknLCAnc2hpZWxkJyxcclxuXHRcdCdjaGVjaycsICd4JywgJ3BsdXMnLCAnbWludXMnLCAnYXJyb3ctbGVmdCcsICdhcnJvdy1yaWdodCcsICdhcnJvdy11cCcsXHJcblx0XHQnYXJyb3ctZG93bicsICdjaGV2cm9uLWxlZnQnLCAnY2hldnJvbi1yaWdodCcsICdjaGV2cm9uLXVwJywgJ2NoZXZyb24tZG93bicsXHJcblx0XHQnbWVudScsICdtb3JlLWhvcml6b250YWwnLCAnbW9yZS12ZXJ0aWNhbCcsICdncmlkJywgJ2xpc3QnLCAnbGF5b3V0JyxcclxuXHRcdCdjb2x1bW5zJywgJ3Jvd3MnLCAnbWF4aW1pemUnLCAnbWluaW1pemUnLCAnem9vbS1pbicsICd6b29tLW91dCcsXHJcblx0XHQncmVmcmVzaC1jdycsICdwbGF5JywgJ3BhdXNlJywgJ3N0b3AnLCAnc3VuJywgJ21vb24nLCAnY2xvdWQnLCAnemFwJyxcclxuXHRcdCd3YW5kLTInLCAnd2FuZCcsICd3YW5kLXNwYXJrbGVzJywgJ3BhbGV0dGUnLCAnYnJ1c2gnLCAnc2xpZGVycycsXHJcblx0XHQncG93ZXInLCAnd2lmaScsICdibHVldG9vdGgnLCAnbW9uaXRvcicsICdsYXB0b3AnLCAnc21hcnRwaG9uZScsXHJcblx0XHQnY2FtZXJhJywgJ21pYycsICdoZWFkcGhvbmVzJywgJ2NvZGUnLCAndGVybWluYWwnLCAndGVybWluYWwtc3F1YXJlJyxcclxuXHRcdCdnaXRodWInLCAnZ2l0bGFiJywgJ2dpdC1icmFuY2gnLCAnZ2l0LWNvbW1pdCcsICdkYXRhYmFzZScsICdzZXJ2ZXInLFxyXG5cdFx0J2Nsb3VkLWRvd25sb2FkJywgJ2Nsb3VkLXVwbG9hZCcsICd0YWcnLCAndGFncycsICdmbGFnJywgJ3BpbicsXHJcblx0XHQnbWFwLXBpbicsICdjb21wYXNzJywgJ2dsb2JlJywgJ3JvY2tldCcsICdjYXInLCAnYmlrZScsICdyb2JvdCcsXHJcblx0XHQnYXBwbGUnLCAnd2luZG93cycsICdsaW51eCcsICdjaHJvbWUnLCAnZmlyZWZveCcsICdzYWZhcmknLFxyXG5cdFx0J2NyZWRpdC1jYXJkJywgJ3dhbGxldCcsICdjb2lucycsICdib29rJywgJ2Jvb2stb3BlbicsICdhd2FyZCcsXHJcblx0XHQndHJvcGh5JywgJ2JhZGdlJywgJ3dyZW5jaCcsICd0b29sJywgJ3BhY2thZ2UnLCAnYm94JywgJ2FyY2hpdmUnLFxyXG5cdFx0J3NlbmQnLCAncmVwbHknLCAnZm9yd2FyZCcsICdtYWlsLW9wZW4nLCAndGFnLXBsdXMnLCAndGFnLW1pbnVzJyxcclxuXHRcdCdmbGFnLW9mZicsICdwaW4tb2ZmJywgJ21hcC1waW4tb2ZmJywgJ25hdmlnYXRpb24nLCAnbWFwJywgJ2VhcnRoJyxcclxuXHRcdCdwbGFuZScsICdzaGlwJywgJ2FuY2hvcicsICdoZWxpY29wdGVyJywgJ2Ryb25lJywgJ2FuZHJvaWQnLFxyXG5cdFx0J2tleWhvbGUnLCAna2V5cycsICdmaW5nZXJwcmludCcsICdzY2FuJywgJ3FyLWNvZGUnLCAnYmFyY29kZScsXHJcblx0XHQncmVjZWlwdCcsICdwaWdneS1iYW5rJywgJ2Jhbmtub3RlJ1xyXG5cdF07XHJcbn07XHJcblxyXG4vLyBDb252ZXJ0IGljb24gSURzIHRvIEljb25PcHRpb24gZm9ybWF0XHJcbmNvbnN0IExVQ0lERV9JQ09OUzogSWNvbk9wdGlvbltdID0gZ2V0SWNvbkxpc3QoKS5tYXAoaWQgPT4gKHtcclxuXHRpZDogaWQsXHJcblx0bmFtZTogaWRcclxuXHRcdC5yZXBsYWNlKC9ebHVjaWRlLS8sICcnKSAvLyBSZW1vdmUgbHVjaWRlLSBwcmVmaXggZm9yIGRpc3BsYXlcclxuXHRcdC5yZXBsYWNlKC8tL2csICcgJylcclxuXHRcdC5yZXBsYWNlKC8oXlxcd3sxfSl8KFxccytcXHd7MX0pL2csIChsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKVxyXG59KSkuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XHJcblxyXG5leHBvcnQgY2xhc3MgSWNvblBpY2tlck1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8SWNvbk9wdGlvbj4ge1xyXG5cdHByaXZhdGUgb25TZWxlY3Q6IChpY29uSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoaWNvbklkOiBzdHJpbmcpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtcygpOiBJY29uT3B0aW9uW10ge1xyXG5cdFx0cmV0dXJuIExVQ0lERV9JQ09OUztcclxuXHR9XHJcblxyXG5cdGdldEl0ZW1UZXh0KGl0ZW06IEljb25PcHRpb24pOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIGl0ZW0ubmFtZTtcclxuXHR9XHJcblxyXG5cdG9uQ2hvb3NlSXRlbShpdGVtOiBJY29uT3B0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLm9uU2VsZWN0KGl0ZW0uaWQpO1xyXG5cdH1cclxuXHJcblx0Ly8gT3ZlcnJpZGUgdG8gc2hvdyBpY29uIHByZXZpZXdcclxuXHRyZW5kZXJTdWdnZXN0aW9uKG1hdGNoOiB7IGl0ZW06IEljb25PcHRpb24gfSwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBpdGVtID0gbWF0Y2guaXRlbTtcclxuXHRcdGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xyXG5cdFx0Y29uc3QgY29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XHJcblx0XHRjb250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnLCB0ZXh0OiBpdGVtLm5hbWUgfSk7XHJcblx0XHRcclxuXHRcdC8vIENyZWF0ZSBpY29uIHByZXZpZXcgdXNpbmcgT2JzaWRpYW4ncyBzZXRJY29uXHJcblx0XHRjb25zdCBhdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XHJcblx0XHRzZXRJY29uKGF1eC5jcmVhdGVTcGFuKHsgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicgfSksIGl0ZW0uaWQpO1xyXG5cdH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb25maXJtTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblx0cmVzdWx0OiBib29sZWFuID0gZmFsc2U7XHJcblx0cmVzb2x2ZVByb21pc2U6ICgocmVzdWx0OiBib29sZWFuKSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcHJpdmF0ZSBtZXNzYWdlOiBzdHJpbmcsIHByaXZhdGUgY29uZmlybVRleHQ6IHN0cmluZyA9IFwiQ29uZmlybVwiLCBwcml2YXRlIGNhbmNlbFRleHQ6IHN0cmluZyA9IFwiQ2FuY2VsXCIpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0fVxyXG5cclxuXHRvbk9wZW4oKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdFx0Y29udGVudEVsLmFkZENsYXNzKFwiYXN0cm8tY29tcG9zZXItY29uZmlybS1tb2RhbFwiKTtcclxuXHJcblx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogdGhpcy5tZXNzYWdlIH0pO1xyXG5cclxuXHRcdGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibW9kYWwtYnV0dG9uLWNvbnRhaW5lclwiIH0pO1xyXG5cclxuXHRcdGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IHRoaXMuY2FuY2VsVGV4dCxcclxuXHRcdH0pO1xyXG5cdFx0Y2FuY2VsQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzdWx0ID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0Y29uc3QgY29uZmlybUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IHRoaXMuY29uZmlybVRleHQsXHJcblx0XHRcdGNsczogXCJtb2QtY3RhIG1vZC13YXJuaW5nXCIsXHJcblx0XHR9KTtcclxuXHRcdGNvbmZpcm1CdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5yZXN1bHQgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0b25DbG9zZSgpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XHJcblx0XHRpZiAodGhpcy5yZXNvbHZlUHJvbWlzZSkge1xyXG5cdFx0XHR0aGlzLnJlc29sdmVQcm9taXNlKHRoaXMucmVzdWx0KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIHdhaXRGb3JSZXN1bHQoKTogUHJvbWlzZTxib29sZWFuPiB7XHJcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHRcdFx0dGhpcy5yZXNvbHZlUHJvbWlzZSA9IHJlc29sdmU7XHJcblx0XHRcdHRoaXMub3BlbigpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59XHJcblxyXG4iLCAiLyoqXHJcbiAqIENvbXBhdGliaWxpdHkgdXRpbGl0aWVzIGZvciBzZXR0aW5nc1xyXG4gKiBQcm92aWRlcyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IGZvciBTZXR0aW5nR3JvdXAgKHJlcXVpcmVzIEFQSSAxLjExLjArKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFNldHRpbmcsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgKiBhcyBPYnNpZGlhbk1vZHVsZSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIHRoYXQgd29ya3Mgd2l0aCBib3RoIFNldHRpbmdHcm91cCBhbmQgZmFsbGJhY2sgY29udGFpbmVyXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCk6IHZvaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgc2V0dGluZ3MgY29udGFpbmVyIHRoYXQgdXNlcyBTZXR0aW5nR3JvdXAgaWYgYXZhaWxhYmxlIChBUEkgMS4xMS4wKyksXHJcbiAqIG90aGVyd2lzZSBmYWxscyBiYWNrIHRvIGNyZWF0aW5nIGEgaGVhZGluZyBhbmQgdXNpbmcgdGhlIGNvbnRhaW5lciBkaXJlY3RseS5cclxuICogXHJcbiAqIFVzZXMgcmVxdWlyZUFwaVZlcnNpb24oJzEuMTEuMCcpIHRvIGNoZWNrIGlmIFNldHRpbmdHcm91cCBpcyBhdmFpbGFibGUuXHJcbiAqIFRoaXMgaXMgdGhlIG9mZmljaWFsIE9ic2lkaWFuIEFQSSBtZXRob2QgZm9yIHZlcnNpb24gY2hlY2tpbmcuXHJcbiAqIFxyXG4gKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgY29udGFpbmVyIGVsZW1lbnQgZm9yIHNldHRpbmdzXHJcbiAqIEBwYXJhbSBoZWFkaW5nIC0gVGhlIGhlYWRpbmcgdGV4dCBmb3IgdGhlIHNldHRpbmdzIGdyb3VwIChvcHRpb25hbClcclxuICogQHBhcmFtIG1hbmlmZXN0SWQgLSBUaGUgcGx1Z2luJ3MgbWFuaWZlc3QgSUQgZm9yIENTUyBzY29waW5nIChyZXF1aXJlZCBmb3IgZmFsbGJhY2sgbW9kZSlcclxuICogQHJldHVybnMgQSBjb250YWluZXIgdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgc2V0dGluZ3NcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXR0aW5nc0dyb3VwKFxyXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcclxuXHRoZWFkaW5nPzogc3RyaW5nLFxyXG5cdG1hbmlmZXN0SWQ/OiBzdHJpbmdcclxuKTogU2V0dGluZ3NDb250YWluZXIge1xyXG5cdC8vIENoZWNrIGlmIFNldHRpbmdHcm91cCBpcyBhdmFpbGFibGUgKEFQSSAxLjExLjArKVxyXG5cdC8vIHJlcXVpcmVBcGlWZXJzaW9uIGlzIHRoZSBvZmZpY2lhbCBPYnNpZGlhbiBBUEkgbWV0aG9kIGZvciB2ZXJzaW9uIGNoZWNraW5nXHJcblx0aWYgKHJlcXVpcmVBcGlWZXJzaW9uKCcxLjExLjAnKSkge1xyXG5cdFx0Ly8gVXNlIFNldHRpbmdHcm91cCAtIGl0J3MgZ3VhcmFudGVlZCB0byBleGlzdCBpZiByZXF1aXJlQXBpVmVyc2lvbiByZXR1cm5zIHRydWVcclxuXHRcdC8vIEFjY2VzcyBTZXR0aW5nR3JvdXAgdmlhIHR5cGUgYXNzZXJ0aW9uIHNpbmNlIGl0IG1heSBub3QgYmUgaW4gdHlwZSBkZWZpbml0aW9uc1xyXG5cdFx0Ly8gZm9yIG9sZGVyIFR5cGVTY3JpcHQgdmVyc2lvbnMsIGJ1dCBleGlzdHMgYXQgcnVudGltZSBpbiBPYnNpZGlhbiAxLjExLjArXHJcblx0XHQvLyBVc2luZyB1bmtub3duIGluc3RlYWQgb2YgYW55IHRvIHNhdGlzZnkgZXNsaW50IHdoaWxlIG1haW50YWluaW5nIHR5cGUgc2FmZXR5XHJcblx0XHRjb25zdCBTZXR0aW5nR3JvdXBDbGFzcyA9IChPYnNpZGlhbk1vZHVsZSBhcyB1bmtub3duIGFzIHsgU2V0dGluZ0dyb3VwPzogbmV3IChjb250YWluZXJFbDogSFRNTEVsZW1lbnQpID0+IHtcclxuXHRcdFx0c2V0SGVhZGluZyhoZWFkaW5nOiBzdHJpbmcpOiB7XHJcblx0XHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCk6IHZvaWQ7XHJcblx0XHR9IH0pLlNldHRpbmdHcm91cDtcclxuXHRcdFxyXG5cdFx0aWYgKFNldHRpbmdHcm91cENsYXNzKSB7XHJcblx0XHRcdGNvbnN0IGdyb3VwID0gaGVhZGluZyBcclxuXHRcdFx0XHQ/IG5ldyBTZXR0aW5nR3JvdXBDbGFzcyhjb250YWluZXJFbCkuc2V0SGVhZGluZyhoZWFkaW5nKVxyXG5cdFx0XHRcdDogbmV3IFNldHRpbmdHcm91cENsYXNzKGNvbnRhaW5lckVsKTtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCkge1xyXG5cdFx0XHRcdFx0Z3JvdXAuYWRkU2V0dGluZyhjYik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHQvLyBGYWxsYmFjayBwYXRoIChlaXRoZXIgQVBJIDwgMS4xMS4wIG9yIFNldHRpbmdHcm91cCBub3QgZm91bmQpXHJcblx0Ly8gQWRkIHNjb3BpbmcgY2xhc3MgdG8gY29udGFpbmVyRWwgdG8gc2NvcGUgQ1NTIHRvIG9ubHkgdGhpcyBwbHVnaW4ncyBzZXR0aW5nc1xyXG5cdGlmIChtYW5pZmVzdElkKSB7XHJcblx0XHRjb250YWluZXJFbC5hZGRDbGFzcyhgJHttYW5pZmVzdElkfS1zZXR0aW5ncy1jb21wYXRgKTtcclxuXHR9XHJcblx0XHJcblx0e1xyXG5cdFx0Ly8gRmFsbGJhY2s6IENyZWF0ZSBhIGhlYWRpbmcgbWFudWFsbHkgZm9yIG9sZGVyIEFQSSB2ZXJzaW9uc1xyXG5cdFx0Ly8gTm90ZTogV2hpbGUgYmVzdCBwcmFjdGljZSBwcmVmZXJzIFNldHRpbmcuc2V0SGVhZGluZygpLCB0aGUgZmFsbGJhY2sgcGF0aFxyXG5cdFx0Ly8gaXMgZm9yIHZlcnNpb25zIHRoYXQgbWF5IG5vdCBzdXBwb3J0IGl0LCBzbyBtYW51YWwgaGVhZGluZyBpcyBhcHByb3ByaWF0ZSBoZXJlXHJcblx0XHRpZiAoaGVhZGluZykge1xyXG5cdFx0XHRjb25zdCBoZWFkaW5nRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ3NldHRpbmctZ3JvdXAtaGVhZGluZycpO1xyXG5cdFx0XHRoZWFkaW5nRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiBoZWFkaW5nIH0pO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCkge1xyXG5cdFx0XHRcdGNvbnN0IHNldHRpbmcgPSBuZXcgU2V0dGluZyhjb250YWluZXJFbCk7XHJcblx0XHRcdFx0Y2Ioc2V0dGluZyk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgeyBURmlsZSwgSGVhZGluZ0NhY2hlLCBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgbWF0Y2hlc0ZvbGRlclBhdHRlcm4sIHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eSB9IGZyb20gXCIuL3BhdGgtbWF0Y2hpbmdcIjtcbmltcG9ydCB7IHRvS2ViYWJDYXNlIH0gZnJvbSBcIi4vc3RyaW5nLXV0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBIZWFkaW5nTGlua0dlbmVyYXRvciB7XG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncykgeyB9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIHRleHQgdG8ga2ViYWItY2FzZSBzbHVnIGZvciBVUkxzXG5cdCAqL1xuXHQvLyBMb2NhbCB0b0tlYmFiQ2FzZSByZW1vdmVkLCB1c2luZyBpbXBvcnRlZCBvbmUgaW5zdGVhZFxuXG5cdC8qKlxuXHQgKiBHZXRzIHRoZSBBc3Ryby1jb21wYXRpYmxlIFVSTCBmcm9tIGFuIGludGVybmFsIGxpbmsgKGNvcGllZCBmcm9tIExpbmtDb252ZXJ0ZXIpXG5cdCAqL1xuXHRwcml2YXRlIGdldEFzdHJvVXJsRnJvbUludGVybmFsTGluayhsaW5rOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGhhc2hJbmRleCA9IGxpbmsuaW5kZXhPZignIycpO1xuXHRcdGxldCBwYXRoID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKDAsIGhhc2hJbmRleCkgOiBsaW5rO1xuXHRcdGNvbnN0IGFuY2hvciA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZShoYXNoSW5kZXgpIDogJyc7XG5cblx0XHRwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC5tZCQvLCBcIlwiKTtcblxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aFxuXHRcdGxldCBiYXNlUGF0aCA9IFwiXCI7XG5cdFx0bGV0IGNvbnRlbnRGb2xkZXIgPSBcIlwiO1xuXHRcdGxldCBjcmVhdGlvbk1vZGU6IFwiZmlsZVwiIHwgXCJmb2xkZXJcIiA9IFwiZmlsZVwiO1xuXHRcdGxldCBpbmRleEZpbGVOYW1lID0gXCJcIjtcblxuXHRcdC8vIENoZWNrIGFsbCBjb250ZW50IHR5cGVzLCBzb3J0ZWQgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9yZSBzcGVjaWZpYyBmaXJzdClcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSB0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRjb25zdCBzb3J0ZWRUeXBlcyA9IHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eShjb250ZW50VHlwZXMpO1xuXG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRUeXBlcykge1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcblxuXHRcdFx0bGV0IG1hdGNoZXMgPSBmYWxzZTtcblxuXHRcdFx0Ly8gSGFuZGxlIGJsYW5rIGZvbGRlciAocm9vdCkgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xuXHRcdFx0XHRpZiAoIXBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IHBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdG1hdGNoZXMgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKHBhdGgsIGNvbnRlbnRUeXBlLmZvbGRlcikpIHtcblx0XHRcdFx0bWF0Y2hlcyA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChtYXRjaGVzKSB7XG5cdFx0XHRcdGNvbnRlbnRGb2xkZXIgPSBjb250ZW50VHlwZS5mb2xkZXIgfHwgXCJcIjtcblx0XHRcdFx0YmFzZVBhdGggPSBjb250ZW50VHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIjtcblx0XHRcdFx0Y3JlYXRpb25Nb2RlID0gY29udGVudFR5cGUuY3JlYXRpb25Nb2RlO1xuXHRcdFx0XHRpbmRleEZpbGVOYW1lID0gY29udGVudFR5cGUuaW5kZXhGaWxlTmFtZSB8fCBcIlwiO1xuXHRcdFx0XHRicmVhazsgLy8gTW9zdCBzcGVjaWZpYyBwYXR0ZXJuIHdpbnNcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblxuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogaWYgdGhlIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZSAocmVnYXJkbGVzcyBvZiBjcmVhdGlvbiBtb2RlKSxcblx0XHQvLyB0cmVhdCBpdCBhcyBmb2xkZXItYmFzZWQgbG9naWNcblx0XHQvLyBOb3RlOiBXZSBvbmx5IHNldCBhZGRUcmFpbGluZ1NsYXNoIGhlcmU7IHRoZSBmaW5hbCBjaGVjayB3aWxsIHByZXZlbnQgaXQgaWYgdGhlcmUncyBhbiBhbmNob3Jcblx0XHRpZiAoaW5kZXhGaWxlTmFtZSAmJiBpbmRleEZpbGVOYW1lLnRyaW0oKSAhPT0gXCJcIikge1xuXHRcdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0XHRpZiAocGFydHNbcGFydHMubGVuZ3RoIC0gMV0gPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHQvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBsb2dpYyBpZiBubyBpbmRleCBmaWxlIG5hbWUgaXMgc3BlY2lmaWVkXG5cdFx0XHQvLyBEZWZhdWx0IHRvIFwiaW5kZXhcIiB3aGVuIGluZGV4RmlsZU5hbWUgaXMgYmxhbmtcblx0XHRcdGNvbnN0IGRlZmF1bHRJbmRleE5hbWUgPSBcImluZGV4XCI7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcblx0XHRcdGlmIChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSA9PT0gZGVmYXVsdEluZGV4TmFtZSkge1xuXHRcdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y29uc3Qgc2x1Z1BhcnRzID0gcGF0aC5zcGxpdCgnLycpLm1hcChwYXJ0ID0+IHRvS2ViYWJDYXNlKHBhcnQpKTtcblx0XHRjb25zdCBzbHVnID0gc2x1Z1BhcnRzLmpvaW4oJy8nKTtcblxuXHRcdC8vIEZvcm1hdCBiYXNlIHBhdGhcblx0XHRpZiAoYmFzZVBhdGgpIHtcblx0XHRcdGlmICghYmFzZVBhdGguc3RhcnRzV2l0aChcIi9cIikpIGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcblx0XHRcdGlmICghYmFzZVBhdGguZW5kc1dpdGgoXCIvXCIpKSBiYXNlUGF0aCArPSBcIi9cIjtcblx0XHR9XG5cblx0XHQvLyBEZXRlcm1pbmUgaWYgd2Ugc2hvdWxkIGFkZCB0cmFpbGluZyBzbGFzaFxuXHRcdC8vIENSSVRJQ0FMOiBOZXZlciBhZGQgdHJhaWxpbmcgc2xhc2ggYmVmb3JlIGFuIGFuY2hvciAoZS5nLiwgL2Fib3V0I2hlYWRpbmcgbm90IC9hYm91dC8jaGVhZGluZylcblx0XHQvLyBUaGlzIGlzIGVzcGVjaWFsbHkgaW1wb3J0YW50IGZvciBhbmNob3IgbGlua3MgZnJvbSBjb3B5IGhlYWRpbmcgVVJMIGZ1bmN0aW9uYWxpdHlcblx0XHQvLyBBbmNob3IgbGlua3Mgc2hvdWxkIE5FVkVSIGhhdmUgdHJhaWxpbmcgc2xhc2hlcywgcmVnYXJkbGVzcyBvZiBzZXR0aW5nc1xuXHRcdGNvbnN0IHNob3VsZEFkZFRyYWlsaW5nU2xhc2ggPSAodGhpcy5zZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoKSAmJiAhYW5jaG9yO1xuXG5cdFx0cmV0dXJuIGAke2Jhc2VQYXRofSR7c2x1Z30ke3Nob3VsZEFkZFRyYWlsaW5nU2xhc2ggPyAnLycgOiAnJ30ke2FuY2hvcn1gO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIHN0YW5kYXJkIE9ic2lkaWFuIGxpbmsgdG8gYSBoZWFkaW5nLCByZXNwZWN0aW5nIHVzZXIncyBsaW5rIGZvcm1hdCBwcmVmZXJlbmNlXG5cdCAqL1xuXHRnZW5lcmF0ZU9ic2lkaWFuTGluayhhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XG5cblx0XHQvLyBDaGVjayBpZiB1c2VyIHByZWZlcnMgd2lraWxpbmtzIGJ5IHRlc3RpbmcgT2JzaWRpYW4ncyBkZWZhdWx0IGJlaGF2aW9yXG5cdFx0Y29uc3QgdGVzdExpbmsgPSBhcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoZmlsZSwgJycsICcnKTtcblx0XHRpZiAodGVzdExpbmsuc3RhcnRzV2l0aCgnW1snKSkge1xuXHRcdFx0Ly8gVXNlciBwcmVmZXJzIHdpa2lsaW5rcyAtIHVzZSBqdXN0IHRoZSBmaWxlbmFtZSAoYmFzZW5hbWUpIHdpdGhvdXQgcGF0aFxuXHRcdFx0Y29uc3QgZmlsZU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuXHRcdFx0cmV0dXJuIGBbWyR7ZmlsZU5hbWV9IyR7aGVhZGluZ1RleHR9fCR7aGVhZGluZ1RleHR9XV1gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBVc2VyIHByZWZlcnMgbWFya2Rvd24gbGlua3MgLSB1c2UgT2JzaWRpYW4ncyBtZXRob2Qgd2l0aCBoZWFkaW5nIHRleHQgYXMtaXMgKFVSTC1lbmNvZGVkKVxuXHRcdFx0Ly8gR2V0IHRoZSBiYXNlIGxpbmsgZnJvbSBPYnNpZGlhbiAocmVzcGVjdHMgdXNlcidzIHBhdGggc2V0dGluZ3MpXG5cdFx0XHRjb25zdCBiYXNlTGluayA9IGFwcC5maWxlTWFuYWdlci5nZW5lcmF0ZU1hcmtkb3duTGluayhmaWxlLCAnJywgJycpO1xuXHRcdFx0Ly8gRXh0cmFjdCB0aGUgcGF0aCBwYXJ0IGFuZCBhZGQgb3VyIGFuY2hvciB3aXRoIHByb3BlciBkaXNwbGF5IHRleHRcblx0XHRcdGlmIChiYXNlTGluay5zdGFydHNXaXRoKCdbWycpKSB7XG5cdFx0XHRcdC8vIFRoaXMgc2hvdWxkbid0IGhhcHBlbiBzaW5jZSB3ZSdyZSBpbiB0aGUgbWFya2Rvd24gYnJhbmNoLCBidXQganVzdCBpbiBjYXNlXG5cdFx0XHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZS5iYXNlbmFtZTtcblx0XHRcdFx0cmV0dXJuIGBbWyR7ZmlsZU5hbWV9IyR7aGVhZGluZ1RleHR9fCR7aGVhZGluZ1RleHR9XV1gO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRXh0cmFjdCB0aGUgcGF0aCBmcm9tIHRoZSBnZW5lcmF0ZWQgbGluayBhbmQgcmVjb25zdHJ1Y3Qgd2l0aCBwcm9wZXIgZGlzcGxheSB0ZXh0XG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gYmFzZUxpbmsubWF0Y2goL1xcWyhbXlxcXV0rKVxcXVxcKChbXildKylcXCkvKTtcblx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRcdFx0Y29uc3QgWywgLCBwYXRoXSA9IG1hdGNoO1xuXHRcdFx0XHRcdC8vIEZvciBPYnNpZGlhbiwgdXNlIHRoZSBoZWFkaW5nIHRleHQgYXMtaXMgKFVSTC1lbmNvZGVkKSwgbm90IGtlYmFiLWNhc2Vcblx0XHRcdFx0XHRyZXR1cm4gYFske2hlYWRpbmdUZXh0fV0oJHtwYXRofSMke2VuY29kZVVSSUNvbXBvbmVudChoZWFkaW5nVGV4dCl9KWA7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gRmFsbGJhY2sgdG8gbWFudWFsIGNvbnN0cnVjdGlvblxuXHRcdFx0XHRcdGNvbnN0IGVuY29kZWRGaWxlbmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChmaWxlLm5hbWUpO1xuXHRcdFx0XHRcdC8vIEZvciBPYnNpZGlhbiwgdXNlIHRoZSBoZWFkaW5nIHRleHQgYXMtaXMgKFVSTC1lbmNvZGVkKVxuXHRcdFx0XHRcdHJldHVybiBgWyR7aGVhZGluZ1RleHR9XSgke2VuY29kZWRGaWxlbmFtZX0jJHtlbmNvZGVVUklDb21wb25lbnQoaGVhZGluZ1RleHQpfSlgO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIHN0YW5kYXJkIE9ic2lkaWFuIHdpa2lsaW5rIHRvIGEgaGVhZGluZ1xuXHQgKi9cblx0Z2VuZXJhdGVPYnNpZGlhbldpa2lsaW5rKGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGhlYWRpbmdUZXh0ID0gaGVhZGluZy5oZWFkaW5nO1xuXHRcdC8vIFVzZSBqdXN0IHRoZSBmaWxlbmFtZSAoYmFzZW5hbWUpLCBub3QgdGhlIGZ1bGwgcGF0aFxuXHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZS5iYXNlbmFtZTtcblx0XHRyZXR1cm4gYFtbJHtmaWxlTmFtZX0jJHtoZWFkaW5nVGV4dH18JHtoZWFkaW5nVGV4dH1dXWA7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIGFuIEFzdHJvLWNvbXBhdGlibGUgbWFya2Rvd24gbGluayB0byBhIGhlYWRpbmdcblx0ICovXG5cdGdlbmVyYXRlQXN0cm9MaW5rKGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGhlYWRpbmdUZXh0ID0gaGVhZGluZy5oZWFkaW5nO1xuXHRcdGNvbnN0IGFuY2hvciA9IHRvS2ViYWJDYXNlKGhlYWRpbmdUZXh0KTtcblx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgdGhlIGV4aXN0aW5nIGxpbmsgY29udmVydGVyXG5cdFx0Y29uc3QgaW50ZXJuYWxMaW5rID0gYCR7ZmlsZS5wYXRofSMke2FuY2hvcn1gO1xuXHRcdGNvbnN0IGFzdHJvVXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsoaW50ZXJuYWxMaW5rKTtcblx0XHRyZXR1cm4gYFske2hlYWRpbmdUZXh0fV0oJHthc3Ryb1VybH0pYDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYW4gQXN0cm8tY29tcGF0aWJsZSB3aWtpbGluayB0byBhIGhlYWRpbmdcblx0ICovXG5cdGdlbmVyYXRlQXN0cm9XaWtpbGluayhmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRjb25zdCBoZWFkaW5nVGV4dCA9IGhlYWRpbmcuaGVhZGluZztcblx0XHRjb25zdCBhbmNob3IgPSB0b0tlYmFiQ2FzZShoZWFkaW5nVGV4dCk7XG5cdFx0Ly8gVXNlIHRoZSBzYW1lIGxvZ2ljIGFzIHRoZSBleGlzdGluZyBsaW5rIGNvbnZlcnRlclxuXHRcdGNvbnN0IGludGVybmFsTGluayA9IGAke2ZpbGUucGF0aH0jJHthbmNob3J9YDtcblx0XHRjb25zdCBhc3Ryb1VybCA9IHRoaXMuZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rKGludGVybmFsTGluayk7XG5cdFx0Ly8gQ3JlYXRlIGEgd2lraWxpbmsgd2l0aCB0aGUgQXN0cm8gVVJMIGFzIHRoZSB0YXJnZXRcblx0XHRyZXR1cm4gYFtbJHtoZWFkaW5nVGV4dH18JHthc3Ryb1VybH1dXWA7XG5cdH1cblxuXHQvKipcblx0ICogRXh0cmFjdHMgdGhlIFVSTCBmcm9tIGEgbWFya2Rvd24gbGluayBvciB3aWtpbGlua1xuXHQgKi9cblx0ZXh0cmFjdFVybChsaW5rOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIEhhbmRsZSBtYXJrZG93biBsaW5rczogW3RleHRdKHVybClcblx0XHRjb25zdCBtYXJrZG93bk1hdGNoID0gbGluay5tYXRjaCgvXFxbKFteXFxdXSspXFxdXFwoKFteKV0rKVxcKS8pO1xuXHRcdGlmIChtYXJrZG93bk1hdGNoKSB7XG5cdFx0XHRyZXR1cm4gbWFya2Rvd25NYXRjaFsyXTtcblx0XHR9XG5cblx0XHQvLyBIYW5kbGUgd2lraWxpbmtzOiBbW3BhdGgjaGVhZGluZ3x0ZXh0XV0gb3IgW1twYXRoI2hlYWRpbmddXVxuXHRcdGNvbnN0IHdpa2lsaW5rTWF0Y2ggPSBsaW5rLm1hdGNoKC9cXFtcXFsoW15cXF1dKylcXF1cXF0vKTtcblx0XHRpZiAod2lraWxpbmtNYXRjaCkge1xuXHRcdFx0Y29uc3QgY29udGVudCA9IHdpa2lsaW5rTWF0Y2hbMV07XG5cdFx0XHQvLyBFeHRyYWN0IHRoZSBwYXRoIHBhcnQgKGJlZm9yZSB8IGlmIHByZXNlbnQpXG5cdFx0XHRjb25zdCBwYXRoUGFydCA9IGNvbnRlbnQuc3BsaXQoJ3wnKVswXTtcblx0XHRcdHJldHVybiBwYXRoUGFydDtcblx0XHR9XG5cblx0XHQvLyBJZiBpdCBkb2Vzbid0IG1hdGNoIGVpdGhlciBmb3JtYXQsIHJldHVybiBhcy1pcyAobWlnaHQgYWxyZWFkeSBiZSBhIFVSTClcblx0XHRyZXR1cm4gbGluaztcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgdGhlIGFwcHJvcHJpYXRlIGxpbmsgZm9ybWF0IGJhc2VkIG9uIHNldHRpbmdzXG5cdCAqL1xuXHRnZW5lcmF0ZUxpbmsoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xuXHRcdGlmICh0aGlzLnNldHRpbmdzLmNvcHlIZWFkaW5nTGlua0Zvcm1hdCA9PT0gXCJhc3Ryb1wiKSB7XG5cdFx0XHQvLyBBc3RybyBmb3JtYXQgYWx3YXlzIHVzZXMgbWFya2Rvd24gbGlua3MgKHdpa2lsaW5rcyB3aXRoIEFzdHJvIFVSTHMgZG9uJ3QgbWFrZSBzZW5zZSlcblx0XHRcdHJldHVybiB0aGlzLmdlbmVyYXRlQXN0cm9MaW5rKGZpbGUsIGhlYWRpbmcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBVc2UgT2JzaWRpYW4ncyBidWlsdC1pbiBtZXRob2Qgd2hpY2ggcmVzcGVjdHMgdXNlciBzZXR0aW5nc1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2VuZXJhdGVPYnNpZGlhbkxpbmsoYXBwLCBmaWxlLCBoZWFkaW5nKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRmluZHMgdGhlIGhlYWRpbmcgYXQgYSBzcGVjaWZpYyBsaW5lIGluIGEgZmlsZVxuXHQgKi9cblx0ZmluZEhlYWRpbmdBdExpbmUoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBsaW5lOiBudW1iZXIpOiBIZWFkaW5nQ2FjaGUgfCBudWxsIHtcblx0XHRjb25zdCBjYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRpZiAoIWNhY2hlIHx8ICFjYWNoZS5oZWFkaW5ncykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gRmluZCB0aGUgaGVhZGluZyB0aGF0IGNvbnRhaW5zIHRoaXMgbGluZVxuXHRcdGZvciAobGV0IGkgPSBjYWNoZS5oZWFkaW5ncy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0Y29uc3QgaGVhZGluZyA9IGNhY2hlLmhlYWRpbmdzW2ldO1xuXHRcdFx0aWYgKGhlYWRpbmcucG9zaXRpb24uc3RhcnQubGluZSA8PSBsaW5lKSB7XG5cdFx0XHRcdHJldHVybiBoZWFkaW5nO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQ29udGVudFR5cGUsIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgTWlncmF0aW9uTW9kYWwsIE1pZ3JhdGlvbkNvbmZsaWN0UmVzdWx0IH0gZnJvbSBcIi4uL3VpL2NvbXBvbmVudHMvTWlncmF0aW9uTW9kYWxcIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdUYWIgfSBmcm9tIFwiLi4vdWkvc2V0dGluZ3MtdGFiXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTWlncmF0aW9uU2VydmljZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBwcml2YXRlIHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSkgeyB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNaWdyYXRlIG9sZCBwb3N0cy9wYWdlcyBzZXR0aW5ncyB0byB1bmlmaWVkIGNvbnRlbnQgdHlwZXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIG1pZ3JhdGVTZXR0aW5nc0lmTmVlZGVkKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIG1pZ3JhdGlvbiBpcyBhbHJlYWR5IGNvbXBsZXRlZFxyXG4gICAgICAgIGlmIChzZXR0aW5ncy5taWdyYXRpb25Db21wbGV0ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIG9sZCBzZXR0aW5ncyB0byBtaWdyYXRlXHJcbiAgICAgICAgY29uc3QgaGFzUG9zdHNTZXR0aW5ncyA9IHNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uICE9PSB1bmRlZmluZWQgJiYgc2V0dGluZ3MuYXV0b21hdGVQb3N0Q3JlYXRpb247XHJcbiAgICAgICAgY29uc3QgaGFzUGFnZXNTZXR0aW5ncyA9IHNldHRpbmdzLmVuYWJsZVBhZ2VzICE9PSB1bmRlZmluZWQgJiYgc2V0dGluZ3MuZW5hYmxlUGFnZXM7XHJcblxyXG4gICAgICAgIGlmICghaGFzUG9zdHNTZXR0aW5ncyAmJiAhaGFzUGFnZXNTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAvLyBObyBvbGQgc2V0dGluZ3MgdG8gbWlncmF0ZSwgbWFyayBhcyBjb21wbGV0ZWRcclxuICAgICAgICAgICAgc2V0dGluZ3MubWlncmF0aW9uQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGZvciBuYW1pbmcgY29uZmxpY3RzXHJcbiAgICAgICAgY29uc3QgbGVnYWN5Q29udGVudFR5cGVzID0gKHNldHRpbmdzIGFzIHVua25vd24gYXMgeyBjdXN0b21Db250ZW50VHlwZXM/OiBDb250ZW50VHlwZVtdIH0pLmN1c3RvbUNvbnRlbnRUeXBlcztcclxuICAgICAgICBjb25zdCBleGlzdGluZ0NvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBsZWdhY3lDb250ZW50VHlwZXMgfHwgW107XHJcbiAgICAgICAgY29uc3QgY29uZmxpY3RzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgIGlmIChleGlzdGluZ0NvbnRlbnRUeXBlcy5zb21lKChjdDogQ29udGVudFR5cGUpID0+IGN0Lm5hbWUgPT09IFwiUG9zdHNcIikpIHtcclxuICAgICAgICAgICAgY29uZmxpY3RzLnB1c2goXCJQb3N0c1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV4aXN0aW5nQ29udGVudFR5cGVzLnNvbWUoKGN0OiBDb250ZW50VHlwZSkgPT4gY3QubmFtZSA9PT0gXCJQYWdlc1wiKSkge1xyXG4gICAgICAgICAgICBjb25mbGljdHMucHVzaChcIlBhZ2VzXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHNob3VsZE1pZ3JhdGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAvLyBJZiBjb25mbGljdHMgZXhpc3QsIHByb21wdCB1c2VyXHJcbiAgICAgICAgaWYgKGNvbmZsaWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2b2lkIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBNaWdyYXRpb25Nb2RhbCh0aGlzLmFwcCwgY29uZmxpY3RzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVvdXRQcm9taXNlID0gbmV3IFByb21pc2U8TWlncmF0aW9uQ29uZmxpY3RSZXN1bHQ+KCh0aW1lb3V0UmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0UmVzb2x2ZSh7IGFjdGlvbjogXCJza2lwXCIgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwMDApOyAvLyAzMCBzZWNvbmQgdGltZW91dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5yYWNlKFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC53YWl0Rm9yUmVzdWx0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dFByb21pc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuYWN0aW9uID09PSBcInNraXBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZE1pZ3JhdGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiTWlncmF0aW9uIHNraXBwZWQuIE9sZCBwb3N0cy9wYWdlcyBzZXR0aW5ncyB3aWxsIGJlIGlnbm9yZWQuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiTWlncmF0aW9uIG1vZGFsIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG91bGRNaWdyYXRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiTWlncmF0aW9uIHNraXBwZWQgZHVlIHRvIGVycm9yLiBZb3UgY2FuIG1pZ3JhdGUgbWFudWFsbHkgaW4gc2V0dGluZ3MuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgNTAwKTsgLy8gU21hbGwgZGVsYXkgdG8gZW5zdXJlIFVJIGlzIHJlYWR5XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFzaG91bGRNaWdyYXRlKSB7XHJcbiAgICAgICAgICAgIHNldHRpbmdzLm1pZ3JhdGlvbkNvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBQZXJmb3JtIG1pZ3JhdGlvblxyXG4gICAgICAgIGNvbnN0IG1pZ3JhdGVkVHlwZXM6IENvbnRlbnRUeXBlW10gPSBbXTtcclxuXHJcbiAgICAgICAgLy8gTWlncmF0ZSBQb3N0c1xyXG4gICAgICAgIGlmIChoYXNQb3N0c1NldHRpbmdzICYmICFjb25mbGljdHMuaW5jbHVkZXMoXCJQb3N0c1wiKSkge1xyXG4gICAgICAgICAgICBjb25zdCBwb3N0c1R5cGU6IENvbnRlbnRUeXBlID0ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGBwb3N0cy0ke0RhdGUubm93KCl9YCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiUG9zdHNcIixcclxuICAgICAgICAgICAgICAgIGZvbGRlcjogc2V0dGluZ3MucG9zdHNGb2xkZXIgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIGxpbmtCYXNlUGF0aDogc2V0dGluZ3MucG9zdHNMaW5rQmFzZVBhdGggfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBzZXR0aW5ncy5kZWZhdWx0VGVtcGxhdGUgfHwgJy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGF0ZToge3tkYXRlfX1cXG50YWdzOiBbXVxcbi0tLVxcbicsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgY3JlYXRpb25Nb2RlOiBzZXR0aW5ncy5jcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCIsXHJcbiAgICAgICAgICAgICAgICBpbmRleEZpbGVOYW1lOiBzZXR0aW5ncy5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBpZ25vcmVTdWJmb2xkZXJzOiBzZXR0aW5ncy5vbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyIHx8IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlVW5kZXJzY29yZVByZWZpeDogc2V0dGluZ3MuZW5hYmxlVW5kZXJzY29yZVByZWZpeCB8fCBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHVzZU1keEV4dGVuc2lvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG1pZ3JhdGVkVHlwZXMucHVzaChwb3N0c1R5cGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTWlncmF0ZSBQYWdlc1xyXG4gICAgICAgIGlmIChoYXNQYWdlc1NldHRpbmdzICYmICFjb25mbGljdHMuaW5jbHVkZXMoXCJQYWdlc1wiKSkge1xyXG4gICAgICAgICAgICBjb25zdCBwYWdlc1R5cGU6IENvbnRlbnRUeXBlID0ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGBwYWdlcy0ke0RhdGUubm93KCl9YCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiUGFnZXNcIixcclxuICAgICAgICAgICAgICAgIGZvbGRlcjogc2V0dGluZ3MucGFnZXNGb2xkZXIgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIGxpbmtCYXNlUGF0aDogc2V0dGluZ3MucGFnZXNMaW5rQmFzZVBhdGggfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBzZXR0aW5ncy5wYWdlVGVtcGxhdGUgfHwgJy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGVzY3JpcHRpb246IFwiXCJcXG4tLS1cXG4nLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0aW9uTW9kZTogc2V0dGluZ3MucGFnZXNDcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCIsXHJcbiAgICAgICAgICAgICAgICBpbmRleEZpbGVOYW1lOiBzZXR0aW5ncy5wYWdlc0luZGV4RmlsZU5hbWUgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIGlnbm9yZVN1YmZvbGRlcnM6IHNldHRpbmdzLm9ubHlBdXRvbWF0ZUluUGFnZXNGb2xkZXIgfHwgZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHVzZU1keEV4dGVuc2lvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG1pZ3JhdGVkVHlwZXMucHVzaChwYWdlc1R5cGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGcm9tTmV3ID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRnJvbUxlZ2FjeSA9IGxlZ2FjeUNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHJcbiAgICAgICAgbGV0IGV4aXN0aW5nVHlwZXM6IENvbnRlbnRUeXBlW10gPSBleGlzdGluZ0Zyb21OZXcubGVuZ3RoID4gMCA/IGV4aXN0aW5nRnJvbU5ldyA6IGV4aXN0aW5nRnJvbUxlZ2FjeTtcclxuICAgICAgICBsZXQgZmluYWxUeXBlczogQ29udGVudFR5cGVbXSA9IFsuLi5leGlzdGluZ1R5cGVzXTtcclxuXHJcbiAgICAgICAgaWYgKG1pZ3JhdGVkVHlwZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ05hbWVzID0gbmV3IFNldChleGlzdGluZ1R5cGVzLm1hcChjdCA9PiBjdC5uYW1lKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld01pZ3JhdGVkVHlwZXMgPSBtaWdyYXRlZFR5cGVzLmZpbHRlcihtdCA9PiAhZXhpc3RpbmdOYW1lcy5oYXMobXQubmFtZSkpO1xyXG5cclxuICAgICAgICAgICAgaWYgKG5ld01pZ3JhdGVkVHlwZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZmluYWxUeXBlcyA9IFsuLi5leGlzdGluZ1R5cGVzLCAuLi5uZXdNaWdyYXRlZFR5cGVzXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0dGluZ3MuY29udGVudFR5cGVzID0gZmluYWxUeXBlcztcclxuXHJcbiAgICAgICAgLy8gQ2xlYW4gdXAgbGVnYWN5IGZpZWxkc1xyXG4gICAgICAgIGNvbnN0IGxlZ2FjeUZpZWxkcyA9IFtcclxuICAgICAgICAgICAgJ2N1c3RvbUNvbnRlbnRUeXBlcycsICdlbmFibGVVbmRlcnNjb3JlUHJlZml4JywgJ3Bvc3RzRm9sZGVyJywgJ3Bvc3RzTGlua0Jhc2VQYXRoJyxcclxuICAgICAgICAgICAgJ2F1dG9tYXRlUG9zdENyZWF0aW9uJywgJ2NyZWF0aW9uTW9kZScsICdpbmRleEZpbGVOYW1lJywgJ2V4Y2x1ZGVkRGlyZWN0b3JpZXMnLFxyXG4gICAgICAgICAgICAnb25seUF1dG9tYXRlSW5Qb3N0c0ZvbGRlcicsICdlbmFibGVQYWdlcycsICdwYWdlc0ZvbGRlcicsICdwYWdlc0xpbmtCYXNlUGF0aCcsXHJcbiAgICAgICAgICAgICdwYWdlc0NyZWF0aW9uTW9kZScsICdwYWdlc0luZGV4RmlsZU5hbWUnLCAncGFnZVRlbXBsYXRlJywgJ29ubHlBdXRvbWF0ZUluUGFnZXNGb2xkZXInXHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3NSZWNvcmQgPSBzZXR0aW5ncyBhcyB1bmtub3duIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xyXG4gICAgICAgIGZvciAoY29uc3QgZmllbGQgb2YgbGVnYWN5RmllbGRzKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBzZXR0aW5nc1JlY29yZFtmaWVsZF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXR0aW5ncy5taWdyYXRpb25Db21wbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuICAgICAgICBpZiAobWlncmF0ZWRUeXBlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYE1pZ3JhdGlvbiBjb21wbGV0ZWQ6ICR7bWlncmF0ZWRUeXBlcy5sZW5ndGh9IGNvbnRlbnQgdHlwZShzKSBtaWdyYXRlZC5gKTtcclxuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzVGFiIGluc3RhbmNlb2YgQXN0cm9Db21wb3NlclNldHRpbmdUYWIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZXR0aW5nc1RhYiA9IHRoaXMucGx1Z2luLnNldHRpbmdzVGFiO1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nc1RhYi5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIgfHwgc2V0dGluZ3NUYWIuY29udGFpbmVyRWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzVGFiLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiQ291bGQgbm90IHJlZnJlc2ggc2V0dGluZ3MgdGFiIGFmdGVyIG1pZ3JhdGlvbjpcIiwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBNaWdyYXRpb25Db25mbGljdFJlc3VsdCB7XHJcblx0YWN0aW9uOiBcInNraXBcIiB8IFwibWlncmF0ZVwiO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTWlncmF0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblx0cmVzdWx0OiBNaWdyYXRpb25Db25mbGljdFJlc3VsdCB8IG51bGwgPSBudWxsO1xyXG5cdHJlc29sdmVQcm9taXNlOiAoKHJlc3VsdDogTWlncmF0aW9uQ29uZmxpY3RSZXN1bHQpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBjb25mbGljdHM6IHN0cmluZ1tdKSB7XHJcblx0XHRzdXBlcihhcHApO1xyXG5cdH1cclxuXHJcblx0b25PcGVuKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcclxuXHRcdGNvbnRlbnRFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLW1pZ3JhdGlvbi1tb2RhbFwiKTtcclxuXHJcblx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiTWlncmF0aW9uIGNvbmZsaWN0IGRldGVjdGVkXCIgfSk7XHJcblxyXG5cdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7XHJcblx0XHRcdHRleHQ6IFwiWW91IGhhdmUgZXhpc3RpbmcgY29udGVudCB0eXBlcyB3aXRoIG5hbWVzIHRoYXQgY29uZmxpY3Qgd2l0aCBwb3N0cyBvciBwYWdlcy4gSG93IHdvdWxkIHlvdSBsaWtlIHRvIHByb2NlZWQ/XCIsXHJcblx0XHR9KTtcclxuXHJcblx0XHRjb25zdCBjb25mbGljdExpc3QgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJ1bFwiKTtcclxuXHRcdGNvbmZsaWN0TGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJTa2lwIG1pZ3JhdGlvbjoga2VlcCB5b3VyIGV4aXN0aW5nIHBvc3RzL3BhZ2VzIHNldHRpbmdzICh0aGV5IHdpbGwgYmUgaWdub3JlZClcIiB9KTtcclxuXHRcdGNvbmZsaWN0TGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJNaWdyYXRlIHdpdGggcmVuYW1lZCB0eXBlczogY3JlYXRlICdwb3N0cyAobWlncmF0ZWQpJyBhbmQgJ3BhZ2VzIChtaWdyYXRlZCknIGNvbnRlbnQgdHlwZXNcIiB9KTtcclxuXHJcblx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1vZGFsLWJ1dHRvbi1jb250YWluZXJcIiB9KTtcclxuXHJcblx0XHRjb25zdCBza2lwQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0dGV4dDogXCJTa2lwIG1pZ3JhdGlvblwiLFxyXG5cdFx0XHRjbHM6IFwibW9kLWN0YVwiLFxyXG5cdFx0fSk7XHJcblx0XHRza2lwQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzdWx0ID0geyBhY3Rpb246IFwic2tpcFwiIH07XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0Y29uc3QgbWlncmF0ZUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IFwiTWlncmF0ZSB3aXRoIHJlbmFtZWQgdHlwZXNcIixcclxuXHRcdFx0Y2xzOiBcIm1vZC1jdGFcIixcclxuXHRcdH0pO1xyXG5cdFx0bWlncmF0ZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnJlc3VsdCA9IHsgYWN0aW9uOiBcIm1pZ3JhdGVcIiB9O1xyXG5cdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0b25DbG9zZSgpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XHJcblx0XHRpZiAodGhpcy5yZXNvbHZlUHJvbWlzZSAmJiB0aGlzLnJlc3VsdCkge1xyXG5cdFx0XHR0aGlzLnJlc29sdmVQcm9taXNlKHRoaXMucmVzdWx0KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIHdhaXRGb3JSZXN1bHQoKTogUHJvbWlzZTxNaWdyYXRpb25Db25mbGljdFJlc3VsdD4ge1xyXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG5cdFx0XHR0aGlzLm9wZW4oKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IEFwcCwgVEZpbGUsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBDb250ZW50VHlwZSwgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBDT05TVEFOVFMgfSBmcm9tIFwiLi4vc2V0dGluZ3NcIjtcclxuaW1wb3J0IHsgbWF0Y2hlc0ZvbGRlclBhdHRlcm4sIHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eSB9IGZyb20gXCIuLi91dGlscy9wYXRoLW1hdGNoaW5nXCI7XHJcbmltcG9ydCB7IFRpdGxlTW9kYWwgfSBmcm9tIFwiLi4vdWkvdGl0bGUtbW9kYWxcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDcmVhdGVFdmVudFNlcnZpY2Uge1xyXG4gICAgcHJpdmF0ZSBsYXN0UHJvY2Vzc2VkRmlsZXM6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcclxuICAgICAgICBwcml2YXRlIHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZVxyXG4gICAgKSB7IH1cclxuXHJcbiAgICBwdWJsaWMgaGFuZGxlQ3JlYXRlKGZpbGU6IFRGaWxlKTogdm9pZCB7XHJcbiAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB8fCAoZmlsZS5leHRlbnNpb24gIT09IFwibWRcIiAmJiBmaWxlLmV4dGVuc2lvbiAhPT0gXCJtZHhcIikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XHJcblxyXG4gICAgICAgICAgICAvLyBTa2lwIGlmIHRoaXMgZmlsZSB3YXMgY3JlYXRlZCBieSB0aGUgcGx1Z2luIGl0c2VsZiAoVFRMIGNoZWNrKVxyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVkVGltZSA9IHRoaXMucGx1Z2luLnBsdWdpbkNyZWF0ZWRGaWxlcy5nZXQoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoY3JlYXRlZFRpbWUgJiYgbm93IC0gY3JlYXRlZFRpbWUgPCA1ICogNjAgKiAxMDAwKSB7IC8vIDUgbWludXRlcyBUVExcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gUGVyLWZpbGUgZGVib3VuY2UgY2hlY2tcclxuICAgICAgICAgICAgY29uc3QgbGFzdFByb2Nlc3NlZCA9IHRoaXMubGFzdFByb2Nlc3NlZEZpbGVzLmdldChmaWxlUGF0aCkgfHwgMDtcclxuICAgICAgICAgICAgaWYgKGxhc3RQcm9jZXNzZWQgPiAwICYmIG5vdyAtIGxhc3RQcm9jZXNzZWQgPCBDT05TVEFOVFMuREVCT1VOQ0VfTVMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQ2xlYW4gdXAgb2xkIGVudHJpZXMgaW4gbG9jYWwgZGVib3VuY2UgbWFwXHJcbiAgICAgICAgICAgIGlmIChsYXN0UHJvY2Vzc2VkID4gMCAmJiBub3cgLSBsYXN0UHJvY2Vzc2VkID4gMjAwMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZXMuZGVsZXRlKGZpbGVQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gUGVyaW9kaWMgY2xlYW51cCBvZiBkZWJvdW5jZSBtYXBcclxuICAgICAgICAgICAgY29uc3QgcGVyaW9kaWNDdXRvZmYgPSBub3cgLSBDT05TVEFOVFMuREVCT1VOQ0VfTVMgKiAyO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtwYXRoLCB0aW1lXSBvZiB0aGlzLmxhc3RQcm9jZXNzZWRGaWxlcy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aW1lIDwgcGVyaW9kaWNDdXRvZmYpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWRGaWxlcy5kZWxldGUocGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFJlbG9hZCBzZXR0aW5ncyB0byBlbnN1cmUgd2UgaGF2ZSB0aGUgbGF0ZXN0XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgYmFja2dyb3VuZCBwcm9jZXNzaW5nXHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBpc0FjdGl2ZUZpbGUgPSBhY3RpdmVGaWxlICYmIGFjdGl2ZUZpbGUucGF0aCA9PT0gZmlsZS5wYXRoO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLnByb2Nlc3NCYWNrZ3JvdW5kRmlsZUNoYW5nZXMgJiYgIWlzQWN0aXZlRmlsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50VHlwZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcbiAgICAgICAgICAgIGNvbnN0IGhhc0VuYWJsZWRDb250ZW50VHlwZXMgPSBjb250ZW50VHlwZXMuc29tZShjdCA9PiBjdC5lbmFibGVkKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghaGFzRW5hYmxlZENvbnRlbnRUeXBlcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzb3J0ZWRDb250ZW50VHlwZXMgPSBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkoY29udGVudFR5cGVzKTtcclxuICAgICAgICAgICAgbGV0IG1hdGNoZWRDb250ZW50VHlwZUlkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgICAgICAgICAgY29uc3QgbWF0Y2hpbmdUeXBlczogQ29udGVudFR5cGVbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRDb250ZW50VHlwZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY29udGVudFR5cGUuZW5hYmxlZCkgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG1hdGNoZXMgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnRUeXBlLmZvbGRlciB8fCBjb250ZW50VHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgZmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlLmlnbm9yZVN1YmZvbGRlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF0aFNlZ21lbnRzID0gZmlsZVBhdGguc3BsaXQoXCIvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRoRGVwdGggPSBwYXRoU2VnbWVudHMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXR0ZXJuU2VnbWVudHMgPSBjb250ZW50VHlwZS5mb2xkZXIuc3BsaXQoXCIvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBlY3RlZERlcHRoID0gcGF0dGVyblNlZ21lbnRzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvbGRlckRlcHRoID0gcGF0aERlcHRoIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCB8fCBmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoaW5nVHlwZXMucHVzaChjb250ZW50VHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXRjaGVkQ29udGVudFR5cGVJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVkQ29udGVudFR5cGVJZCA9IGNvbnRlbnRUeXBlLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG1hdGNoaW5nVHlwZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHlwZU5hbWVzID0gbWF0Y2hpbmdUeXBlcy5tYXAoY3QgPT4gY3QubmFtZSB8fCBcIlVubmFtZWRcIikuam9pbihcIiwgXCIpO1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTXVsdGlwbGUgY29udGVudCB0eXBlcyAoJHt0eXBlTmFtZXN9KSBtYXRjaCB0aGlzIGZpbGUuIFVzaW5nIG1vc3Qgc3BlY2lmaWM6ICR7bWF0Y2hpbmdUeXBlc1swXS5uYW1lIHx8IFwiVW5uYW1lZFwifWApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIW1hdGNoZWRDb250ZW50VHlwZUlkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLnN0YXQoZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgY29uc3QgaXNOZXdOb3RlID0gc3RhdD8ubXRpbWUgJiYgKG5vdyAtIHN0YXQubXRpbWUgPCBDT05TVEFOVFMuU1RBVF9NVElNRV9USFJFU0hPTEQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFpc05ld05vdGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcmVhZGluZyBmaWxlIGZvciBjcmVhdGUgZGV0ZWN0aW9uOlwiLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChjb250ZW50LnRyaW0oKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudC5zdGFydHNXaXRoKCctLS0nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyRW5kID0gY29udGVudC5pbmRleE9mKCdcXG4tLS0nLCAzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXJFbmQgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyVGV4dCA9IGNvbnRlbnQuc2xpY2UoNCwgZnJvbnRtYXR0ZXJFbmQpLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBmcm9udG1hdHRlclRleHQuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpLmxlbmd0aCA+IDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9jZXNzQmFja2dyb3VuZEZpbGVDaGFuZ2VzICYmIGxpbmVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA+IDEgfHwgKGxpbmVzLmxlbmd0aCA9PT0gMSAmJiAhbGluZXNbMF0uc3RhcnRzV2l0aCgndGl0bGU6JykpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50V2l0aG91dEZyb250bWF0dGVyID0gY29udGVudC5zdGFydHNXaXRoKCctLS0nKVxyXG4gICAgICAgICAgICAgICAgICAgID8gY29udGVudC5zbGljZShjb250ZW50LmluZGV4T2YoJ1xcbi0tLScsIDMpICsgNCkudHJpbSgpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBjb250ZW50LnRyaW0oKTtcclxuICAgICAgICAgICAgICAgIGlmIChjb250ZW50V2l0aG91dEZyb250bWF0dGVyLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEZpbGVzLnNldChmaWxlLnBhdGgsIG5vdyk7XHJcblxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEZpbGVzLmRlbGV0ZShmaWxlLnBhdGgpO1xyXG4gICAgICAgICAgICB9LCBDT05TVEFOVFMuREVCT1VOQ0VfTVMgKyAxMDApO1xyXG5cclxuICAgICAgICAgICAgbmV3IFRpdGxlTW9kYWwodGhpcy5hcHAsIGZpbGUsIHRoaXMucGx1Z2luLCBtYXRjaGVkQ29udGVudFR5cGVJZCwgZmFsc2UsIHRydWUpLm9wZW4oKTtcclxuICAgICAgICB9KSgpO1xyXG4gICAgfVxyXG59XHJcbiIsICIvKipcclxuICogV2FpdHMgZm9yIGFuIGVsZW1lbnQgdG8gYXBwZWFyIGluIHRoZSBET00gdXNpbmcgTXV0YXRpb25PYnNlcnZlci5cclxuICogQHBhcmFtIHNlbGVjdG9yIENTUyBzZWxlY3RvciB0byB3YWl0IGZvclxyXG4gKiBAcGFyYW0gdGltZW91dCBUaW1lb3V0IGluIG1pbGxpc2Vjb25kcyAoZGVmYXVsdDogNTAwMClcclxuICogQHJldHVybnMgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIGVsZW1lbnQgb3IgcmVqZWN0cyBvbiB0aW1lb3V0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckVsZW1lbnQoc2VsZWN0b3I6IHN0cmluZywgdGltZW91dCA9IDUwMDApOiBQcm9taXNlPEVsZW1lbnQ+IHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0Y29uc3QgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG5cdFx0aWYgKGVsZW1lbnQpIHtcclxuXHRcdFx0cmV0dXJuIHJlc29sdmUoZWxlbWVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XHJcblx0XHRcdGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuXHRcdFx0aWYgKHRhcmdldEVsZW1lbnQpIHtcclxuXHRcdFx0XHRyZXNvbHZlKHRhcmdldEVsZW1lbnQpO1xyXG5cdFx0XHRcdG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRvYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcclxuXHRcdFx0Y2hpbGRMaXN0OiB0cnVlLFxyXG5cdFx0XHRzdWJ0cmVlOiB0cnVlLFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Y29uc3QgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0b2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG5cdFx0XHRyZWplY3QobmV3IEVycm9yKGBUaW1lb3V0IHdhaXRpbmcgZm9yIGVsZW1lbnQgbWF0Y2hpbmcgc2VsZWN0b3I6ICR7c2VsZWN0b3J9YCkpO1xyXG5cdFx0fSwgdGltZW91dCk7XHJcblx0fSk7XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsb0JBT087OztBQ2lGQSxJQUFNLG1CQUFtQixDQUFDLFFBQVEsV0FBVyxZQUFZO0FBRXpELElBQU0sWUFBWTtBQUFBLEVBQ3hCLGFBQWE7QUFBQSxFQUNiLHNCQUFzQjtBQUFBLEVBQ3RCLHdCQUF3QjtBQUFBLEVBQ3hCLDRCQUE0QjtBQUM3Qjs7O0FDMUZPLElBQU0sbUJBQTBDO0FBQUEsRUFDdEQsaUJBQ0M7QUFBQSxFQUNELHNCQUFzQjtBQUFBLEVBQ3RCLFlBQVk7QUFBQSxFQUNaLHVCQUF1QjtBQUFBLEVBQ3ZCLHVCQUF1QjtBQUFBLEVBQ3ZCLHlCQUF5QjtBQUFBLEVBQ3pCLDJCQUEyQjtBQUFBLEVBQzNCLHlCQUF5QjtBQUFBLEVBQ3pCLHlCQUF5QjtBQUFBLEVBQ3pCLDRCQUE0QjtBQUFBLEVBQzVCLDBCQUEwQjtBQUFBLEVBQzFCLDZCQUE2QjtBQUFBLEVBQzdCLGdCQUFnQjtBQUFBLEVBQ2hCLHdCQUF3QjtBQUFBLEVBQ3hCLGNBQWMsQ0FBQztBQUFBLEVBQ2Ysb0JBQW9CO0FBQUEsRUFDcEIsdUJBQXVCO0FBQUEsSUFDdEIsU0FBUztBQUFBLElBQ1QsV0FBVztBQUFBLElBQ1gsUUFBUTtBQUFBLEVBQ1Q7QUFBQSxFQUNBLHdCQUF3QjtBQUFBLEVBQ3hCLDhCQUE4QjtBQUMvQjs7O0FDOUJBLElBQUFDLG1CQUFzRzs7O0FDQXRHLHNCQUE0Qzs7O0FDa0JyQyxTQUFTLHFCQUFxQixVQUFrQixlQUFnQztBQUV0RixRQUFNLHFCQUFxQixTQUFTLFlBQVk7QUFDaEQsUUFBTSxvQkFBb0IsY0FBYyxZQUFZLEVBQUUsUUFBUSxZQUFZLEVBQUU7QUFHNUUsTUFBSSxDQUFDLHFCQUFxQixrQkFBa0IsS0FBSyxNQUFNLElBQUk7QUFDMUQsV0FBTyxDQUFDLG1CQUFtQixTQUFTLEdBQUcsS0FBTSxtQkFBbUIsTUFBTSxHQUFHLEVBQUUsV0FBVztBQUFBLEVBQ3ZGO0FBR0EsTUFBSSxDQUFDLGtCQUFrQixTQUFTLEdBQUcsR0FBRztBQUNyQyxXQUFPLHVCQUF1QixxQkFBcUIsbUJBQW1CLFdBQVcsb0JBQW9CLEdBQUc7QUFBQSxFQUN6RztBQUlBLFFBQU0saUJBQWlCLGtCQUNyQixRQUFRLHNCQUFzQixNQUFNLEVBQ3BDLFFBQVEsT0FBTyxPQUFPO0FBR3hCLFFBQU0sZUFBZSxJQUFJLGNBQWM7QUFDdkMsUUFBTSxRQUFRLElBQUksT0FBTyxZQUFZO0FBQ3JDLFNBQU8sTUFBTSxLQUFLLGtCQUFrQjtBQUNyQztBQVNPLFNBQVMsZ0JBQWdCLGVBQStCO0FBQzlELE1BQUksQ0FBQyxpQkFBaUIsY0FBYyxLQUFLLE1BQU0sR0FBSSxRQUFPO0FBQzFELFNBQU8sY0FBYyxNQUFNLEdBQUcsRUFBRTtBQUNqQztBQU9PLFNBQVMseUJBQXVELE9BQWlCO0FBQ3ZGLFNBQU8sQ0FBQyxHQUFHLEtBQUssRUFBRSxLQUFLLENBQUMsR0FBRyxNQUFNO0FBQ2hDLFVBQU0sU0FBUyxnQkFBZ0IsRUFBRSxNQUFNO0FBQ3ZDLFVBQU0sU0FBUyxnQkFBZ0IsRUFBRSxNQUFNO0FBR3ZDLFdBQU8sU0FBUztBQUFBLEVBQ2pCLENBQUM7QUFDRjs7O0FDakVPLFNBQVMsWUFBWSxLQUFxQjtBQUM3QyxTQUFPLElBQ0YsUUFBUSxzQkFBc0IsT0FBTyxFQUNyQyxRQUFRLHdCQUF3QixTQUFTLEVBQ3pDLFlBQVksRUFDWixRQUFRLGlCQUFpQixFQUFFLEVBQzNCLEtBQUssRUFDTCxRQUFRLFFBQVEsR0FBRyxFQUNuQixRQUFRLE9BQU8sR0FBRyxFQUNsQixRQUFRLFVBQVUsRUFBRTtBQUM3Qjs7O0FGVk8sSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBQzNCLFlBQW9CLEtBQWtCLFVBQXlDLFFBQXVDO0FBQWxHO0FBQWtCO0FBQXlDO0FBQUEsRUFBeUM7QUFBQTtBQUFBLEVBR2hILGNBQXFDO0FBVDlDO0FBV0UsU0FBSSxVQUFLLFdBQUwsbUJBQWEsVUFBVTtBQUMxQixhQUFPLEtBQUssT0FBTztBQUFBLElBQ3BCO0FBQ0EsV0FBTyxLQUFLO0FBQUEsRUFDYjtBQUFBLEVBRUEsaUJBQWlCLE9BQWUseUJBQWtDLE9BQWU7QUFDaEYsVUFBTSxhQUFhLFlBQVksS0FBSztBQUVwQyxVQUFNLGlCQUFpQixjQUFjO0FBQ3JDLFVBQU0sU0FBUyx5QkFBeUIsTUFBTTtBQUM5QyxXQUFPLEdBQUcsTUFBTSxHQUFHLGNBQWM7QUFBQSxFQUNsQztBQUFBLEVBRUEsY0FBYyxNQUE0QjtBQUN6QyxVQUFNLFdBQVcsS0FBSztBQUN0QixVQUFNLFdBQVcsS0FBSyxZQUFZO0FBR2xDLFVBQU0sZUFBZSxTQUFTLGdCQUFnQixDQUFDO0FBQy9DLFVBQU0sY0FBYyx5QkFBeUIsWUFBWTtBQUV6RCxlQUFXLGVBQWUsYUFBYTtBQUN0QyxVQUFJLENBQUMsWUFBWSxRQUFTO0FBRzFCLFVBQUksQ0FBQyxZQUFZLFVBQVUsWUFBWSxPQUFPLEtBQUssTUFBTSxJQUFJO0FBQzVELFlBQUksQ0FBQyxTQUFTLFNBQVMsR0FBRyxLQUFLLFNBQVMsTUFBTSxHQUFHLEVBQUUsV0FBVyxHQUFHO0FBQ2hFLGlCQUFPLFlBQVk7QUFBQSxRQUNwQjtBQUFBLE1BQ0QsV0FBVyxxQkFBcUIsVUFBVSxZQUFZLE1BQU0sR0FBRztBQUU5RCxZQUFJLFlBQVksa0JBQWtCO0FBQ2pDLGdCQUFNLGVBQWUsU0FBUyxNQUFNLEdBQUc7QUFDdkMsZ0JBQU0sWUFBWSxhQUFhO0FBQy9CLGdCQUFNLGtCQUFrQixZQUFZLE9BQU8sTUFBTSxHQUFHO0FBQ3BELGdCQUFNLGdCQUFnQixnQkFBZ0I7QUFFdEMsY0FBSSxZQUFZLGlCQUFpQixVQUFVO0FBRzFDLGtCQUFNLGNBQWMsWUFBWTtBQUNoQyxnQkFBSSxnQkFBZ0IsaUJBQWlCLGdCQUFnQixnQkFBZ0IsR0FBRztBQUN2RSxxQkFBTyxZQUFZO0FBQUEsWUFDcEI7QUFBQSxVQUNELE9BQU87QUFFTixnQkFBSSxjQUFjLGVBQWU7QUFDaEMscUJBQU8sWUFBWTtBQUFBLFlBQ3BCO0FBQUEsVUFDRDtBQUFBLFFBQ0QsT0FBTztBQUNOLGlCQUFPLFlBQVk7QUFBQSxRQUNwQjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBR0EsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLGVBQWUsUUFBMkM7QUFDekQsVUFBTSxXQUFXLEtBQUssWUFBWTtBQUNsQyxVQUFNLGVBQWUsU0FBUyxnQkFBZ0IsQ0FBQztBQUMvQyxXQUFPLGFBQWEsS0FBSyxRQUFNLEdBQUcsT0FBTyxNQUFNLEtBQUs7QUFBQSxFQUNyRDtBQUFBLEVBRUEsWUFBWSxNQUE2QjtBQUV4QyxRQUFJLFNBQVMsT0FBUSxRQUFPO0FBRTVCLFVBQU0sY0FBYyxLQUFLLGVBQWUsSUFBSTtBQUM1QyxRQUFJLENBQUMsWUFBYSxRQUFPO0FBRXpCLFVBQU0sV0FBVyxZQUFZO0FBQzdCLFVBQU0sUUFBUSxTQUFTLE1BQU0sSUFBSTtBQUNqQyxRQUFJLGVBQWU7QUFDbkIsZUFBVyxRQUFRLE9BQU87QUFDekIsWUFBTSxVQUFVLEtBQUssS0FBSztBQUMxQixVQUFJLFlBQVksT0FBTztBQUN0Qix1QkFBZSxDQUFDO0FBQ2hCO0FBQUEsTUFDRDtBQUNBLFVBQUksY0FBYztBQUNqQixjQUFNLFFBQVEsUUFBUSxNQUFNLGlCQUFpQjtBQUM3QyxZQUFJLE9BQU87QUFDVixnQkFBTSxNQUFNLE1BQU0sQ0FBQztBQUNuQixnQkFBTSxRQUFRLE1BQU0sQ0FBQztBQUNyQixjQUFJLE1BQU0sU0FBUyxXQUFXLEdBQUc7QUFDaEMsbUJBQU87QUFBQSxVQUNSO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBQ0EsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLE1BQU0sV0FBVyxTQUFxRDtBQTVHdkU7QUE2R0UsVUFBTSxFQUFFLE1BQU0sT0FBTyxLQUFLLElBQUk7QUFFOUIsUUFBSSxDQUFDLE9BQU87QUFDWCxVQUFJLHVCQUFPLGlDQUFpQyxJQUFJLEdBQUc7QUFDbkQsYUFBTztBQUFBLElBQ1I7QUFHQSxVQUFNLGNBQWMsS0FBSyxlQUFlLElBQUk7QUFDNUMsUUFBSSxDQUFDLGVBQWUsU0FBUyxRQUFRO0FBQ3BDLFVBQUksdUJBQU8sZ0JBQWdCLElBQUksYUFBYTtBQUM1QyxhQUFPO0FBQUEsSUFDUjtBQUVBLFVBQU0sYUFBYSxZQUFZLEtBQUs7QUFDcEMsVUFBTSwwQkFBeUIsMkNBQWEsMkJBQTBCO0FBQ3RFLFVBQU0sU0FBUyx5QkFBeUIsTUFBTTtBQUU5QyxRQUFJLGVBQWU7QUFDbkIsUUFBSSxTQUFTLFFBQVE7QUFFcEIscUJBQWU7QUFBQSxJQUNoQixXQUFXLGFBQWE7QUFFdkIsWUFBTSxnQkFBYyxVQUFLLFdBQUwsbUJBQWEsU0FBUTtBQUl6QyxVQUFJLGdCQUFnQixNQUFNLGdCQUFnQixLQUFLO0FBQzlDLHVCQUFlLFlBQVksVUFBVTtBQUFBLE1BQ3RDLE9BQU87QUFDTix1QkFBZTtBQUFBLE1BQ2hCO0FBQUEsSUFDRDtBQUVBLFFBQUksY0FBYztBQUNqQixZQUFNLFNBQVMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFlBQVk7QUFDaEUsVUFBSSxFQUFFLGtCQUFrQiwwQkFBVTtBQUNqQyxjQUFNLEtBQUssSUFBSSxNQUFNLGFBQWEsWUFBWTtBQUFBLE1BQy9DO0FBQUEsSUFDRDtBQUVBLFVBQU0sZ0JBQWUsMkNBQWEsaUJBQWdCO0FBQ2xELFFBQUksaUJBQWlCLFVBQVU7QUFDOUIsYUFBTyxLQUFLLHNCQUFzQixNQUFNLFlBQVksUUFBUSxjQUFjLE1BQU0sV0FBVztBQUFBLElBQzVGLE9BQU87QUFDTixhQUFPLEtBQUssb0JBQW9CLE1BQU0sWUFBWSxRQUFRLGNBQWMsV0FBVztBQUFBLElBQ3BGO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBYyxzQkFBc0IsTUFBYSxZQUFvQixRQUFnQixjQUFzQixNQUFxQixhQUF3RDtBQUN2TCxVQUFNLGFBQWEsR0FBRyxNQUFNLEdBQUcsVUFBVTtBQUN6QyxRQUFJO0FBRUosUUFBSSxjQUFjO0FBRWpCLG1CQUFhLEdBQUcsWUFBWSxJQUFJLFVBQVU7QUFBQSxJQUMzQyxPQUFPO0FBRU4sWUFBTSxhQUFhLEtBQUssU0FBUyxLQUFLLE9BQU8sT0FBTztBQUNwRCxVQUFJLGNBQWMsZUFBZSxLQUFLO0FBQ3JDLHFCQUFhLEdBQUcsVUFBVSxJQUFJLFVBQVU7QUFBQSxNQUN6QyxPQUFPO0FBRU4scUJBQWE7QUFBQSxNQUNkO0FBQUEsSUFDRDtBQUVBLFFBQUk7QUFDSCxZQUFNLFNBQVMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFVBQVU7QUFDOUQsVUFBSSxFQUFFLGtCQUFrQiwwQkFBVTtBQUNqQyxjQUFNLEtBQUssSUFBSSxNQUFNLGFBQWEsVUFBVTtBQUFBLE1BQzdDO0FBQUEsSUFDRCxTQUFRO0FBQUEsSUFFUjtBQUVBLFVBQU0saUJBQWdCLDJDQUFhLGtCQUFpQjtBQUNwRCxVQUFNLGFBQVksMkNBQWEsbUJBQWtCLFNBQVM7QUFDMUQsVUFBTSxXQUFXLEdBQUcsYUFBYSxHQUFHLFNBQVM7QUFDN0MsVUFBTSxVQUFVLEdBQUcsVUFBVSxJQUFJLFFBQVE7QUFFekMsVUFBTSxlQUFlLEtBQUssSUFBSSxNQUFNLHNCQUFzQixPQUFPO0FBQ2pFLFFBQUksd0JBQXdCLHVCQUFPO0FBQ2xDLFVBQUksdUJBQU8sMEJBQTBCLE9BQU8sR0FBRztBQUMvQyxhQUFPO0FBQUEsSUFDUjtBQUlBLFFBQUksS0FBSyxRQUFRO0FBQ2hCLFdBQUssT0FBTyxtQkFBbUIsSUFBSSxTQUFTLEtBQUssSUFBSSxDQUFDO0FBQUEsSUFDdkQ7QUFFQSxRQUFJO0FBQ0gsWUFBTSxLQUFLLElBQUksWUFBWSxXQUFXLE1BQU0sT0FBTztBQUNuRCxZQUFNLFVBQVUsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLE9BQU87QUFDNUQsVUFBSSxFQUFFLG1CQUFtQix3QkFBUTtBQUNoQyxlQUFPO0FBQUEsTUFDUjtBQUVBLGlCQUFXLE1BQU07QUFDaEIsY0FBTSxlQUFlLEtBQUssSUFBSSxVQUFVLGdCQUFnQixlQUFlLEVBQUUsQ0FBQztBQUMxRSxZQUFJLGdCQUFnQixhQUFhLE1BQU07QUFDdEMsZ0JBQU0sT0FBTyxhQUFhO0FBQzFCLGNBQUksUUFBUSxPQUFPLFNBQVMsWUFBWSxVQUFVLE1BQU07QUFDdkQsa0JBQU0sV0FBWSxLQUEyRDtBQUM3RSxnQkFBSSxZQUFZLG1CQUFtQix5QkFBUyxPQUFPLFNBQVMsZUFBZSxZQUFZO0FBQ3RGLHVCQUFTLFdBQVcsT0FBTztBQUFBLFlBQzVCO0FBQUEsVUFDRDtBQUFBLFFBQ0Q7QUFBQSxNQUNELEdBQUcsR0FBRztBQUVOLFlBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxRQUFRLEtBQUs7QUFDN0MsWUFBTSxLQUFLLFNBQVMsT0FBTztBQUczQixZQUFNLGlCQUFpQixNQUFNO0FBbk9oQztBQW9PSSxjQUFNLE9BQU8sS0FBSztBQUNsQixZQUFJLFFBQVEsWUFBWSxNQUFNO0FBQzdCLGdCQUFNLFNBQVUsS0FBNEg7QUFDNUksY0FBSSxRQUFRO0FBQ1gsa0JBQU0sVUFBVSxPQUFPLFNBQVM7QUFDaEMsZ0JBQUksU0FBUztBQUNaLG9CQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFDaEMsb0JBQU0sV0FBVyxNQUFNLFNBQVM7QUFDaEMsb0JBQU0sbUJBQWlCLFdBQU0sUUFBUSxNQUFkLG1CQUFpQixXQUFVO0FBQ2xELHFCQUFPLFVBQVUsRUFBRSxNQUFNLFVBQVUsSUFBSSxlQUFlLENBQUM7QUFDdkQscUJBQU8sTUFBTTtBQUNiLHFCQUFPO0FBQUEsWUFDUjtBQUFBLFVBQ0Q7QUFBQSxRQUNEO0FBQ0EsZUFBTztBQUFBLE1BQ1I7QUFFQSxpQkFBVyxNQUFNO0FBQ2hCLFlBQUksQ0FBQyxlQUFlLEdBQUc7QUFDdEIscUJBQVcsTUFBTTtBQUNoQiwyQkFBZTtBQUFBLFVBQ2hCLEdBQUcsR0FBRztBQUFBLFFBQ1A7QUFBQSxNQUNELEdBQUcsR0FBRztBQUVOLGFBQU87QUFBQSxJQUNSLFNBQVMsT0FBTztBQUNmLFlBQU0sZUFBZSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsT0FBTyxLQUFLO0FBQzFFLFVBQUksdUJBQU8sc0NBQXNDLFlBQVksR0FBRztBQUNoRSxhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsb0JBQW9CLE1BQWEsWUFBb0IsUUFBZ0IsY0FBc0IsYUFBd0Q7QUFDaEssVUFBTSxhQUFZLDJDQUFhLG1CQUFrQixTQUFTO0FBQzFELFVBQU0sVUFBVSxHQUFHLE1BQU0sR0FBRyxVQUFVLEdBQUcsU0FBUztBQUNsRCxRQUFJO0FBRUosUUFBSSxjQUFjO0FBRWpCLGdCQUFVLEdBQUcsWUFBWSxJQUFJLE9BQU87QUFBQSxJQUNyQyxPQUFPO0FBRU4sWUFBTSxhQUFhLEtBQUssU0FBUyxLQUFLLE9BQU8sT0FBTztBQUNwRCxVQUFJLGNBQWMsZUFBZSxLQUFLO0FBQ3JDLGtCQUFVLEdBQUcsVUFBVSxJQUFJLE9BQU87QUFBQSxNQUNuQyxPQUFPO0FBRU4sa0JBQVU7QUFBQSxNQUNYO0FBQUEsSUFDRDtBQUVBLFVBQU0sZUFBZSxLQUFLLElBQUksTUFBTSxzQkFBc0IsT0FBTztBQUNqRSxRQUFJLHdCQUF3Qix5QkFBUyxpQkFBaUIsTUFBTTtBQUMzRCxVQUFJLHVCQUFPLG1CQUFtQixPQUFPLG1CQUFtQjtBQUN4RCxhQUFPO0FBQUEsSUFDUjtBQUlBLFFBQUksS0FBSyxRQUFRO0FBQ2hCLFdBQUssT0FBTyxtQkFBbUIsSUFBSSxTQUFTLEtBQUssSUFBSSxDQUFDO0FBQUEsSUFDdkQ7QUFFQSxRQUFJO0FBRUgsWUFBTSxLQUFLLElBQUksWUFBWSxXQUFXLE1BQU0sT0FBTztBQUVuRCxZQUFNLFVBQVUsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLE9BQU87QUFDNUQsVUFBSSxFQUFFLG1CQUFtQix3QkFBUTtBQUNoQyxZQUFJLHVCQUFPLGdDQUFnQztBQUMzQyxlQUFPO0FBQUEsTUFDUjtBQUVBLFlBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxRQUFRLEtBQUs7QUFDN0MsWUFBTSxLQUFLLFNBQVMsT0FBTztBQUczQixZQUFNLGlCQUFpQixNQUFNO0FBblRoQztBQW9USSxjQUFNLE9BQU8sS0FBSztBQUNsQixZQUFJLFFBQVEsWUFBWSxNQUFNO0FBQzdCLGdCQUFNLFNBQVUsS0FBNEg7QUFDNUksY0FBSSxRQUFRO0FBQ1gsa0JBQU0sVUFBVSxPQUFPLFNBQVM7QUFDaEMsZ0JBQUksU0FBUztBQUNaLG9CQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFDaEMsb0JBQU0sV0FBVyxNQUFNLFNBQVM7QUFDaEMsb0JBQU0sbUJBQWlCLFdBQU0sUUFBUSxNQUFkLG1CQUFpQixXQUFVO0FBQ2xELHFCQUFPLFVBQVUsRUFBRSxNQUFNLFVBQVUsSUFBSSxlQUFlLENBQUM7QUFDdkQscUJBQU8sTUFBTTtBQUNiLHFCQUFPO0FBQUEsWUFDUjtBQUFBLFVBQ0Q7QUFBQSxRQUNEO0FBQ0EsZUFBTztBQUFBLE1BQ1I7QUFFQSxpQkFBVyxNQUFNO0FBQ2hCLFlBQUksQ0FBQyxlQUFlLEdBQUc7QUFDdEIscUJBQVcsTUFBTTtBQUNoQiwyQkFBZTtBQUFBLFVBQ2hCLEdBQUcsR0FBRztBQUFBLFFBQ1A7QUFBQSxNQUNELEdBQUcsR0FBRztBQUVOLGFBQU87QUFBQSxJQUNSLFNBQVMsT0FBTztBQUNmLFlBQU0sZUFBZSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsT0FBTyxLQUFLO0FBQzFFLFVBQUksdUJBQU8sMEJBQTBCLFlBQVksR0FBRztBQUNwRCxhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFBQSxFQUdBLE1BQU0sV0FBVyxTQUErQztBQUMvRCxVQUFNLEVBQUUsTUFBTSxPQUFPLEtBQUssSUFBSTtBQUU5QixRQUFJLENBQUMsT0FBTztBQUNYLFVBQUksdUJBQU8sMENBQTBDO0FBQ3JELGFBQU87QUFBQSxJQUNSO0FBRUEsVUFBTSxjQUFjLEtBQUssZUFBZSxJQUFJO0FBQzVDLFFBQUksQ0FBQyxlQUFlLFNBQVMsUUFBUTtBQUNwQyxVQUFJLHVCQUFPLGdCQUFnQixJQUFJLGFBQWE7QUFDNUMsYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLGFBQWEsWUFBWSxLQUFLO0FBQ3BDLFVBQU0sU0FBUztBQUVmLFVBQU0sZ0JBQWUsMkNBQWEsaUJBQWdCO0FBQ2xELFFBQUksaUJBQWlCLFVBQVU7QUFDOUIsYUFBTyxLQUFLLHNCQUFzQixNQUFNLFlBQVksUUFBUSxNQUFNLFdBQVc7QUFBQSxJQUM5RSxPQUFPO0FBQ04sYUFBTyxLQUFLLG9CQUFvQixNQUFNLFlBQVksUUFBUSxXQUFXO0FBQUEsSUFDdEU7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFjLHNCQUFzQixNQUFhLFlBQW9CLFFBQWdCLE1BQXFCLGFBQXdEO0FBR2pLLFVBQU0saUJBQWdCLDJDQUFhLGtCQUFpQjtBQUNwRCxVQUFNLFVBQVUsS0FBSyxhQUFhO0FBQ2xDLFFBQUksU0FBUztBQUNaLFVBQUksQ0FBQyxLQUFLLFFBQVE7QUFDakIsWUFBSSx1QkFBTywyQ0FBMkM7QUFDdEQsZUFBTztBQUFBLE1BQ1I7QUFDQSxlQUFTLEtBQUssT0FBTyxLQUFLLFdBQVcsR0FBRyxJQUFJLE1BQU07QUFDbEQsWUFBTSxnQkFBZ0IsR0FBRyxNQUFNLEdBQUcsVUFBVTtBQUM1QyxZQUFNLGVBQWUsS0FBSyxPQUFPO0FBQ2pDLFVBQUksQ0FBQyxjQUFjO0FBQ2xCLFlBQUksdUJBQU8sNkNBQTZDO0FBQ3hELGVBQU87QUFBQSxNQUNSO0FBRUEsVUFBSTtBQUNKLFVBQUksYUFBYSxTQUFTLE1BQU0sYUFBYSxTQUFTLEtBQUs7QUFFMUQsd0JBQWdCO0FBQUEsTUFDakIsT0FBTztBQUVOLHdCQUFnQixHQUFHLGFBQWEsSUFBSSxJQUFJLGFBQWE7QUFBQSxNQUN0RDtBQUVBLFlBQU0saUJBQWlCLEtBQUssSUFBSSxNQUFNLHNCQUFzQixhQUFhO0FBQ3pFLFVBQUksMEJBQTBCLHlCQUFTO0FBQ3RDLFlBQUksdUJBQU8sNEJBQTRCLGFBQWEsR0FBRztBQUN2RCxlQUFPO0FBQUEsTUFDUjtBQUVBLFVBQUk7QUFDSCxjQUFNLEtBQUssSUFBSSxZQUFZLFdBQVcsS0FBSyxRQUFRLGFBQWE7QUFBQSxNQUNqRSxTQUFTLE9BQU87QUFDZixjQUFNLGVBQWUsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLE9BQU8sS0FBSztBQUMxRSxZQUFJLHVCQUFPLDRCQUE0QixZQUFZLEdBQUc7QUFDdEQsZUFBTztBQUFBLE1BQ1I7QUFFQSxZQUFNLGNBQWMsR0FBRyxhQUFhLElBQUksS0FBSyxJQUFJO0FBQ2pELFlBQU0sVUFBVSxLQUFLLElBQUksTUFBTSxzQkFBc0IsV0FBVztBQUNoRSxVQUFJLEVBQUUsbUJBQW1CLHdCQUFRO0FBQ2hDLFlBQUksdUJBQU8sZ0NBQWdDO0FBQzNDLGVBQU87QUFBQSxNQUNSO0FBR0EsYUFBTztBQUFBLElBQ1IsT0FBTztBQUNOLFVBQUksQ0FBQyxLQUFLLFFBQVE7QUFDakIsWUFBSSx1QkFBTywyQ0FBMkM7QUFDdEQsZUFBTztBQUFBLE1BQ1I7QUFDQSxlQUFTLEtBQUssU0FBUyxXQUFXLEdBQUcsSUFBSSxNQUFNO0FBRS9DLFlBQU0sWUFBWSxLQUFLO0FBQ3ZCLFlBQU0sVUFBVSxHQUFHLE1BQU0sR0FBRyxVQUFVLElBQUksU0FBUztBQUNuRCxZQUFNLFVBQVUsR0FBRyxLQUFLLE9BQU8sSUFBSSxJQUFJLE9BQU87QUFFOUMsWUFBTSxlQUFlLEtBQUssSUFBSSxNQUFNLHNCQUFzQixPQUFPO0FBQ2pFLFVBQUksd0JBQXdCLHlCQUFTLGlCQUFpQixNQUFNO0FBQzNELFlBQUksdUJBQU8sMEJBQTBCLE9BQU8sR0FBRztBQUMvQyxlQUFPO0FBQUEsTUFDUjtBQUdBLFlBQU0sS0FBSyxJQUFJLFlBQVksV0FBVyxNQUFNLE9BQU87QUFDbkQsWUFBTSxVQUFVLEtBQUssSUFBSSxNQUFNLHNCQUFzQixPQUFPO0FBQzVELFVBQUksRUFBRSxtQkFBbUIsd0JBQVE7QUFDaEMsWUFBSSx1QkFBTyxnQ0FBZ0M7QUFDM0MsZUFBTztBQUFBLE1BQ1I7QUFHQSxhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsb0JBQW9CLE1BQWEsWUFBb0IsUUFBZ0IsYUFBd0Q7QUFDMUksUUFBSSxDQUFDLEtBQUssUUFBUTtBQUNqQixVQUFJLHVCQUFPLDJDQUEyQztBQUN0RCxhQUFPO0FBQUEsSUFDUjtBQUlBLFVBQU0saUJBQWdCLDJDQUFhLGtCQUFpQjtBQUNwRCxVQUFNLFVBQVUsaUJBQ2YsY0FBYyxLQUFLLE1BQU0sTUFDekIsS0FBSyxhQUFhO0FBRW5CLFFBQUksU0FBUztBQUNaLGVBQVMsS0FBSyxPQUFPLEtBQUssV0FBVyxHQUFHLElBQUksTUFBTTtBQUNsRCxZQUFNLGdCQUFnQixHQUFHLE1BQU0sR0FBRyxVQUFVO0FBQzVDLFlBQU0sZUFBZSxLQUFLLE9BQU87QUFDakMsVUFBSSxDQUFDLGNBQWM7QUFDbEIsWUFBSSx1QkFBTyw2Q0FBNkM7QUFDeEQsZUFBTztBQUFBLE1BQ1I7QUFFQSxVQUFJO0FBQ0osVUFBSSxhQUFhLFNBQVMsTUFBTSxhQUFhLFNBQVMsS0FBSztBQUUxRCx3QkFBZ0I7QUFBQSxNQUNqQixPQUFPO0FBRU4sd0JBQWdCLEdBQUcsYUFBYSxJQUFJLElBQUksYUFBYTtBQUFBLE1BQ3REO0FBRUEsWUFBTSxpQkFBaUIsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLGFBQWE7QUFDekUsVUFBSSwwQkFBMEIseUJBQVM7QUFDdEMsWUFBSSx1QkFBTyw0QkFBNEIsYUFBYSxHQUFHO0FBQ3ZELGVBQU87QUFBQSxNQUNSO0FBR0EsWUFBTSxjQUFjLEdBQUcsYUFBYSxJQUFJLEtBQUssSUFBSTtBQUlqRCxVQUFJLEtBQUssUUFBUTtBQUNoQixhQUFLLE9BQU8sbUJBQW1CLElBQUksYUFBYSxLQUFLLElBQUksQ0FBQztBQUFBLE1BQzNEO0FBRUEsVUFBSTtBQUNILGNBQU0sS0FBSyxJQUFJLFlBQVksV0FBVyxLQUFLLFFBQVEsYUFBYTtBQUFBLE1BQ2pFLFNBQVMsT0FBTztBQUNmLGdCQUFRLE1BQU0seUNBQXlDLEtBQUs7QUFDNUQsY0FBTSxlQUFlLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxPQUFPLEtBQUs7QUFDMUUsWUFBSSx1QkFBTyw0QkFBNEIsWUFBWSxHQUFHO0FBQ3RELGVBQU87QUFBQSxNQUNSO0FBRUEsWUFBTUMsV0FBVSxLQUFLLElBQUksTUFBTSxzQkFBc0IsV0FBVztBQUNoRSxVQUFJLEVBQUVBLG9CQUFtQix3QkFBUTtBQUNoQyxZQUFJLHVCQUFPLGdDQUFnQztBQUMzQyxlQUFPO0FBQUEsTUFDUjtBQUVBLGFBQU9BO0FBQUEsSUFDUjtBQUdBLGFBQVMsS0FBSyxTQUFTLFdBQVcsR0FBRyxJQUFJLE1BQU07QUFFL0MsVUFBTSxZQUFZLEtBQUs7QUFDdkIsVUFBTSxVQUFVLEdBQUcsTUFBTSxHQUFHLFVBQVUsSUFBSSxTQUFTO0FBR25ELFFBQUk7QUFDSixRQUFJLEtBQUssT0FBTyxTQUFTLE1BQU0sS0FBSyxPQUFPLFNBQVMsS0FBSztBQUV4RCxnQkFBVTtBQUFBLElBQ1gsT0FBTztBQUVOLGdCQUFVLEdBQUcsS0FBSyxPQUFPLElBQUksSUFBSSxPQUFPO0FBQUEsSUFDekM7QUFFQSxVQUFNLGVBQWUsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLE9BQU87QUFDakUsUUFBSSx3QkFBd0IseUJBQVMsaUJBQWlCLE1BQU07QUFDM0QsVUFBSSx1QkFBTywwQkFBMEIsT0FBTyxHQUFHO0FBQy9DLGFBQU87QUFBQSxJQUNSO0FBSUEsUUFBSSxLQUFLLFFBQVE7QUFDaEIsV0FBSyxPQUFPLG1CQUFtQixJQUFJLFNBQVMsS0FBSyxJQUFJLENBQUM7QUFBQSxJQUN2RDtBQUVBLFFBQUk7QUFDSCxZQUFNLEtBQUssSUFBSSxZQUFZLFdBQVcsTUFBTSxPQUFPO0FBQUEsSUFDcEQsU0FBUyxPQUFPO0FBQ2YsY0FBUSxNQUFNLHVDQUF1QyxLQUFLO0FBQzFELFlBQU0sZUFBZSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsT0FBTyxLQUFLO0FBQzFFLFVBQUksdUJBQU8sMEJBQTBCLFlBQVksR0FBRztBQUNwRCxhQUFPO0FBQUEsSUFDUjtBQUVBLFVBQU0sVUFBVSxLQUFLLElBQUksTUFBTSxzQkFBc0IsT0FBTztBQUM1RCxRQUFJLEVBQUUsbUJBQW1CLHdCQUFRO0FBQ2hDLFVBQUksdUJBQU8sZ0NBQWdDO0FBQzNDLGFBQU87QUFBQSxJQUNSO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFDRDs7O0FHN2lCQSxJQUFBQyxtQkFBbUM7QUFHNUIsSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBQzNCLFlBQW9CLEtBQWtCLFVBQWlDO0FBQW5EO0FBQWtCO0FBQUEsRUFBa0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtoRSxZQUFZLEtBQXFCO0FBQ3hDLFdBQU8sSUFDTCxZQUFZLEVBQ1osUUFBUSxpQkFBaUIsRUFBRSxFQUMzQixLQUFLLEVBQ0wsUUFBUSxRQUFRLEdBQUcsRUFDbkIsUUFBUSxPQUFPLEdBQUcsRUFDbEIsUUFBUSxVQUFVLEVBQUU7QUFBQSxFQUN2QjtBQUFBLEVBRUEsaUJBQWlCLFNBQW9DO0FBQ3BELFFBQUksZ0JBQWdCO0FBQ3BCLFFBQUksaUJBQWlCO0FBQ3JCLFVBQU0scUJBQStDLENBQUM7QUFHdEQsUUFBSSxRQUFRLFdBQVcsS0FBSyxHQUFHO0FBQzlCLHNCQUFnQixRQUFRLFFBQVEsU0FBUyxDQUFDO0FBQzFDLFVBQUksa0JBQWtCLElBQUk7QUFDekIsd0JBQWdCLFFBQVE7QUFBQSxNQUN6QixPQUFPO0FBQ04seUJBQWlCO0FBQUEsTUFDbEI7QUFDQSx1QkFBaUIsUUFBUSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsRUFBRSxLQUFLO0FBRTFELFVBQUk7QUFDSCxZQUFJLGFBQTRCO0FBQ2hDLGNBQU0sWUFBWSxvQkFBSSxJQUFZO0FBRWxDLHVCQUFlLE1BQU0sSUFBSSxFQUFFLFFBQVEsQ0FBQyxTQUFTO0FBQzVDLGdCQUFNLGNBQWMsS0FBSyxLQUFLO0FBRzlCLGdCQUFNLFFBQVEsWUFBWSxNQUFNLHFDQUFxQztBQUNyRSxjQUFJLE9BQU87QUFDVixrQkFBTSxDQUFDLEVBQUUsS0FBSyxLQUFLLElBQUk7QUFDdkIseUJBQWE7QUFDYixrQkFBTSxlQUFlLFFBQVEsTUFBTSxLQUFLLElBQUk7QUFHNUMsa0JBQU0sb0JBQW9CLGFBQWEsTUFBTSxZQUFZO0FBQ3pELGdCQUFJLG1CQUFtQjtBQUV0QixvQkFBTSxlQUFlLGtCQUFrQixDQUFDLEVBQUUsS0FBSztBQUMvQyxpQ0FBbUIsR0FBRyxJQUFJLENBQUM7QUFDM0Isd0JBQVUsSUFBSSxHQUFHO0FBRWpCLGtCQUFJLGNBQWM7QUFHakIsc0JBQU0sUUFBa0IsQ0FBQztBQUN6QixvQkFBSSxjQUFjO0FBQ2xCLG9CQUFJLFdBQVc7QUFDZixvQkFBSSxZQUFZO0FBRWhCLHlCQUFTLElBQUksR0FBRyxJQUFJLGFBQWEsUUFBUSxLQUFLO0FBQzdDLHdCQUFNLE9BQU8sYUFBYSxDQUFDO0FBRTNCLHNCQUFJLENBQUMsYUFBYSxTQUFTLE9BQU8sU0FBUyxNQUFNO0FBQ2hELCtCQUFXO0FBQ1gsZ0NBQVk7QUFBQSxrQkFDYixXQUFXLFlBQVksU0FBUyxXQUFXO0FBRTFDLHdCQUFJLElBQUksS0FBSyxhQUFhLElBQUksQ0FBQyxNQUFNLE1BQU07QUFDMUMscUNBQWU7QUFBQSxvQkFDaEIsT0FBTztBQUNOLGlDQUFXO0FBQ1gsa0NBQVk7QUFBQSxvQkFDYjtBQUFBLGtCQUNELFdBQVcsQ0FBQyxZQUFZLFNBQVMsS0FBSztBQUVyQywwQkFBTSxjQUFjLFlBQVksS0FBSztBQUNyQyx3QkFBSSxhQUFhO0FBRWhCLDRCQUFNLFdBQVcsWUFBWSxRQUFRLGdCQUFnQixFQUFFO0FBQ3ZELDRCQUFNLEtBQUssUUFBUTtBQUFBLG9CQUNwQjtBQUNBLGtDQUFjO0FBQUEsa0JBQ2YsT0FBTztBQUNOLG1DQUFlO0FBQUEsa0JBQ2hCO0FBQUEsZ0JBQ0Q7QUFHQSxvQkFBSSxZQUFZLEtBQUssR0FBRztBQUN2Qix3QkFBTSxjQUFjLFlBQVksS0FBSztBQUNyQyx3QkFBTSxXQUFXLFlBQVksUUFBUSxnQkFBZ0IsRUFBRTtBQUN2RCx3QkFBTSxLQUFLLFFBQVE7QUFBQSxnQkFDcEI7QUFFQSxtQ0FBbUIsR0FBRyxJQUFJO0FBQUEsY0FDM0I7QUFBQSxZQUNELE9BQU87QUFFTixvQkFBTSxrQkFBa0IsaUJBQWlCLFNBQVMsR0FBc0M7QUFDeEYsb0JBQU0sZUFBZSxDQUFDLGdCQUFnQixpQkFBaUI7QUFDdkQsb0JBQU0sa0JBQWtCLG1CQUFtQjtBQUUzQyxrQkFBSSxpQkFBaUI7QUFDcEIsbUNBQW1CLEdBQUcsSUFBSSxDQUFDO0FBQzNCLDBCQUFVLElBQUksR0FBRztBQUFBLGNBQ2xCLE9BQU87QUFFTixzQkFBTSxnQkFBZ0IsYUFBYSxRQUFRLGdCQUFnQixFQUFFO0FBQzdELG1DQUFtQixHQUFHLElBQUksQ0FBQyxhQUFhO0FBQUEsY0FDekM7QUFBQSxZQUNEO0FBQUEsVUFDRCxXQUFXLGNBQWMsWUFBWSxXQUFXLElBQUksR0FBRztBQUV0RCxrQkFBTSxrQkFBa0IsVUFBVSxJQUFJLFVBQVU7QUFFaEQsZ0JBQUksaUJBQWlCO0FBQ3BCLG9CQUFNLE9BQU8sWUFBWSxRQUFRLFNBQVMsRUFBRTtBQUM1QyxrQkFBSSxLQUFNLG9CQUFtQixVQUFVLEVBQUUsS0FBSyxJQUFJO0FBQUEsWUFDbkQ7QUFBQSxVQUNELFdBQVcsZUFBZSxDQUFDLFlBQVksV0FBVyxJQUFJLEtBQUssQ0FBQyxZQUFZLFdBQVcsR0FBRyxHQUFHO0FBR3hGLGtCQUFNLFdBQVcsWUFBWSxNQUFNLG1CQUFtQjtBQUN0RCxnQkFBSSxVQUFVO0FBQ2Isb0JBQU0sQ0FBQyxFQUFFLEtBQUssS0FBSyxJQUFJO0FBQ3ZCLGtCQUFJLENBQUMsbUJBQW1CLEdBQUcsR0FBRztBQUM3QixtQ0FBbUIsR0FBRyxJQUFJLENBQUMsUUFBUSxNQUFNLEtBQUssSUFBSSxFQUFFO0FBQUEsY0FDckQ7QUFBQSxZQUNEO0FBQUEsVUFDRDtBQUFBLFFBQ0QsQ0FBQztBQUVELHlCQUFpQixRQUFRLFNBQU87QUFDL0IsY0FBSSxlQUFlLFNBQVMsTUFBTSxHQUFHLEtBQUssQ0FBQyxtQkFBbUIsR0FBRyxHQUFHO0FBQ25FLCtCQUFtQixHQUFHLElBQUksQ0FBQztBQUFBLFVBQzVCO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRixTQUFRO0FBRVAsWUFBSSx3QkFBTyxnREFBZ0Q7QUFBQSxNQUM1RDtBQUFBLElBQ0Q7QUFFQSxVQUFNLGNBQWMsUUFBUSxNQUFNLGFBQWE7QUFDL0MsV0FBTztBQUFBLE1BQ04sWUFBWTtBQUFBLE1BQ1o7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUEsRUFFQSxjQUFjLGdCQUF3QixPQUE0RTtBQUNqSCxVQUFNLGdCQUFnQixlQUFlLE1BQU0sSUFBSTtBQUMvQyxVQUFNLGdCQUEwQixDQUFDO0FBQ2pDLFVBQU0saUJBQWlDLENBQUM7QUFDeEMsUUFBSSxlQUFlO0FBRW5CLGFBQVMsSUFBSSxHQUFHLElBQUksY0FBYyxRQUFRLEtBQUs7QUFDOUMsWUFBTSxPQUFPLGNBQWMsQ0FBQyxFQUFFLEtBQUs7QUFDbkMsVUFBSSxTQUFTLE9BQU87QUFDbkIsdUJBQWUsQ0FBQztBQUNoQixZQUFJLENBQUMsY0FBYztBQUNsQjtBQUFBLFFBQ0Q7QUFDQTtBQUFBLE1BQ0Q7QUFDQSxVQUFJLGNBQWM7QUFDakIsY0FBTSxRQUFRLEtBQUssTUFBTSxpQkFBaUI7QUFDMUMsWUFBSSxPQUFPO0FBQ1YsZ0JBQU0sQ0FBQyxFQUFFLEtBQUssS0FBSyxJQUFJO0FBQ3ZCLHdCQUFjLEtBQUssR0FBRztBQUd0QixnQkFBTSxrQkFBa0IsaUJBQWlCLFNBQVMsR0FBc0M7QUFFeEYsZ0JBQU0sZUFBZSxDQUFDLFNBQVMsTUFBTSxLQUFLLE1BQU0sTUFBTSxNQUFNLEtBQUssTUFBTTtBQUN2RSxnQkFBTSxrQkFBa0IsbUJBQW1CO0FBRTNDLGNBQUksaUJBQWlCO0FBRXBCLGdCQUFJLFNBQVMsTUFBTSxXQUFXLEdBQUcsR0FBRztBQUVuQyxvQkFBTSxRQUFRLE1BQ1osUUFBUSxVQUFVLEVBQUUsRUFDcEIsTUFBTSxHQUFHLEVBQ1QsSUFBSSxPQUFLLEVBQUUsS0FBSyxDQUFDLEVBQ2pCLE9BQU8sT0FBSyxDQUFDO0FBQ2YsNkJBQWUsR0FBRyxJQUFJO0FBQUEsWUFDdkIsT0FBTztBQUVOLDZCQUFlLEdBQUcsSUFBSSxDQUFDO0FBRXZCLHVCQUFTLElBQUksSUFBSSxHQUFHLElBQUksY0FBYyxRQUFRLEtBQUs7QUFDbEQsc0JBQU0sV0FBVyxjQUFjLENBQUMsRUFBRSxLQUFLO0FBQ3ZDLG9CQUFJLFNBQVMsV0FBVyxJQUFJLEdBQUc7QUFDOUIsd0JBQU0sT0FBTyxTQUFTLFFBQVEsU0FBUyxFQUFFLEVBQUUsS0FBSztBQUNoRCxzQkFBSSxNQUFNO0FBQ1QsMEJBQU0sYUFBYSxlQUFlLEdBQUc7QUFDckMsd0JBQUksTUFBTSxRQUFRLFVBQVUsR0FBRztBQUM5QixpQ0FBVyxLQUFLLElBQUk7QUFBQSxvQkFDckI7QUFBQSxrQkFDRDtBQUFBLGdCQUNELFdBQVcsYUFBYSxTQUFVLFlBQVksQ0FBQyxTQUFTLFdBQVcsSUFBSSxLQUFLLFNBQVMsU0FBUyxHQUFHLEdBQUk7QUFFcEc7QUFBQSxnQkFDRDtBQUFBLGNBQ0Q7QUFBQSxZQUNEO0FBQUEsVUFDRCxPQUFPO0FBRU4sa0JBQU0sT0FBTyxLQUFLLFlBQVksS0FBSztBQUNuQyxrQkFBTSxlQUFlLFNBQVMsSUFDNUIsUUFBUSxrQkFBa0IsS0FBSyxFQUMvQixRQUFRLGlCQUFpQixPQUFPLE9BQU8sb0JBQUksS0FBSyxDQUFDLEVBQUUsT0FBTyxLQUFLLFNBQVMsVUFBVSxDQUFDLEVBQ25GLFFBQVEsaUJBQWlCLElBQUk7QUFFL0IsMkJBQWUsR0FBRyxJQUFJO0FBQUEsVUFDdkI7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFFQSxXQUFPLEVBQUUsZUFBZSxlQUFlO0FBQUEsRUFDeEM7QUFBQSxFQUVBLHdCQUF3QixZQUFzQyxXQUFpQztBQUM5RixRQUFJLGFBQWE7QUFDakIsZUFBVyxPQUFPLFlBQVk7QUFFN0IsWUFBTSxrQkFBa0IsaUJBQWlCLFNBQVMsR0FBc0MsS0FDdEYsYUFBYSxVQUFVLElBQUksR0FBRztBQUVoQyxVQUFJLGlCQUFpQjtBQUNwQixzQkFBYyxHQUFHLEdBQUc7QUFBQTtBQUNwQixZQUFJLFdBQVcsR0FBRyxFQUFFLFNBQVMsR0FBRztBQUMvQixxQkFBVyxHQUFHLEVBQUUsUUFBUSxVQUFRO0FBQy9CLDBCQUFjLE9BQU8sSUFBSTtBQUFBO0FBQUEsVUFDMUIsQ0FBQztBQUFBLFFBQ0Y7QUFBQSxNQUNELE9BQU87QUFDTixzQkFBYyxHQUFHLEdBQUcsS0FBSyxXQUFXLEdBQUcsRUFBRSxDQUFDLEtBQUssRUFBRTtBQUFBO0FBQUEsTUFDbEQ7QUFBQSxJQUNEO0FBQ0Esa0JBQWM7QUFDZCxXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEsTUFBTSx5QkFBeUIsTUFBYSxVQUFrQixNQUFvQztBQUVqRyxVQUFNLFdBQVcsS0FBSyxZQUFZLElBQUk7QUFDdEMsVUFBTSxxQkFBcUIsS0FBSyxpQkFBaUIsSUFBSTtBQUdyRCxRQUFJLENBQUMsb0JBQW9CO0FBQ3hCO0FBQUEsSUFDRDtBQUVBLFVBQU0sVUFBVSxNQUFNLEtBQUssSUFBSSxNQUFNLEtBQUssSUFBSTtBQUM5QyxRQUFJLGdCQUFnQjtBQUNwQixRQUFJLGlCQUFpQjtBQUNyQixRQUFJLGlCQUFpQjtBQUVyQixRQUFJLFFBQVEsV0FBVyxLQUFLLEdBQUc7QUFDOUIsdUJBQWlCO0FBQ2pCLHNCQUFnQixRQUFRLFFBQVEsU0FBUyxDQUFDO0FBQzFDLFVBQUksa0JBQWtCLElBQUk7QUFDekIsd0JBQWdCLFFBQVE7QUFBQSxNQUN6QixPQUFPO0FBQ04seUJBQWlCO0FBQUEsTUFDbEI7QUFDQSx1QkFBaUIsUUFBUSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsRUFBRSxLQUFLO0FBQUEsSUFDM0Q7QUFFQSxVQUFNLFlBQXNCLENBQUM7QUFDN0IsVUFBTSxXQUE4QyxDQUFDO0FBQ3JELFFBQUksYUFBNEI7QUFDaEMsUUFBSSxtQkFBbUI7QUFFdkIsVUFBTSxZQUFZLG9CQUFJLElBQVk7QUFFbEMsbUJBQWUsTUFBTSxJQUFJLEVBQUUsUUFBUSxDQUFDLE1BQU0sVUFBVTtBQUNuRCxZQUFNLGNBQWMsS0FBSyxLQUFLO0FBRzlCLFlBQU0sUUFBUSxZQUFZLE1BQU0scUNBQXFDO0FBQ3JFLFVBQUksT0FBTztBQUNWLGNBQU0sQ0FBQyxFQUFFLEtBQUssS0FBSyxJQUFJO0FBQ3ZCLGtCQUFVLEtBQUssR0FBRztBQUNsQixxQkFBYTtBQUdiLFlBQUksUUFBUSxVQUFVO0FBQ3JCLDZCQUFtQjtBQUFBLFFBQ3BCO0FBRUEsY0FBTSxrQkFBa0IsaUJBQWlCLFNBQVMsR0FBc0M7QUFDeEYsY0FBTSxlQUFlLENBQUMsU0FBUyxNQUFNLEtBQUssTUFBTSxNQUFNLE1BQU0sS0FBSyxNQUFNO0FBQ3ZFLGNBQU0sa0JBQWtCLG1CQUFtQjtBQUUzQyxZQUFJLGlCQUFpQjtBQUNwQixtQkFBUyxHQUFHLElBQUksQ0FBQztBQUNqQixvQkFBVSxJQUFJLEdBQUc7QUFBQSxRQUNsQixPQUFPO0FBQ04sbUJBQVMsR0FBRyxJQUFJLFFBQVEsTUFBTSxLQUFLLElBQUk7QUFBQSxRQUN4QztBQUFBLE1BQ0QsV0FBVyxjQUFjLFVBQVUsSUFBSSxVQUFVLEtBQUssWUFBWSxXQUFXLElBQUksR0FBRztBQUVuRixjQUFNLE9BQU8sWUFBWSxRQUFRLFNBQVMsRUFBRTtBQUM1QyxZQUFJLEtBQU0sQ0FBQyxTQUFTLFVBQVUsRUFBZSxLQUFLLElBQUk7QUFBQSxNQUN2RCxXQUFXLGVBQWUsQ0FBQyxZQUFZLFdBQVcsSUFBSSxLQUFLLENBQUMsWUFBWSxXQUFXLEdBQUcsR0FBRztBQUd4RixjQUFNLFdBQVcsWUFBWSxNQUFNLG1CQUFtQjtBQUN0RCxZQUFJLFVBQVU7QUFDYixnQkFBTSxDQUFDLEVBQUUsS0FBSyxLQUFLLElBQUk7QUFDdkIsY0FBSSxDQUFDLFVBQVUsU0FBUyxHQUFHLEdBQUc7QUFDN0Isc0JBQVUsS0FBSyxHQUFHO0FBQ2xCLHFCQUFTLEdBQUcsSUFBSSxRQUFRLE1BQU0sS0FBSyxJQUFJO0FBQUEsVUFDeEM7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQUlELFFBQUk7QUFDSixRQUFJLFNBQVMsU0FBUyxHQUFHLEtBQUssU0FBUyxTQUFTLEdBQUcsS0FBSyxTQUFTLFNBQVMsSUFBSSxLQUFLLFNBQVMsU0FBUyxJQUFJLEdBQUc7QUFFM0csaUJBQVcsSUFBSSxTQUFTLFFBQVEsTUFBTSxJQUFJLENBQUM7QUFBQSxJQUM1QyxXQUFXLFNBQVMsU0FBUyxHQUFHLEtBQUssU0FBUyxTQUFTLEdBQUcsS0FBSyxTQUFTLFNBQVMsR0FBRyxLQUFLLFNBQVMsU0FBUyxHQUFHLEdBQUc7QUFFaEgsaUJBQVcsSUFBSSxTQUFTLFFBQVEsTUFBTSxLQUFLLENBQUM7QUFBQSxJQUM3QyxPQUFPO0FBRU4saUJBQVc7QUFBQSxJQUNaO0FBQ0EsYUFBUyxRQUFRLElBQUk7QUFHckIsUUFBSSxVQUFVLFVBQVU7QUFDdkIsWUFBTSxVQUFVLEtBQUssWUFBWSxRQUFRO0FBQ3pDLGVBQVMsTUFBTSxJQUFJO0FBQUEsSUFDcEI7QUFJQSxRQUFJLHFCQUFxQixJQUFJO0FBRTVCLGdCQUFVLEtBQUssUUFBUTtBQUFBLElBQ3hCO0FBS0EsUUFBSSxDQUFDLGdCQUFnQjtBQUdwQjtBQUFBLElBQ0Q7QUFHQSxRQUFJLGFBQWE7QUFDakIsZUFBVyxPQUFPLFdBQVc7QUFDNUIsWUFBTSxNQUFNLFNBQVMsR0FBRztBQUN4QixVQUFJLE1BQU0sUUFBUSxHQUFHLEdBQUc7QUFDdkIsc0JBQWMsR0FBRyxHQUFHO0FBQUE7QUFDcEIsWUFBSSxJQUFJLFNBQVMsR0FBRztBQUNuQixjQUFJLFFBQVEsQ0FBQyxTQUFpQjtBQUM3QiwwQkFBYyxPQUFPLElBQUk7QUFBQTtBQUFBLFVBQzFCLENBQUM7QUFBQSxRQUNGO0FBQUEsTUFDRCxPQUFPO0FBQ04sc0JBQWMsR0FBRyxHQUFHLEtBQUssT0FBTyxFQUFFO0FBQUE7QUFBQSxNQUNuQztBQUFBLElBQ0Q7QUFDQSxrQkFBYztBQUdkLFVBQU0sY0FBYyxRQUFRLE1BQU0sYUFBYTtBQUMvQyxrQkFBYztBQUVkLFVBQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxNQUFNLFVBQVU7QUFBQSxFQUM3QztBQUFBLEVBRVEsWUFBWSxNQUE2QjtBQUNoRCxRQUFJLFNBQVMsT0FBUSxRQUFPO0FBRTVCLFVBQU0sZUFBZSxLQUFLLFNBQVMsZ0JBQWdCLENBQUM7QUFDcEQsVUFBTSxjQUFjLGFBQWEsS0FBSyxRQUFNLEdBQUcsT0FBTyxJQUFJO0FBQzFELFFBQUksQ0FBQyxZQUFhLFFBQU87QUFFekIsVUFBTSxXQUFXLFlBQVk7QUFDN0IsVUFBTSxRQUFRLFNBQVMsTUFBTSxJQUFJO0FBQ2pDLFFBQUksZUFBZTtBQUNuQixlQUFXLFFBQVEsT0FBTztBQUN6QixZQUFNLFVBQVUsS0FBSyxLQUFLO0FBQzFCLFVBQUksWUFBWSxPQUFPO0FBQ3RCLHVCQUFlLENBQUM7QUFDaEI7QUFBQSxNQUNEO0FBQ0EsVUFBSSxjQUFjO0FBQ2pCLGNBQU0sUUFBUSxRQUFRLE1BQU0saUJBQWlCO0FBQzdDLFlBQUksT0FBTztBQUNWLGdCQUFNLE1BQU0sTUFBTSxDQUFDO0FBQ25CLGdCQUFNLFFBQVEsTUFBTSxDQUFDO0FBQ3JCLGNBQUksTUFBTSxTQUFTLFdBQVcsR0FBRztBQUNoQyxtQkFBTztBQUFBLFVBQ1I7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFDQSxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUEsRUFHUSxpQkFBaUIsTUFBOEI7QUFDdEQsUUFBSSxTQUFTLE9BQVEsUUFBTztBQUU1QixVQUFNLGVBQWUsS0FBSyxTQUFTLGdCQUFnQixDQUFDO0FBQ3BELFVBQU0sY0FBYyxhQUFhLEtBQUssUUFBTSxHQUFHLE9BQU8sSUFBSTtBQUMxRCxRQUFJLENBQUMsWUFBYSxRQUFPO0FBRXpCLFVBQU0sV0FBVyxZQUFZO0FBQzdCLFdBQU8sU0FBUyxTQUFTLFdBQVc7QUFBQSxFQUNyQztBQUNEOzs7QUMvYUEsSUFBQUMsbUJBQXNDO0FBTS9CLElBQU0sZ0JBQU4sTUFBb0I7QUFBQSxFQUMxQixZQUFvQixVQUF5QyxRQUErQztBQUF4RjtBQUF5QztBQUFBLEVBQWlEO0FBQUE7QUFBQSxFQUd0RyxjQUFxQztBQVY5QztBQVlFLFNBQUksVUFBSyxXQUFMLG1CQUFhLFVBQVU7QUFDMUIsYUFBTyxLQUFLLE9BQU87QUFBQSxJQUNwQjtBQUNBLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQTtBQUFBLEVBSUEsNEJBQTRCLE1BQXNCO0FBQ2pELFVBQU0sWUFBWSxLQUFLLFFBQVEsR0FBRztBQUNsQyxRQUFJLE9BQU8sYUFBYSxJQUFJLEtBQUssTUFBTSxHQUFHLFNBQVMsSUFBSTtBQUN2RCxVQUFNLFNBQVMsYUFBYSxJQUFJLEtBQUssTUFBTSxTQUFTLElBQUk7QUFHeEQsV0FBTyxtQkFBbUIsSUFBSTtBQUM5QixXQUFPLEtBQUssUUFBUSxlQUFlLEVBQUU7QUFJckMsVUFBTSxnQkFBZ0IsS0FBSyxTQUFTLE1BQU0sSUFBSSxTQUFTO0FBQ3ZELFVBQU0sa0JBQWtCLEtBQUssc0JBQXNCLE9BQU8sYUFBYTtBQUN2RSxRQUFJLFdBQVcsZ0JBQWdCLFlBQVk7QUFDM0MsUUFBSSxnQkFBZ0IsZ0JBQWdCLGlCQUFpQjtBQUNyRCxRQUFJLGdCQUFnQixnQkFBZ0IsaUJBQWlCO0FBSXJELFFBQUksZUFBZTtBQUNsQixhQUFPLEtBQUssTUFBTSxjQUFjLFNBQVMsQ0FBQztBQUFBLElBQzNDO0FBRUEsUUFBSSxtQkFBbUI7QUFLdkIsVUFBTSxRQUFRLEtBQUssTUFBTSxHQUFHO0FBQzVCLFVBQU0sV0FBVyxNQUFNLE1BQU0sU0FBUyxDQUFDO0FBR3ZDLFFBQUksaUJBQWlCLGNBQWMsS0FBSyxNQUFNLE1BQU0sYUFBYSxlQUFlO0FBQy9FLFlBQU0sSUFBSTtBQUNWLGFBQU8sTUFBTSxLQUFLLEdBQUc7QUFDckIseUJBQW1CO0FBQUEsSUFDcEIsWUFFVSxDQUFDLGlCQUFpQixjQUFjLEtBQUssTUFBTSxPQUFPLGFBQWEsU0FBUztBQUNqRixZQUFNLElBQUk7QUFDVixhQUFPLE1BQU0sS0FBSyxHQUFHO0FBQ3JCLHlCQUFtQjtBQUFBLElBQ3BCO0FBRUEsVUFBTSxZQUFZLEtBQUssTUFBTSxHQUFHLEVBQUUsSUFBSSxVQUFRLFlBQVksSUFBSSxDQUFDO0FBQy9ELFVBQU0sT0FBTyxVQUFVLEtBQUssR0FBRztBQUcvQixRQUFJLFVBQVU7QUFFYixVQUFJLENBQUMsU0FBUyxXQUFXLEdBQUcsR0FBRztBQUM5QixtQkFBVyxNQUFNO0FBQUEsTUFDbEI7QUFFQSxVQUFJLENBQUMsU0FBUyxTQUFTLEdBQUcsR0FBRztBQUM1QixvQkFBWTtBQUFBLE1BQ2I7QUFBQSxJQUNELE9BQU87QUFFTixpQkFBVztBQUFBLElBQ1o7QUFNQSxVQUFNLFdBQVcsS0FBSyxZQUFZO0FBQ2xDLFVBQU0sMEJBQTBCLFNBQVMsMkJBQTJCLHFCQUFxQixDQUFDO0FBRTFGLFdBQU8sR0FBRyxRQUFRLEdBQUcsSUFBSSxHQUFHLHlCQUF5QixNQUFNLEVBQUUsR0FBRyxNQUFNO0FBQUEsRUFDdkU7QUFBQSxFQUVRLHVDQUF1QyxNQUFjLGlCQUF5Qix3QkFBcUk7QUFFMU4sVUFBTSxZQUFZLEtBQUssUUFBUSxHQUFHO0FBQ2xDLFFBQUksT0FBTyxhQUFhLElBQUksS0FBSyxNQUFNLEdBQUcsU0FBUyxJQUFJO0FBQ3ZELFVBQU0sU0FBUyxhQUFhLElBQUksS0FBSyxNQUFNLFNBQVMsSUFBSTtBQUd4RCxXQUFPLG1CQUFtQixJQUFJO0FBQzlCLFdBQU8sS0FBSyxRQUFRLGVBQWUsRUFBRTtBQUlyQyxRQUFJLFdBQVc7QUFDZixRQUFJLGdCQUFnQjtBQUNwQixRQUFJLGdCQUFnQjtBQUlwQixVQUFNLGdCQUFnQixLQUFLLFNBQVMsTUFBTSxJQUFJLFNBQVM7QUFDdkQsVUFBTSxvQkFBb0IsS0FBSyxzQkFBc0IsT0FBTyxhQUFhO0FBR3pFLFFBQUksQ0FBQyxrQkFBa0IsWUFBWSx1QkFBdUIsVUFBVTtBQUNuRSxpQkFBVyx1QkFBdUI7QUFDbEMsc0JBQWdCLHVCQUF1QjtBQUN2QyxzQkFBZ0IsdUJBQXVCO0FBQUEsSUFDeEMsT0FBTztBQUNOLGlCQUFXLGtCQUFrQjtBQUM3QixzQkFBZ0Isa0JBQWtCO0FBQ2xDLHNCQUFnQixrQkFBa0I7QUFBQSxJQUNuQztBQUdBLFFBQUksZUFBZTtBQUNsQixhQUFPLEtBQUssTUFBTSxjQUFjLFNBQVMsQ0FBQztBQUFBLElBQzNDO0FBRUEsUUFBSSxtQkFBbUI7QUFLdkIsVUFBTSxRQUFRLEtBQUssTUFBTSxHQUFHO0FBQzVCLFVBQU0sV0FBVyxNQUFNLE1BQU0sU0FBUyxDQUFDO0FBR3ZDLFFBQUksaUJBQWlCLGNBQWMsS0FBSyxNQUFNLE1BQU0sYUFBYSxlQUFlO0FBQy9FLFlBQU0sSUFBSTtBQUNWLGFBQU8sTUFBTSxLQUFLLEdBQUc7QUFDckIseUJBQW1CO0FBQUEsSUFDcEIsWUFFVSxDQUFDLGlCQUFpQixjQUFjLEtBQUssTUFBTSxPQUFPLGFBQWEsU0FBUztBQUNqRixZQUFNLElBQUk7QUFDVixhQUFPLE1BQU0sS0FBSyxHQUFHO0FBQ3JCLHlCQUFtQjtBQUFBLElBQ3BCO0FBRUEsVUFBTSxZQUFZLEtBQUssTUFBTSxHQUFHLEVBQUUsSUFBSSxVQUFRLFlBQVksSUFBSSxDQUFDO0FBQy9ELFVBQU0sT0FBTyxVQUFVLEtBQUssR0FBRztBQUcvQixRQUFJLFVBQVU7QUFFYixVQUFJLENBQUMsU0FBUyxXQUFXLEdBQUcsR0FBRztBQUM5QixtQkFBVyxNQUFNO0FBQUEsTUFDbEI7QUFFQSxVQUFJLENBQUMsU0FBUyxTQUFTLEdBQUcsR0FBRztBQUM1QixvQkFBWTtBQUFBLE1BQ2I7QUFBQSxJQUNELE9BQU87QUFFTixpQkFBVztBQUFBLElBQ1o7QUFNQSxVQUFNLFdBQVcsS0FBSyxZQUFZO0FBQ2xDLFVBQU0sMEJBQTBCLFNBQVMsMkJBQTJCLHFCQUFxQixDQUFDO0FBRTFGLFdBQU8sR0FBRyxRQUFRLEdBQUcsSUFBSSxHQUFHLHlCQUF5QixNQUFNLEVBQUUsR0FBRyxNQUFNO0FBQUEsRUFDdkU7QUFBQSxFQUVRLCtCQUErQixVQUEyQjtBQUVqRSxVQUFNLFdBQVcsS0FBSyxZQUFZO0FBQ2xDLFVBQU0sZUFBZSxTQUFTLGdCQUFnQixDQUFDO0FBQy9DLFVBQU0sY0FBYyx5QkFBeUIsWUFBWTtBQUV6RCxlQUFXLGVBQWUsYUFBYTtBQUN0QyxVQUFJLENBQUMsWUFBWSxRQUFTO0FBRzFCLFVBQUksQ0FBQyxZQUFZLFVBQVUsWUFBWSxPQUFPLEtBQUssTUFBTSxJQUFJO0FBQzVELFlBQUksQ0FBQyxTQUFTLFNBQVMsR0FBRyxLQUFLLFNBQVMsTUFBTSxHQUFHLEVBQUUsV0FBVyxHQUFHO0FBQ2hFLGlCQUFPO0FBQUEsUUFDUjtBQUFBLE1BQ0QsV0FBVyxxQkFBcUIsVUFBVSxZQUFZLE1BQU0sR0FBRztBQUU5RCxZQUFJLFlBQVksa0JBQWtCO0FBQ2pDLGdCQUFNLGVBQWUsU0FBUyxNQUFNLEdBQUc7QUFDdkMsZ0JBQU0sWUFBWSxhQUFhO0FBQy9CLGdCQUFNLGtCQUFrQixZQUFZLE9BQU8sTUFBTSxHQUFHO0FBQ3BELGdCQUFNLGdCQUFnQixnQkFBZ0I7QUFFdEMsY0FBSSxZQUFZLGlCQUFpQixVQUFVO0FBRzFDLGtCQUFNLGNBQWMsWUFBWTtBQUNoQyxnQkFBSSxnQkFBZ0IsaUJBQWlCLGdCQUFnQixnQkFBZ0IsR0FBRztBQUN2RSxxQkFBTztBQUFBLFlBQ1I7QUFBQSxVQUNELE9BQU87QUFFTixnQkFBSSxjQUFjLGVBQWU7QUFDaEMscUJBQU87QUFBQSxZQUNSO0FBQUEsVUFDRDtBQUFBLFFBQ0QsT0FBTztBQUNOLGlCQUFPO0FBQUEsUUFDUjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVRLHNCQUFzQixVQUF1SDtBQUVwSixVQUFNLFdBQVcsS0FBSyxZQUFZO0FBQ2xDLFVBQU0sZUFBZSxTQUFTLGdCQUFnQixDQUFDO0FBQy9DLFVBQU0sY0FBYyx5QkFBeUIsWUFBWTtBQUV6RCxlQUFXLGVBQWUsYUFBYTtBQUN0QyxVQUFJLENBQUMsWUFBWSxRQUFTO0FBRzFCLFVBQUksQ0FBQyxZQUFZLFVBQVUsWUFBWSxPQUFPLEtBQUssTUFBTSxJQUFJO0FBQzVELFlBQUksQ0FBQyxTQUFTLFNBQVMsR0FBRyxLQUFLLFNBQVMsTUFBTSxHQUFHLEVBQUUsV0FBVyxHQUFHO0FBQ2hFLGlCQUFPO0FBQUEsWUFDTixVQUFVLFlBQVksZ0JBQWdCO0FBQUEsWUFDdEMsY0FBYyxZQUFZO0FBQUEsWUFDMUIsZUFBZSxZQUFZLGlCQUFpQjtBQUFBLFlBQzVDLGVBQWU7QUFBQSxVQUNoQjtBQUFBLFFBQ0Q7QUFBQSxNQUNELFdBQVcscUJBQXFCLFVBQVUsWUFBWSxNQUFNLEdBQUc7QUFFOUQsWUFBSSxZQUFZLGtCQUFrQjtBQUNqQyxnQkFBTSxlQUFlLFNBQVMsTUFBTSxHQUFHO0FBQ3ZDLGdCQUFNLFlBQVksYUFBYTtBQUMvQixnQkFBTSxrQkFBa0IsWUFBWSxPQUFPLE1BQU0sR0FBRztBQUNwRCxnQkFBTSxnQkFBZ0IsZ0JBQWdCO0FBRXRDLGNBQUksWUFBWSxpQkFBaUIsVUFBVTtBQUcxQyxrQkFBTSxjQUFjLFlBQVk7QUFDaEMsZ0JBQUksZ0JBQWdCLGlCQUFpQixnQkFBZ0IsZ0JBQWdCLEdBQUc7QUFDdkUscUJBQU87QUFBQSxnQkFDTixVQUFVLFlBQVksZ0JBQWdCO0FBQUEsZ0JBQ3RDLGNBQWMsWUFBWTtBQUFBLGdCQUMxQixlQUFlLFlBQVksaUJBQWlCO0FBQUEsZ0JBQzVDLGVBQWUsWUFBWTtBQUFBLGNBQzVCO0FBQUEsWUFDRDtBQUFBLFVBQ0QsT0FBTztBQUVOLGdCQUFJLGNBQWMsZUFBZTtBQUNoQyxxQkFBTztBQUFBLGdCQUNOLFVBQVUsWUFBWSxnQkFBZ0I7QUFBQSxnQkFDdEMsY0FBYyxZQUFZO0FBQUEsZ0JBQzFCLGVBQWUsWUFBWSxpQkFBaUI7QUFBQSxnQkFDNUMsZUFBZSxZQUFZO0FBQUEsY0FDNUI7QUFBQSxZQUNEO0FBQUEsVUFDRDtBQUFBLFFBQ0QsT0FBTztBQUNOLGlCQUFPO0FBQUEsWUFDTixVQUFVLFlBQVksZ0JBQWdCO0FBQUEsWUFDdEMsY0FBYyxZQUFZO0FBQUEsWUFDMUIsZUFBZSxZQUFZLGlCQUFpQjtBQUFBLFlBQzVDLGVBQWUsWUFBWTtBQUFBLFVBQzVCO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBR0EsV0FBTztBQUFBLE1BQ04sVUFBVTtBQUFBLE1BQ1YsY0FBYztBQUFBLE1BQ2QsZUFBZTtBQUFBLE1BQ2YsZUFBZTtBQUFBLElBQ2hCO0FBQUEsRUFDRDtBQUFBLEVBRUEseUJBQXlCLFFBQWdCLE1BQTBCO0FBcFNwRTtBQXFTRSxRQUFJLEVBQUUsZ0JBQWdCLHlCQUFRO0FBQzdCLFVBQUksd0JBQU8saUJBQWlCO0FBQzVCO0FBQUEsSUFDRDtBQUdBLFVBQU0sU0FBUyxPQUFPLFVBQVU7QUFDaEMsVUFBTSxlQUFlLE9BQU87QUFDNUIsVUFBTSxhQUFhLE9BQU87QUFDMUIsVUFBTSxrQkFBa0IsT0FBTyxTQUFTO0FBQ3hDLFVBQU0sb0JBQW9CLGdCQUFnQixNQUFNLElBQUksRUFBRTtBQUN0RCxVQUFNLHVCQUFxQixxQkFBZ0IsTUFBTSxJQUFJLEVBQUUsWUFBWSxNQUF4QyxtQkFBMkMsV0FBVTtBQUVoRixVQUFNLFVBQVUsT0FBTyxTQUFTO0FBQ2hDLFFBQUksYUFBYTtBQUNqQixRQUFJLGlCQUFpQjtBQUNyQixRQUFJLGVBQWU7QUFDbkIsVUFBTSxlQUF5QixDQUFDO0FBR2hDLFVBQU0seUJBQXlCLEtBQUssc0JBQXNCLEtBQUssSUFBSTtBQUduRSxVQUFNLGtCQUFrQjtBQUd4QixVQUFNLGlCQUFpQixDQUFDLGFBQThCO0FBRXJELFVBQUksZ0JBQWdCLEtBQUssUUFBUSxHQUFHO0FBQ25DLGVBQU87QUFBQSxNQUNSO0FBR0EsVUFBSSxTQUFTLE1BQU0sY0FBYyxHQUFHO0FBQ25DLGVBQU87QUFBQSxNQUNSO0FBR0EsVUFBSSxDQUFDLFNBQVMsU0FBUyxLQUFLLEtBQUssQ0FBQyxTQUFTLFNBQVMsTUFBTSxLQUFLLENBQUMsU0FBUyxNQUFNLHFDQUFxQyxHQUFHO0FBQ3RILGVBQU87QUFBQSxNQUNSO0FBSUEsVUFBSTtBQUNKLFVBQUksU0FBUyxTQUFTLEtBQUssS0FBSyxTQUFTLFNBQVMsTUFBTSxHQUFHO0FBQzFELHFCQUFhO0FBQUEsTUFDZCxPQUFPO0FBRU4scUJBQWEsV0FBVztBQUFBLE1BQ3pCO0FBR0EsWUFBTSwwQkFBMEIsS0FBSywrQkFBK0IsVUFBVTtBQUc5RSxZQUFNLG1CQUFtQixDQUFDLFdBQVcsU0FBUyxHQUFHO0FBQ2pELFlBQU0sd0JBQXdCLHVCQUF1QixhQUFhLE1BQU0sdUJBQXVCLGlCQUFpQixVQUFVLHVCQUF1QixrQkFBa0I7QUFFbkssYUFBTywyQkFBNEIsb0JBQW9CO0FBQUEsSUFDeEQ7QUFHQSxpQkFBYSxXQUFXO0FBQUEsTUFDdkI7QUFBQSxNQUNBLENBQUMsT0FBZSxVQUFrQixPQUEyQixnQkFBb0M7QUFFaEcsWUFBSSxnQkFBZ0IsS0FBSyxRQUFRLEdBQUc7QUFDbkM7QUFDQSx1QkFBYSxLQUFLLFFBQVE7QUFDMUIsaUJBQU87QUFBQSxRQUNSO0FBR0EsWUFBSSxDQUFDLGVBQWUsUUFBUSxHQUFHO0FBQzlCO0FBQ0EsdUJBQWEsS0FBSyxRQUFRO0FBQzFCLGlCQUFPO0FBQUEsUUFDUjtBQUVBLGNBQU0sVUFBVSxlQUFlLFNBQVMsUUFBUSxlQUFlLEVBQUU7QUFHakUsY0FBTSxNQUFNLEtBQUssdUNBQXVDLFVBQVUsS0FBSyxNQUFNLHNCQUFzQjtBQUVuRztBQUNBLGVBQU8sSUFBSSxPQUFPLEtBQUssR0FBRztBQUFBLE1BQzNCO0FBQUEsSUFDRDtBQUlBLGlCQUFhLFdBQVc7QUFBQSxNQUN2QjtBQUFBLE1BQ0EsQ0FBQyxPQUFlLGFBQXFCLFNBQWlCO0FBRXJELFlBQUksS0FBSyxNQUFNLGNBQWMsS0FBSyxnQkFBZ0IsS0FBSyxJQUFJLEdBQUc7QUFDN0Q7QUFDQSx1QkFBYSxLQUFLLElBQUk7QUFDdEIsaUJBQU87QUFBQSxRQUNSO0FBR0EsWUFBSSxDQUFDLGVBQWUsSUFBSSxHQUFHO0FBQzFCO0FBQ0EsdUJBQWEsS0FBSyxJQUFJO0FBQ3RCLGlCQUFPO0FBQUEsUUFDUjtBQUVBLGNBQU0sTUFBTSxLQUFLLHVDQUF1QyxNQUFNLEtBQUssTUFBTSxzQkFBc0I7QUFFL0Y7QUFDQSxlQUFPLElBQUksV0FBVyxLQUFLLEdBQUc7QUFBQSxNQUMvQjtBQUFBLElBQ0Q7QUFHQSxpQkFBYSxXQUFXO0FBQUEsTUFDdkI7QUFBQSxNQUNBLENBQUMsVUFBa0I7QUFDbEI7QUFDQSxlQUFPO0FBQUEsTUFDUjtBQUFBLElBQ0Q7QUFHQSxpQkFBYSxXQUFXLFFBQVEsb0JBQW9CLENBQUMsT0FBZSxhQUFxQjtBQUN4RixVQUFJLGdCQUFnQixLQUFLLFFBQVEsR0FBRztBQUNuQztBQUNBLHFCQUFhLEtBQUssUUFBUTtBQUMxQixlQUFPO0FBQUEsTUFDUjtBQUdBLFVBQUksQ0FBQyxlQUFlLFFBQVEsR0FBRztBQUM5QjtBQUNBLHFCQUFhLEtBQUssUUFBUTtBQUMxQixlQUFPO0FBQUEsTUFDUjtBQUVBLFlBQU0sTUFBTSxLQUFLLHVDQUF1QyxVQUFVLEtBQUssTUFBTSxzQkFBc0I7QUFFbkc7QUFDQSxhQUFPLGNBQWMsUUFBUSxLQUFLLEdBQUc7QUFBQSxJQUN0QyxDQUFDO0FBRUQsV0FBTyxTQUFTLFVBQVU7QUFHMUIsVUFBTSxlQUFlLFdBQVcsTUFBTSxJQUFJLEVBQUU7QUFDNUMsVUFBTSxrQkFBZ0IsZ0JBQVcsTUFBTSxJQUFJLEVBQUUsWUFBWSxNQUFuQyxtQkFBc0MsV0FBVTtBQUd0RSxRQUFJLFVBQVU7QUFDZCxRQUFJLFFBQVE7QUFHWixRQUFJLGlCQUFpQixtQkFBbUI7QUFHdkMsVUFBSSxXQUFXLGNBQWM7QUFDNUIsa0JBQVUsS0FBSyxJQUFJLEdBQUcsZUFBZSxDQUFDO0FBQUEsTUFDdkM7QUFBQSxJQUNEO0FBR0EsUUFBSSxrQkFBa0Isb0JBQW9CO0FBRXpDLFVBQUksUUFBUSxlQUFlO0FBQzFCLGdCQUFRLEtBQUssSUFBSSxHQUFHLGFBQWE7QUFBQSxNQUNsQztBQUFBLElBQ0Q7QUFHQSxXQUFPLFVBQVUsRUFBRSxNQUFNLFNBQVMsSUFBSSxNQUFNLENBQUM7QUFHN0MsUUFBSSxpQkFBaUIsS0FBSyxpQkFBaUIsR0FBRztBQUM3QyxVQUFJLHdCQUFPLGFBQWEsY0FBYyxpQkFBaUIsaUJBQWlCLElBQUksTUFBTSxFQUFFLGFBQWE7QUFBQSxJQUNsRyxXQUFXLGlCQUFpQixLQUFLLGVBQWUsR0FBRztBQUNsRCxVQUFJLHdCQUFPLGFBQWEsY0FBYyxRQUFRLGlCQUFpQixJQUFJLE1BQU0sRUFBRSx1QkFBdUIsWUFBWSxRQUFRLGVBQWUsSUFBSSxNQUFNLEVBQUUsMENBQTBDO0FBQUEsSUFDNUwsV0FBVyxlQUFlLEdBQUc7QUFDNUIsVUFBSSx3QkFBTywyQkFBMkIsWUFBWSxRQUFRLGVBQWUsSUFBSSxNQUFNLEVBQUUsMkVBQTJFO0FBQUEsSUFDakssT0FBTztBQUNOLFVBQUksd0JBQU8scUNBQXFDO0FBQUEsSUFDakQ7QUFBQSxFQUNEO0FBQ0Q7OztBQ2hlQSxJQUFBQyxtQkFBa0U7QUFNM0QsSUFBTSxhQUFOLGNBQXlCLHVCQUFNO0FBQUEsRUFVckMsWUFBWSxLQUFVLE1BQW9CLFFBQXNDLE1BQXFCLFdBQVcsT0FBTyxZQUFZLE9BQU87QUFDekksVUFBTSxHQUFHO0FBQ1QsU0FBSyxPQUFPO0FBQ1osU0FBSyxTQUFTO0FBQ2QsU0FBSyxPQUFPO0FBQ1osU0FBSyxXQUFXO0FBQ2hCLFNBQUssWUFBWTtBQUlqQixVQUFNLFdBQVcsT0FBTztBQUN4QixTQUFLLFVBQVUsSUFBSSxlQUFlLEtBQUssVUFBVSxNQUFNO0FBQ3ZELFNBQUssaUJBQWlCLElBQUksZUFBZSxLQUFLLFFBQVE7QUFBQSxFQUN2RDtBQUFBLEVBRUEsTUFBTSx1QkFBd0M7QUFDN0MsUUFBSSxDQUFDLEtBQUssTUFBTTtBQUNmLGFBQU87QUFBQSxJQUNSO0FBR0EsUUFBSTtBQUNILFlBQU0sVUFBVSxNQUFNLEtBQUssSUFBSSxNQUFNLEtBQUssS0FBSyxJQUFJO0FBQ25ELFlBQU0sV0FBVyxLQUFLLFFBQVEsWUFBWSxLQUFLLElBQUk7QUFDbkQsWUFBTSxFQUFFLFdBQVcsSUFBSSxLQUFLLGVBQWUsaUJBQWlCLE9BQU87QUFFbkUsVUFBSSxZQUFZLFlBQVk7QUFDM0IsY0FBTSxhQUFhLFdBQVcsUUFBUTtBQUN0QyxZQUFJLE1BQU0sUUFBUSxVQUFVLEtBQUssV0FBVyxTQUFTLEdBQUc7QUFDdkQsaUJBQU8sT0FBTyxXQUFXLENBQUMsQ0FBQztBQUFBLFFBQzVCO0FBQ0EsWUFBSSxlQUFlLFFBQVEsZUFBZSxRQUFXO0FBQ3BELGlCQUFPLE9BQU8sVUFBVTtBQUFBLFFBQ3pCO0FBQUEsTUFDRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsY0FBUSxNQUFNLGlDQUFpQyxLQUFLO0FBQUEsSUFDckQ7QUFHQSxXQUFPLEtBQUssaUJBQWlCO0FBQUEsRUFDOUI7QUFBQSxFQUVBLGtCQUEwQjtBQUN6QixRQUFJLENBQUMsS0FBSyxNQUFNO0FBQ2YsYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLFdBQVcsS0FBSyxRQUFRLFlBQVksS0FBSyxJQUFJO0FBQ25ELFVBQU0sUUFBUSxLQUFLLElBQUksY0FBYyxhQUFhLEtBQUssSUFBSTtBQUUzRCxTQUFJLCtCQUFPLGdCQUFlLFlBQVksTUFBTSxhQUFhO0FBQ3hELFlBQU0sYUFBYSxNQUFNLFlBQVksUUFBUTtBQUM3QyxVQUFJLE9BQU8sZUFBZSxVQUFVO0FBQ25DLGVBQU87QUFBQSxNQUNSO0FBQ0EsVUFBSSxNQUFNLFFBQVEsVUFBVSxLQUFLLFdBQVcsU0FBUyxHQUFHO0FBQ3ZELGNBQU0sYUFBYSxXQUFXLENBQUM7QUFDL0IsWUFBSSxPQUFPLGVBQWUsVUFBVTtBQUNuQyxpQkFBTztBQUFBLFFBQ1I7QUFDQSxZQUFJLGNBQWMsTUFBTTtBQUN2QixjQUFJLE9BQU8sZUFBZSxZQUFZLE9BQU8sZUFBZSxXQUFXO0FBQ3RFLG1CQUFPLE9BQU8sVUFBVTtBQUFBLFVBQ3pCO0FBQ0EsY0FBSSxPQUFPLGVBQWUsVUFBVTtBQUNuQyxtQkFBTztBQUFBLFVBQ1I7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUNBLFVBQUksY0FBYyxNQUFNO0FBQ3ZCLGVBQU87QUFBQSxNQUNSO0FBQ0EsVUFBSSxPQUFPLGVBQWUsWUFBWSxPQUFPLGVBQWUsV0FBVztBQUN0RSxlQUFPLE9BQU8sVUFBVTtBQUFBLE1BQ3pCO0FBQ0EsVUFBSSxPQUFPLGVBQWUsVUFBVTtBQUNuQyxlQUFPO0FBQUEsTUFDUjtBQUNBLGFBQU87QUFBQSxJQUNSO0FBQ0EsV0FBTyxLQUFLLGlCQUFpQjtBQUFBLEVBQzlCO0FBQUEsRUFFUSxtQkFBMkI7QUFDbEMsUUFBSSxDQUFDLEtBQUssTUFBTTtBQUNmLGFBQU87QUFBQSxJQUNSO0FBRUEsUUFBSSxXQUFXLEtBQUssS0FBSztBQUN6QixRQUFJLEtBQUssS0FBSyxVQUFVLEtBQUssU0FBUyxRQUFRO0FBQzdDLFlBQU0sY0FBYyxLQUFLLFFBQVEsZUFBZSxLQUFLLElBQUk7QUFDekQsWUFBTSxpQkFBZ0IsMkNBQWEsa0JBQWlCO0FBQ3BELFVBQUksY0FBYyxLQUFLLE1BQU0sTUFBTSxhQUFhLGVBQWU7QUFDOUQsbUJBQVcsS0FBSyxLQUFLLE9BQU87QUFBQSxNQUM3QjtBQUFBLElBQ0Q7QUFDQSxRQUFJLFNBQVMsV0FBVyxHQUFHLEdBQUc7QUFDN0IsaUJBQVcsU0FBUyxNQUFNLENBQUM7QUFBQSxJQUM1QjtBQUNBLFdBQU8sU0FBUyxRQUFRLE1BQU0sR0FBRyxFQUFFLE1BQU0sR0FBRyxFQUFFLElBQUksVUFBUSxLQUFLLE9BQU8sQ0FBQyxFQUFFLFlBQVksSUFBSSxLQUFLLE1BQU0sQ0FBQyxDQUFDLEVBQUUsS0FBSyxHQUFHO0FBQUEsRUFDakg7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPQSxnQ0FBd0M7QUFDdkMsUUFBSSxDQUFDLEtBQUssTUFBTTtBQUNmLGFBQU87QUFBQSxJQUNSO0FBRUEsUUFBSSxXQUFXLEtBQUssS0FBSztBQUd6QixRQUFJLEtBQUssS0FBSyxVQUFVLEtBQUssU0FBUyxRQUFRO0FBQzdDLFlBQU0sY0FBYyxLQUFLLFFBQVEsZUFBZSxLQUFLLElBQUk7QUFDekQsWUFBTSxpQkFBZ0IsMkNBQWEsa0JBQWlCO0FBQ3BELFVBQUksY0FBYyxLQUFLLE1BQU0sTUFBTSxhQUFhLGVBQWU7QUFDOUQsbUJBQVcsS0FBSyxLQUFLLE9BQU87QUFBQSxNQUM3QjtBQUFBLElBQ0Q7QUFHQSxRQUFJLFNBQVMsV0FBVyxHQUFHLEdBQUc7QUFDN0IsaUJBQVcsU0FBUyxNQUFNLENBQUM7QUFBQSxJQUM1QjtBQUlBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxTQUFTO0FBQ1IsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFHaEIsVUFBTSxXQUFXLE9BQU8sY0FBYyxPQUFPLDBCQUFTO0FBQ3RELFFBQUksVUFBVTtBQUNiLFdBQUssUUFBUSxTQUFTLDZCQUE2QjtBQUFBLElBQ3BEO0FBRUEsUUFBSSxLQUFLLFVBQVU7QUFDbEIsWUFBTSxXQUFXLEtBQUssbUJBQW1CO0FBRXpDLFVBQUksS0FBSyxTQUFTLFFBQVE7QUFFekIsa0JBQVUsU0FBUyxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNuRCxrQkFBVSxTQUFTLEtBQUssRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQUEsTUFDcEUsT0FBTztBQUNOLGtCQUFVLFNBQVMsTUFBTSxFQUFFLE1BQU0sVUFBVSxRQUFRLFdBQVcsQ0FBQztBQUMvRCxrQkFBVSxTQUFTLEtBQUssRUFBRSxNQUFNLDRCQUE0QixRQUFRLFlBQVksQ0FBQztBQUFBLE1BQ2xGO0FBRUEsV0FBSyxhQUFhLFVBQVUsU0FBUyxTQUFTO0FBQUEsUUFDN0MsTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLFFBQ2IsS0FBSztBQUFBLE1BQ04sQ0FBQztBQUdELFdBQUssS0FBSyxxQkFBcUIsRUFBRSxLQUFLLFdBQVM7QUFDOUMsYUFBSyxXQUFXLFFBQVE7QUFBQSxNQUN6QixDQUFDO0FBQUEsSUFDRixXQUFXLEtBQUssV0FBVztBQUMxQixZQUFNLFdBQVcsS0FBSyxtQkFBbUI7QUFFekMsVUFBSSxLQUFLLFNBQVMsUUFBUTtBQUN6QixrQkFBVSxTQUFTLE1BQU0sRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUNoRCxrQkFBVSxTQUFTLEtBQUssRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQUEsTUFDcEUsT0FBTztBQUNOLGtCQUFVLFNBQVMsTUFBTSxFQUFFLE1BQU0sY0FBYyxRQUFRLFdBQVcsQ0FBQztBQUNuRSxrQkFBVSxTQUFTLEtBQUssRUFBRSxNQUFNLDhCQUE4QixRQUFRLFlBQVksQ0FBQztBQUFBLE1BQ3BGO0FBRUEsV0FBSyxhQUFhLFVBQVUsU0FBUyxTQUFTO0FBQUEsUUFDN0MsTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLFFBQ2IsS0FBSztBQUFBLE1BQ04sQ0FBQztBQUFBLElBRUYsT0FBTztBQUNOLFlBQU0sV0FBVyxLQUFLLG1CQUFtQjtBQUV6QyxVQUFJLEtBQUssU0FBUyxRQUFRO0FBQ3pCLGtCQUFVLFNBQVMsTUFBTSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQ2hELGtCQUFVLFNBQVMsS0FBSyxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFBQSxNQUNwRSxPQUFPO0FBQ04sa0JBQVUsU0FBUyxNQUFNLEVBQUUsTUFBTSxjQUFjLFFBQVEsV0FBVyxDQUFDO0FBQ25FLGtCQUFVLFNBQVMsS0FBSyxFQUFFLE1BQU0sOEJBQThCLFFBQVEsWUFBWSxDQUFDO0FBQUEsTUFDcEY7QUFFQSxXQUFLLGFBQWEsVUFBVSxTQUFTLFNBQVM7QUFBQSxRQUM3QyxNQUFNO0FBQUEsUUFDTixhQUFhO0FBQUEsUUFDYixLQUFLO0FBQUEsTUFDTixDQUFDO0FBR0QsVUFBSSxLQUFLLE1BQU07QUFDZCxjQUFNLGlCQUFpQixLQUFLLDhCQUE4QjtBQUMxRCxZQUFJLGdCQUFnQjtBQUNuQixlQUFLLFdBQVcsUUFBUTtBQUFBLFFBQ3pCO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFDQSxTQUFLLFdBQVcsTUFBTTtBQUV0QixRQUFJLEtBQUssV0FBVztBQUNuQixpQkFBVyxNQUFNO0FBQ2hCLGFBQUssV0FBVyxrQkFBa0IsR0FBRyxDQUFDO0FBQUEsTUFDdkMsR0FBRyxDQUFDO0FBQUEsSUFDTDtBQUVBLFVBQU0sa0JBQWtCLFVBQVUsVUFBVSxFQUFFLEtBQUssa0NBQWtDLENBQUM7QUFFdEYsVUFBTSxlQUFlLGdCQUFnQixTQUFTLFVBQVUsRUFBRSxNQUFNLFVBQVUsS0FBSywrQkFBK0IsQ0FBQztBQUMvRyxpQkFBYSxVQUFVLE1BQU0sS0FBSyxNQUFNO0FBRXhDLFVBQU0sZUFBZSxnQkFBZ0IsU0FBUyxVQUFVLEVBQUUsTUFBTSxLQUFLLFdBQVcsV0FBVyxVQUFVLEtBQUssQ0FBQyxnQ0FBZ0MsU0FBUyxFQUFFLENBQUM7QUFDdkosaUJBQWEsVUFBVSxNQUFNLEtBQUssT0FBTztBQUV6QyxTQUFLLFdBQVcsaUJBQWlCLFlBQVksQ0FBQyxNQUFNO0FBQ25ELFVBQUksRUFBRSxRQUFRLFFBQVMsTUFBSyxLQUFLLE9BQU87QUFBQSxJQUN6QyxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRUEsTUFBTSxTQUFTO0FBQ2QsVUFBTSxRQUFRLEtBQUssV0FBVyxNQUFNLEtBQUs7QUFFekMsUUFBSSxDQUFDLE9BQU87QUFDWCxVQUFJLHdCQUFPLHVCQUF1QjtBQUNsQztBQUFBLElBQ0Q7QUFFQSxRQUFJO0FBQ0gsVUFBSSxVQUF3QjtBQUM1QixVQUFJLEtBQUssVUFBVTtBQUNsQixrQkFBVSxNQUFNLEtBQUssUUFBUSxXQUFXLEVBQUUsTUFBTSxLQUFLLE1BQU8sT0FBTyxNQUFNLEtBQUssS0FBSyxDQUFDO0FBRXBGLFlBQUksU0FBUztBQUNaLGdCQUFNLEtBQUssZUFBZSx5QkFBeUIsU0FBUyxPQUFPLEtBQUssSUFBSTtBQUFBLFFBQzdFLE9BQU87QUFFTixlQUFLLE1BQU07QUFDWDtBQUFBLFFBQ0Q7QUFBQSxNQUNELFdBQVcsS0FBSyxXQUFXO0FBRzFCLFlBQUksS0FBSyxNQUFNO0FBQ2Qsb0JBQVUsTUFBTSxLQUFLLFFBQVEsV0FBVyxFQUFFLE1BQU0sS0FBSyxNQUFNLE9BQU8sTUFBTSxLQUFLLEtBQUssQ0FBQztBQUVuRixnQkFBTSx5QkFBeUIsS0FBSyxPQUFPLFNBQVM7QUFFcEQsY0FBSSxXQUFXLHdCQUF3QjtBQUN0QyxrQkFBTSxLQUFLLG9CQUFvQixTQUFTLE9BQU8sS0FBSyxJQUFJO0FBRXhELGlCQUFLLG9CQUFvQixPQUFPO0FBQUEsVUFDakM7QUFBQSxRQUNEO0FBQUEsTUFDRCxXQUFXLEtBQUssTUFBTTtBQUVyQixrQkFBVSxNQUFNLEtBQUssUUFBUSxXQUFXLEVBQUUsTUFBTSxLQUFLLE1BQU0sT0FBTyxNQUFNLEtBQUssS0FBSyxDQUFDO0FBRW5GLGNBQU0seUJBQXlCLEtBQUssT0FBTyxTQUFTO0FBRXBELFlBQUksV0FBVyx3QkFBd0I7QUFDdEMsZ0JBQU0sS0FBSyxvQkFBb0IsU0FBUyxPQUFPLEtBQUssSUFBSTtBQUV4RCxlQUFLLG9CQUFvQixPQUFPO0FBQUEsUUFDakM7QUFBQSxNQUNELE9BQU87QUFFTixrQkFBVSxNQUFNLEtBQUssY0FBYyxLQUFLO0FBQUEsTUFDekM7QUFFQSxVQUFJLENBQUMsU0FBUztBQUNiLFlBQUksd0JBQU8sYUFBYSxLQUFLLFdBQVcsV0FBVyxRQUFRLElBQUksS0FBSyxJQUFJLEdBQUc7QUFDM0UsYUFBSyxNQUFNO0FBQ1g7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixjQUFRLE1BQU0scUNBQXFDLEtBQUs7QUFDeEQsWUFBTSxlQUFlLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxPQUFPLEtBQUs7QUFDMUUsVUFBSSx3QkFBTyxTQUFTLEtBQUssV0FBVyxhQUFhLFVBQVUsSUFBSSxLQUFLLElBQUksS0FBSyxZQUFZLEdBQUc7QUFDNUYsV0FBSyxNQUFNO0FBQ1g7QUFBQSxJQUNEO0FBRUEsU0FBSyxNQUFNO0FBQUEsRUFDWjtBQUFBLEVBRVEscUJBQTZCO0FBQ3BDLFFBQUksS0FBSyxTQUFTLFFBQVE7QUFDekIsYUFBTztBQUFBLElBQ1I7QUFDQSxVQUFNLGNBQWMsS0FBSyxRQUFRLGVBQWUsS0FBSyxJQUFJO0FBQ3pELFdBQU8sY0FBYyxZQUFZLE9BQU87QUFBQSxFQUN6QztBQUFBLEVBRUEsTUFBYyxjQUFjLE9BQXNDO0FBL1RuRTtBQWlVRSxRQUFJO0FBR0osVUFBTSxnQkFBYyxnQkFBSyxTQUFMLG1CQUFXLFdBQVgsbUJBQW1CLFNBQVE7QUFFL0MsUUFBSSxLQUFLLFNBQVMsUUFBUTtBQUN6QixZQUFNQyxlQUFjLEtBQUssUUFBUSxlQUFlLEtBQUssSUFBSTtBQUd6RCxVQUFJLGdCQUFnQixNQUFNLGdCQUFnQixLQUFLO0FBQzlDLHdCQUFlQSxnQkFBQSxnQkFBQUEsYUFBYSxXQUFVO0FBQUEsTUFDdkMsT0FBTztBQUNOLHVCQUFlO0FBQUEsTUFDaEI7QUFBQSxJQUNELE9BQU87QUFFTixxQkFBZTtBQUFBLElBQ2hCO0FBR0EsVUFBTSxXQUFXLEtBQUssUUFBUSxpQkFBaUIsS0FBSztBQUNwRCxVQUFNLGNBQWMsS0FBSyxRQUFRLGVBQWUsS0FBSyxJQUFJO0FBQ3pELFVBQU0sYUFBWSwyQ0FBYSxtQkFBa0IsU0FBUztBQUMxRCxVQUFNLFdBQVcsZUFBZSxHQUFHLFlBQVksSUFBSSxRQUFRLEdBQUcsU0FBUyxLQUFLLEdBQUcsUUFBUSxHQUFHLFNBQVM7QUFJbkcsUUFBSSxLQUFLLFFBQVE7QUFDaEIsV0FBSyxPQUFPLG1CQUFtQixJQUFJLFVBQVUsS0FBSyxJQUFJLENBQUM7QUFBQSxJQUN4RDtBQUdBLFFBQUksaUJBQWlCO0FBRXJCLFFBQUksS0FBSyxPQUFPLFNBQVMsc0JBQXNCO0FBQzlDLHVCQUFpQixLQUFLLHVCQUF1QixLQUFLO0FBQUEsSUFDbkQ7QUFFQSxRQUFJO0FBQ0gsWUFBTSxVQUFVLE1BQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxVQUFVLGNBQWM7QUFHcEUsWUFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLFFBQVE7QUFDeEMsWUFBTSxLQUFLLFNBQVMsT0FBTztBQUkzQixZQUFNLGlCQUFpQixNQUFNO0FBaFhoQyxZQUFBQztBQWlYSSxjQUFNLE9BQU8sS0FBSztBQUNsQixZQUFJLGdCQUFnQixpQ0FBZ0IsS0FBSyxRQUFRO0FBQ2hELGdCQUFNLFNBQVMsS0FBSztBQUNwQixnQkFBTSxVQUFVLE9BQU8sU0FBUztBQUNoQyxjQUFJLFNBQVM7QUFDWixrQkFBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBQ2hDLGtCQUFNLFdBQVcsTUFBTSxTQUFTO0FBQ2hDLGtCQUFNLG1CQUFpQkEsTUFBQSxNQUFNLFFBQVEsTUFBZCxnQkFBQUEsSUFBaUIsV0FBVTtBQUNsRCxtQkFBTyxVQUFVLEVBQUUsTUFBTSxVQUFVLElBQUksZUFBZSxDQUFDO0FBRXZELG1CQUFPLE1BQU07QUFDYixtQkFBTztBQUFBLFVBQ1I7QUFBQSxRQUNEO0FBQ0EsZUFBTztBQUFBLE1BQ1I7QUFHQSxpQkFBVyxNQUFNO0FBQ2hCLFlBQUksQ0FBQyxlQUFlLEdBQUc7QUFFdEIscUJBQVcsTUFBTTtBQUNoQiwyQkFBZTtBQUFBLFVBQ2hCLEdBQUcsR0FBRztBQUFBLFFBQ1A7QUFBQSxNQUNELEdBQUcsR0FBRztBQUVOLGFBQU87QUFBQSxJQUNSLFNBQVMsT0FBTztBQUNmLFlBQU0sZUFBZSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsT0FBTyxLQUFLO0FBQzFFLFlBQU0sSUFBSSxNQUFNLDBCQUEwQixZQUFZLEVBQUU7QUFBQSxJQUN6RDtBQUFBLEVBQ0Q7QUFBQSxFQUVRLHVCQUF1QixPQUF1QjtBQUNyRCxVQUFNLE1BQU0sb0JBQUksS0FBSztBQUNyQixVQUFNLGFBQWEsT0FBTyxPQUFPLEdBQUcsRUFBRSxPQUFPLEtBQUssT0FBTyxTQUFTLFVBQVU7QUFDNUUsVUFBTSxPQUFPLFlBQVksS0FBSztBQUU5QixRQUFJO0FBQ0osUUFBSSxLQUFLLFNBQVMsUUFBUTtBQUd6QixZQUFNLGVBQWUsS0FBSyxpQkFBaUIsS0FBSztBQUNoRCxpQkFBVztBQUFBLFNBQWUsWUFBWTtBQUFBLFFBQVcsVUFBVTtBQUFBO0FBQUE7QUFBQSxJQUM1RCxPQUFPO0FBQ04sWUFBTSxjQUFjLEtBQUssUUFBUSxlQUFlLEtBQUssSUFBSTtBQUN6RCxVQUFJLENBQUMsYUFBYTtBQUNqQixjQUFNLGVBQWUsS0FBSyxpQkFBaUIsS0FBSztBQUNoRCxtQkFBVztBQUFBLFNBQWUsWUFBWTtBQUFBLFFBQVcsVUFBVTtBQUFBO0FBQUE7QUFBQSxNQUM1RCxPQUFPO0FBQ04sbUJBQVcsWUFBWTtBQUFBLE1BQ3hCO0FBQUEsSUFDRDtBQUVBLGVBQVcsU0FBUyxRQUFRLGtCQUFrQixLQUFLO0FBQ25ELGVBQVcsU0FBUyxRQUFRLGlCQUFpQixVQUFVO0FBQ3ZELGVBQVcsU0FBUyxRQUFRLGlCQUFpQixJQUFJO0FBRWpELFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFjLG9CQUFvQixNQUFhLE9BQWUsTUFBcUI7QUFDbEYsVUFBTSxNQUFNLG9CQUFJLEtBQUs7QUFDckIsVUFBTSxhQUFhLE9BQU8sT0FBTyxHQUFHLEVBQUUsT0FBTyxLQUFLLE9BQU8sU0FBUyxVQUFVO0FBQzVFLFVBQU0sT0FBTyxZQUFZLEtBQUs7QUFFOUIsUUFBSTtBQUNKLFFBQUksU0FBUyxRQUFRO0FBR3BCLFlBQU0sZUFBZSxLQUFLLGlCQUFpQixLQUFLO0FBQ2hELGlCQUFXO0FBQUEsU0FBZSxZQUFZO0FBQUEsUUFBVyxVQUFVO0FBQUE7QUFBQTtBQUFBLElBQzVELE9BQU87QUFDTixZQUFNLGNBQWMsS0FBSyxRQUFRLGVBQWUsSUFBSTtBQUNwRCxVQUFJLENBQUMsYUFBYTtBQUNqQixjQUFNLGVBQWUsS0FBSyxpQkFBaUIsS0FBSztBQUNoRCxtQkFBVztBQUFBLFNBQWUsWUFBWTtBQUFBLFFBQVcsVUFBVTtBQUFBO0FBQUE7QUFBQSxNQUM1RCxPQUFPO0FBQ04sbUJBQVcsWUFBWTtBQUFBLE1BQ3hCO0FBQUEsSUFDRDtBQUVBLGVBQVcsU0FBUyxRQUFRLGtCQUFrQixLQUFLO0FBQ25ELGVBQVcsU0FBUyxRQUFRLGlCQUFpQixVQUFVO0FBQ3ZELGVBQVcsU0FBUyxRQUFRLGlCQUFpQixJQUFJO0FBR2pELFVBQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxNQUFNLFFBQVE7QUFBQSxFQUMzQztBQUFBLEVBRVEsb0JBQW9CLE1BQWE7QUFDeEMsVUFBTSxpQkFBaUIsTUFBTTtBQTdjL0I7QUE4Y0csWUFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLG9CQUFvQiw2QkFBWTtBQUNoRSxVQUFJLFFBQVEsS0FBSyxTQUFTLFFBQVEsS0FBSyxRQUFRO0FBQzlDLGNBQU0sU0FBUyxLQUFLO0FBQ3BCLGNBQU0sVUFBVSxPQUFPLFNBQVM7QUFDaEMsWUFBSSxTQUFTO0FBQ1osZ0JBQU0sUUFBUSxRQUFRLE1BQU0sSUFBSTtBQUNoQyxnQkFBTSxXQUFXLE1BQU0sU0FBUztBQUNoQyxnQkFBTSxtQkFBaUIsV0FBTSxRQUFRLE1BQWQsbUJBQWlCLFdBQVU7QUFDbEQsaUJBQU8sVUFBVSxFQUFFLE1BQU0sVUFBVSxJQUFJLGVBQWUsQ0FBQztBQUV2RCxpQkFBTyxNQUFNO0FBQ2IsaUJBQU87QUFBQSxRQUNSO0FBQUEsTUFDRDtBQUNBLGFBQU87QUFBQSxJQUNSO0FBRUEsZUFBVyxNQUFNO0FBQ2hCLFVBQUksQ0FBQyxlQUFlLEdBQUc7QUFFdEIsbUJBQVcsTUFBTTtBQUNoQix5QkFBZTtBQUFBLFFBQ2hCLEdBQUcsR0FBRztBQUFBLE1BQ1A7QUFBQSxJQUNELEdBQUcsR0FBRztBQUFBLEVBQ1A7QUFBQSxFQUVRLGlCQUFpQixLQUFxQjtBQUc3QyxRQUFJLElBQUksU0FBUyxHQUFHLEtBQUssSUFBSSxTQUFTLEdBQUcsS0FBSyxJQUFJLFNBQVMsSUFBSSxLQUFLLElBQUksU0FBUyxJQUFJLEdBQUc7QUFFdkYsYUFBTyxJQUFJLElBQUksUUFBUSxNQUFNLElBQUksQ0FBQztBQUFBLElBQ25DLFdBQVcsSUFBSSxTQUFTLEdBQUcsS0FBSyxJQUFJLFNBQVMsR0FBRyxLQUFLLElBQUksU0FBUyxHQUFHLEtBQUssSUFBSSxTQUFTLEdBQUcsR0FBRztBQUU1RixhQUFPLElBQUksSUFBSSxRQUFRLE1BQU0sS0FBSyxDQUFDO0FBQUEsSUFDcEMsT0FBTztBQUVOLGFBQU87QUFBQSxJQUNSO0FBQUEsRUFDRDtBQUFBLEVBRUEsVUFBVTtBQUNULFVBQU0sRUFBRSxVQUFVLElBQUk7QUFDdEIsY0FBVSxNQUFNO0FBQUEsRUFDakI7QUFDRDs7O0FOcGZPLFNBQVMsaUJBQWlCLFFBQWdCLFVBQXVDO0FBR3ZGLFFBQU0sV0FBVywwQkFBUztBQUkxQixNQUFJLFVBQVU7QUFtQ2IsUUFBU0MsMEJBQVQsU0FBZ0MsTUFBYUMsV0FBMEM7QUFDdEYsWUFBTSxPQUFPLFFBQVEsY0FBYyxJQUFJO0FBRXZDLFVBQUksU0FBUyxRQUFRO0FBQ3BCLGVBQU87QUFBQSxNQUNSO0FBRUEsWUFBTSxjQUFjLFFBQVEsZUFBZSxJQUFJO0FBQy9DLGFBQU8sZ0JBQWdCLFFBQVEsWUFBWTtBQUFBLElBQzVDO0FBVFMsaUNBQUFEO0FBakNULFVBQU1FLG1CQUFrQjtBQUN4QixVQUFNLFVBQVUsSUFBSSxlQUFlLE9BQU8sS0FBSyxVQUFVQSxnQkFBZTtBQUN4RSxVQUFNLGdCQUFnQixJQUFJLGNBQWMsVUFBVUEsZ0JBQWU7QUFHakUsV0FBTyxXQUFXO0FBQUEsTUFDakIsSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLE1BQ04sZ0JBQWdCLENBQUMsUUFBZ0IsUUFBeUM7QUFDekUsY0FBTSxPQUFPLGVBQWUsZ0NBQWUsSUFBSSxPQUFPLElBQUk7QUFDMUQsWUFBSSxnQkFBZ0Isd0JBQU87QUFFMUIsZ0JBQU0sa0JBQWtCQSxpQkFBZ0IsWUFBWTtBQUNwRCxlQUFLLHNCQUFzQixPQUFPLEtBQUssaUJBQWlCLE1BQU1BLGtCQUFpQixNQUFNO0FBQUEsUUFDdEY7QUFBQSxNQUNEO0FBQUEsSUFDRCxDQUFDO0FBRUQsV0FBTyxXQUFXO0FBQUEsTUFDakIsSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLE1BQ04sZ0JBQWdCLENBQUMsUUFBZ0IsUUFBeUM7QUFDekUsY0FBTSxPQUFPLGVBQWUsZ0NBQWUsSUFBSSxPQUFPLElBQUk7QUFDMUQsWUFBSSxnQkFBZ0Isd0JBQU87QUFDMUIsd0JBQWMseUJBQXlCLFFBQVEsSUFBSTtBQUFBLFFBQ3BEO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQWVELFdBQU8sV0FBVztBQUFBLE1BQ2pCLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLE1BQU07QUFBQSxNQUNOLGdCQUFnQixDQUFDLFFBQWdCLFFBQXlDO0FBQ3pFLGNBQU0sT0FBTyxlQUFlLGdDQUFlLElBQUksT0FBTyxJQUFJO0FBQzFELFlBQUksZ0JBQWdCLHdCQUFPO0FBQzFCLGNBQUksQ0FBQ0Ysd0JBQXVCLE1BQU0sUUFBUSxHQUFHO0FBQzVDLGdCQUFJLHdCQUFPLDJFQUEyRTtBQUN0RjtBQUFBLFVBQ0Q7QUFFQSxnQkFBTSxPQUFPLFFBQVEsY0FBYyxJQUFJO0FBQ3ZDLGdCQUFNLFFBQVEsT0FBTyxJQUFJLGNBQWMsYUFBYSxJQUFJO0FBQ3hELGdCQUFNLFdBQVcsUUFBUSxZQUFZLElBQUk7QUFFekMsY0FBSSxFQUFDLCtCQUFPLGdCQUFlLEVBQUUsWUFBWSxNQUFNLGNBQWM7QUFDNUQsZ0JBQUksd0JBQU8scUJBQXFCLFFBQVEsc0JBQXNCO0FBQzlEO0FBQUEsVUFDRDtBQUVBLGNBQUksV0FBVyxPQUFPLEtBQUssTUFBTSxRQUFtRCxNQUFNLElBQUksRUFBRSxLQUFLO0FBQUEsUUFDdEc7QUFBQSxNQUNEO0FBQUEsSUFDRCxDQUFDO0FBR0Q7QUFBQSxFQUNEO0FBR0EsUUFBTSxrQkFBa0I7QUFNeEIsV0FBUyx1QkFBdUIsTUFBYUMsV0FBMEM7QUFFdEYsVUFBTSxtQkFBbUIsaUNBQW9ELGFBQVlBO0FBRXpGLFVBQU0sY0FBYyxJQUFJLGVBQWUsT0FBTyxLQUFLLGlCQUFpQixNQUFpRDtBQUNySCxVQUFNLE9BQU8sWUFBWSxjQUFjLElBQUk7QUFFM0MsUUFBSSxTQUFTLFFBQVE7QUFDcEIsYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLGNBQWMsWUFBWSxlQUFlLElBQUk7QUFDbkQsV0FBTyxnQkFBZ0IsUUFBUSxZQUFZO0FBQUEsRUFDNUM7QUFHQSxTQUFPLFdBQVc7QUFBQSxJQUNqQixJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixNQUFNO0FBQUEsSUFDTixnQkFBZ0IsQ0FBQyxRQUFnQixRQUF5QztBQUN6RSxZQUFNLE9BQU8sZUFBZSxnQ0FBZSxJQUFJLE9BQU8sSUFBSTtBQUMxRCxVQUFJLGdCQUFnQix3QkFBTztBQUMxQixhQUFLLHNCQUFzQixPQUFPLEtBQUssVUFBVSxNQUFNLFFBQW1ELE1BQU07QUFBQSxNQUNqSDtBQUFBLElBQ0Q7QUFBQSxFQUNELENBQUM7QUFHRCxTQUFPLFdBQVc7QUFBQSxJQUNqQixJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixNQUFNO0FBQUEsSUFDTixnQkFBZ0IsQ0FBQyxRQUFnQixRQUF5QztBQUN6RSxZQUFNLE9BQU8sZUFBZSxnQ0FBZSxJQUFJLE9BQU8sSUFBSTtBQUMxRCxVQUFJLGdCQUFnQix3QkFBTztBQUUxQixjQUFNLGtCQUFrQixnQkFBZ0IsWUFBWTtBQUNwRCxjQUFNLHVCQUF1QixJQUFJLGNBQWMsaUJBQWlCLGVBQWU7QUFDL0UsNkJBQXFCLHlCQUF5QixRQUFRLElBQUk7QUFBQSxNQUMzRDtBQUFBLElBQ0Q7QUFBQSxFQUNELENBQUM7QUFHRCxTQUFPLFdBQVc7QUFBQSxJQUNqQixJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixNQUFNO0FBQUEsSUFDTixnQkFBZ0IsQ0FBQyxRQUFnQixRQUF5QztBQUN6RSxZQUFNLE9BQU8sZUFBZSxnQ0FBZSxJQUFJLE9BQU8sSUFBSTtBQUMxRCxVQUFJLGdCQUFnQix3QkFBTztBQUUxQixjQUFNLGtCQUFrQixnQkFBZ0IsWUFBWTtBQUVwRCxjQUFNLGlCQUFpQixJQUFJLGVBQWUsT0FBTyxLQUFLLGlCQUFpQixlQUFlO0FBR3RGLFlBQUksQ0FBQyx1QkFBdUIsTUFBTSxlQUFlLEdBQUc7QUFDbkQsY0FBSSx3QkFBTywyRUFBMkU7QUFDdEY7QUFBQSxRQUNEO0FBR0EsY0FBTSxPQUFPLGVBQWUsY0FBYyxJQUFJO0FBSzlDLFlBQUksV0FBVyxPQUFPLEtBQUssTUFBTSxpQkFBaUIsTUFBTSxJQUFJLEVBQUUsS0FBSztBQUFBLE1BQ3BFO0FBQUEsSUFDRDtBQUFBLEVBQ0QsQ0FBQztBQUdELE1BQUksQ0FBQyxVQUFVO0FBQ2QsV0FBTyxXQUFXO0FBQUEsTUFDakIsSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNO0FBQ2YsY0FBTSxrQkFBbUIsT0FBbUQ7QUFDNUUsWUFBSSxDQUFDLGdCQUFnQiwyQkFBMkI7QUFDL0MsY0FBSSx3QkFBTywrRUFBK0U7QUFDMUY7QUFBQSxRQUNEO0FBQ0Esa0NBQTBCLE9BQU8sS0FBSyxlQUFlO0FBQUEsTUFDdEQ7QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGO0FBR0EsTUFBSSxDQUFDLFVBQVU7QUFDZCxXQUFPLFdBQVc7QUFBQSxNQUNqQixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixNQUFNO0FBQUEsTUFDTixVQUFVLFlBQVk7QUFDckIsY0FBTSxrQkFBbUIsT0FBbUQ7QUFDNUUsWUFBSSxDQUFDLGdCQUFnQiw2QkFBNkI7QUFDakQsY0FBSSx3QkFBTyxrRkFBa0Y7QUFDN0Y7QUFBQSxRQUNEO0FBQ0EsY0FBTSxlQUFlLE9BQU8sS0FBSyxlQUFlO0FBQUEsTUFDakQ7QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGO0FBQ0Q7QUFFQSxlQUFlLHNCQUFzQixLQUFVLFVBQWlDLE1BQWEsUUFBdUMsUUFBZ0M7QUEvTXBLO0FBaU5DLFFBQU0sbUJBQWtCLGlDQUFRLGFBQVk7QUFDNUMsUUFBTSxpQkFBaUIsSUFBSSxlQUFlLEtBQUssZUFBZTtBQUM5RCxRQUFNLFVBQVUsSUFBSSxlQUFlLEtBQUssaUJBQWlCLE1BQU07QUFHL0QsTUFBSSxpQkFBc0Q7QUFDMUQsTUFBSSxrQkFBa0I7QUFDdEIsTUFBSSxRQUFRO0FBQ1gsVUFBTSxTQUFTLE9BQU8sVUFBVTtBQUNoQyxxQkFBaUIsRUFBRSxNQUFNLE9BQU8sTUFBTSxJQUFJLE9BQU8sR0FBRztBQUNwRCxzQkFBa0IsT0FBTyxTQUFTO0FBQUEsRUFDbkM7QUFHQSxRQUFNLE9BQU8sUUFBUSxjQUFjLElBQUk7QUFHdkMsTUFBSSxTQUFTLFFBQVE7QUFDcEIsUUFBSSx3QkFBTyxpSEFBaUg7QUFDNUg7QUFBQSxFQUNEO0FBRUEsTUFBSTtBQUdKLE1BQUksU0FBUyxRQUFRO0FBQ3BCLFFBQUksd0JBQU8saUhBQWlIO0FBQzVIO0FBQUEsRUFDRDtBQUVBLFFBQU0sY0FBYyxRQUFRLGVBQWUsSUFBSTtBQUMvQyxNQUFJLENBQUMsYUFBYTtBQUNqQixRQUFJLHdCQUFPLHlCQUF5QjtBQUNwQztBQUFBLEVBQ0Q7QUFFQSxtQkFBaUIsWUFBWTtBQUc3QixRQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxHQUFHLENBQUM7QUFHckQsUUFBTSxVQUFVLE1BQU0sSUFBSSxNQUFNLEtBQUssSUFBSTtBQUN6QyxRQUFNLFFBQVEsS0FBSyxTQUFTLFFBQVEsTUFBTSxFQUFFO0FBRTVDLFFBQU0sU0FBUyxlQUFlLGlCQUFpQixPQUFPO0FBQ3RELFFBQU0sRUFBRSxlQUFlLGVBQWUsSUFBSSxlQUFlLGNBQWMsZ0JBQWdCLEtBQUs7QUFHNUYsUUFBTSxhQUF1QyxFQUFFLEdBQUcsT0FBTyxXQUFXO0FBQ3BFLFFBQU0sWUFBWSxvQkFBSSxJQUFZO0FBR2xDLFFBQU0sT0FBTyxZQUFZLEtBQUs7QUFFOUIsYUFBVyxPQUFPLGVBQWU7QUFDaEMsUUFBSSxFQUFFLE9BQU8sT0FBTyxhQUFhO0FBRWhDLFlBQU0sZ0JBQWdCLGVBQWUsR0FBRztBQUN4QyxVQUFJLE1BQU0sUUFBUSxhQUFhLEdBQUc7QUFDakMsbUJBQVcsR0FBRyxJQUFJO0FBQ2xCLGtCQUFVLElBQUksR0FBRztBQUFBLE1BQ2xCLE9BQU87QUFDTixtQkFBVyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsRUFBRTtBQUFBLE1BQ3ZDO0FBQUEsSUFDRCxPQUFPO0FBRU4sWUFBTSxnQkFBZ0IsZUFBZSxHQUFHO0FBQ3hDLFlBQU0sZUFBZSxNQUFNLFFBQVEsYUFBYTtBQUVoRCxVQUFJLGNBQWM7QUFFakIsY0FBTSxnQkFBZ0IsT0FBTyxXQUFXLEdBQUcsS0FBSyxDQUFDO0FBQ2pELGNBQU0sV0FBVyxjQUFjLE9BQU8sVUFBUSxDQUFDLGNBQWMsU0FBUyxJQUFJLENBQUM7QUFDM0UsbUJBQVcsR0FBRyxJQUFJLENBQUMsR0FBRyxlQUFlLEdBQUcsUUFBUTtBQUNoRCxrQkFBVSxJQUFJLEdBQUc7QUFBQSxNQUNsQixPQUFPO0FBRU4sWUFBSSxRQUFRLFFBQVE7QUFDbkIsZ0JBQU0sZUFBZSxPQUFPLFdBQVcsR0FBRyxFQUFFLENBQUMsS0FBSztBQUVsRCxjQUFJLENBQUMsZ0JBQWdCLGFBQWEsS0FBSyxNQUFNLElBQUk7QUFDaEQsdUJBQVcsR0FBRyxJQUFJLENBQUMsSUFBSTtBQUFBLFVBQ3hCO0FBQUEsUUFFRDtBQUFBLE1BRUQ7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUlBLE1BQUksVUFBVSxPQUFPLGNBQWMsZUFBZSxTQUFTLFVBQVUsR0FBRztBQUN2RSxVQUFNLGVBQWUsT0FBTyxXQUFXLE1BQU0sRUFBRSxDQUFDLEtBQUs7QUFDckQsUUFBSSxDQUFDLGdCQUFnQixhQUFhLEtBQUssTUFBTSxJQUFJO0FBRWhELGlCQUFXLE1BQU0sSUFBSSxDQUFDLElBQUk7QUFBQSxJQUMzQjtBQUFBLEVBQ0Q7QUFHQSxhQUFXLE9BQU8sT0FBTyxZQUFZO0FBQ3BDLFFBQUksT0FBTyxXQUFXLEdBQUcsRUFBRSxTQUFTLEdBQUc7QUFDdEMsZ0JBQVUsSUFBSSxHQUFHO0FBQUEsSUFDbEI7QUFBQSxFQUNEO0FBRUEsUUFBTSxhQUFhLGVBQWUsd0JBQXdCLFlBQVksU0FBUyxJQUFJLE9BQU87QUFFMUYsUUFBTSxJQUFJLE1BQU0sT0FBTyxNQUFNLFVBQVU7QUFHdkMsTUFBSSxVQUFVLGdCQUFnQjtBQUU3QixVQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxFQUFFLENBQUM7QUFHcEQsVUFBTSxhQUFhLElBQUksVUFBVSxvQkFBb0IsNkJBQVk7QUFDakUsUUFBSSxjQUFjLFdBQVcsU0FBUyxRQUFRLFdBQVcsUUFBUTtBQUNoRSxZQUFNLGVBQWUsV0FBVztBQUNoQyxZQUFNLGVBQWUsV0FBVyxNQUFNLElBQUksRUFBRTtBQUM1QyxZQUFNLG9CQUFvQixnQkFBZ0IsTUFBTSxJQUFJLEVBQUU7QUFHdEQsVUFBSSxVQUFVLGVBQWU7QUFDN0IsVUFBSSxRQUFRLGVBQWU7QUFHM0IsVUFBSSxpQkFBaUIsbUJBQW1CO0FBRXZDLFlBQUksV0FBVyxjQUFjO0FBQzVCLG9CQUFVLEtBQUssSUFBSSxHQUFHLGVBQWUsQ0FBQztBQUFBLFFBQ3ZDO0FBQUEsTUFDRDtBQUdBLFlBQU0sa0JBQWdCLGdCQUFXLE1BQU0sSUFBSSxFQUFFLE9BQU8sTUFBOUIsbUJBQWlDLFdBQVU7QUFDakUsVUFBSSxRQUFRLGVBQWU7QUFDMUIsZ0JBQVEsS0FBSyxJQUFJLEdBQUcsYUFBYTtBQUFBLE1BQ2xDO0FBR0EsbUJBQWEsVUFBVSxFQUFFLE1BQU0sU0FBUyxJQUFJLE1BQU0sQ0FBQztBQUFBLElBQ3BEO0FBQUEsRUFDRDtBQUVBLE1BQUksd0JBQU8seUNBQXlDO0FBQ3JEO0FBTU8sU0FBUyxvQkFDZixLQUNBLFVBQ0EsVUFDQSxRQUNPO0FBQ1AsUUFBTSxPQUFPLElBQUksTUFBTSxzQkFBc0IsUUFBUTtBQUNyRCxNQUFJLEVBQUUsZ0JBQWdCLHlCQUFRO0FBQzdCLFFBQUksd0JBQU8sbUJBQW1CLFFBQVEsRUFBRTtBQUN4QztBQUFBLEVBQ0Q7QUFFQSxRQUFNLFVBQVUsSUFBSSxlQUFlLEtBQUssVUFBVSxNQUFNO0FBSXhELFdBQVMsdUJBQXVCRSxPQUFhRixXQUEwQztBQUN0RixVQUFNRyxRQUFPLFFBQVEsY0FBY0QsS0FBSTtBQUV2QyxRQUFJQyxVQUFTLFFBQVE7QUFDcEIsYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLGNBQWMsUUFBUSxlQUFlQSxLQUFJO0FBQy9DLFdBQU8sZ0JBQWdCLFFBQVEsWUFBWTtBQUFBLEVBQzVDO0FBRUEsTUFBSSxDQUFDLHVCQUF1QixNQUFNLFFBQVEsR0FBRztBQUM1QyxRQUFJLHdCQUFPLDJFQUEyRTtBQUN0RjtBQUFBLEVBQ0Q7QUFFQSxRQUFNLE9BQU8sUUFBUSxjQUFjLElBQUk7QUFLdkMsTUFBSSxXQUFXLEtBQUssTUFBTSxRQUFRLE1BQU0sSUFBSSxFQUFFLEtBQUs7QUFDcEQ7QUFNTyxTQUFTLDRCQUE0QixRQUFnQixVQUF1QztBQUNsRyxRQUFNLGtCQUFrQjtBQUN4QixRQUFNLGVBQWUsU0FBUyxnQkFBZ0IsQ0FBQztBQUcvQyxhQUFXLGVBQWUsY0FBYztBQUN2QyxRQUFJLENBQUMsWUFBWSxTQUFTO0FBQ3pCO0FBQUEsSUFDRDtBQUVBLFVBQU0sWUFBWSx1QkFBdUIsWUFBWSxFQUFFO0FBQ3ZELFVBQU0sY0FBYyw0QkFBNEIsWUFBWSxJQUFJO0FBRWhFLFdBQU8sV0FBVztBQUFBLE1BQ2pCLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsWUFBWTtBQUVyQixZQUFJLGVBQWUsWUFBWSxVQUFVO0FBR3pDLFlBQUksZ0JBQWdCLGFBQWEsS0FBSyxNQUFNLElBQUk7QUFDL0MsZ0JBQU0sU0FBUyxPQUFPLElBQUksTUFBTSxzQkFBc0IsWUFBWTtBQUNsRSxjQUFJLEVBQUUsa0JBQWtCLDJCQUFVO0FBQ2pDLGdCQUFJO0FBQ0gsb0JBQU0sT0FBTyxJQUFJLE1BQU0sYUFBYSxZQUFZO0FBQUEsWUFDakQsU0FBUyxPQUFPO0FBQ2Ysb0JBQU0sZUFBZSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsT0FBTyxLQUFLO0FBQzFFLGtCQUFJLHdCQUFPLDRCQUE0QixZQUFZLEVBQUU7QUFDckQ7QUFBQSxZQUNEO0FBQUEsVUFDRDtBQUFBLFFBQ0Q7QUFHQSxjQUFNLGVBQWU7QUFDckIsY0FBTSxXQUFXLGVBQWUsR0FBRyxZQUFZLElBQUksWUFBWSxLQUFLO0FBR3BFLGNBQU0sZUFBZSxPQUFPLElBQUksTUFBTSxzQkFBc0IsUUFBUTtBQUNwRSxZQUFJLHdCQUF3Qix3QkFBTztBQUVsQyxjQUFJLFdBQVcsT0FBTyxLQUFLLGNBQWMsaUJBQWlCLFlBQVksSUFBSSxPQUFPLElBQUksRUFBRSxLQUFLO0FBQzVGO0FBQUEsUUFDRDtBQUlBLFlBQUksbUJBQW1CLHdCQUF3QixpQkFBaUI7QUFDL0QsMEJBQWdCLG1CQUFtQixJQUFJLFVBQVUsS0FBSyxJQUFJLENBQUM7QUFBQSxRQUM1RDtBQUVBLFlBQUk7QUFFSCxnQkFBTSxXQUFXLE1BQU0sT0FBTyxJQUFJLE1BQU0sT0FBTyxVQUFVLEVBQUU7QUFHM0QsY0FBSSxXQUFXLE9BQU8sS0FBSyxVQUFVLGlCQUFpQixZQUFZLElBQUksT0FBTyxJQUFJLEVBQUUsS0FBSztBQUFBLFFBQ3pGLFNBQVMsT0FBTztBQUNmLGdCQUFNLGVBQWUsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLE9BQU8sS0FBSztBQUMxRSxjQUFJLHdCQUFPLDBCQUEwQixZQUFZLEVBQUU7QUFHbkQsY0FBSSxtQkFBbUIsd0JBQXdCLGlCQUFpQjtBQUMvRCw0QkFBZ0IsbUJBQW1CLE9BQU8sUUFBUTtBQUFBLFVBQ25EO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGO0FBQ0Q7QUFLQSxJQUFNLGlCQUFpQjtBQUFBLEVBQ3RCLFNBQVM7QUFBQSxFQUNULFdBQVcsT0FBZ0I7QUFDMUIsU0FBSyxVQUFVO0FBQUEsRUFDaEI7QUFBQSxFQUNBLE9BQU8sTUFBaUI7QUFDdkIsUUFBSSxLQUFLLFNBQVM7QUFDakIsY0FBUSxNQUFNLDZCQUE2QixHQUFHLElBQUk7QUFBQSxJQUNuRDtBQUFBLEVBQ0Q7QUFDRDtBQUtBLFNBQVMsd0JBQWdDO0FBQ3hDLE1BQUksQ0FBQywwQkFBUyxjQUFjO0FBQzNCLFdBQU87QUFBQSxFQUNSO0FBQ0EsTUFBSSwwQkFBUyxTQUFTO0FBQ3JCLFdBQU87QUFBQSxFQUNSO0FBQ0EsTUFBSSwwQkFBUyxPQUFPO0FBQ25CLFFBQUk7QUFFSCxZQUFNLEtBQUssUUFBUSxJQUFJO0FBQ3ZCLFlBQU0sVUFBVSxHQUFHLFFBQVE7QUFFM0IsWUFBTSxlQUFlLFNBQVMsUUFBUSxNQUFNLEdBQUcsRUFBRSxDQUFDLENBQUM7QUFDbkQsWUFBTSxjQUFjLFNBQVMsUUFBUSxNQUFNLEdBQUcsRUFBRSxDQUFDLENBQUM7QUFFbEQsVUFBSSxlQUFlLE1BQU8saUJBQWlCLE1BQU0sZUFBZSxNQUFRO0FBQ3ZFLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRCxTQUFRO0FBQUEsSUFFUjtBQUNBLFdBQU87QUFBQSxFQUNSO0FBQ0EsTUFBSSwwQkFBUyxTQUFTO0FBQ3JCLFdBQU87QUFBQSxFQUNSO0FBQ0EsU0FBTztBQUNSO0FBS0EsU0FBUyxvQkFBb0IsT0FBdUI7QUFDbkQsU0FBTyxNQUFNLEtBQUs7QUFDbkI7QUFLQSxTQUFTLG1CQUFtQixPQUF1QjtBQUNsRCxTQUFPLE1BQU0sUUFBUSxNQUFNLEtBQUs7QUFDakM7QUFNTyxTQUFTLDBCQUEwQixLQUFVLFVBQXVDO0FBRTFGLGlCQUFlLFdBQVcsU0FBUywwQkFBMEI7QUFFN0QsTUFBSTtBQUVILFVBQU0sRUFBRSxLQUFLLElBQUksUUFBUSxlQUFlO0FBRXhDLFVBQU0sT0FBTyxRQUFRLE1BQU07QUFFM0IsVUFBTSxLQUFLLFFBQVEsSUFBSTtBQUd2QixVQUFNLFVBQVUsSUFBSSxNQUFNO0FBQzFCLFVBQU0sWUFBWSxRQUFRLFlBQVksUUFBUTtBQUM5QyxVQUFNLGtCQUFrQixPQUFPLGNBQWMsV0FBVyxZQUFZLE9BQU8sU0FBUztBQUdwRixRQUFJO0FBQ0osUUFBSSxTQUFTLDJCQUEyQixTQUFTLHdCQUF3QixLQUFLLEdBQUc7QUFFaEYsb0JBQWMsS0FBSyxRQUFRLGlCQUFpQixTQUFTLHVCQUF1QjtBQUFBLElBQzdFLE9BQU87QUFFTixvQkFBYztBQUFBLElBQ2Y7QUFHQSxRQUFJLENBQUMsR0FBRyxXQUFXLFdBQVcsR0FBRztBQUNoQyxVQUFJLHdCQUFPLHdDQUF3QyxXQUFXLEVBQUU7QUFDaEU7QUFBQSxJQUNEO0FBR0EsVUFBTSxnQkFBZ0Isb0JBQW9CLFNBQVMsMkJBQTJCLEVBQUU7QUFDaEYsVUFBTSxjQUFjLGlCQUFpQixzQkFBc0I7QUFHM0QsUUFBSSxDQUFDLGlCQUFpQixDQUFDLGFBQWE7QUFDbkMsVUFBSSx3QkFBTyxzRUFBc0U7QUFDakY7QUFBQSxJQUNEO0FBR0EsVUFBTSxXQUFXLFFBQVE7QUFDekIsbUJBQWUsSUFBSSxvQkFBb0IsRUFBRSxVQUFVLGFBQWEsWUFBWSxDQUFDO0FBRTdFLFFBQUksYUFBYSxTQUFTO0FBRXpCLFlBQU0sY0FBYyxZQUFZLFFBQVEsTUFBTSxHQUFHO0FBQ2pELFlBQU0sV0FBVyxZQUFZLFlBQVk7QUFFekMsVUFBSSxhQUFhLFlBQVksYUFBYSxRQUFRLGFBQWEsb0JBQW9CO0FBRWxGLGFBQUssWUFBWSxDQUFDLFVBQXVDO0FBQ3hELGNBQUksQ0FBQyxPQUFPO0FBQ1gsa0JBQU0sVUFBVSx1QkFBdUIsV0FBVztBQUNsRCwyQkFBZSxJQUFJLHVCQUF1QixFQUFFLFNBQVMsWUFBWSxDQUFDO0FBQ2xFLGlCQUFLLFNBQVMsQ0FBQyxjQUEyQztBQUN6RCxrQkFBSSxXQUFXO0FBQ2QsK0JBQWUsSUFBSSxnREFBZ0QsRUFBRSxPQUFPLFVBQVUsUUFBUSxDQUFDO0FBRS9GLHNCQUFNLGtCQUFrQiwrQkFBK0IsV0FBVztBQUNsRSxxQkFBSyxpQkFBaUIsQ0FBQyxhQUEwQztBQUNoRSxzQkFBSSxVQUFVO0FBQ2Isd0JBQUksd0JBQU8sMkJBQTJCLFNBQVMsV0FBVyxlQUFlLEVBQUU7QUFBQSxrQkFDNUU7QUFBQSxnQkFDRCxDQUFDO0FBQUEsY0FDRjtBQUFBLFlBQ0QsQ0FBQztBQUFBLFVBQ0YsT0FBTztBQUVOLDJCQUFlLElBQUkseUNBQXlDLENBQUMsQ0FBQztBQUM5RCxrQkFBTSxrQkFBa0IsK0JBQStCLFdBQVc7QUFDbEUsaUJBQUssaUJBQWlCLENBQUMsYUFBMEM7QUFDaEUsa0JBQUksVUFBVTtBQUNiLG9CQUFJLHdCQUFPLDJCQUEyQixTQUFTLFdBQVcsZUFBZSxFQUFFO0FBQUEsY0FDNUU7QUFBQSxZQUNELENBQUM7QUFBQSxVQUNGO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRixXQUFXLGFBQWEsZ0JBQWdCLGFBQWEsa0JBQWtCO0FBRXRFLGNBQU0sbUJBQW1CLFlBQVksUUFBUSxNQUFNLElBQUk7QUFDdkQsY0FBTSxVQUFVLHVEQUF1RCxnQkFBZ0I7QUFDdkYsdUJBQWUsSUFBSSwrQkFBK0IsRUFBRSxTQUFTLFlBQVksQ0FBQztBQUMxRSxhQUFLLFNBQVMsQ0FBQyxVQUF1QztBQUNyRCxjQUFJLE9BQU87QUFDVixnQkFBSSx3QkFBTywyQkFBMkIsTUFBTSxXQUFXLGVBQWUsRUFBRTtBQUFBLFVBQ3pFO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRixXQUFXLGFBQWEsYUFBYSxhQUFhLE9BQU87QUFFeEQsY0FBTSxVQUFVLCtCQUErQixXQUFXO0FBQzFELHVCQUFlLElBQUksd0JBQXdCLEVBQUUsU0FBUyxZQUFZLENBQUM7QUFDbkUsYUFBSyxTQUFTLENBQUMsVUFBdUM7QUFDckQsY0FBSSxPQUFPO0FBQ1YsZ0JBQUksd0JBQU8sMkJBQTJCLE1BQU0sV0FBVyxlQUFlLEVBQUU7QUFBQSxVQUN6RTtBQUFBLFFBQ0QsQ0FBQztBQUFBLE1BQ0YsT0FBTztBQUVOLGNBQU0sVUFBVSxhQUFhLFdBQVc7QUFDeEMsdUJBQWUsSUFBSSw0QkFBNEIsRUFBRSxTQUFTLGFBQWEsWUFBWSxDQUFDO0FBQ3BGLGFBQUssU0FBUyxDQUFDLFVBQXVDO0FBQ3JELGNBQUksT0FBTztBQUVWLDJCQUFlLElBQUksZ0RBQWdELEVBQUUsT0FBTyxNQUFNLFFBQVEsQ0FBQztBQUMzRixrQkFBTSxrQkFBa0IsK0JBQStCLFdBQVc7QUFDbEUsaUJBQUssaUJBQWlCLENBQUMsYUFBMEM7QUFDaEUsa0JBQUksVUFBVTtBQUNiLG9CQUFJLHdCQUFPLDJCQUEyQixTQUFTLFdBQVcsZUFBZSxFQUFFO0FBQUEsY0FDNUU7QUFBQSxZQUNELENBQUM7QUFBQSxVQUNGO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0QsV0FBVyxhQUFhLFVBQVU7QUFFakMsWUFBTSxhQUFhLG1CQUFtQixXQUFXO0FBQ2pELFlBQU0sY0FBYyxtQkFBbUIsV0FBVztBQUNsRCxZQUFNLFVBQVUsYUFBYSxVQUFVLE1BQU0sV0FBVztBQUN4RCxxQkFBZSxJQUFJLGdCQUFnQixFQUFFLFNBQVMsYUFBYSxZQUFZLENBQUM7QUFDeEUsV0FBSyxTQUFTLENBQUMsVUFBdUM7QUFDckQsWUFBSSxPQUFPO0FBQ1YsY0FBSSx3QkFBTywyQkFBMkIsTUFBTSxXQUFXLGVBQWUsRUFBRTtBQUFBLFFBQ3pFO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRixPQUFPO0FBRU4sWUFBTSxZQUFZLGNBQWMsQ0FBQyxXQUFXLElBQUksQ0FBQyxrQkFBa0IsV0FBVyxPQUFPO0FBQ3JGLFlBQU0scUJBQXFCLFlBQVksUUFBUSxNQUFNLEtBQUs7QUFHMUQsWUFBTSxjQUFjLENBQUMsVUFBa0I7QUFDdEMsWUFBSSxTQUFTLFVBQVUsUUFBUTtBQUM5QixjQUFJLHdCQUFPLGtHQUFrRztBQUM3RztBQUFBLFFBQ0Q7QUFFQSxjQUFNLGtCQUFrQixVQUFVLEtBQUs7QUFDdkMsY0FBTSxlQUFlLGdCQUFnQixNQUFNLEdBQUcsRUFBRSxDQUFDO0FBR2pELGFBQUssU0FBUyxZQUFZLElBQUksQ0FBQyxVQUF1QztBQUNyRSxjQUFJLENBQUMsT0FBTztBQUVYLGdCQUFJO0FBQ0osZ0JBQUksZ0JBQWdCLFNBQVMsZ0JBQWdCLEdBQUc7QUFDL0Msd0JBQVUsdUNBQXVDLGtCQUFrQjtBQUFBLFlBQ3BFLFdBQVcsZ0JBQWdCLFNBQVMsU0FBUyxHQUFHO0FBQy9DLHdCQUFVLHNCQUFzQixrQkFBa0I7QUFBQSxZQUNuRCxPQUFPO0FBRU4sd0JBQVUsR0FBRyxlQUFlLGNBQWMsa0JBQWtCO0FBQUEsWUFDN0Q7QUFDQSwyQkFBZSxJQUFJLGdCQUFnQixFQUFFLFNBQVMsVUFBVSxpQkFBaUIsWUFBWSxDQUFDO0FBQ3RGLGlCQUFLLFNBQVMsQ0FBQyxjQUEyQztBQUN6RCxrQkFBSSxhQUFhLFFBQVEsVUFBVSxTQUFTLEdBQUc7QUFDOUMsK0JBQWUsSUFBSSx1Q0FBdUMsRUFBRSxVQUFVLGlCQUFpQixPQUFPLFVBQVUsUUFBUSxDQUFDO0FBQ2pILDRCQUFZLFFBQVEsQ0FBQztBQUFBLGNBQ3RCLFdBQVcsV0FBVztBQUNyQixvQkFBSSx3QkFBTywyQkFBMkIsVUFBVSxXQUFXLGVBQWUsRUFBRTtBQUFBLGNBQzdFO0FBQUEsWUFDRCxDQUFDO0FBQUEsVUFDRixPQUFPO0FBRU4sMkJBQWUsSUFBSSxtQ0FBbUMsRUFBRSxVQUFVLGdCQUFnQixDQUFDO0FBQ25GLHdCQUFZLFFBQVEsQ0FBQztBQUFBLFVBQ3RCO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRjtBQUVBLGtCQUFZLENBQUM7QUFBQSxJQUNkO0FBQUEsRUFDRCxTQUFTLE9BQU87QUFDZixtQkFBZSxJQUFJLG9CQUFvQixFQUFFLE1BQU0sQ0FBQztBQUNoRCxRQUFJLHdCQUFPLDJCQUEyQixpQkFBaUIsUUFBUSxNQUFNLFVBQVUsT0FBTyxLQUFLLENBQUMsRUFBRTtBQUFBLEVBQy9GO0FBQ0Q7QUFNQSxlQUFzQixlQUFlLEtBQVUsVUFBZ0Q7QUFDOUYsTUFBSTtBQUVILFVBQU0sS0FBSyxRQUFRLElBQUk7QUFFdkIsVUFBTSxPQUFPLFFBQVEsTUFBTTtBQUUzQixVQUFNLEVBQUUsTUFBTSxJQUFJLFFBQVEsVUFBVTtBQUdwQyxVQUFNLFVBQVUsSUFBSSxNQUFNO0FBQzFCLFVBQU0sWUFBWSxRQUFRLFlBQVksUUFBUTtBQUM5QyxVQUFNLGtCQUFrQixPQUFPLGNBQWMsV0FBVyxZQUFZLE9BQU8sU0FBUztBQUdwRixRQUFJLENBQUMsU0FBUyxrQkFBa0IsQ0FBQyxTQUFTLGVBQWUsS0FBSyxHQUFHO0FBQ2hFLFVBQUksd0JBQU8sZ0RBQWdEO0FBQzNEO0FBQUEsSUFDRDtBQUdBLFVBQU0sYUFBYSxLQUFLLFFBQVEsaUJBQWlCLFNBQVMsY0FBYztBQUd4RSxRQUFJLENBQUMsR0FBRyxXQUFXLFVBQVUsR0FBRztBQUMvQixVQUFJLHdCQUFPLDZCQUE2QixVQUFVLEVBQUU7QUFDcEQ7QUFBQSxJQUNEO0FBR0EsVUFBTSxNQUFNLFNBQVMsVUFBVTtBQUFBLEVBQ2hDLFNBQVMsT0FBTztBQUNmLFFBQUksd0JBQU8sOEJBQThCLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxPQUFPLEtBQUssQ0FBQyxFQUFFO0FBQUEsRUFDbEc7QUFDRDs7O0FPNXZCQSxJQUFBQyxvQkFBa0U7OztBQ0tsRSxJQUFBQyxtQkFBdUM7QUFPaEMsSUFBTSxxQkFBTixjQUFpQyxtQ0FBaUM7QUFBQSxFQUd4RSxZQUFZLEtBQVUsVUFBdUM7QUFDNUQsVUFBTSxHQUFHO0FBQ1QsU0FBSyxXQUFXO0FBQUEsRUFDakI7QUFBQSxFQUVBLFdBQTRCO0FBRzNCLFVBQU0sa0JBQW1CLEtBQUssSUFBMko7QUFHekwsVUFBTSxhQUFhLG9CQUFJLElBQTJCO0FBR2xELFFBQUksbUJBQW1CLE9BQU8sZ0JBQWdCLGlCQUFpQixZQUFZO0FBQzFFLFVBQUk7QUFDSCxjQUFNLFdBQVcsZ0JBQWdCLGFBQWE7QUFDOUMsbUJBQVcsV0FBVyxVQUFVO0FBQy9CLGNBQUksV0FBVyxRQUFRLE1BQU0sUUFBUSxRQUFRLENBQUMsV0FBVyxJQUFJLFFBQVEsRUFBRSxHQUFHO0FBQ3pFLHVCQUFXLElBQUksUUFBUSxJQUFJO0FBQUEsY0FDMUIsSUFBSSxRQUFRO0FBQUEsY0FDWixNQUFNLFFBQVE7QUFBQSxZQUNmLENBQUM7QUFBQSxVQUNGO0FBQUEsUUFDRDtBQUFBLE1BQ0QsU0FBUyxHQUFHO0FBQ1gsZ0JBQVEsS0FBSywrREFBK0QsQ0FBQztBQUFBLE1BQzlFO0FBQUEsSUFDRDtBQUlBLFFBQUk7QUFDSCxZQUFNLFdBQVcsbURBQWlCO0FBQ2xDLFVBQUksWUFBWSxPQUFPLGFBQWEsVUFBVTtBQUM3QyxjQUFNLGNBQWMsT0FBTyxPQUFPLFFBQVE7QUFDMUMsbUJBQVcsV0FBVyxhQUFhO0FBQ2xDLGNBQUksV0FBVyxRQUFRLE1BQU0sUUFBUSxRQUFRLENBQUMsV0FBVyxJQUFJLFFBQVEsRUFBRSxHQUFHO0FBQ3pFLHVCQUFXLElBQUksUUFBUSxJQUFJO0FBQUEsY0FDMUIsSUFBSSxRQUFRO0FBQUEsY0FDWixNQUFNLFFBQVE7QUFBQSxZQUNmLENBQUM7QUFBQSxVQUNGO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFNBQVMsR0FBRztBQUNYLGNBQVEsS0FBSyx5REFBeUQsQ0FBQztBQUFBLElBQ3hFO0FBR0EsUUFBSTtBQUNILFlBQU0sbUJBQW1CLG1EQUFpQjtBQUMxQyxVQUFJLG9CQUFvQixPQUFPLHFCQUFxQixVQUFVO0FBQzdELGNBQU0sY0FBYyxPQUFPLE9BQU8sZ0JBQWdCO0FBQ2xELG1CQUFXLFdBQVcsYUFBYTtBQUNsQyxjQUFJLFdBQVcsUUFBUSxNQUFNLFFBQVEsUUFBUSxDQUFDLFdBQVcsSUFBSSxRQUFRLEVBQUUsR0FBRztBQUN6RSx1QkFBVyxJQUFJLFFBQVEsSUFBSTtBQUFBLGNBQzFCLElBQUksUUFBUTtBQUFBLGNBQ1osTUFBTSxRQUFRO0FBQUEsWUFDZixDQUFDO0FBQUEsVUFDRjtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLEdBQUc7QUFDWCxjQUFRLEtBQUssa0VBQWtFLENBQUM7QUFBQSxJQUNqRjtBQUVBLFVBQU0saUJBQWlCLE1BQU0sS0FBSyxXQUFXLE9BQU8sQ0FBQztBQUdyRCxtQkFBZSxLQUFLLENBQUMsR0FBRyxNQUFNLEVBQUUsS0FBSyxjQUFjLEVBQUUsSUFBSSxDQUFDO0FBRTFELFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxZQUFZLE1BQTZCO0FBQ3hDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQSxFQUVBLGFBQWEsTUFBcUIsS0FBdUM7QUFDeEUsU0FBSyxTQUFTLEtBQUssRUFBRTtBQUFBLEVBQ3RCO0FBQUE7QUFBQSxFQUdBLGlCQUFpQixPQUFnQyxJQUF1QjtBQUN2RSxVQUFNLE9BQU8sTUFBTTtBQUNuQixPQUFHLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixNQUFNLEtBQUssS0FBSyxDQUFDO0FBQUEsRUFDMUQ7QUFDRDs7O0FDbEdBLElBQUFDLG1CQUErRTtBQVEvRSxJQUFNLGNBQWMsTUFBZ0I7QUFDbkMsTUFBSSwwQ0FBcUIsb0NBQWtCLE9BQU8sS0FBSyw2QkFBWTtBQUNsRSxRQUFJO0FBQ0gsaUJBQU8sNkJBQVc7QUFBQSxJQUNuQixTQUFTLEdBQUc7QUFDWCxjQUFRLEtBQUssMERBQTBELENBQUM7QUFBQSxJQUN6RTtBQUFBLEVBQ0Q7QUFFQSxTQUFPO0FBQUEsSUFDTjtBQUFBLElBQWM7QUFBQSxJQUFZO0FBQUEsSUFBZTtBQUFBLElBQVE7QUFBQSxJQUFRO0FBQUEsSUFBUztBQUFBLElBQ2xFO0FBQUEsSUFBUTtBQUFBLElBQVU7QUFBQSxJQUFRO0FBQUEsSUFBUTtBQUFBLElBQVE7QUFBQSxJQUFTO0FBQUEsSUFBVTtBQUFBLElBQVE7QUFBQSxJQUNyRTtBQUFBLElBQVM7QUFBQSxJQUFTO0FBQUEsSUFBUztBQUFBLElBQVk7QUFBQSxJQUFTO0FBQUEsSUFBUTtBQUFBLElBQVU7QUFBQSxJQUNsRTtBQUFBLElBQVE7QUFBQSxJQUFPO0FBQUEsSUFBUztBQUFBLElBQVk7QUFBQSxJQUFVO0FBQUEsSUFBUTtBQUFBLElBQVM7QUFBQSxJQUMvRDtBQUFBLElBQWlCO0FBQUEsSUFBUTtBQUFBLElBQVU7QUFBQSxJQUFPO0FBQUEsSUFBVztBQUFBLElBQU87QUFBQSxJQUM1RDtBQUFBLElBQVM7QUFBQSxJQUFLO0FBQUEsSUFBUTtBQUFBLElBQVM7QUFBQSxJQUFjO0FBQUEsSUFBZTtBQUFBLElBQzVEO0FBQUEsSUFBYztBQUFBLElBQWdCO0FBQUEsSUFBaUI7QUFBQSxJQUFjO0FBQUEsSUFDN0Q7QUFBQSxJQUFRO0FBQUEsSUFBbUI7QUFBQSxJQUFpQjtBQUFBLElBQVE7QUFBQSxJQUFRO0FBQUEsSUFDNUQ7QUFBQSxJQUFXO0FBQUEsSUFBUTtBQUFBLElBQVk7QUFBQSxJQUFZO0FBQUEsSUFBVztBQUFBLElBQ3REO0FBQUEsSUFBYztBQUFBLElBQVE7QUFBQSxJQUFTO0FBQUEsSUFBUTtBQUFBLElBQU87QUFBQSxJQUFRO0FBQUEsSUFBUztBQUFBLElBQy9EO0FBQUEsSUFBVTtBQUFBLElBQVE7QUFBQSxJQUFpQjtBQUFBLElBQVc7QUFBQSxJQUFTO0FBQUEsSUFDdkQ7QUFBQSxJQUFTO0FBQUEsSUFBUTtBQUFBLElBQWE7QUFBQSxJQUFXO0FBQUEsSUFBVTtBQUFBLElBQ25EO0FBQUEsSUFBVTtBQUFBLElBQU87QUFBQSxJQUFjO0FBQUEsSUFBUTtBQUFBLElBQVk7QUFBQSxJQUNuRDtBQUFBLElBQVU7QUFBQSxJQUFVO0FBQUEsSUFBYztBQUFBLElBQWM7QUFBQSxJQUFZO0FBQUEsSUFDNUQ7QUFBQSxJQUFrQjtBQUFBLElBQWdCO0FBQUEsSUFBTztBQUFBLElBQVE7QUFBQSxJQUFRO0FBQUEsSUFDekQ7QUFBQSxJQUFXO0FBQUEsSUFBVztBQUFBLElBQVM7QUFBQSxJQUFVO0FBQUEsSUFBTztBQUFBLElBQVE7QUFBQSxJQUN4RDtBQUFBLElBQVM7QUFBQSxJQUFXO0FBQUEsSUFBUztBQUFBLElBQVU7QUFBQSxJQUFXO0FBQUEsSUFDbEQ7QUFBQSxJQUFlO0FBQUEsSUFBVTtBQUFBLElBQVM7QUFBQSxJQUFRO0FBQUEsSUFBYTtBQUFBLElBQ3ZEO0FBQUEsSUFBVTtBQUFBLElBQVM7QUFBQSxJQUFVO0FBQUEsSUFBUTtBQUFBLElBQVc7QUFBQSxJQUFPO0FBQUEsSUFDdkQ7QUFBQSxJQUFRO0FBQUEsSUFBUztBQUFBLElBQVc7QUFBQSxJQUFhO0FBQUEsSUFBWTtBQUFBLElBQ3JEO0FBQUEsSUFBWTtBQUFBLElBQVc7QUFBQSxJQUFlO0FBQUEsSUFBYztBQUFBLElBQU87QUFBQSxJQUMzRDtBQUFBLElBQVM7QUFBQSxJQUFRO0FBQUEsSUFBVTtBQUFBLElBQWM7QUFBQSxJQUFTO0FBQUEsSUFDbEQ7QUFBQSxJQUFXO0FBQUEsSUFBUTtBQUFBLElBQWU7QUFBQSxJQUFRO0FBQUEsSUFBVztBQUFBLElBQ3JEO0FBQUEsSUFBVztBQUFBLElBQWM7QUFBQSxFQUMxQjtBQUNEO0FBR0EsSUFBTSxlQUE2QixZQUFZLEVBQUUsSUFBSSxTQUFPO0FBQUEsRUFDM0Q7QUFBQSxFQUNBLE1BQU0sR0FDSixRQUFRLFlBQVksRUFBRSxFQUN0QixRQUFRLE1BQU0sR0FBRyxFQUNqQixRQUFRLHdCQUF3QixDQUFDLFdBQVcsT0FBTyxZQUFZLENBQUM7QUFDbkUsRUFBRSxFQUFFLEtBQUssQ0FBQyxHQUFHLE1BQU0sRUFBRSxLQUFLLGNBQWMsRUFBRSxJQUFJLENBQUM7QUFFeEMsSUFBTSxrQkFBTixjQUE4QixtQ0FBOEI7QUFBQSxFQUdsRSxZQUFZLEtBQVUsVUFBb0M7QUFDekQsVUFBTSxHQUFHO0FBQ1QsU0FBSyxXQUFXO0FBQUEsRUFDakI7QUFBQSxFQUVBLFdBQXlCO0FBQ3hCLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxZQUFZLE1BQTBCO0FBQ3JDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQSxFQUVBLGFBQWEsTUFBa0IsS0FBdUM7QUFDckUsU0FBSyxTQUFTLEtBQUssRUFBRTtBQUFBLEVBQ3RCO0FBQUE7QUFBQSxFQUdBLGlCQUFpQixPQUE2QixJQUF1QjtBQUNwRSxVQUFNLE9BQU8sTUFBTTtBQUNuQixPQUFHLFNBQVMsYUFBYTtBQUN6QixVQUFNLFVBQVUsR0FBRyxVQUFVLEVBQUUsS0FBSyxxQkFBcUIsQ0FBQztBQUMxRCxZQUFRLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixNQUFNLEtBQUssS0FBSyxDQUFDO0FBRzlELFVBQU0sTUFBTSxHQUFHLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQ2xELGtDQUFRLElBQUksV0FBVyxFQUFFLEtBQUssbUJBQW1CLENBQUMsR0FBRyxLQUFLLEVBQUU7QUFBQSxFQUM3RDtBQUNEOzs7QUMxRkEsSUFBQUMsbUJBQTJCO0FBRXBCLElBQU0sZUFBTixjQUEyQix1QkFBTTtBQUFBLEVBSXZDLFlBQVksS0FBa0IsU0FBeUIsY0FBc0IsV0FBbUIsYUFBcUIsVUFBVTtBQUM5SCxVQUFNLEdBQUc7QUFEb0I7QUFBeUI7QUFBeUM7QUFIaEcsa0JBQWtCO0FBQ2xCLDBCQUFxRDtBQUFBLEVBSXJEO0FBQUEsRUFFQSxTQUFTO0FBQ1IsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFDaEIsY0FBVSxTQUFTLDhCQUE4QjtBQUVqRCxjQUFVLFNBQVMsS0FBSyxFQUFFLE1BQU0sS0FBSyxRQUFRLENBQUM7QUFFOUMsVUFBTSxrQkFBa0IsVUFBVSxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUU3RSxVQUFNLGVBQWUsZ0JBQWdCLFNBQVMsVUFBVTtBQUFBLE1BQ3ZELE1BQU0sS0FBSztBQUFBLElBQ1osQ0FBQztBQUNELGlCQUFhLFVBQVUsTUFBTTtBQUM1QixXQUFLLFNBQVM7QUFDZCxXQUFLLE1BQU07QUFBQSxJQUNaO0FBRUEsVUFBTSxnQkFBZ0IsZ0JBQWdCLFNBQVMsVUFBVTtBQUFBLE1BQ3hELE1BQU0sS0FBSztBQUFBLE1BQ1gsS0FBSztBQUFBLElBQ04sQ0FBQztBQUNELGtCQUFjLFVBQVUsTUFBTTtBQUM3QixXQUFLLFNBQVM7QUFDZCxXQUFLLE1BQU07QUFBQSxJQUNaO0FBQUEsRUFDRDtBQUFBLEVBRUEsVUFBVTtBQUNULFVBQU0sRUFBRSxVQUFVLElBQUk7QUFDdEIsY0FBVSxNQUFNO0FBQ2hCLFFBQUksS0FBSyxnQkFBZ0I7QUFDeEIsV0FBSyxlQUFlLEtBQUssTUFBTTtBQUFBLElBQ2hDO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSxnQkFBa0M7QUFDdkMsV0FBTyxJQUFJLFFBQVEsQ0FBQyxZQUFZO0FBQy9CLFdBQUssaUJBQWlCO0FBQ3RCLFdBQUssS0FBSztBQUFBLElBQ1gsQ0FBQztBQUFBLEVBQ0Y7QUFDRDs7O0FDOUNBLElBQUFDLG1CQUEyQztBQUMzQyxxQkFBZ0M7QUFxQnpCLFNBQVMsb0JBQ2YsYUFDQSxTQUNBLFlBQ29CO0FBR3BCLFVBQUksb0NBQWtCLFFBQVEsR0FBRztBQUtoQyxVQUFNLG9CQUtEO0FBRUwsUUFBSSxtQkFBbUI7QUFDdEIsWUFBTSxRQUFRLFVBQ1gsSUFBSSxrQkFBa0IsV0FBVyxFQUFFLFdBQVcsT0FBTyxJQUNyRCxJQUFJLGtCQUFrQixXQUFXO0FBQ3BDLGFBQU87QUFBQSxRQUNOLFdBQVcsSUFBZ0M7QUFDMUMsZ0JBQU0sV0FBVyxFQUFFO0FBQUEsUUFDcEI7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFJQSxNQUFJLFlBQVk7QUFDZixnQkFBWSxTQUFTLEdBQUcsVUFBVSxrQkFBa0I7QUFBQSxFQUNyRDtBQUVBO0FBSUMsUUFBSSxTQUFTO0FBQ1osWUFBTSxZQUFZLFlBQVksVUFBVSx1QkFBdUI7QUFDL0QsZ0JBQVUsU0FBUyxNQUFNLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFBQSxJQUMzQztBQUVBLFdBQU87QUFBQSxNQUNOLFdBQVcsSUFBZ0M7QUFDMUMsY0FBTSxVQUFVLElBQUkseUJBQVEsV0FBVztBQUN2QyxXQUFHLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFDRDs7O0FKdkVPLElBQU0sMEJBQU4sY0FBc0MsbUNBQWlCO0FBQUEsRUFzQjdELFlBQVksS0FBVSxRQUFnQjtBQUNyQyxVQUFNLEtBQUssTUFBTTtBQXJCbEIsU0FBTyxPQUFPO0FBQ2QsK0JBQTBDO0FBQzFDLGdDQUEyQztBQUMzQyxpQ0FBNEM7QUFDNUMsaUNBQTRDO0FBQzVDLDhCQUF5QztBQUN6QyxpQ0FBNEM7QUFDNUMscUNBQWdEO0FBQ2hELCtCQUEwQztBQUMxQyxnQ0FBMkM7QUFDM0MsbUNBQThDO0FBQzlDLHNDQUFpRDtBQUNqRCxvQ0FBK0M7QUFDL0Msa0NBQTZDO0FBQzdDLHVDQUFrRDtBQUNsRCxnQ0FBdUM7QUFDdkMsOEJBQXFDO0FBQ3JDLFNBQVEsZ0NBQXFGO0FBQzdGLFNBQVEsOEJBQW1GO0FBSTFGLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTU8sc0JBQTRCO0FBQ2xDLFFBQUksS0FBSyw2QkFBNkI7QUFDckMsV0FBSyx5QkFBeUI7QUFBQSxJQUMvQjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxNQUFNO0FBSWxCLFVBQU0sV0FBVyxLQUFLLE9BQU87QUFJN0IsU0FBSyxrQkFBa0IsYUFBYSxRQUFRO0FBQUEsRUFDN0M7QUFBQSxFQUVRLGtCQUFrQixhQUEwQixVQUF1QztBQTNENUY7QUE4REUsVUFBTSxlQUFlLG9CQUFvQixhQUFhLFFBQVcsZ0JBQWdCO0FBQ2pGLGlCQUFhLFdBQVcsQ0FBQyxZQUFZO0FBQ3BDLGNBQ0UsUUFBUSxhQUFhLEVBRXJCLFFBQVEsc0ZBQXNGLEVBQzlGO0FBQUEsUUFBUSxDQUFDLFNBQ1QsS0FFRSxlQUFlLFlBQVksRUFDM0IsU0FBUyxTQUFTLFVBQVUsRUFDNUIsU0FBUyxPQUFPLFVBQWtCO0FBQ2xDLG1CQUFTLGFBQWEsU0FBUztBQUMvQixnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2hDLENBQUM7QUFBQSxNQUNIO0FBQUEsSUFDRixDQUFDO0FBRUQsaUJBQWEsV0FBVyxDQUFDLFlBQVk7QUFDcEMsY0FDRSxRQUFRLDJCQUEyQixFQUNuQyxRQUFRLCtFQUErRSxFQUN2RjtBQUFBLFFBQVUsQ0FBQyxXQUNYLE9BQ0UsU0FBUyxTQUFTLHFCQUFxQixFQUN2QyxTQUFTLE9BQU8sVUFBbUI7QUFDbkMsbUJBQVMsd0JBQXdCO0FBQ2pDLGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLGVBQUssd0JBQXdCO0FBQUEsUUFDOUIsQ0FBQztBQUFBLE1BQ0g7QUFBQSxJQUNGLENBQUM7QUFFRCxpQkFBYSxXQUFXLENBQUMsWUFBWTtBQUNwQyxjQUNFLFFBQVEsNkJBQTZCLEVBRXJDLFFBQVEsMlBBQTJQLEVBQ25RO0FBQUEsUUFBWSxDQUFDLGFBQ2IsU0FDRSxVQUFVLFlBQVksZUFBZSxFQUNyQyxVQUFVLFNBQVMsWUFBWSxFQUMvQixTQUFTLFNBQVMscUJBQXFCLEVBQ3ZDLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxtQkFBUyx3QkFBd0I7QUFDakMsZ0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUNoQyxDQUFDO0FBQUEsTUFDSDtBQUVELGNBQVEsVUFBVSxVQUFVLE9BQU8sNENBQTRDLFNBQVMscUJBQXFCO0FBQzdHLGNBQVEsVUFBVSxVQUFVLE9BQU8sMkNBQTJDLENBQUMsU0FBUyxxQkFBcUI7QUFBQSxJQUM5RyxDQUFDO0FBRUQsaUJBQWEsV0FBVyxDQUFDLFlBQVk7QUFDcEMsY0FDRSxRQUFRLDZCQUE2QixFQUNyQyxRQUFRLHlGQUF5RixFQUNqRztBQUFBLFFBQVUsQ0FBQyxXQUNYLE9BQ0UsU0FBUyxTQUFTLHVCQUF1QixFQUN6QyxTQUFTLE9BQU8sVUFBbUI7QUFDbkMsbUJBQVMsMEJBQTBCO0FBQ25DLGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDaEMsQ0FBQztBQUFBLE1BQ0g7QUFBQSxJQUNGLENBQUM7QUFFRCxpQkFBYSxXQUFXLENBQUMsWUFBWTtBQUNwQyxjQUNFLFFBQVEsaUNBQWlDLEVBRXpDLFFBQVEsa01BQWtNLEVBQzFNO0FBQUEsUUFBVSxDQUFDLFdBQ1gsT0FDRSxTQUFTLFNBQVMsNEJBQTRCLEVBQzlDLFNBQVMsT0FBTyxVQUFtQjtBQUNuQyxtQkFBUywrQkFBK0I7QUFDeEMsZ0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUNoQyxDQUFDO0FBQUEsTUFDSDtBQUFBLElBQ0YsQ0FBQztBQUVELGlCQUFhLFdBQVcsQ0FBQyxZQUFZO0FBQ3BDLGNBRUUsUUFBUSxpQ0FBaUMsRUFDekMsUUFBUSxzRkFBc0YsRUFDOUY7QUFBQSxRQUFVLENBQUMsV0FDWCxPQUNFLFNBQVMsU0FBUyxzQkFBc0IsRUFDeEMsU0FBUyxPQUFPLFVBQW1CO0FBQ25DLG1CQUFTLHlCQUF5QjtBQUNsQyxnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2hDLENBQUM7QUFBQSxNQUNIO0FBQUEsSUFDRixDQUFDO0FBR0QsaUJBQWEsV0FBVyxDQUFDLFlBQVk7QUFDcEMsY0FDRSxRQUFRLHdCQUF3QixFQUNoQyxRQUFRLDRGQUE0RixFQUNwRztBQUFBLFFBQVUsQ0FBQyxXQUNYLE9BQ0UsU0FBUyxTQUFTLG9CQUFvQixFQUN0QyxTQUFTLE9BQU8sVUFBbUI7QUFDbkMsbUJBQVMsdUJBQXVCO0FBQ2hDLGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDaEMsQ0FBQztBQUFBLE1BQ0g7QUFBQSxJQUNGLENBQUM7QUFHRCxVQUFNLG9CQUFvQixvQkFBb0IsYUFBYSxpQkFBaUIsZ0JBQWdCO0FBRzVGLHNCQUFrQixXQUFXLENBQUMsWUFBWTtBQUV6QyxjQUFRLFVBQVUsU0FBUyx3Q0FBd0M7QUFDbkUsY0FBUSxVQUFVLFNBQVMsNkNBQTZDO0FBRXhFLFdBQUssOEJBQThCLFFBQVEsVUFBVSxVQUFVO0FBQUEsUUFDOUQsS0FBSztBQUFBLE1BQ04sQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUVELFFBQUksS0FBSyw2QkFBNkI7QUFDckMsV0FBSyx5QkFBeUI7QUFBQSxJQUMvQjtBQUdBLFFBQUksQ0FBQywyQkFBUyxVQUFVO0FBQ3ZCLFlBQU0saUJBQWlCLG9CQUFvQixhQUFhLHNCQUFzQixnQkFBZ0I7QUFHOUYscUJBQWUsV0FBVyxDQUFDLFlBQVk7QUFDdEMsZ0JBQ0UsUUFBUSw4QkFBOEIsRUFDdEMsUUFBUSw0REFBNEQsRUFDcEU7QUFBQSxVQUFVLENBQUMsV0FDWCxPQUNFLFNBQVMsU0FBUyx5QkFBeUIsRUFDM0MsU0FBUyxPQUFPLFVBQW1CO0FBQ25DLHFCQUFTLDRCQUE0QjtBQUNyQyxrQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixpQkFBSyw0QkFBNEI7QUFHakMsZ0JBQUksS0FBSyxPQUFPLHFCQUFxQjtBQUNwQyxtQkFBSyxPQUFPLG9CQUFvQjtBQUFBLFlBQ2pDO0FBQUEsVUFDRCxDQUFDO0FBQUEsUUFDSDtBQUFBLE1BQ0YsQ0FBQztBQUdELFdBQUssMkJBQTJCLFlBQVksVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDeEYsV0FBSyx5QkFBeUIsVUFBVSxPQUFPLDRDQUE0QyxTQUFTLHlCQUF5QjtBQUM3SCxXQUFLLHlCQUF5QixVQUFVLE9BQU8sMkNBQTJDLENBQUMsU0FBUyx5QkFBeUI7QUFFN0gscUJBQWUsV0FBVyxDQUFDLFlBQVk7QUFDdEMsY0FBTSxlQUFlLFNBQVMsdUJBQXVCO0FBRXJELHFCQUFhLFNBQVMsT0FBTyxFQUFFLE1BQU0sb0hBQW9ILENBQUM7QUFDMUoscUJBQWEsU0FBUyxPQUFPLEVBQUUsTUFBTSxrRUFBa0UsQ0FBQztBQUN4RyxnQkFDRSxRQUFRLDZCQUE2QixFQUNyQyxRQUFRLFlBQVksRUFDcEI7QUFBQSxVQUFRLENBQUMsU0FDVCxLQUNFLGVBQWUsT0FBTyxFQUN0QixTQUFTLFNBQVMsdUJBQXVCLEVBQ3pDLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxxQkFBUywwQkFBMEI7QUFDbkMsa0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxVQUNoQyxDQUFDO0FBQUEsUUFDSDtBQUVELGdCQUFRLFVBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTLHlCQUF5QjtBQUNqSCxnQkFBUSxVQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTLHlCQUF5QjtBQUFBLE1BQ2xILENBQUM7QUFFRCxxQkFBZSxXQUFXLENBQUMsWUFBWTtBQUN0QyxjQUFNLGVBQWUsU0FBUyx1QkFBdUI7QUFFckQscUJBQWEsU0FBUyxPQUFPLEVBQUUsTUFBTSw0TEFBNEwsQ0FBQztBQUVsTyxxQkFBYSxTQUFTLE9BQU8sRUFBRSxNQUFNLDhEQUE4RCxDQUFDO0FBQ3BHLGdCQUNFLFFBQVEsMkJBQTJCLEVBQ25DLFFBQVEsWUFBWSxFQUNwQjtBQUFBLFVBQVEsQ0FBQyxTQUNULEtBQ0UsZUFBZSxVQUFVLEVBQ3pCLFNBQVMsU0FBUyx1QkFBdUIsRUFDekMsU0FBUyxPQUFPLFVBQWtCO0FBQ2xDLHFCQUFTLDBCQUEwQjtBQUNuQyxrQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFVBQ2hDLENBQUM7QUFBQSxRQUNIO0FBRUQsZ0JBQVEsVUFBVSxVQUFVLE9BQU8sNENBQTRDLFNBQVMseUJBQXlCO0FBQ2pILGdCQUFRLFVBQVUsVUFBVSxPQUFPLDJDQUEyQyxDQUFDLFNBQVMseUJBQXlCO0FBQUEsTUFDbEgsQ0FBQztBQUVELHFCQUFlLFdBQVcsQ0FBQyxZQUFZO0FBQ3RDLGdCQUNFLFFBQVEsc0JBQXNCLEVBQzlCLFFBQVEsbUdBQW1HLEVBQzNHO0FBQUEsVUFBVSxDQUFDLFdBQ1gsT0FDRSxTQUFTLFNBQVMsMEJBQTBCLEVBQzVDLFNBQVMsT0FBTyxVQUFtQjtBQUNuQyxxQkFBUyw2QkFBNkI7QUFDdEMsa0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxVQUNoQyxDQUFDO0FBQUEsUUFDSDtBQUVELGdCQUFRLFVBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTLHlCQUF5QjtBQUNqSCxnQkFBUSxVQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTLHlCQUF5QjtBQUFBLE1BQ2xILENBQUM7QUFFRCxxQkFBZSxXQUFXLENBQUMsWUFBWTtBQUN0QyxnQkFDRSxRQUFRLGdDQUFnQyxFQUN4QyxRQUFRLG1EQUFtRCxFQUMzRCxVQUFVLENBQUMsV0FBVztBQUN0QixlQUFLLGdDQUFnQztBQUNyQyxpQkFDRSxTQUFTLFNBQVMsd0JBQXdCLEVBQzFDLFlBQVksQ0FBQyxTQUFTLHlCQUF5QixFQUMvQyxTQUFTLE9BQU8sVUFBbUI7QUFFbkMsaUJBQUssT0FBTyxTQUFTLDJCQUEyQjtBQUNoRCxxQkFBUywyQkFBMkI7QUFDcEMsa0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsdUJBQVcsTUFBTTtBQUNoQixrQkFBSSxLQUFLLE9BQU8scUJBQXFCO0FBQ3BDLHFCQUFLLE9BQU8sb0JBQW9CO0FBQUEsY0FDakM7QUFBQSxZQUNELEdBQUcsRUFBRTtBQUFBLFVBQ04sQ0FBQztBQUFBLFFBQ0gsQ0FBQztBQUVGLGdCQUFRLFVBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTLHlCQUF5QjtBQUNqSCxnQkFBUSxVQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTLHlCQUF5QjtBQUVqSCxhQUFLLHVCQUF1QjtBQUFBLE1BQzdCLENBQUM7QUFHRCxxQkFBZSxXQUFXLENBQUMsWUFBWTtBQUN0QyxnQkFDRSxRQUFRLGlDQUFpQyxFQUN6QyxRQUFRLDZEQUE2RCxFQUNyRTtBQUFBLFVBQVUsQ0FBQyxXQUNYLE9BQ0UsU0FBUyxTQUFTLDJCQUEyQixFQUM3QyxTQUFTLE9BQU8sVUFBbUI7QUFDbkMscUJBQVMsOEJBQThCO0FBQ3ZDLGtCQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLGlCQUFLLDBCQUEwQjtBQUcvQixnQkFBSSxLQUFLLE9BQU8scUJBQXFCO0FBQ3BDLG1CQUFLLE9BQU8sb0JBQW9CO0FBQUEsWUFDakM7QUFBQSxVQUNELENBQUM7QUFBQSxRQUNIO0FBQUEsTUFDRixDQUFDO0FBR0QsV0FBSyx5QkFBeUIsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNwRixXQUFLLHVCQUF1QixVQUFVLE9BQU8sNENBQTRDLFNBQVMsMkJBQTJCO0FBQzdILFdBQUssdUJBQXVCLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTLDJCQUEyQjtBQUU3SCxxQkFBZSxXQUFXLENBQUMsWUFBWTtBQUN0QyxjQUFNLGVBQWUsU0FBUyx1QkFBdUI7QUFDckQscUJBQWEsU0FBUyxPQUFPLEVBQUUsTUFBTSxrR0FBa0csQ0FBQztBQUN4SSxxQkFBYSxTQUFTLE9BQU8sRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ2xFLGdCQUNFLFFBQVEsa0JBQWtCLEVBQzFCLFFBQVEsWUFBWSxFQUNwQjtBQUFBLFVBQVEsQ0FBQyxTQUNULEtBQ0UsZUFBZSxjQUFjLEVBQzdCLFNBQVMsU0FBUyxjQUFjLEVBQ2hDLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxxQkFBUyxpQkFBaUI7QUFDMUIsa0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxVQUNoQyxDQUFDO0FBQUEsUUFDSDtBQUVELGdCQUFRLFVBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTLDJCQUEyQjtBQUNuSCxnQkFBUSxVQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTLDJCQUEyQjtBQUFBLE1BQ3BILENBQUM7QUFFRCxxQkFBZSxXQUFXLENBQUMsWUFBWTtBQUN0QyxnQkFDRSxRQUFRLDhCQUE4QixFQUN0QyxRQUFRLHNEQUFzRCxFQUM5RCxVQUFVLENBQUMsV0FBVztBQUN0QixlQUFLLDhCQUE4QjtBQUNuQyxpQkFDRSxTQUFTLFNBQVMsc0JBQXNCLEVBQ3hDLFlBQVksQ0FBQyxTQUFTLDJCQUEyQixFQUNqRCxTQUFTLE9BQU8sVUFBbUI7QUFFbkMsaUJBQUssT0FBTyxTQUFTLHlCQUF5QjtBQUM5QyxxQkFBUyx5QkFBeUI7QUFDbEMsa0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsdUJBQVcsTUFBTTtBQUNoQixrQkFBSSxLQUFLLE9BQU8scUJBQXFCO0FBQ3BDLHFCQUFLLE9BQU8sb0JBQW9CO0FBQUEsY0FDakM7QUFBQSxZQUNELEdBQUcsRUFBRTtBQUFBLFVBQ04sQ0FBQztBQUFBLFFBQ0gsQ0FBQztBQUVGLGdCQUFRLFVBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTLDJCQUEyQjtBQUNuSCxnQkFBUSxVQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTLDJCQUEyQjtBQUVuSCxhQUFLLHFCQUFxQjtBQUFBLE1BQzNCLENBQUM7QUFHRCxxQkFBZSxXQUFXLENBQUMsWUFBWTtBQUN0QyxnQkFDRSxRQUFRLHdDQUF3QyxFQUNoRCxRQUFRLHlFQUF5RSxFQUNqRixVQUFVLFlBQU87QUExWXZCLGNBQUFDLEtBQUE7QUEwWTBCLHdCQUNuQixVQUFTLE1BQUFBLE1BQUEsU0FBUywwQkFBVCxnQkFBQUEsSUFBZ0MsWUFBaEMsWUFBMkMsS0FBSyxFQUN6RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixnQkFBSSxDQUFDLFNBQVMsdUJBQXVCO0FBQ3BDLHVCQUFTLHdCQUF3QjtBQUFBLGdCQUNoQyxTQUFTO0FBQUEsZ0JBQ1QsV0FBVztBQUFBLGdCQUNYLFFBQVE7QUFBQSxjQUNUO0FBQUEsWUFDRDtBQUNBLHFCQUFTLHNCQUFzQixVQUFVO0FBQ3pDLGtCQUFNLEtBQUssT0FBTyxhQUFhO0FBRS9CLGdCQUFJLEtBQUssT0FBTyxrQkFBa0I7QUFDakMsb0JBQU0sS0FBSyxPQUFPLGlCQUFpQjtBQUFBLFlBQ3BDO0FBRUEsaUJBQUssUUFBUTtBQUFBLFVBQ2QsQ0FBQztBQUFBLFNBQUM7QUFBQSxNQUNMLENBQUM7QUFHRCxXQUFJLGNBQVMsMEJBQVQsbUJBQWdDLFNBQVM7QUFFNUMsY0FBTSxjQUFjLEtBQUssZUFBZSxTQUFTLHNCQUFzQixTQUFTO0FBQ2hGLHVCQUFlLFdBQVcsQ0FBQyxZQUFZO0FBQ3RDLGtCQUNFLFFBQVEsU0FBUyxFQUNqQixRQUFRLDJEQUEyRCxFQUNuRSxVQUFVLFlBQVUsT0FDbkIsY0FBYyxlQUFlLGdCQUFnQixFQUM3QyxRQUFRLE1BQU07QUFDZCxrQkFBTSxRQUFRLElBQUksbUJBQW1CLEtBQUssS0FBSyxDQUFDLGNBQWM7QUFDN0Qsb0JBQU0sWUFBWTtBQUNqQixvQkFBSSxDQUFDLFNBQVMsdUJBQXVCO0FBQ3BDLDJCQUFTLHdCQUF3QjtBQUFBLG9CQUNoQyxTQUFTO0FBQUEsb0JBQ1QsV0FBVztBQUFBLG9CQUNYLFFBQVE7QUFBQSxrQkFDVDtBQUFBLGdCQUNEO0FBQ0EseUJBQVMsc0JBQXNCLFlBQVk7QUFDM0Msc0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0Isb0JBQUksS0FBSyxPQUFPLGtCQUFrQjtBQUNqQyx3QkFBTSxLQUFLLE9BQU8saUJBQWlCO0FBQUEsZ0JBQ3BDO0FBRUEscUJBQUssUUFBUTtBQUFBLGNBQ2QsR0FBRztBQUFBLFlBQ0osQ0FBQztBQUNELGtCQUFNLEtBQUs7QUFBQSxVQUNaLENBQUMsQ0FBQztBQUFBLFFBQ0wsQ0FBQztBQUdELGNBQU0sV0FBVyxLQUFLLFlBQVksU0FBUyxzQkFBc0IsTUFBTTtBQUN2RSx1QkFBZSxXQUFXLENBQUMsWUFBWTtBQUN0QyxrQkFDRSxRQUFRLE1BQU0sRUFDZCxRQUFRLDJDQUEyQyxFQUNuRCxVQUFVLFlBQVUsT0FDbkIsY0FBYyxZQUFZLGdCQUFnQixFQUMxQyxRQUFRLE1BQU07QUFDZCxrQkFBTSxRQUFRLElBQUksZ0JBQWdCLEtBQUssS0FBSyxDQUFDLFdBQVc7QUFDdkQsb0JBQU0sWUFBWTtBQUNqQixvQkFBSSxDQUFDLFNBQVMsdUJBQXVCO0FBQ3BDLDJCQUFTLHdCQUF3QjtBQUFBLG9CQUNoQyxTQUFTO0FBQUEsb0JBQ1QsV0FBVztBQUFBLG9CQUNYLFFBQVE7QUFBQSxrQkFDVDtBQUFBLGdCQUNEO0FBQ0EseUJBQVMsc0JBQXNCLFNBQVM7QUFDeEMsc0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0Isb0JBQUksS0FBSyxPQUFPLGtCQUFrQjtBQUNqQyx3QkFBTSxLQUFLLE9BQU8saUJBQWlCO0FBQUEsZ0JBQ3BDO0FBRUEscUJBQUssUUFBUTtBQUFBLGNBQ2QsR0FBRztBQUFBLFlBQ0osQ0FBQztBQUNELGtCQUFNLEtBQUs7QUFBQSxVQUNaLENBQUMsQ0FBQztBQUFBLFFBQ0wsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNEO0FBRUEsU0FBSyx3QkFBd0I7QUFFN0IsUUFBSSxDQUFDLDJCQUFTLFVBQVU7QUFDdkIsV0FBSyw0QkFBNEI7QUFDakMsV0FBSywwQkFBMEI7QUFBQSxJQUNoQztBQUFBLEVBQ0Q7QUFBQSxFQUdBLDBCQUEwQjtBQUN6QixVQUFNLFdBQVcsS0FBSyxPQUFPO0FBQzdCLFVBQU0sWUFBWSxTQUFTO0FBRzNCLFVBQU0sY0FBYyxLQUFLO0FBQ3pCLFVBQU0sY0FBYyxZQUFZLGlCQUFpQixlQUFlO0FBQ2hFLGdCQUFZLFFBQVEsQ0FBQyxjQUFjO0FBbmZyQztBQW9mRyxZQUFNLFNBQVMsVUFBVSxjQUFjLG9CQUFvQjtBQUMzRCxVQUFJLFlBQVUsWUFBTyxnQkFBUCxtQkFBb0IsWUFBVywrQkFBK0I7QUFDM0Usa0JBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTO0FBQ2hGLGtCQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTO0FBQUEsTUFDakY7QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFQSw4QkFBOEI7QUFDN0IsVUFBTSxXQUFXLEtBQUssT0FBTztBQUM3QixVQUFNLFlBQVksU0FBUztBQUczQixRQUFJLEtBQUssMEJBQTBCO0FBQ2xDLFdBQUsseUJBQXlCLFVBQVUsT0FBTyw0Q0FBNEMsU0FBUztBQUNwRyxXQUFLLHlCQUF5QixVQUFVLE9BQU8sMkNBQTJDLENBQUMsU0FBUztBQUFBLElBQ3JHO0FBSUEsVUFBTSxjQUFjLEtBQUs7QUFDekIsVUFBTSxjQUFjLFlBQVksaUJBQWlCLGVBQWU7QUFDaEUsZ0JBQVksUUFBUSxDQUFDLGNBQWM7QUExZ0JyQztBQTJnQkcsWUFBTSxTQUFTLFVBQVUsY0FBYyxvQkFBb0I7QUFDM0QsVUFBSSxRQUFRO0FBQ1gsY0FBTSxRQUFPLFlBQU8sZ0JBQVAsbUJBQW9CO0FBQ2pDLFlBQUksU0FBUyxpQ0FBaUMsU0FBUyxrQ0FBa0M7QUFDeEYsb0JBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTO0FBQ2hGLG9CQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTO0FBQUEsUUFDakY7QUFBQSxNQUNEO0FBQUEsSUFDRCxDQUFDO0FBR0QsUUFBSSxLQUFLLCtCQUErQjtBQUN2QyxXQUFLLDhCQUE4QixZQUFZLENBQUMsS0FBSyxPQUFPLFNBQVMseUJBQXlCO0FBQUEsSUFDL0Y7QUFBQSxFQUNEO0FBQUEsRUFFQSw0QkFBNEI7QUFDM0IsVUFBTSxXQUFXLEtBQUssT0FBTztBQUM3QixVQUFNLFlBQVksU0FBUztBQUczQixRQUFJLEtBQUssd0JBQXdCO0FBQ2hDLFdBQUssdUJBQXVCLFVBQVUsT0FBTyw0Q0FBNEMsU0FBUztBQUNsRyxXQUFLLHVCQUF1QixVQUFVLE9BQU8sMkNBQTJDLENBQUMsU0FBUztBQUFBLElBQ25HO0FBSUEsVUFBTSxjQUFjLEtBQUs7QUFDekIsVUFBTSxjQUFjLFlBQVksaUJBQWlCLGVBQWU7QUFDaEUsZ0JBQVksUUFBUSxDQUFDLGNBQWM7QUF6aUJyQztBQTBpQkcsWUFBTSxTQUFTLFVBQVUsY0FBYyxvQkFBb0I7QUFDM0QsVUFBSSxRQUFRO0FBQ1gsY0FBTSxRQUFPLFlBQU8sZ0JBQVAsbUJBQW9CO0FBQ2pDLFlBQUksU0FBUyxzQkFBc0IsU0FBUyxnQ0FBZ0M7QUFDM0Usb0JBQVUsVUFBVSxPQUFPLDRDQUE0QyxTQUFTO0FBQ2hGLG9CQUFVLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxTQUFTO0FBQUEsUUFDakY7QUFBQSxNQUNEO0FBQUEsSUFDRCxDQUFDO0FBR0QsUUFBSSxLQUFLLDZCQUE2QjtBQUNyQyxXQUFLLDRCQUE0QixZQUFZLENBQUMsS0FBSyxPQUFPLFNBQVMsMkJBQTJCO0FBQUEsSUFDL0Y7QUFBQSxFQUNEO0FBQUEsRUFFQSwwQkFBMEI7QUFDekIsVUFBTSxXQUFXLEtBQUssT0FBTztBQUM3QixVQUFNLGVBQXlCLENBQUM7QUFDaEMsVUFBTSxrQkFBa0QsQ0FBQztBQUd6RCxVQUFNLGVBQWUsU0FBUyxnQkFBZ0IsQ0FBQztBQUMvQyxlQUFXLGVBQWUsY0FBYztBQUN2QyxVQUFJLFlBQVksU0FBUztBQUN4QixZQUFJLENBQUMsWUFBWSxVQUFVLFlBQVksT0FBTyxLQUFLLE1BQU0sSUFBSTtBQUM1RCx1QkFBYSxLQUFLLFlBQVksUUFBUSxTQUFTO0FBQUEsUUFDaEQsT0FBTztBQUNOLGNBQUksQ0FBQyxnQkFBZ0IsWUFBWSxNQUFNLEdBQUc7QUFDekMsNEJBQWdCLFlBQVksTUFBTSxJQUFJLENBQUM7QUFBQSxVQUN4QztBQUNBLDBCQUFnQixZQUFZLE1BQU0sRUFBRSxLQUFLLFlBQVksUUFBUSxTQUFTO0FBQUEsUUFDdkU7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUFBLEVBSUQ7QUFBQSxFQUVRLHVCQUF1QjtBQUM5QixVQUFNLFdBQVcsS0FBSyxPQUFPO0FBQzdCLFVBQU0sZUFBZSxTQUFTLGdCQUFnQixDQUFDO0FBQy9DLFVBQU0sVUFBdUI7QUFBQSxNQUM1QixJQUFJLFdBQVcsS0FBSyxJQUFJLENBQUM7QUFBQSxNQUN6QixNQUFNLFdBQVcsYUFBYSxTQUFTLENBQUM7QUFBQSxNQUN4QyxRQUFRO0FBQUEsTUFDUixjQUFjO0FBQUEsTUFDZCxVQUFVO0FBQUEsTUFDVixTQUFTO0FBQUEsTUFDVCxjQUFjO0FBQUEsTUFDZCxlQUFlO0FBQUEsTUFDZixrQkFBa0I7QUFBQSxNQUNsQix3QkFBd0I7QUFBQSxNQUN4QixpQkFBaUI7QUFBQSxJQUNsQjtBQUNBLGlCQUFhLEtBQUssT0FBTztBQUN6QixhQUFTLGVBQWU7QUFDeEIsU0FBSyxLQUFLLE9BQU8sYUFBYTtBQUM5QixTQUFLLHlCQUF5QjtBQUM5QixTQUFLLE9BQU8sb0JBQW9CO0FBRWhDLGdDQUE0QixLQUFLLFFBQTZCLFFBQVE7QUFBQSxFQUN2RTtBQUFBLEVBRVEsMkJBQTJCO0FBQ2xDLFFBQUksQ0FBQyxLQUFLLDRCQUE2QjtBQUV2QyxTQUFLLDRCQUE0QixNQUFNO0FBSXZDLFVBQU0sV0FBVyxLQUFLLE9BQU87QUFDN0IsVUFBTSxlQUFlLFNBQVMsZ0JBQWdCLENBQUM7QUFDL0MsaUJBQWEsUUFBUSxDQUFDLFlBQXlCLFVBQWtCO0FBcG5CbkU7QUFxbkJHLFVBQUksQ0FBQyxLQUFLLDRCQUE2QjtBQUN2QyxZQUFNLGdCQUFnQixLQUFLLDRCQUE0QixVQUFVO0FBQUEsUUFDaEUsS0FBSztBQUFBLFFBQ0wsTUFBTSxFQUFFLGdCQUFnQixXQUFXLEdBQUc7QUFBQSxNQUN2QyxDQUFDO0FBR0QsWUFBTSxTQUFTLGNBQWMsVUFBVSxFQUFFLEtBQUssNkJBQTZCLENBQUM7QUFDNUUsYUFBTyxVQUFVLElBQUksbUNBQW1DO0FBR3hELFlBQU0saUJBQWlCLE9BQU8sU0FBUyxVQUFVO0FBQUEsUUFDaEQsS0FBSztBQUFBLFFBQ0wsTUFBTSxFQUFFLGNBQWMsa0JBQWtCO0FBQUEsTUFDekMsQ0FBQztBQUNELFlBQU0sZUFBYyxnQkFBVyxjQUFYLFlBQXdCO0FBRTVDLHFDQUFRLGdCQUFnQixjQUFjO0FBQ3RDLFVBQUksYUFBYTtBQUNoQix1QkFBZSxVQUFVLElBQUksY0FBYztBQUFBLE1BQzVDO0FBQ0EscUJBQWUsaUJBQWlCLFNBQVMsTUFBTTtBQUM5QyxhQUFLLEtBQUssMEJBQTBCLFdBQVcsRUFBRTtBQUVqRCxjQUFNLGNBQWMsS0FBSyxPQUFPLFNBQVMsYUFBYSxLQUFLLENBQUMsT0FBb0IsR0FBRyxPQUFPLFdBQVcsRUFBRTtBQUN2RyxZQUFJLGFBQWE7QUFDaEIsY0FBSSxZQUFZLFdBQVc7QUFDMUIsMkJBQWUsVUFBVSxJQUFJLGNBQWM7QUFBQSxVQUM1QyxPQUFPO0FBQ04sMkJBQWUsVUFBVSxPQUFPLGNBQWM7QUFBQSxVQUMvQztBQUFBLFFBQ0Q7QUFBQSxNQUNELENBQUM7QUFHRCxZQUFNLGFBQWEsT0FBTyxVQUFVLEVBQUUsS0FBSyw2QkFBNkIsQ0FBQztBQUN6RSxpQkFBVyxTQUFTLE9BQU8sRUFBRSxNQUFNLFdBQVcsUUFBUSxXQUFXLFFBQVEsQ0FBQyxJQUFJLEtBQUssb0JBQW9CLENBQUM7QUFHeEcsWUFBTSxtQkFBbUIsT0FBTyxVQUFVLEVBQUUsS0FBSyxpQ0FBaUMsQ0FBQztBQUNuRixZQUFNLFdBQVcsaUJBQWlCLFNBQVMsVUFBVTtBQUFBLFFBQ3BELEtBQUs7QUFBQSxRQUNMLE1BQU0sRUFBRSxjQUFjLFVBQVU7QUFBQSxNQUNqQyxDQUFDO0FBQ0QscUNBQVEsVUFBVSxZQUFZO0FBQzlCLGVBQVMsV0FBVyxVQUFVO0FBQzlCLGVBQVMsaUJBQWlCLFNBQVMsTUFBTTtBQUN4QyxhQUFLLEtBQUssa0JBQWtCLFdBQVcsRUFBRTtBQUFBLE1BQzFDLENBQUM7QUFFRCxZQUFNLGFBQWEsaUJBQWlCLFNBQVMsVUFBVTtBQUFBLFFBQ3RELEtBQUs7QUFBQSxRQUNMLE1BQU0sRUFBRSxjQUFjLFlBQVk7QUFBQSxNQUNuQyxDQUFDO0FBQ0QscUNBQVEsWUFBWSxjQUFjO0FBQ2xDLGlCQUFXLFdBQVcsVUFBVSxhQUFhLFNBQVM7QUFDdEQsaUJBQVcsaUJBQWlCLFNBQVMsTUFBTTtBQUMxQyxhQUFLLEtBQUssb0JBQW9CLFdBQVcsRUFBRTtBQUFBLE1BQzVDLENBQUM7QUFHRCxZQUFNLGtCQUFrQixPQUFPLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3RFLFVBQUksV0FBVyxTQUFTO0FBQ3ZCLHdCQUFnQixVQUFVLElBQUksWUFBWTtBQUFBLE1BQzNDO0FBRUEsWUFBTSxTQUFTLGdCQUFnQixTQUFTLFNBQVMsRUFBRSxNQUFNLFlBQVksS0FBSyxpQkFBaUIsQ0FBQztBQUM1RixhQUFPLFVBQVUsV0FBVztBQUc1QixzQkFBZ0IsaUJBQWlCLFNBQVMsQ0FBQyxNQUFNO0FBQ2hELGNBQU0sWUFBWTtBQUNqQixZQUFFLGVBQWU7QUFDakIsZ0JBQU0sV0FBVyxDQUFDLFdBQVc7QUFDN0IscUJBQVcsVUFBVTtBQUNyQixpQkFBTyxVQUFVO0FBRWpCLGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLGVBQUssT0FBTyxvQkFBb0I7QUFHaEMsY0FBSSxVQUFVO0FBQ2IsNEJBQWdCLFVBQVUsSUFBSSxZQUFZO0FBQUEsVUFDM0MsT0FBTztBQUNOLDRCQUFnQixVQUFVLE9BQU8sWUFBWTtBQUFBLFVBQzlDO0FBR0EsZUFBSyxrQ0FBa0MsV0FBVyxJQUFJLFFBQVE7QUFHOUQsc0NBQTRCLEtBQUssUUFBNkIsS0FBSyxPQUFPLFFBQVE7QUFBQSxRQUduRixHQUFHO0FBQUEsTUFDSixDQUFDO0FBR0QsYUFBTyxpQkFBaUIsVUFBVSxDQUFDLE1BQU07QUFDeEMsY0FBTSxZQUFZO0FBQ2pCLGdCQUFNLFFBQVMsRUFBRSxPQUE0QjtBQUM3QyxxQkFBVyxVQUFVO0FBQ3JCLGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLGVBQUssT0FBTyxvQkFBb0I7QUFHaEMsY0FBSSxPQUFPO0FBQ1YsNEJBQWdCLFVBQVUsSUFBSSxZQUFZO0FBQUEsVUFDM0MsT0FBTztBQUNOLDRCQUFnQixVQUFVLE9BQU8sWUFBWTtBQUFBLFVBQzlDO0FBR0EsZUFBSyxrQ0FBa0MsV0FBVyxJQUFJLEtBQUs7QUFHM0Qsc0NBQTRCLEtBQUssUUFBNkIsS0FBSyxPQUFPLFFBQVE7QUFBQSxRQUNuRixHQUFHO0FBQUEsTUFDSixDQUFDO0FBR0QsWUFBTSxvQkFBb0IsY0FBYyxVQUFVO0FBQUEsUUFDakQsS0FBSztBQUFBLFFBQ0wsTUFBTSxFQUFFLGdCQUFnQixXQUFXLEdBQUc7QUFBQSxNQUN2QyxDQUFDO0FBR0QsWUFBTSxzQkFBcUIsZ0JBQVcsY0FBWCxZQUF3QjtBQUNuRCxZQUFNLG1CQUFtQixXQUFXLFdBQVcsQ0FBQztBQUNoRCxVQUFJLGtCQUFrQjtBQUNyQiwwQkFBa0IsVUFBVSxJQUFJLDBDQUEwQztBQUFBLE1BQzNFLE9BQU87QUFDTiwwQkFBa0IsVUFBVSxJQUFJLHlDQUF5QztBQUFBLE1BQzFFO0FBR0EsWUFBTSxnQkFBZ0Isa0JBQWtCLFVBQVU7QUFDbEQsVUFBSSwwQkFBUSxhQUFhLEVBQ3ZCLFFBQVEsbUJBQW1CLEVBQzNCLFFBQVEsNkVBQTZFLEVBQ3JGLFFBQVEsQ0FBQyxTQUFTO0FBQ2xCLGFBQ0UsZUFBZSx5QkFBeUIsRUFDeEMsU0FBUyxXQUFXLElBQUksRUFDeEIsU0FBUyxPQUFPLFVBQWtCO0FBQ2xDLHFCQUFXLE9BQU87QUFDbEIsZ0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0Isc0NBQTRCLEtBQUssUUFBNkIsS0FBSyxPQUFPLFFBQVE7QUFBQSxRQUNuRixDQUFDO0FBQUEsTUFDSCxDQUFDO0FBR0YsWUFBTSxrQkFBa0Isa0JBQWtCLFVBQVU7QUFDcEQsWUFBTSxnQkFBZ0IsSUFBSSwwQkFBUSxlQUFlLEVBQy9DLFFBQVEsaUJBQWlCLEVBQ3pCLFFBQVEsaUxBQWlMLEVBQ3pMLFFBQVEsQ0FBQyxTQUFTO0FBQ2xCLGFBQ0UsZUFBZSxzRkFBc0YsRUFDckcsU0FBUyxXQUFXLE1BQU0sRUFDMUIsU0FBUyxPQUFPLFVBQWtCO0FBQ2xDLHFCQUFXLFNBQVM7QUFDcEIsZ0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFDL0IsZUFBSyxPQUFPLG9CQUFvQjtBQUNoQyxlQUFLLDZDQUE2QyxXQUFXLEVBQUU7QUFFL0QsZ0JBQU0sa0JBQWtCLEtBQUssT0FBTyxTQUFTLGdCQUFnQixDQUFDO0FBQzlELHFCQUFXLE1BQU0saUJBQWlCO0FBQ2pDLGlCQUFLLDRCQUE0QixHQUFHLElBQUksSUFBSTtBQUFBLFVBQzdDO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDSCxDQUFDO0FBR0Ysc0JBQWdCLFVBQVUsRUFBRSxLQUFLLDBDQUEwQyxNQUFNLEVBQUUsZ0JBQWdCLFdBQVcsR0FBRyxFQUFFLENBQUM7QUFDcEgsV0FBSyw0QkFBNEIsV0FBVyxJQUFJLGFBQWE7QUFHN0QsWUFBTSw0QkFBNEIsa0JBQWtCLFVBQVUsRUFBRSxLQUFLLGlDQUFpQyxDQUFDO0FBQ3ZHLGdDQUEwQixhQUFhLGdCQUFnQixXQUFXLEVBQUU7QUFDcEUsZ0NBQTBCLFVBQVUsT0FBTyw0Q0FBNEMsQ0FBQyxDQUFDLFdBQVcsTUFBTTtBQUMxRyxnQ0FBMEIsVUFBVSxPQUFPLDJDQUEyQyxDQUFDLFdBQVcsTUFBTTtBQUN4RyxVQUFJLDBCQUFRLHlCQUF5QixFQUNuQyxRQUFRLG1CQUFtQixFQUMzQixRQUFRLDJMQUEyTCxFQUNuTTtBQUFBLFFBQVUsQ0FBQ0MsWUFDWEEsUUFDRSxTQUFTLFdBQVcsb0JBQW9CLEtBQUssRUFDN0MsU0FBUyxPQUFPLFVBQW1CO0FBQ25DLHFCQUFXLG1CQUFtQjtBQUM5QixnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2hDLENBQUM7QUFBQSxNQUNIO0FBR0QsWUFBTSw0QkFBNEIsa0JBQWtCLFVBQVU7QUFDOUQsVUFBSSwwQkFBUSx5QkFBeUIsRUFDbkMsUUFBUSxrQ0FBa0MsRUFDMUMsUUFBUSw2SUFBNkksRUFDcko7QUFBQSxRQUFVLENBQUNBLFlBQ1hBLFFBQ0UsU0FBUyxXQUFXLDBCQUEwQixLQUFLLEVBQ25ELFNBQVMsT0FBTyxVQUFtQjtBQUNuQyxxQkFBVyx5QkFBeUI7QUFDcEMsZ0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUNoQyxDQUFDO0FBQUEsTUFDSDtBQUdELFlBQU0sZ0JBQWdCLGtCQUFrQixVQUFVO0FBQ2xELFVBQUksMEJBQVEsYUFBYSxFQUN2QixRQUFRLGdCQUFnQixFQUN4QixRQUFRLGtHQUFrRyxFQUMxRyxRQUFRLENBQUMsU0FBUztBQUNsQixhQUNFLGVBQWUsc0JBQXNCLEVBQ3JDLFNBQVMsV0FBVyxnQkFBZ0IsRUFBRSxFQUN0QyxTQUFTLE9BQU8sVUFBa0I7QUFDbEMscUJBQVcsZUFBZTtBQUMxQixnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2hDLENBQUM7QUFBQSxNQUNILENBQUM7QUFHRixZQUFNLHdCQUF3QixrQkFBa0IsVUFBVTtBQUMxRCxVQUFJLDBCQUFRLHFCQUFxQixFQUMvQixRQUFRLGVBQWUsRUFDdkIsUUFBUSwyRUFBMkUsRUFDbkY7QUFBQSxRQUFZLENBQUMsYUFDYixTQUNFLFVBQVUsUUFBUSwrQkFBK0IsRUFDakQsVUFBVSxVQUFVLHVDQUF1QyxFQUMzRCxTQUFTLFdBQVcsWUFBWSxFQUNoQyxTQUFTLE9BQU8sVUFBa0I7QUFDbEMscUJBQVcsZUFBZTtBQUMxQixnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixlQUFLLHNDQUFzQyxXQUFXLEVBQUU7QUFBQSxRQUN6RCxDQUFDO0FBQUEsTUFDSDtBQUdELFlBQU0sa0JBQWtCLGtCQUFrQixVQUFVO0FBQ3BELFVBQUksMEJBQVEsZUFBZSxFQUV6QixRQUFRLHVCQUF1QixFQUMvQixRQUFRLDREQUE0RCxFQUNwRTtBQUFBLFFBQVUsQ0FBQ0EsWUFDWEEsUUFDRSxTQUFTLFdBQVcsbUJBQW1CLEtBQUssRUFDNUMsU0FBUyxPQUFPLFVBQW1CO0FBQ25DLHFCQUFXLGtCQUFrQjtBQUM3QixnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2hDLENBQUM7QUFBQSxNQUNIO0FBR0QsWUFBTSxxQkFBcUIsa0JBQWtCLFVBQVUsRUFBRSxLQUFLLDBCQUEwQixDQUFDO0FBQ3pGLHlCQUFtQixVQUFVLE9BQU8sNENBQTRDLFdBQVcsaUJBQWlCLFFBQVE7QUFDcEgseUJBQW1CLFVBQVUsT0FBTywyQ0FBMkMsV0FBVyxpQkFBaUIsUUFBUTtBQUNuSCxVQUFJLDBCQUFRLGtCQUFrQixFQUM1QixRQUFRLGlCQUFpQixFQUN6QixRQUFRLDBHQUEwRyxFQUNsSDtBQUFBLFFBQVEsQ0FBQyxTQUNULEtBQ0UsZUFBZSxPQUFPLEVBQ3RCLFNBQVMsV0FBVyxhQUFhLEVBQ2pDLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxxQkFBVyxnQkFBZ0I7QUFDM0IsZ0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUNoQyxDQUFDO0FBQUEsTUFDSDtBQUdELFlBQU0sb0JBQW9CLGtCQUFrQixVQUFVO0FBQ3RELFVBQUksMEJBQVEsaUJBQWlCLEVBQzNCLFFBQVEscUJBQXFCLEVBQzdCLFlBQVksQ0FBQyxTQUFTO0FBQ3RCLGFBQ0UsZUFBZSxnREFBZ0QsRUFDL0QsU0FBUyxXQUFXLFFBQVEsRUFDNUIsU0FBUyxPQUFPLFVBQWtCO0FBQ2xDLHFCQUFXLFdBQVc7QUFDdEIsZ0JBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUNoQyxDQUFDO0FBQ0YsYUFBSyxRQUFRLFVBQVUsSUFBSSxrQ0FBa0M7QUFDN0QsZUFBTztBQUFBLE1BQ1IsQ0FBQyxFQUNBLEtBQUssQ0FBQyxZQUFZO0FBQ2xCLGdCQUFRLE9BQU8sTUFBTTtBQUNyQixjQUFNLFVBQVUsUUFBUSxPQUFPLFNBQVMsS0FBSztBQUM3QyxnQkFBUSxTQUFTLE9BQU8sRUFBRSxNQUFNLCtDQUErQyxDQUFDO0FBQ2hGLGdCQUFRLFNBQVMsT0FBTyxFQUFFLE1BQU0sdURBQXVELENBQUM7QUFDeEYsZ0JBQVEsU0FBUyxPQUFPLEVBQUUsTUFBTSxrRkFBa0YsQ0FBQztBQUFBLE1BQ3BILENBQUM7QUFHRixZQUFNLGtCQUFrQixrQkFBa0IsVUFBVTtBQUNwRCxZQUFNLGdCQUFnQixJQUFJLDBCQUFRLGVBQWUsRUFDL0MsUUFBUSxFQUFFLEVBQ1YsVUFBVSxDQUFDLFdBQVc7QUFDdEIsZUFDRSxjQUFjLFFBQVEsRUFDdEIsV0FBVyxFQUNYLFFBQVEsWUFBWTtBQUNwQixnQkFBTSxjQUFjLEtBQUssT0FBTyxTQUFTLGFBQWEsS0FBSyxRQUFNLEdBQUcsT0FBTyxXQUFXLEVBQUU7QUFDeEYsZ0JBQU0sWUFBVywyQ0FBYSxTQUFRO0FBQ3RDLGdCQUFNLFFBQVEsSUFBSTtBQUFBLFlBQ2pCLEtBQUs7QUFBQSxZQUNMLG9DQUFvQyxRQUFRO0FBQUEsWUFDNUM7QUFBQSxZQUNBO0FBQUEsVUFDRDtBQUNBLGdCQUFNLFlBQVksTUFBTSxNQUFNLGNBQWM7QUFDNUMsY0FBSSxXQUFXO0FBQ2Qsa0JBQU0sS0FBSyx3QkFBd0IsV0FBVyxFQUFFO0FBQUEsVUFDakQ7QUFBQSxRQUNELENBQUM7QUFBQSxNQUNILENBQUM7QUFHRixvQkFBYyxVQUFVLFVBQVUsSUFBSSwrQkFBK0I7QUFHckUsV0FBSyxrQ0FBa0MsV0FBVyxJQUFJLFdBQVcsT0FBTztBQUFBLElBQ3pFLENBQUM7QUFHRCxpQkFBYSxRQUFRLENBQUMsZUFBNEI7QUFDakQsV0FBSyw0QkFBNEIsV0FBVyxJQUFJLElBQUk7QUFBQSxJQUNyRCxDQUFDO0FBR0QsVUFBTSxxQkFBcUIsS0FBSyw0QkFBNEIsVUFBVSxFQUFFLEtBQUssc0NBQXNDLENBQUM7QUFDcEgsVUFBTSxZQUFZLG1CQUFtQixTQUFTLFVBQVU7QUFBQSxNQUN2RCxLQUFLO0FBQUEsTUFDTCxNQUFNO0FBQUEsSUFDUCxDQUFDO0FBQ0QsY0FBVSxpQkFBaUIsU0FBUyxNQUFNO0FBQ3pDLFdBQUsscUJBQXFCO0FBQUEsSUFDM0IsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVRLGtDQUFrQyxRQUFnQixTQUFrQjtBQTU4QjdFO0FBNjhCRSxVQUFNLHFCQUFvQixVQUFLLGdDQUFMLG1CQUFrQyxjQUFjLGtCQUFrQixNQUFNO0FBQ2xHLFFBQUksbUJBQW1CO0FBQ3RCLFlBQU0sZUFBZSxLQUFLLE9BQU8sU0FBUyxnQkFBZ0IsQ0FBQztBQUMzRCxZQUFNLGNBQWMsYUFBYSxLQUFLLENBQUMsT0FBb0IsR0FBRyxPQUFPLE1BQU07QUFDM0UsWUFBTSxlQUFjLGdEQUFhLGNBQWIsWUFBMEI7QUFDOUMsWUFBTSxrQkFBa0IsV0FBVyxDQUFDO0FBRXBDLHdCQUFrQixVQUFVLE9BQU8sNENBQTRDLGVBQWU7QUFDOUYsd0JBQWtCLFVBQVUsT0FBTywyQ0FBMkMsQ0FBQyxlQUFlO0FBQUEsSUFDL0Y7QUFBQSxFQUNEO0FBQUEsRUFFUSxzQ0FBc0MsUUFBZ0I7QUF6OUIvRDtBQTA5QkUsVUFBTSxlQUFlLEtBQUssT0FBTyxTQUFTLGdCQUFnQixDQUFDO0FBQzNELFVBQU0sYUFBYSxhQUFhLEtBQUssVUFBUSxLQUFLLE9BQU8sTUFBTTtBQUMvRCxRQUFJLENBQUMsV0FBWTtBQUVqQixVQUFNLHNCQUFxQixVQUFLLGdDQUFMLG1CQUFrQyxjQUFjLGtCQUFrQixNQUFNO0FBQ25HLFFBQUksb0JBQW9CO0FBQ3ZCLHlCQUFtQixVQUFVLE9BQU8sNENBQTRDLFdBQVcsaUJBQWlCLFFBQVE7QUFDcEgseUJBQW1CLFVBQVUsT0FBTywyQ0FBMkMsV0FBVyxpQkFBaUIsUUFBUTtBQUFBLElBQ3BIO0FBQUEsRUFDRDtBQUFBLEVBRVEsNkNBQTZDLFFBQWdCO0FBcitCdEU7QUFzK0JFLFVBQU0sZUFBZSxLQUFLLE9BQU8sU0FBUyxnQkFBZ0IsQ0FBQztBQUMzRCxVQUFNLGFBQWEsYUFBYSxLQUFLLFVBQVEsS0FBSyxPQUFPLE1BQU07QUFDL0QsUUFBSSxDQUFDLFdBQVk7QUFFakIsVUFBTSw2QkFBNEIsVUFBSyxnQ0FBTCxtQkFBa0MsY0FBYyxrQkFBa0IsTUFBTTtBQUMxRyxRQUFJLDJCQUEyQjtBQUM5QixnQ0FBMEIsVUFBVSxPQUFPLDRDQUE0QyxDQUFDLENBQUMsV0FBVyxVQUFVLFdBQVcsT0FBTyxLQUFLLE1BQU0sRUFBRTtBQUM3SSxnQ0FBMEIsVUFBVSxPQUFPLDJDQUEyQyxDQUFDLFdBQVcsVUFBVSxXQUFXLE9BQU8sS0FBSyxNQUFNLEVBQUU7QUFBQSxJQUM1STtBQUFBLEVBQ0Q7QUFBQSxFQUVRLDRCQUE0QixRQUFnQixTQUF5QjtBQWovQjlFO0FBay9CRSxVQUFNLGVBQWUsS0FBSyxPQUFPLFNBQVMsZ0JBQWdCLENBQUM7QUFDM0QsVUFBTSxjQUFjLGFBQWEsS0FBSyxVQUFRLEtBQUssT0FBTyxNQUFNO0FBQ2hFLFFBQUksQ0FBQyxZQUFhO0FBRWxCLFVBQU0scUJBQW9CLFVBQUssZ0NBQUwsbUJBQWtDLGNBQWMsa0JBQWtCLE1BQU07QUFDbEcsUUFBSSxDQUFDLGtCQUFtQjtBQUd4QixVQUFNLGlCQUFpQixZQUFZLFVBQVUsSUFBSSxLQUFLO0FBQ3RELFVBQU0sbUJBQTZCLENBQUM7QUFFcEMsZUFBVyxhQUFhLGNBQWM7QUFDckMsVUFBSSxVQUFVLE9BQU8sVUFBVSxDQUFDLFVBQVUsUUFBUztBQUVuRCxZQUFNLGVBQWUsVUFBVSxVQUFVLElBQUksS0FBSztBQUlsRCxVQUFJLGtCQUFrQixNQUFNLGdCQUFnQixJQUFJO0FBQy9DLHlCQUFpQixLQUFLLFVBQVUsUUFBUSxTQUFTO0FBQUEsTUFDbEQsV0FFUyxrQkFBa0IsZUFBZSxrQkFBa0IsSUFBSTtBQUMvRCx5QkFBaUIsS0FBSyxVQUFVLFFBQVEsU0FBUztBQUFBLE1BQ2xEO0FBQUEsSUFDRDtBQUVBLFFBQUksaUJBQWlCLFNBQVMsR0FBRztBQUNoQyx3QkFBa0IsWUFBWSxRQUFRO0FBQ3RDLHdCQUFrQixjQUFjLGFBQWEsaUJBQWlCLEtBQUssSUFBSSxDQUFDLFlBQVksaUJBQWlCLFdBQVcsSUFBSSxNQUFNLEVBQUU7QUFBQSxJQUM3SCxPQUFPO0FBQ04sd0JBQWtCLFNBQVMsUUFBUTtBQUFBLElBQ3BDO0FBQUEsRUFDRDtBQUFBLEVBR0EsTUFBYyxrQkFBa0IsUUFBZ0I7QUFDL0MsVUFBTSxXQUFXLEtBQUssT0FBTztBQUM3QixVQUFNLGVBQWUsU0FBUyxnQkFBZ0IsQ0FBQztBQUMvQyxVQUFNLGVBQWUsYUFBYSxVQUFVLENBQUMsT0FBb0IsR0FBRyxPQUFPLE1BQU07QUFFakYsUUFBSSxnQkFBZ0IsRUFBRztBQUd2QixLQUFDLGFBQWEsWUFBWSxHQUFHLGFBQWEsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsZUFBZSxDQUFDLEdBQUcsYUFBYSxZQUFZLENBQUM7QUFDMUgsYUFBUyxlQUFlO0FBQ3hCLFVBQU0sS0FBSyxPQUFPLGFBQWE7QUFDL0IsU0FBSyx5QkFBeUI7QUFBQSxFQUMvQjtBQUFBLEVBRUEsTUFBYyxvQkFBb0IsUUFBZ0I7QUFDakQsVUFBTSxXQUFXLEtBQUssT0FBTztBQUM3QixVQUFNLGVBQWUsU0FBUyxnQkFBZ0IsQ0FBQztBQUMvQyxVQUFNLGVBQWUsYUFBYSxVQUFVLENBQUMsT0FBb0IsR0FBRyxPQUFPLE1BQU07QUFFakYsUUFBSSxlQUFlLEtBQUssZ0JBQWdCLGFBQWEsU0FBUyxFQUFHO0FBR2pFLEtBQUMsYUFBYSxZQUFZLEdBQUcsYUFBYSxlQUFlLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxlQUFlLENBQUMsR0FBRyxhQUFhLFlBQVksQ0FBQztBQUMxSCxhQUFTLGVBQWU7QUFDeEIsVUFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixTQUFLLHlCQUF5QjtBQUFBLEVBQy9CO0FBQUEsRUFFQSxNQUFjLDBCQUEwQixRQUFnQjtBQUN2RCxVQUFNLFdBQVcsS0FBSyxPQUFPO0FBQzdCLFVBQU0sZUFBZSxTQUFTLGdCQUFnQixDQUFDO0FBQy9DLFVBQU0sY0FBYyxhQUFhLEtBQUssQ0FBQyxPQUFvQixHQUFHLE9BQU8sTUFBTTtBQUUzRSxRQUFJLENBQUMsWUFBYTtBQUVsQixnQkFBWSxZQUFZLENBQUMsWUFBWTtBQUNyQyxVQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLFNBQUssa0NBQWtDLFFBQVEsWUFBWSxPQUFPO0FBQUEsRUFDbkU7QUFBQSxFQUVBLE1BQWMsd0JBQXdCLFFBQWdCO0FBQ3JELFVBQU0sV0FBVyxLQUFLLE9BQU87QUFDN0IsVUFBTSxlQUFlLFNBQVMsZ0JBQWdCLENBQUM7QUFDL0MsYUFBUyxlQUFlLGFBQWEsT0FBTyxDQUFDLE9BQW9CLEdBQUcsT0FBTyxNQUFNO0FBRWpGLFVBQU0sS0FBSyxPQUFPLGFBQWE7QUFDL0IsU0FBSyx5QkFBeUI7QUFDOUIsU0FBSyxPQUFPLG9CQUFvQjtBQUVoQyxnQ0FBNEIsS0FBSyxRQUE2QixRQUFRO0FBQUEsRUFDdkU7QUFBQSxFQUVRLGVBQWUsV0FBMkI7QUFDakQsUUFBSSxDQUFDLFVBQVcsUUFBTztBQUN2QixRQUFJO0FBQ0gsWUFBTSxrQkFBbUIsS0FBSyxJQUF3SjtBQUd0TCxVQUFJLG1CQUFtQixPQUFPLGdCQUFnQixpQkFBaUIsWUFBWTtBQUMxRSxZQUFJO0FBQ0gsZ0JBQU0sY0FBYyxnQkFBZ0IsYUFBYTtBQUNqRCxnQkFBTSxVQUFVLFlBQVksS0FBSyxDQUFDLFFBQXVDLElBQUksT0FBTyxTQUFTO0FBQzdGLGNBQUksbUNBQVMsTUFBTTtBQUNsQixtQkFBTyxRQUFRO0FBQUEsVUFDaEI7QUFBQSxRQUNELFNBQVMsR0FBRztBQUNYLGtCQUFRLEtBQUssbUVBQW1FLENBQUM7QUFBQSxRQUNsRjtBQUFBLE1BQ0Q7QUFHQSxVQUFJO0FBQ0gsY0FBTSxXQUFXLG1EQUFpQjtBQUNsQyxZQUFJLFlBQVksT0FBTyxhQUFhLFVBQVU7QUFDN0MsZ0JBQU0sVUFBVyxTQUErQyxTQUFTO0FBQ3pFLGNBQUksbUNBQVMsTUFBTTtBQUNsQixtQkFBTyxRQUFRO0FBQUEsVUFDaEI7QUFBQSxRQUNEO0FBQUEsTUFDRCxTQUFTLEdBQUc7QUFDWCxnQkFBUSxLQUFLLDZEQUE2RCxDQUFDO0FBQUEsTUFDNUU7QUFBQSxJQUNELFNBQVMsR0FBRztBQUNYLGNBQVEsS0FBSyxnREFBZ0QsQ0FBQztBQUFBLElBQy9EO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVRLFlBQVksUUFBd0I7QUFDM0MsUUFBSSxDQUFDLE9BQVEsUUFBTztBQUVwQixXQUFPLE9BQ0wsUUFBUSxZQUFZLEVBQUUsRUFDdEIsTUFBTSxHQUFHLEVBQ1QsSUFBSSxVQUFRLEtBQUssT0FBTyxDQUFDLEVBQUUsWUFBWSxJQUFJLEtBQUssTUFBTSxDQUFDLENBQUMsRUFDeEQsS0FBSyxHQUFHO0FBQUEsRUFDWDtBQUNEOzs7QUtubkNPLElBQU0sdUJBQU4sTUFBMkI7QUFBQSxFQUNqQyxZQUFvQixVQUFpQztBQUFqQztBQUFBLEVBQW1DO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQVUvQyw0QkFBNEIsTUFBc0I7QUFDekQsVUFBTSxZQUFZLEtBQUssUUFBUSxHQUFHO0FBQ2xDLFFBQUksT0FBTyxhQUFhLElBQUksS0FBSyxNQUFNLEdBQUcsU0FBUyxJQUFJO0FBQ3ZELFVBQU0sU0FBUyxhQUFhLElBQUksS0FBSyxNQUFNLFNBQVMsSUFBSTtBQUV4RCxXQUFPLEtBQUssUUFBUSxTQUFTLEVBQUU7QUFHL0IsUUFBSSxXQUFXO0FBQ2YsUUFBSSxnQkFBZ0I7QUFDcEIsUUFBSSxlQUFrQztBQUN0QyxRQUFJLGdCQUFnQjtBQUdwQixVQUFNLGVBQWUsS0FBSyxTQUFTLGdCQUFnQixDQUFDO0FBQ3BELFVBQU0sY0FBYyx5QkFBeUIsWUFBWTtBQUV6RCxlQUFXLGVBQWUsYUFBYTtBQUN0QyxVQUFJLENBQUMsWUFBWSxRQUFTO0FBRTFCLFVBQUksVUFBVTtBQUdkLFVBQUksQ0FBQyxZQUFZLFVBQVUsWUFBWSxPQUFPLEtBQUssTUFBTSxJQUFJO0FBQzVELFlBQUksQ0FBQyxLQUFLLFNBQVMsR0FBRyxLQUFLLEtBQUssTUFBTSxHQUFHLEVBQUUsV0FBVyxHQUFHO0FBQ3hELG9CQUFVO0FBQUEsUUFDWDtBQUFBLE1BQ0QsV0FBVyxxQkFBcUIsTUFBTSxZQUFZLE1BQU0sR0FBRztBQUMxRCxrQkFBVTtBQUFBLE1BQ1g7QUFFQSxVQUFJLFNBQVM7QUFDWix3QkFBZ0IsWUFBWSxVQUFVO0FBQ3RDLG1CQUFXLFlBQVksZ0JBQWdCO0FBQ3ZDLHVCQUFlLFlBQVk7QUFDM0Isd0JBQWdCLFlBQVksaUJBQWlCO0FBQzdDO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFHQSxRQUFJLGVBQWU7QUFDbEIsYUFBTyxLQUFLLE1BQU0sY0FBYyxTQUFTLENBQUM7QUFBQSxJQUMzQztBQUVBLFFBQUksbUJBQW1CO0FBS3ZCLFFBQUksaUJBQWlCLGNBQWMsS0FBSyxNQUFNLElBQUk7QUFDakQsWUFBTSxRQUFRLEtBQUssTUFBTSxHQUFHO0FBQzVCLFVBQUksTUFBTSxNQUFNLFNBQVMsQ0FBQyxNQUFNLGVBQWU7QUFDOUMsY0FBTSxJQUFJO0FBQ1YsZUFBTyxNQUFNLEtBQUssR0FBRztBQUNyQiwyQkFBbUI7QUFBQSxNQUNwQjtBQUFBLElBQ0QsV0FBVyxpQkFBaUIsVUFBVTtBQUdyQyxZQUFNLG1CQUFtQjtBQUN6QixZQUFNLFFBQVEsS0FBSyxNQUFNLEdBQUc7QUFDNUIsVUFBSSxNQUFNLE1BQU0sU0FBUyxDQUFDLE1BQU0sa0JBQWtCO0FBQ2pELGNBQU0sSUFBSTtBQUNWLGVBQU8sTUFBTSxLQUFLLEdBQUc7QUFDckIsMkJBQW1CO0FBQUEsTUFDcEI7QUFBQSxJQUNEO0FBRUEsVUFBTSxZQUFZLEtBQUssTUFBTSxHQUFHLEVBQUUsSUFBSSxVQUFRLFlBQVksSUFBSSxDQUFDO0FBQy9ELFVBQU0sT0FBTyxVQUFVLEtBQUssR0FBRztBQUcvQixRQUFJLFVBQVU7QUFDYixVQUFJLENBQUMsU0FBUyxXQUFXLEdBQUcsRUFBRyxZQUFXLE1BQU07QUFDaEQsVUFBSSxDQUFDLFNBQVMsU0FBUyxHQUFHLEVBQUcsYUFBWTtBQUFBLElBQzFDO0FBTUEsVUFBTSwwQkFBMEIsS0FBSyxTQUFTLDJCQUEyQixxQkFBcUIsQ0FBQztBQUUvRixXQUFPLEdBQUcsUUFBUSxHQUFHLElBQUksR0FBRyx5QkFBeUIsTUFBTSxFQUFFLEdBQUcsTUFBTTtBQUFBLEVBQ3ZFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBcUIsS0FBVSxNQUFhLFNBQStCO0FBQzFFLFVBQU0sY0FBYyxRQUFRO0FBRzVCLFVBQU0sV0FBVyxJQUFJLFlBQVkscUJBQXFCLE1BQU0sSUFBSSxFQUFFO0FBQ2xFLFFBQUksU0FBUyxXQUFXLElBQUksR0FBRztBQUU5QixZQUFNLFdBQVcsS0FBSztBQUN0QixhQUFPLEtBQUssUUFBUSxJQUFJLFdBQVcsSUFBSSxXQUFXO0FBQUEsSUFDbkQsT0FBTztBQUdOLFlBQU0sV0FBVyxJQUFJLFlBQVkscUJBQXFCLE1BQU0sSUFBSSxFQUFFO0FBRWxFLFVBQUksU0FBUyxXQUFXLElBQUksR0FBRztBQUU5QixjQUFNLFdBQVcsS0FBSztBQUN0QixlQUFPLEtBQUssUUFBUSxJQUFJLFdBQVcsSUFBSSxXQUFXO0FBQUEsTUFDbkQsT0FBTztBQUVOLGNBQU0sUUFBUSxTQUFTLE1BQU0seUJBQXlCO0FBQ3RELFlBQUksT0FBTztBQUNWLGdCQUFNLENBQUMsRUFBRSxFQUFFLElBQUksSUFBSTtBQUVuQixpQkFBTyxJQUFJLFdBQVcsS0FBSyxJQUFJLElBQUksbUJBQW1CLFdBQVcsQ0FBQztBQUFBLFFBQ25FLE9BQU87QUFFTixnQkFBTSxrQkFBa0IsbUJBQW1CLEtBQUssSUFBSTtBQUVwRCxpQkFBTyxJQUFJLFdBQVcsS0FBSyxlQUFlLElBQUksbUJBQW1CLFdBQVcsQ0FBQztBQUFBLFFBQzlFO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx5QkFBeUIsTUFBYSxTQUErQjtBQUNwRSxVQUFNLGNBQWMsUUFBUTtBQUU1QixVQUFNLFdBQVcsS0FBSztBQUN0QixXQUFPLEtBQUssUUFBUSxJQUFJLFdBQVcsSUFBSSxXQUFXO0FBQUEsRUFDbkQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUFrQixNQUFhLFNBQStCO0FBQzdELFVBQU0sY0FBYyxRQUFRO0FBQzVCLFVBQU0sU0FBUyxZQUFZLFdBQVc7QUFFdEMsVUFBTSxlQUFlLEdBQUcsS0FBSyxJQUFJLElBQUksTUFBTTtBQUMzQyxVQUFNLFdBQVcsS0FBSyw0QkFBNEIsWUFBWTtBQUM5RCxXQUFPLElBQUksV0FBVyxLQUFLLFFBQVE7QUFBQSxFQUNwQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esc0JBQXNCLE1BQWEsU0FBK0I7QUFDakUsVUFBTSxjQUFjLFFBQVE7QUFDNUIsVUFBTSxTQUFTLFlBQVksV0FBVztBQUV0QyxVQUFNLGVBQWUsR0FBRyxLQUFLLElBQUksSUFBSSxNQUFNO0FBQzNDLFVBQU0sV0FBVyxLQUFLLDRCQUE0QixZQUFZO0FBRTlELFdBQU8sS0FBSyxXQUFXLElBQUksUUFBUTtBQUFBLEVBQ3BDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxXQUFXLE1BQXNCO0FBRWhDLFVBQU0sZ0JBQWdCLEtBQUssTUFBTSx5QkFBeUI7QUFDMUQsUUFBSSxlQUFlO0FBQ2xCLGFBQU8sY0FBYyxDQUFDO0FBQUEsSUFDdkI7QUFHQSxVQUFNLGdCQUFnQixLQUFLLE1BQU0sa0JBQWtCO0FBQ25ELFFBQUksZUFBZTtBQUNsQixZQUFNLFVBQVUsY0FBYyxDQUFDO0FBRS9CLFlBQU0sV0FBVyxRQUFRLE1BQU0sR0FBRyxFQUFFLENBQUM7QUFDckMsYUFBTztBQUFBLElBQ1I7QUFHQSxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsYUFBYSxLQUFVLE1BQWEsU0FBK0I7QUFDbEUsUUFBSSxLQUFLLFNBQVMsMEJBQTBCLFNBQVM7QUFFcEQsYUFBTyxLQUFLLGtCQUFrQixNQUFNLE9BQU87QUFBQSxJQUM1QyxPQUFPO0FBRU4sYUFBTyxLQUFLLHFCQUFxQixLQUFLLE1BQU0sT0FBTztBQUFBLElBQ3BEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQWtCLEtBQVUsTUFBYSxNQUFtQztBQUMzRSxVQUFNLFFBQVEsSUFBSSxjQUFjLGFBQWEsSUFBSTtBQUNqRCxRQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sVUFBVTtBQUM5QixhQUFPO0FBQUEsSUFDUjtBQUdBLGFBQVMsSUFBSSxNQUFNLFNBQVMsU0FBUyxHQUFHLEtBQUssR0FBRyxLQUFLO0FBQ3BELFlBQU0sVUFBVSxNQUFNLFNBQVMsQ0FBQztBQUNoQyxVQUFJLFFBQVEsU0FBUyxNQUFNLFFBQVEsTUFBTTtBQUN4QyxlQUFPO0FBQUEsTUFDUjtBQUFBLElBQ0Q7QUFFQSxXQUFPO0FBQUEsRUFDUjtBQUNEOzs7QUN2T0EsSUFBQUMsb0JBQTRCOzs7QUNBNUIsSUFBQUMsb0JBQTJCO0FBTXBCLElBQU0saUJBQU4sY0FBNkIsd0JBQU07QUFBQSxFQUl6QyxZQUFZLEtBQVUsV0FBcUI7QUFDMUMsVUFBTSxHQUFHO0FBSlYsa0JBQXlDO0FBQ3pDLDBCQUFxRTtBQUFBLEVBSXJFO0FBQUEsRUFFQSxTQUFTO0FBQ1IsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFDaEIsY0FBVSxTQUFTLGdDQUFnQztBQUVuRCxjQUFVLFNBQVMsTUFBTSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFFaEUsY0FBVSxTQUFTLEtBQUs7QUFBQSxNQUN2QixNQUFNO0FBQUEsSUFDUCxDQUFDO0FBRUQsVUFBTSxlQUFlLFVBQVUsU0FBUyxJQUFJO0FBQzVDLGlCQUFhLFNBQVMsTUFBTSxFQUFFLE1BQU0saUZBQWlGLENBQUM7QUFDdEgsaUJBQWEsU0FBUyxNQUFNLEVBQUUsTUFBTSw2RkFBNkYsQ0FBQztBQUVsSSxVQUFNLGtCQUFrQixVQUFVLFVBQVUsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBRTdFLFVBQU0sYUFBYSxnQkFBZ0IsU0FBUyxVQUFVO0FBQUEsTUFDckQsTUFBTTtBQUFBLE1BQ04sS0FBSztBQUFBLElBQ04sQ0FBQztBQUNELGVBQVcsVUFBVSxNQUFNO0FBQzFCLFdBQUssU0FBUyxFQUFFLFFBQVEsT0FBTztBQUMvQixXQUFLLE1BQU07QUFBQSxJQUNaO0FBRUEsVUFBTSxnQkFBZ0IsZ0JBQWdCLFNBQVMsVUFBVTtBQUFBLE1BQ3hELE1BQU07QUFBQSxNQUNOLEtBQUs7QUFBQSxJQUNOLENBQUM7QUFDRCxrQkFBYyxVQUFVLE1BQU07QUFDN0IsV0FBSyxTQUFTLEVBQUUsUUFBUSxVQUFVO0FBQ2xDLFdBQUssTUFBTTtBQUFBLElBQ1o7QUFBQSxFQUNEO0FBQUEsRUFFQSxVQUFVO0FBQ1QsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFDaEIsUUFBSSxLQUFLLGtCQUFrQixLQUFLLFFBQVE7QUFDdkMsV0FBSyxlQUFlLEtBQUssTUFBTTtBQUFBLElBQ2hDO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSxnQkFBa0Q7QUFDdkQsV0FBTyxJQUFJLFFBQVEsQ0FBQyxZQUFZO0FBQy9CLFdBQUssaUJBQWlCO0FBQ3RCLFdBQUssS0FBSztBQUFBLElBQ1gsQ0FBQztBQUFBLEVBQ0Y7QUFDRDs7O0FEM0RPLElBQU0sbUJBQU4sTUFBdUI7QUFBQSxFQUMxQixZQUFvQixLQUFrQixRQUFzQztBQUF4RDtBQUFrQjtBQUFBLEVBQXdDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLOUUsTUFBYSwwQkFBeUM7QUFDbEQsVUFBTSxXQUFXLEtBQUssT0FBTztBQUc3QixRQUFJLFNBQVMsb0JBQW9CO0FBQzdCO0FBQUEsSUFDSjtBQUdBLFVBQU0sbUJBQW1CLFNBQVMseUJBQXlCLFVBQWEsU0FBUztBQUNqRixVQUFNLG1CQUFtQixTQUFTLGdCQUFnQixVQUFhLFNBQVM7QUFFeEUsUUFBSSxDQUFDLG9CQUFvQixDQUFDLGtCQUFrQjtBQUV4QyxlQUFTLHFCQUFxQjtBQUM5QixZQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CO0FBQUEsSUFDSjtBQUdBLFVBQU0scUJBQXNCLFNBQStEO0FBQzNGLFVBQU0sdUJBQXVCLFNBQVMsZ0JBQWdCLHNCQUFzQixDQUFDO0FBQzdFLFVBQU0sWUFBc0IsQ0FBQztBQUM3QixRQUFJLHFCQUFxQixLQUFLLENBQUMsT0FBb0IsR0FBRyxTQUFTLE9BQU8sR0FBRztBQUNyRSxnQkFBVSxLQUFLLE9BQU87QUFBQSxJQUMxQjtBQUNBLFFBQUkscUJBQXFCLEtBQUssQ0FBQyxPQUFvQixHQUFHLFNBQVMsT0FBTyxHQUFHO0FBQ3JFLGdCQUFVLEtBQUssT0FBTztBQUFBLElBQzFCO0FBRUEsUUFBSSxnQkFBZ0I7QUFHcEIsUUFBSSxVQUFVLFNBQVMsR0FBRztBQUN0QixZQUFNLElBQUksUUFBYyxDQUFDLFlBQVk7QUFDakMsbUJBQVcsTUFBTTtBQUNiLGdCQUFNLFlBQVk7QUFDZCxnQkFBSTtBQUNBLG9CQUFNLFFBQVEsSUFBSSxlQUFlLEtBQUssS0FBSyxTQUFTO0FBQ3BELG9CQUFNLGlCQUFpQixJQUFJLFFBQWlDLENBQUMsbUJBQW1CO0FBQzVFLDJCQUFXLE1BQU07QUFDYixpQ0FBZSxFQUFFLFFBQVEsT0FBTyxDQUFDO0FBQUEsZ0JBQ3JDLEdBQUcsR0FBSztBQUFBLGNBQ1osQ0FBQztBQUVELG9CQUFNLFNBQVMsTUFBTSxRQUFRLEtBQUs7QUFBQSxnQkFDOUIsTUFBTSxjQUFjO0FBQUEsZ0JBQ3BCO0FBQUEsY0FDSixDQUFDO0FBRUQsa0JBQUksT0FBTyxXQUFXLFFBQVE7QUFDMUIsZ0NBQWdCO0FBQ2hCLG9CQUFJLHlCQUFPLDhEQUE4RDtBQUFBLGNBQzdFO0FBQUEsWUFDSixTQUFTLE9BQU87QUFDWixzQkFBUSxLQUFLLDBCQUEwQixLQUFLO0FBQzVDLDhCQUFnQjtBQUNoQixrQkFBSSx5QkFBTyx1RUFBdUU7QUFBQSxZQUN0RjtBQUNBLG9CQUFRO0FBQUEsVUFDWixHQUFHO0FBQUEsUUFDUCxHQUFHLEdBQUc7QUFBQSxNQUNWLENBQUM7QUFBQSxJQUNMO0FBRUEsUUFBSSxDQUFDLGVBQWU7QUFDaEIsZUFBUyxxQkFBcUI7QUFDOUIsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQjtBQUFBLElBQ0o7QUFHQSxVQUFNLGdCQUErQixDQUFDO0FBR3RDLFFBQUksb0JBQW9CLENBQUMsVUFBVSxTQUFTLE9BQU8sR0FBRztBQUNsRCxZQUFNLFlBQXlCO0FBQUEsUUFDM0IsSUFBSSxTQUFTLEtBQUssSUFBSSxDQUFDO0FBQUEsUUFDdkIsTUFBTTtBQUFBLFFBQ04sUUFBUSxTQUFTLGVBQWU7QUFBQSxRQUNoQyxjQUFjLFNBQVMscUJBQXFCO0FBQUEsUUFDNUMsVUFBVSxTQUFTLG1CQUFtQjtBQUFBLFFBQ3RDLFNBQVM7QUFBQSxRQUNULGNBQWMsU0FBUyxnQkFBZ0I7QUFBQSxRQUN2QyxlQUFlLFNBQVMsaUJBQWlCO0FBQUEsUUFDekMsa0JBQWtCLFNBQVMsNkJBQTZCO0FBQUEsUUFDeEQsd0JBQXdCLFNBQVMsMEJBQTBCO0FBQUEsUUFDM0QsaUJBQWlCO0FBQUEsTUFDckI7QUFDQSxvQkFBYyxLQUFLLFNBQVM7QUFBQSxJQUNoQztBQUdBLFFBQUksb0JBQW9CLENBQUMsVUFBVSxTQUFTLE9BQU8sR0FBRztBQUNsRCxZQUFNLFlBQXlCO0FBQUEsUUFDM0IsSUFBSSxTQUFTLEtBQUssSUFBSSxDQUFDO0FBQUEsUUFDdkIsTUFBTTtBQUFBLFFBQ04sUUFBUSxTQUFTLGVBQWU7QUFBQSxRQUNoQyxjQUFjLFNBQVMscUJBQXFCO0FBQUEsUUFDNUMsVUFBVSxTQUFTLGdCQUFnQjtBQUFBLFFBQ25DLFNBQVM7QUFBQSxRQUNULGNBQWMsU0FBUyxxQkFBcUI7QUFBQSxRQUM1QyxlQUFlLFNBQVMsc0JBQXNCO0FBQUEsUUFDOUMsa0JBQWtCLFNBQVMsNkJBQTZCO0FBQUEsUUFDeEQsd0JBQXdCO0FBQUEsUUFDeEIsaUJBQWlCO0FBQUEsTUFDckI7QUFDQSxvQkFBYyxLQUFLLFNBQVM7QUFBQSxJQUNoQztBQUVBLFVBQU0sa0JBQWtCLFNBQVMsZ0JBQWdCLENBQUM7QUFDbEQsVUFBTSxxQkFBcUIsc0JBQXNCLENBQUM7QUFFbEQsUUFBSSxnQkFBK0IsZ0JBQWdCLFNBQVMsSUFBSSxrQkFBa0I7QUFDbEYsUUFBSSxhQUE0QixDQUFDLEdBQUcsYUFBYTtBQUVqRCxRQUFJLGNBQWMsU0FBUyxHQUFHO0FBQzFCLFlBQU0sZ0JBQWdCLElBQUksSUFBSSxjQUFjLElBQUksUUFBTSxHQUFHLElBQUksQ0FBQztBQUM5RCxZQUFNLG1CQUFtQixjQUFjLE9BQU8sUUFBTSxDQUFDLGNBQWMsSUFBSSxHQUFHLElBQUksQ0FBQztBQUUvRSxVQUFJLGlCQUFpQixTQUFTLEdBQUc7QUFDN0IscUJBQWEsQ0FBQyxHQUFHLGVBQWUsR0FBRyxnQkFBZ0I7QUFBQSxNQUN2RDtBQUFBLElBQ0o7QUFFQSxhQUFTLGVBQWU7QUFHeEIsVUFBTSxlQUFlO0FBQUEsTUFDakI7QUFBQSxNQUFzQjtBQUFBLE1BQTBCO0FBQUEsTUFBZTtBQUFBLE1BQy9EO0FBQUEsTUFBd0I7QUFBQSxNQUFnQjtBQUFBLE1BQWlCO0FBQUEsTUFDekQ7QUFBQSxNQUE2QjtBQUFBLE1BQWU7QUFBQSxNQUFlO0FBQUEsTUFDM0Q7QUFBQSxNQUFxQjtBQUFBLE1BQXNCO0FBQUEsTUFBZ0I7QUFBQSxJQUMvRDtBQUVBLFVBQU0saUJBQWlCO0FBQ3ZCLGVBQVcsU0FBUyxjQUFjO0FBQzlCLGFBQU8sZUFBZSxLQUFLO0FBQUEsSUFDL0I7QUFFQSxhQUFTLHFCQUFxQjtBQUM5QixVQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLFVBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsUUFBSSxjQUFjLFNBQVMsR0FBRztBQUMxQixVQUFJLHlCQUFPLHdCQUF3QixjQUFjLE1BQU0sNEJBQTRCO0FBRW5GLGlCQUFXLE1BQU07QUFDYixZQUFJLEtBQUssT0FBTyx1QkFBdUIseUJBQXlCO0FBQzVELGdCQUFNLGNBQWMsS0FBSyxPQUFPO0FBQ2hDLGNBQUk7QUFDQSxnQkFBSSxZQUFZLCtCQUErQixZQUFZLGFBQWE7QUFDcEUsMEJBQVksUUFBUTtBQUFBLFlBQ3hCO0FBQUEsVUFDSixTQUFTLEdBQUc7QUFDUixvQkFBUSxLQUFLLG1EQUFtRCxDQUFDO0FBQUEsVUFDckU7QUFBQSxRQUNKO0FBQUEsTUFDSixHQUFHLEdBQUc7QUFBQSxJQUNWO0FBQUEsRUFDSjtBQUNKOzs7QUU1S0EsSUFBQUMsb0JBQW1DO0FBTTVCLElBQU0scUJBQU4sTUFBeUI7QUFBQSxFQUc1QixZQUNZLEtBQ0EsUUFDVjtBQUZVO0FBQ0E7QUFKWixTQUFRLHFCQUEwQyxvQkFBSSxJQUFJO0FBQUEsRUFLdEQ7QUFBQSxFQUVHLGFBQWEsTUFBbUI7QUFDbkMsVUFBTSxZQUFZO0FBQ2QsWUFBTSxNQUFNLEtBQUssSUFBSTtBQUVyQixVQUFJLEVBQUUsZ0JBQWdCLDRCQUFXLEtBQUssY0FBYyxRQUFRLEtBQUssY0FBYyxPQUFRO0FBQ25GO0FBQUEsTUFDSjtBQUVBLFlBQU0sV0FBVyxLQUFLO0FBR3RCLFlBQU0sY0FBYyxLQUFLLE9BQU8sbUJBQW1CLElBQUksUUFBUTtBQUMvRCxVQUFJLGVBQWUsTUFBTSxjQUFjLElBQUksS0FBSyxLQUFNO0FBQ2xEO0FBQUEsTUFDSjtBQUdBLFlBQU0sZ0JBQWdCLEtBQUssbUJBQW1CLElBQUksUUFBUSxLQUFLO0FBQy9ELFVBQUksZ0JBQWdCLEtBQUssTUFBTSxnQkFBZ0IsVUFBVSxhQUFhO0FBQ2xFO0FBQUEsTUFDSjtBQUdBLFVBQUksZ0JBQWdCLEtBQUssTUFBTSxnQkFBZ0IsS0FBTTtBQUNqRCxhQUFLLG1CQUFtQixPQUFPLFFBQVE7QUFBQSxNQUMzQztBQUdBLFlBQU0saUJBQWlCLE1BQU0sVUFBVSxjQUFjO0FBQ3JELGlCQUFXLENBQUMsTUFBTSxJQUFJLEtBQUssS0FBSyxtQkFBbUIsUUFBUSxHQUFHO0FBQzFELFlBQUksT0FBTyxnQkFBZ0I7QUFDdkIsZUFBSyxtQkFBbUIsT0FBTyxJQUFJO0FBQUEsUUFDdkM7QUFBQSxNQUNKO0FBR0EsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUcvQixZQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUNwRCxZQUFNLGVBQWUsY0FBYyxXQUFXLFNBQVMsS0FBSztBQUM1RCxVQUFJLENBQUMsS0FBSyxPQUFPLFNBQVMsZ0NBQWdDLENBQUMsY0FBYztBQUNyRTtBQUFBLE1BQ0o7QUFFQSxZQUFNLGVBQWUsS0FBSyxPQUFPLFNBQVMsZ0JBQWdCLENBQUM7QUFDM0QsWUFBTSx5QkFBeUIsYUFBYSxLQUFLLFFBQU0sR0FBRyxPQUFPO0FBRWpFLFVBQUksQ0FBQyx3QkFBd0I7QUFDekI7QUFBQSxNQUNKO0FBRUEsWUFBTSxxQkFBcUIseUJBQXlCLFlBQVk7QUFDaEUsVUFBSSx1QkFBc0M7QUFDMUMsWUFBTSxnQkFBK0IsQ0FBQztBQUV0QyxpQkFBVyxlQUFlLG9CQUFvQjtBQUMxQyxZQUFJLENBQUMsWUFBWSxRQUFTO0FBRTFCLFlBQUksVUFBVTtBQUVkLFlBQUksQ0FBQyxZQUFZLFVBQVUsWUFBWSxPQUFPLEtBQUssTUFBTSxJQUFJO0FBQ3pELGNBQUksQ0FBQyxTQUFTLFNBQVMsR0FBRyxLQUFLLFNBQVMsTUFBTSxHQUFHLEVBQUUsV0FBVyxHQUFHO0FBQzdELHNCQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0osV0FBVyxxQkFBcUIsVUFBVSxZQUFZLE1BQU0sR0FBRztBQUMzRCxjQUFJLFlBQVksa0JBQWtCO0FBQzlCLGtCQUFNLGVBQWUsU0FBUyxNQUFNLEdBQUc7QUFDdkMsa0JBQU0sWUFBWSxhQUFhO0FBQy9CLGtCQUFNLGtCQUFrQixZQUFZLE9BQU8sTUFBTSxHQUFHO0FBQ3BELGtCQUFNLGdCQUFnQixnQkFBZ0I7QUFFdEMsZ0JBQUksWUFBWSxpQkFBaUIsVUFBVTtBQUN2QyxvQkFBTSxjQUFjLFlBQVk7QUFDaEMsa0JBQUksZ0JBQWdCLGlCQUFpQixnQkFBZ0IsZ0JBQWdCLEdBQUc7QUFDcEUsMEJBQVU7QUFBQSxjQUNkO0FBQUEsWUFDSixPQUFPO0FBQ0gsa0JBQUksY0FBYyxlQUFlO0FBQzdCLDBCQUFVO0FBQUEsY0FDZDtBQUFBLFlBQ0o7QUFBQSxVQUNKLE9BQU87QUFDSCxzQkFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBRUEsWUFBSSxTQUFTO0FBQ1Qsd0JBQWMsS0FBSyxXQUFXO0FBQzlCLGNBQUksQ0FBQyxzQkFBc0I7QUFDdkIsbUNBQXVCLFlBQVk7QUFBQSxVQUN2QztBQUFBLFFBQ0o7QUFBQSxNQUNKO0FBRUEsVUFBSSxjQUFjLFNBQVMsR0FBRztBQUMxQixjQUFNLFlBQVksY0FBYyxJQUFJLFFBQU0sR0FBRyxRQUFRLFNBQVMsRUFBRSxLQUFLLElBQUk7QUFDekUsWUFBSSx5QkFBTywyQkFBMkIsU0FBUywyQ0FBMkMsY0FBYyxDQUFDLEVBQUUsUUFBUSxTQUFTLEVBQUU7QUFBQSxNQUNsSTtBQUVBLFVBQUksQ0FBQyxzQkFBc0I7QUFDdkI7QUFBQSxNQUNKO0FBRUEsWUFBTSxPQUFPLE1BQU0sS0FBSyxJQUFJLE1BQU0sUUFBUSxLQUFLLEtBQUssSUFBSTtBQUN4RCxZQUFNLGFBQVksNkJBQU0sVUFBVSxNQUFNLEtBQUssUUFBUSxVQUFVO0FBRS9ELFVBQUksQ0FBQyxXQUFXO0FBQ1o7QUFBQSxNQUNKO0FBRUEsWUFBTSxJQUFJLFFBQVEsYUFBVyxXQUFXLFNBQVMsRUFBRSxDQUFDO0FBRXBELFVBQUk7QUFDSixVQUFJO0FBQ0Esa0JBQVUsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLElBQUk7QUFBQSxNQUM1QyxTQUFTLE9BQU87QUFDWixnQkFBUSxNQUFNLDRDQUE0QyxLQUFLO0FBQy9EO0FBQUEsTUFDSjtBQUVBLFVBQUksUUFBUSxLQUFLLEVBQUUsU0FBUyxHQUFHO0FBQzNCLFlBQUksUUFBUSxXQUFXLEtBQUssR0FBRztBQUMzQixnQkFBTSxpQkFBaUIsUUFBUSxRQUFRLFNBQVMsQ0FBQztBQUNqRCxjQUFJLG1CQUFtQixJQUFJO0FBQ3ZCLGtCQUFNLGtCQUFrQixRQUFRLE1BQU0sR0FBRyxjQUFjLEVBQUUsS0FBSztBQUM5RCxrQkFBTSxRQUFRLGdCQUFnQixNQUFNLElBQUksRUFBRSxPQUFPLFVBQVEsS0FBSyxLQUFLLEVBQUUsU0FBUyxDQUFDO0FBRS9FLGdCQUFJLENBQUMsS0FBSyxPQUFPLFNBQVMsZ0NBQWdDLE1BQU0sU0FBUyxHQUFHO0FBQ3hFO0FBQUEsWUFDSjtBQUVBLGdCQUFJLE1BQU0sU0FBUyxLQUFNLE1BQU0sV0FBVyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsV0FBVyxRQUFRLEdBQUk7QUFDNUU7QUFBQSxZQUNKO0FBQUEsVUFDSjtBQUFBLFFBQ0o7QUFDQSxjQUFNLDRCQUE0QixRQUFRLFdBQVcsS0FBSyxJQUNwRCxRQUFRLE1BQU0sUUFBUSxRQUFRLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLElBQ3BELFFBQVEsS0FBSztBQUNuQixZQUFJLDBCQUEwQixTQUFTLEdBQUc7QUFDdEM7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUVBLFdBQUssbUJBQW1CLElBQUksS0FBSyxNQUFNLEdBQUc7QUFFMUMsaUJBQVcsTUFBTTtBQUNiLGFBQUssbUJBQW1CLE9BQU8sS0FBSyxJQUFJO0FBQUEsTUFDNUMsR0FBRyxVQUFVLGNBQWMsR0FBRztBQUU5QixVQUFJLFdBQVcsS0FBSyxLQUFLLE1BQU0sS0FBSyxRQUFRLHNCQUFzQixPQUFPLElBQUksRUFBRSxLQUFLO0FBQUEsSUFDeEYsR0FBRztBQUFBLEVBQ1A7QUFDSjs7O0FDbEtPLFNBQVMsZUFBZSxVQUFrQixVQUFVLEtBQXdCO0FBQ2xGLFNBQU8sSUFBSSxRQUFRLENBQUMsU0FBUyxXQUFXO0FBQ3ZDLFVBQU0sVUFBVSxTQUFTLGNBQWMsUUFBUTtBQUMvQyxRQUFJLFNBQVM7QUFDWixhQUFPLFFBQVEsT0FBTztBQUFBLElBQ3ZCO0FBRUEsVUFBTSxXQUFXLElBQUksaUJBQWlCLENBQUMsY0FBYztBQUNwRCxZQUFNLGdCQUFnQixTQUFTLGNBQWMsUUFBUTtBQUNyRCxVQUFJLGVBQWU7QUFDbEIsZ0JBQVEsYUFBYTtBQUNyQixpQkFBUyxXQUFXO0FBQ3BCLHFCQUFhLEtBQUs7QUFBQSxNQUNuQjtBQUFBLElBQ0QsQ0FBQztBQUVELGFBQVMsUUFBUSxTQUFTLE1BQU07QUFBQSxNQUMvQixXQUFXO0FBQUEsTUFDWCxTQUFTO0FBQUEsSUFDVixDQUFDO0FBRUQsVUFBTSxRQUFRLFdBQVcsTUFBTTtBQUM5QixlQUFTLFdBQVc7QUFDcEIsYUFBTyxJQUFJLE1BQU0sa0RBQWtELFFBQVEsRUFBRSxDQUFDO0FBQUEsSUFDL0UsR0FBRyxPQUFPO0FBQUEsRUFDWCxDQUFDO0FBQ0Y7OztBbkJaQSxJQUFxQixzQkFBckIsY0FBaUQseUJBQStDO0FBQUEsRUFBaEc7QUFBQTtBQU1DLFNBQU8scUJBQTBDLG9CQUFJLElBQUk7QUFDekQsU0FBUSxpQkFBc0Msb0JBQUksSUFBSTtBQUN0RCxTQUFRLHFCQUF5QztBQUNqRCxTQUFRLG1CQUF1QztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFhL0MsTUFBYywwQkFBeUM7QUFDdEQsUUFBSSxDQUFDLEtBQUssa0JBQWtCO0FBQzNCLFdBQUssbUJBQW1CLElBQUksaUJBQWlCLEtBQUssS0FBSyxJQUFJO0FBQUEsSUFDNUQ7QUFDQSxVQUFNLEtBQUssaUJBQWlCLHdCQUF3QjtBQUFBLEVBQ3JEO0FBQUEsRUFFQSxNQUFNLFNBQVM7QUFDZCxVQUFNLEtBQUssYUFBYTtBQUd4QixTQUFLLG1CQUFtQixJQUFJLGlCQUFpQixLQUFLLEtBQUssSUFBSTtBQUMzRCxTQUFLLHFCQUFxQixJQUFJLG1CQUFtQixLQUFLLEtBQUssSUFBSTtBQUMvRCxTQUFLLFVBQVUsSUFBSSxlQUFlLEtBQUssS0FBSyxLQUFLLFVBQVUsSUFBSTtBQUMvRCxTQUFLLGlCQUFpQixJQUFJLGVBQWUsS0FBSyxLQUFLLEtBQUssUUFBUTtBQUNoRSxTQUFLLHVCQUF1QixJQUFJLHFCQUFxQixLQUFLLFFBQVE7QUFHbEUsUUFBSSxLQUFLLFNBQVMsd0JBQXdCO0FBQ3pDLFdBQUssbUJBQW1CLENBQUMsS0FBSyxHQUFHLFVBQVU7QUFBQSxJQUM1QztBQUdBLFNBQUssSUFBSSxVQUFVLGNBQWMsTUFBTTtBQUN0QyxXQUFLLG9CQUFvQjtBQUV6QixVQUFJLENBQUMsMkJBQVMsVUFBVTtBQUN2QixhQUFLLEtBQUssaUJBQWlCO0FBQUEsTUFDNUI7QUFHQSxXQUFLLEtBQUssd0JBQXdCO0FBQUEsSUFDbkMsQ0FBQztBQUdELHFCQUFpQixNQUFNLEtBQUssUUFBUTtBQUdwQyxnQ0FBNEIsTUFBTSxLQUFLLFFBQVE7QUFHL0MsU0FBSyxjQUFjLElBQUksd0JBQXdCLEtBQUssS0FBSyxJQUFJO0FBQzdELFNBQUssY0FBYyxLQUFLLFdBQVc7QUFHbkMsU0FBSyxvQkFBb0I7QUFHekIsU0FBSyxvQkFBb0I7QUFHekIsU0FBSywrQkFBK0I7QUFBQSxFQUNyQztBQUFBLEVBRU8sc0JBQXNCO0FBQzVCLFFBQUksS0FBSyxnQkFBZ0I7QUFDeEIsV0FBSyxJQUFJLE1BQU0sT0FBTyxLQUFLLGNBQWM7QUFDekMsV0FBSyxpQkFBaUI7QUFBQSxJQUN2QjtBQUVBLFVBQU0saUJBQWlCLEtBQUssSUFBSSxNQUFNLEdBQUcsVUFBVSxDQUFDLFNBQVM7QUFDNUQsVUFBSSxnQkFBZ0IseUJBQU87QUFDMUIsYUFBSyxtQkFBbUIsYUFBYSxJQUFJO0FBQ3pDLGFBQUssMEJBQTBCO0FBQUEsTUFDaEM7QUFBQSxJQUNELENBQUM7QUFDRCxTQUFLLGNBQWMsY0FBYztBQUNqQyxTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFUSw0QkFBNEI7QUFDbkMsVUFBTSxNQUFNLEtBQUssSUFBSTtBQUNyQixVQUFNLE1BQU0sSUFBSSxLQUFLO0FBQ3JCLGVBQVcsQ0FBQyxNQUFNLFNBQVMsS0FBSyxLQUFLLG1CQUFtQixRQUFRLEdBQUc7QUFDbEUsVUFBSSxNQUFNLFlBQVksS0FBSztBQUMxQixhQUFLLG1CQUFtQixPQUFPLElBQUk7QUFBQSxNQUNwQztBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDcEIsVUFBTSxhQUFjLE1BQU0sS0FBSyxTQUFTO0FBQ3hDLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixVQUErRDtBQUduSCxRQUFJLENBQUMsS0FBSyxTQUFTLGdCQUFnQixDQUFDLE1BQU0sUUFBUSxLQUFLLFNBQVMsWUFBWSxHQUFHO0FBQzlFLFdBQUssU0FBUyxlQUFlLENBQUM7QUFBQSxJQUMvQjtBQUVBLFFBQUksQ0FBQyxLQUFLLFNBQVMsb0JBQW9CO0FBQ3RDLFlBQU0saUJBQWlCLEtBQUs7QUFDNUIsWUFBTSxpQkFBaUIsZUFBZSxzQkFBc0IsTUFBTSxRQUFRLGVBQWUsa0JBQWtCLEtBQUssZUFBZSxtQkFBbUIsU0FBUztBQUMzSixZQUFNLGNBQWMsS0FBSyxTQUFTLGdCQUFnQixNQUFNLFFBQVEsS0FBSyxTQUFTLFlBQVksS0FBSyxLQUFLLFNBQVMsYUFBYSxTQUFTO0FBRW5JLFVBQUksa0JBQWtCLENBQUMsYUFBYTtBQUNuQyxhQUFLLFNBQVMsZUFBZSxlQUFlLHNCQUFzQixDQUFDO0FBQUEsTUFDcEU7QUFBQSxJQUNELE9BQU87QUFDTixZQUFNLGVBQWU7QUFBQSxRQUNwQjtBQUFBLFFBQXNCO0FBQUEsUUFBMEI7QUFBQSxRQUFlO0FBQUEsUUFDL0Q7QUFBQSxRQUF3QjtBQUFBLFFBQWdCO0FBQUEsUUFBaUI7QUFBQSxRQUN6RDtBQUFBLFFBQTZCO0FBQUEsUUFBZTtBQUFBLFFBQWU7QUFBQSxRQUMzRDtBQUFBLFFBQXFCO0FBQUEsUUFBc0I7QUFBQSxRQUFnQjtBQUFBLE1BQzVEO0FBRUEsWUFBTSxpQkFBaUIsS0FBSztBQUM1QixpQkFBVyxTQUFTLGNBQWM7QUFDakMsWUFBSSxlQUFlLEtBQUssTUFBTSxRQUFXO0FBQ3hDLGlCQUFPLGVBQWUsS0FBSztBQUFBLFFBQzVCO0FBQUEsTUFDRDtBQUNBLFlBQU0sS0FBSyxhQUFhO0FBQUEsSUFDekI7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDcEIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFDbEM7QUFBQSxFQUVRLHNCQUFzQjtBQUM3QixTQUFLO0FBQUEsTUFDSixLQUFLLElBQUksVUFBVSxHQUFHLGVBQWUsQ0FBQyxNQUFNLFFBQVEsU0FBUztBQUM1RCxZQUFJLENBQUMsS0FBSyxTQUFTLHVCQUF1QjtBQUN6QztBQUFBLFFBQ0Q7QUFFQSxjQUFNLFNBQVMsT0FBTyxVQUFVO0FBQ2hDLGNBQU0sT0FBTyxLQUFLO0FBRWxCLFlBQUksRUFBRSxnQkFBZ0IsMEJBQVE7QUFDN0I7QUFBQSxRQUNEO0FBRUEsY0FBTSxVQUFVLEtBQUsscUJBQXFCLGtCQUFrQixLQUFLLEtBQUssTUFBTSxPQUFPLElBQUk7QUFFdkYsWUFBSSxTQUFTO0FBQ1osZ0JBQU0sV0FBVyxLQUFLLHFCQUFxQixhQUFhLEtBQUssS0FBSyxNQUFNLE9BQU87QUFDL0UsZ0JBQU0sVUFBVSxLQUFLLHFCQUFxQixXQUFXLFFBQVE7QUFFN0QsZUFBSyxRQUFRLENBQUMsU0FBUztBQUN0QixpQkFDRSxTQUFTLG1CQUFtQixFQUM1QixRQUFRLFFBQVEsRUFDaEIsUUFBUSxZQUFZO0FBQ3BCLG9CQUFNLFVBQVUsVUFBVSxVQUFVLE9BQU87QUFDM0Msa0JBQUkseUJBQU8sa0NBQWtDO0FBQUEsWUFDOUMsQ0FBQztBQUFBLFVBQ0gsQ0FBQztBQUVELGVBQUssUUFBUSxDQUFDLFNBQVM7QUFDdEIsaUJBQ0UsU0FBUyw2QkFBNkIsRUFDdEMsUUFBUSxTQUFTLEVBQ2pCLFFBQVEsWUFBWTtBQUNwQixvQkFBTSxVQUFVLFVBQVUsVUFBVSxRQUFRO0FBQzVDLGtCQUFJLHlCQUFPLDRDQUE0QztBQUFBLFlBQ3hELENBQUM7QUFBQSxVQUNILENBQUM7QUFBQSxRQUNGO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLG9CQUFvQixVQUF3QjtBQUMzQyx3QkFBNEIsS0FBSyxLQUFLLFVBQVUsS0FBSyxVQUFVLElBQUk7QUFBQSxFQUNwRTtBQUFBLEVBRU8sc0JBQXNCO0FBQzVCLFFBQUksMkJBQVMsVUFBVTtBQUN0QixVQUFJLEtBQUssb0JBQW9CO0FBQzVCLFlBQUk7QUFBRSxjQUFJLEtBQUssbUJBQW1CLFdBQVksTUFBSyxtQkFBbUIsT0FBTztBQUFBLFFBQUcsU0FBUTtBQUFBLFFBQWU7QUFDdkcsYUFBSyxxQkFBcUI7QUFBQSxNQUMzQjtBQUNBLFVBQUksS0FBSyxrQkFBa0I7QUFDMUIsWUFBSTtBQUFFLGNBQUksS0FBSyxpQkFBaUIsV0FBWSxNQUFLLGlCQUFpQixPQUFPO0FBQUEsUUFBRyxTQUFRO0FBQUEsUUFBZTtBQUNuRyxhQUFLLG1CQUFtQjtBQUFBLE1BQ3pCO0FBQ0EsVUFBSTtBQUNILGNBQU0sZ0JBQWdCLFNBQVMsaUJBQWlCLDhEQUE4RDtBQUM5RyxzQkFBYyxRQUFRLENBQUMsU0FBa0IsS0FBSyxPQUFPLENBQUM7QUFDdEQsY0FBTSxjQUFjLFNBQVMsaUJBQWlCLDBEQUEwRDtBQUN4RyxvQkFBWSxRQUFRLENBQUMsU0FBa0IsS0FBSyxPQUFPLENBQUM7QUFBQSxNQUNyRCxTQUFRO0FBQUEsTUFBZTtBQUN2QjtBQUFBLElBQ0Q7QUFFQSxVQUFNLHNCQUFzQixLQUFLLFNBQVMsNEJBQTRCLEtBQUssU0FBUztBQUNwRixVQUFNLG9CQUFvQixLQUFLLFNBQVMsMEJBQTBCLEtBQUssU0FBUztBQUVoRixRQUFJLEtBQUssb0JBQW9CO0FBQzVCLFVBQUk7QUFBRSxZQUFJLEtBQUssbUJBQW1CLFdBQVksTUFBSyxtQkFBbUIsT0FBTztBQUFBLE1BQUcsU0FBUTtBQUFBLE1BQWU7QUFDdkcsV0FBSyxxQkFBcUI7QUFBQSxJQUMzQjtBQUVBLFFBQUksS0FBSyxrQkFBa0I7QUFDMUIsVUFBSTtBQUFFLFlBQUksS0FBSyxpQkFBaUIsV0FBWSxNQUFLLGlCQUFpQixPQUFPO0FBQUEsTUFBRyxTQUFRO0FBQUEsTUFBZTtBQUNuRyxXQUFLLG1CQUFtQjtBQUFBLElBQ3pCO0FBRUEsUUFBSTtBQUNILGVBQVMsaUJBQWlCLDhEQUE4RCxFQUFFLFFBQVEsUUFBTSxHQUFHLE9BQU8sQ0FBQztBQUNuSCxlQUFTLGlCQUFpQiwwREFBMEQsRUFBRSxRQUFRLFFBQU0sR0FBRyxPQUFPLENBQUM7QUFBQSxJQUNoSCxTQUFRO0FBQUEsSUFBZTtBQUV2QixRQUFJLHFCQUFxQjtBQUN4QixXQUFLLHFCQUFxQixLQUFLLGNBQWMsbUJBQW1CLHlCQUF5QixNQUFNO0FBQzlGLFlBQUksQ0FBQyxLQUFLLFNBQVMsMkJBQTJCO0FBQzdDLGNBQUkseUJBQU8sb0NBQW9DO0FBQy9DO0FBQUEsUUFDRDtBQUNBLGtDQUEwQixLQUFLLEtBQUssS0FBSyxRQUFRO0FBQUEsTUFDbEQsQ0FBQztBQUNELFVBQUksS0FBSyxtQkFBb0IsTUFBSyxtQkFBbUIsYUFBYSx1Q0FBdUMsTUFBTTtBQUFBLElBQ2hIO0FBRUEsUUFBSSxtQkFBbUI7QUFDdEIsV0FBSyxtQkFBbUIsS0FBSyxjQUFjLFVBQVUscUJBQXFCLFlBQVk7QUFDckYsWUFBSSxDQUFDLEtBQUssU0FBUyw2QkFBNkI7QUFDL0MsY0FBSSx5QkFBTyx1Q0FBdUM7QUFDbEQ7QUFBQSxRQUNEO0FBQ0EsY0FBTSxlQUFlLEtBQUssS0FBSyxLQUFLLFFBQVE7QUFBQSxNQUM3QyxDQUFDO0FBQ0QsVUFBSSxLQUFLLGlCQUFrQixNQUFLLGlCQUFpQixhQUFhLHFDQUFxQyxNQUFNO0FBQUEsSUFDMUc7QUFFQSxTQUFLLDJCQUEyQjtBQUNoQyxTQUFLLCtCQUErQjtBQUFBLEVBQ3JDO0FBQUEsRUFFQSxXQUFXO0FBQ1YsUUFBSSxLQUFLLG9CQUFvQjtBQUM1QixXQUFLLG1CQUFtQixPQUFPO0FBQy9CLFdBQUsscUJBQXFCO0FBQUEsSUFDM0I7QUFDQSxRQUFJLEtBQUssa0JBQWtCO0FBQzFCLFdBQUssaUJBQWlCLE9BQU87QUFDN0IsV0FBSyxtQkFBbUI7QUFBQSxJQUN6QjtBQUNBLFFBQUksS0FBSywyQkFBMkI7QUFDbkMsV0FBSywwQkFBMEIsV0FBVztBQUMxQyxXQUFLLDRCQUE0QjtBQUFBLElBQ2xDO0FBQ0EsYUFBUyxLQUFLLFlBQVksbUNBQW1DO0FBQzdELGFBQVMsS0FBSyxZQUFZLGlDQUFpQztBQUMzRCxRQUFJLEtBQUssb0JBQW9CO0FBQzVCLFdBQUssbUJBQW1CLFdBQVc7QUFDbkMsV0FBSyxxQkFBcUI7QUFBQSxJQUMzQjtBQUNBLFFBQUksS0FBSyxrQkFBa0I7QUFDMUIsV0FBSyxpQkFBaUIsT0FBTztBQUM3QixXQUFLLG1CQUFtQjtBQUFBLElBQ3pCO0FBQ0EsU0FBSyxvQkFBb0I7QUFBQSxFQUMxQjtBQUFBLEVBRVEsaUNBQWlDO0FBQ3hDLFNBQUssMkJBQTJCO0FBQ2hDLFNBQUssK0JBQStCO0FBQUEsRUFDckM7QUFBQSxFQUVRLDZCQUE2QjtBQUNwQyxVQUFNLHlCQUF5QixDQUFDLEtBQUssU0FBUyw0QkFBNEIsQ0FBQyxLQUFLLFNBQVM7QUFDekYsVUFBTSx1QkFBdUIsQ0FBQyxLQUFLLFNBQVMsMEJBQTBCLENBQUMsS0FBSyxTQUFTO0FBRXJGLFFBQUksdUJBQXdCLFVBQVMsS0FBSyxTQUFTLG1DQUFtQztBQUFBLFFBQ2pGLFVBQVMsS0FBSyxZQUFZLG1DQUFtQztBQUVsRSxRQUFJLHFCQUFzQixVQUFTLEtBQUssU0FBUyxpQ0FBaUM7QUFBQSxRQUM3RSxVQUFTLEtBQUssWUFBWSxpQ0FBaUM7QUFBQSxFQUNqRTtBQUFBLEVBRVEsaUNBQWlDO0FBQ3hDLFFBQUksS0FBSywwQkFBMkIsTUFBSywwQkFBMEIsV0FBVztBQUU5RSxVQUFNLHlCQUF5QixDQUFDLEtBQUssU0FBUyw0QkFBNEIsQ0FBQyxLQUFLLFNBQVM7QUFDekYsVUFBTSx1QkFBdUIsQ0FBQyxLQUFLLFNBQVMsMEJBQTBCLENBQUMsS0FBSyxTQUFTO0FBRXJGLFFBQUksQ0FBQywwQkFBMEIsQ0FBQyxxQkFBc0I7QUFFdEQsU0FBSyw0QkFBNEIsSUFBSSxpQkFBaUIsQ0FBQyxjQUFjO0FBQ3BFLGlCQUFXLFlBQVksV0FBVztBQUNqQyxZQUFJLFNBQVMsV0FBVyxTQUFTLEdBQUc7QUFDbkMscUJBQVcsUUFBUSxNQUFNLEtBQUssU0FBUyxVQUFVLEdBQUc7QUFDbkQsZ0JBQUksZ0JBQWdCLGFBQWE7QUFDaEMsa0JBQUksS0FBSyxVQUFVLFNBQVMsTUFBTSxLQUFLLEtBQUssY0FBYyxPQUFPLEdBQUc7QUFDbkUscUJBQUssaUNBQWlDLElBQUk7QUFBQSxjQUMzQztBQUFBLFlBQ0Q7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELENBQUM7QUFFRCxTQUFLLDBCQUEwQixRQUFRLFNBQVMsTUFBTSxFQUFFLFdBQVcsTUFBTSxTQUFTLEtBQUssQ0FBQztBQUFBLEVBQ3pGO0FBQUEsRUFFUSxzQkFBc0I7QUFuVi9CO0FBb1ZFLFNBQUksVUFBSyxTQUFTLDBCQUFkLG1CQUFxQyxRQUFTLFVBQVMsS0FBSyxTQUFTLGlDQUFpQztBQUFBLFFBQ3JHLFVBQVMsS0FBSyxZQUFZLGlDQUFpQztBQUFBLEVBQ2pFO0FBQUEsRUFFQSxNQUFhLG1CQUFtQjtBQXhWakM7QUF5VkUsUUFBSSwyQkFBUyxVQUFVO0FBQ3RCLFdBQUssa0JBQWtCO0FBQ3ZCO0FBQUEsSUFDRDtBQUVBLFFBQUksS0FBSyxtQkFBb0IsTUFBSyxtQkFBbUIsV0FBVztBQUVoRSxVQUFNLEtBQUssYUFBYTtBQUN4QixTQUFLLG9CQUFvQjtBQUV6QixRQUFJLEdBQUMsVUFBSyxTQUFTLDBCQUFkLG1CQUFxQyxVQUFTO0FBQ2xELFdBQUssa0JBQWtCO0FBQ3ZCLFdBQUssd0JBQXdCO0FBQzdCO0FBQUEsSUFDRDtBQUVBLFFBQUk7QUFDSCxZQUFNLGFBQWEsTUFBTSxlQUFlLDREQUE0RCxHQUFLLEVBQ3ZHLEtBQUssU0FBTyxJQUFJLGFBQTRCO0FBRTlDLFVBQUksQ0FBQyxZQUFZO0FBQ2hCLGFBQUssd0JBQXdCO0FBQzdCO0FBQUEsTUFDRDtBQUVBLFdBQUssb0JBQW9CO0FBRXpCLFVBQUksS0FBSyxvQkFBb0IsS0FBSyxpQkFBaUIsaUJBQWlCLFNBQVMsS0FBSyxTQUFTLEtBQUssZ0JBQWdCLEtBQy9HLEtBQUssaUJBQWlCLGFBQWEsc0NBQXNDLEdBQUc7QUFDNUUsYUFBSyxpQkFBaUIsT0FBTztBQUFBLE1BQzlCO0FBQ0EsV0FBSyxtQkFBbUI7QUFFeEIsWUFBTSxlQUFlLFdBQVcsVUFBVSxJQUFJO0FBQzlDLG1CQUFhLFNBQVMsaUNBQWlDO0FBQ3ZELG1CQUFhLGdCQUFnQixZQUFZO0FBQ3pDLG1CQUFhLGFBQWEsd0NBQXdDLE1BQU07QUFDeEUsbUJBQWEsVUFBVSxJQUFJLGlDQUFpQztBQUM1RCxtQkFBYSxVQUFVO0FBRXZCLFlBQU0sa0JBQWdCLGtCQUFhLGNBQWMsS0FBSyxNQUFoQyxtQkFBbUMsa0JBQWlCO0FBQzFFLFVBQUk7QUFDSCxZQUFJLHlCQUF5QixhQUFhO0FBQ3pDLHlDQUFRLGVBQWUsS0FBSyxTQUFTLHNCQUFzQixNQUFNO0FBQUEsUUFDbEU7QUFBQSxNQUNELFNBQVMsT0FBTztBQUNmLGdCQUFRLEtBQUssd0NBQXdDLEtBQUs7QUFBQSxNQUMzRDtBQUVBLG1CQUFhLGlCQUFpQixTQUFTLENBQUMsUUFBb0I7QUExWS9ELFlBQUFDO0FBMllJLFlBQUksZUFBZTtBQUNuQixZQUFJLGdCQUFnQjtBQUVwQixjQUFNLGFBQVlBLE1BQUEsS0FBSyxTQUFTLDBCQUFkLGdCQUFBQSxJQUFxQztBQUN2RCxZQUFJLFdBQVc7QUFDZCxnQkFBTSxZQUFZO0FBaFp2QixnQkFBQUE7QUFpWk0sZ0JBQUk7QUFDSCxvQkFBTSxrQkFBa0IsS0FBSztBQUM3QixtQkFBSUEsTUFBQSxnQkFBZ0IsYUFBaEIsZ0JBQUFBLElBQTBCLG9CQUFvQjtBQUNqRCxzQkFBTSxnQkFBZ0IsU0FBUyxtQkFBbUIsU0FBUztBQUFBLGNBQzVEO0FBQUEsWUFDRCxTQUFTLE9BQU87QUFDZixzQkFBUSxLQUFLLDZDQUE2QyxLQUFLO0FBQy9ELGtCQUFJLHlCQUFPLDhCQUE4QixTQUFTLEVBQUU7QUFBQSxZQUNyRDtBQUFBLFVBQ0QsR0FBRztBQUFBLFFBQ0o7QUFBQSxNQUNELEdBQUcsSUFBSTtBQUVQLHVCQUFXLGtCQUFYLG1CQUEwQixhQUFhLGNBQWM7QUFDckQsV0FBSyxtQkFBbUI7QUFFeEIsaUJBQVcsTUFBTTtBQWphcEIsWUFBQUE7QUFrYUksYUFBSUEsTUFBQSxLQUFLLFNBQVMsMEJBQWQsZ0JBQUFBLElBQXFDLFFBQVMsTUFBSyx3QkFBd0I7QUFBQSxNQUNoRixHQUFHLEdBQUk7QUFBQSxJQUNSLFNBQVMsT0FBTztBQUNmLGNBQVEsS0FBSyxnREFBZ0QsS0FBSztBQUNsRSxXQUFLLHdCQUF3QjtBQUFBLElBQzlCO0FBQUEsRUFDRDtBQUFBLEVBRVEsMEJBQTBCO0FBMWFuQztBQTJhRSxRQUFJLEtBQUssbUJBQW9CLE1BQUssbUJBQW1CLFdBQVc7QUFDaEUsUUFBSSxHQUFDLFVBQUssU0FBUywwQkFBZCxtQkFBcUMsU0FBUztBQUVuRCxRQUFJLGdCQUErQjtBQUNuQyxTQUFLLHFCQUFxQixJQUFJLGlCQUFpQixNQUFNO0FBQ3BELFVBQUksY0FBZSxjQUFhLGFBQWE7QUFDN0Msc0JBQWdCLE9BQU8sV0FBVyxNQUFNO0FBQ3ZDLGNBQU1DLGdCQUFlLFNBQVMsY0FBYyxpQ0FBaUM7QUFDN0UsWUFBSSxDQUFDQSxjQUFjO0FBRW5CLGNBQU0scUJBQXFCLEtBQUssb0JBQW9CLEtBQUssaUJBQWlCLGlCQUFpQixTQUFTLEtBQUssU0FBUyxLQUFLLGdCQUFnQixLQUN0SSxLQUFLLGlCQUFpQixhQUFhLHNDQUFzQztBQUUxRSxZQUFJLENBQUMsb0JBQW9CO0FBQ3hCLGNBQUksS0FBSyxxQkFBcUIsQ0FBQyxTQUFTLEtBQUssU0FBUyxLQUFLLGdCQUFnQixLQUFLLENBQUMsS0FBSyxpQkFBaUIsYUFBYSxzQ0FBc0MsSUFBSTtBQUM3SixpQkFBSyxtQkFBbUI7QUFBQSxVQUN6QjtBQUNBLGVBQUssS0FBSyxpQkFBaUI7QUFBQSxRQUM1QjtBQUFBLE1BQ0QsR0FBRyxHQUFHO0FBQUEsSUFDUCxDQUFDO0FBRUQsVUFBTSxlQUFlLFNBQVMsY0FBYyxpQ0FBaUM7QUFDN0UsUUFBSSxhQUFjLE1BQUssbUJBQW1CLFFBQVEsY0FBYyxFQUFFLFdBQVcsTUFBTSxTQUFTLEtBQUssQ0FBQztBQUVsRyxVQUFNLGVBQWUsU0FBUyxjQUFjLG1DQUFtQztBQUMvRSxRQUFJLGFBQWMsTUFBSyxtQkFBbUIsUUFBUSxjQUFjLEVBQUUsV0FBVyxNQUFNLFNBQVMsS0FBSyxDQUFDO0FBRWxHLFFBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjO0FBQ25DLFlBQU0sWUFBWSxTQUFTLGNBQWMsa0JBQWtCO0FBQzNELFVBQUksVUFBVyxNQUFLLG1CQUFtQixRQUFRLFdBQVcsRUFBRSxXQUFXLE1BQU0sU0FBUyxLQUFLLENBQUM7QUFBQSxVQUN2RixNQUFLLG1CQUFtQixRQUFRLFNBQVMsTUFBTSxFQUFFLFdBQVcsTUFBTSxTQUFTLEtBQUssQ0FBQztBQUFBLElBQ3ZGO0FBQUEsRUFDRDtBQUFBLEVBRVEsb0JBQW9CO0FBQzNCLGFBQVMsS0FBSyxZQUFZLGlDQUFpQztBQUMzRCxRQUFJLEtBQUssa0JBQWtCO0FBQzFCLFdBQUssaUJBQWlCLE9BQU87QUFDN0IsV0FBSyxtQkFBbUI7QUFBQSxJQUN6QjtBQUNBLFNBQUssb0JBQW9CO0FBQUEsRUFDMUI7QUFBQSxFQUVRLGlDQUFpQyxhQUEwQjtBQXZkcEU7QUF3ZEUsVUFBTSx5QkFBeUIsQ0FBQyxLQUFLLFNBQVMsNEJBQTRCLENBQUMsS0FBSyxTQUFTO0FBQ3pGLFVBQU0sdUJBQXVCLENBQUMsS0FBSyxTQUFTLDBCQUEwQixDQUFDLEtBQUssU0FBUztBQUVyRixVQUFNLFlBQVksWUFBWSxpQkFBaUIsWUFBWTtBQUMzRCxlQUFXLFFBQVEsTUFBTSxLQUFLLFNBQVMsR0FBRztBQUN6QyxZQUFNLE1BQU0sS0FBSyxjQUFjLEtBQUs7QUFDcEMsVUFBSSxLQUFLO0FBQ1IsY0FBTSxXQUFXLElBQUksYUFBYSxhQUFhLEtBQUssSUFBSSxhQUFhLGNBQWMsTUFDakYsSUFBSSxVQUFVLFNBQVMsd0JBQXdCLElBQUksb0JBQW9CLFVBQ3ZFLElBQUksVUFBVSxTQUFTLGVBQWUsSUFBSSxXQUFXO0FBRXZELFlBQUksMEJBQTBCLGFBQWEsbUJBQW1CO0FBQzdELGVBQUksVUFBSyxnQkFBTCxtQkFBa0IsY0FBYyxTQUFTLFlBQWEsTUFBSyxPQUFPO0FBQUEsUUFDdkU7QUFDQSxZQUFJLHdCQUF3QixhQUFhLFVBQVU7QUFDbEQsZUFBSSxVQUFLLGdCQUFMLG1CQUFrQixjQUFjLFNBQVMsVUFBVyxNQUFLLE9BQU87QUFBQSxRQUNyRTtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIm5ld0ZpbGUiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiY29udGVudFR5cGUiLCAiX2EiLCAiaGFzTWF0Y2hpbmdDb250ZW50VHlwZSIsICJzZXR0aW5ncyIsICJwbHVnaW5JbnRlcmZhY2UiLCAiZmlsZSIsICJ0eXBlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAidG9nZ2xlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgInZhdWx0QWN0aW9ucyJdCn0K
